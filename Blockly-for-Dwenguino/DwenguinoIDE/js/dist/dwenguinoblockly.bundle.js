!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=20)}([function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var i=n(12);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}},function(e,t,n){var i=n(13),o=n(4);e.exports=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?o(e):t}},function(e,t,n){var i=n(11);function o(t,n,a){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=o=Reflect.get:e.exports=o=function(e,t,n){var o=i(e,t);if(o){var a=Object.getOwnPropertyDescriptor(o,t);return a.get?a.get.call(n):a.value}},o(t,n,a||t)}e.exports=o},function(e,t,n){var i=n(14),o=n(15),a=n(16),l=n(18);e.exports=function(e,t){return i(e)||o(e,t)||a(e,t)||l()}},function(e,t,n){e.exports=n(19)},function(e,t){function n(e,t,n,i,o,a,l){try{var s=e[a](l),r=s.value}catch(e){return void n(e)}s.done?t(r):Promise.resolve(r).then(i,o)}e.exports=function(e){return function(){var t=this,i=arguments;return new Promise((function(o,a){var l=e.apply(t,i);function s(e){n(l,o,a,s,r,"next",e)}function r(e){n(l,o,a,s,r,"throw",e)}s(void 0)}))}}},function(e,t,n){var i=n(3);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}},function(e,t){function n(t,i){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,i)}e.exports=n},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,a=void 0;try{for(var l,s=e[Symbol.iterator]();!(i=(l=s.next()).done)&&(n.push(l.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return n}}},function(e,t,n){var i=n(17);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){var i=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function s(e,t,n,i){var o=t&&t.prototype instanceof d?t:d,a=Object.create(o.prototype),l=new S(i||[]);return a._invoke=function(e,t,n){var i="suspendedStart";return function(o,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw a;return I()}for(n.method=o,n.arg=a;;){var l=n.delegate;if(l){var s=b(l,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var d=r(e,t,n);if("normal"===d.type){if(i=n.done?"completed":"suspendedYield",d.arg===c)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(i="completed",n.method="throw",n.arg=d.arg)}}}(e,n,l),a}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var c={};function d(){}function u(){}function p(){}var g={};g[o]=function(){return this};var h=Object.getPrototypeOf,m=h&&h(h(w([])));m&&m!==t&&n.call(m,o)&&(g=m);var v=p.prototype=d.prototype=Object.create(g);function f(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function y(e,t){var i;this._invoke=function(o,a){function l(){return new t((function(i,l){!function i(o,a,l,s){var c=r(e[o],e,a);if("throw"!==c.type){var d=c.arg,u=d.value;return u&&"object"==typeof u&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,l,s)}),(function(e){i("throw",e,l,s)})):t.resolve(u).then((function(e){d.value=e,l(d)}),(function(e){return i("throw",e,l,s)}))}s(c.arg)}(o,a,i,l)}))}return i=i?i.then(l,l):l()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var i=r(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,c;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function w(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:I}}function I(){return{value:void 0,done:!0}}return u.prototype=v.constructor=p,p.constructor=u,p[l]=u.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===u||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},f(y.prototype),y.prototype[a]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,i,o,a){void 0===a&&(a=Promise);var l=new y(s(t,n,i,o),a);return e.isGeneratorFunction(n)?l:l.next().then((function(e){return e.done?e.value:l.next()}))},f(v),v[l]="Generator",v[o]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=w,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return l.type="throw",l.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],l=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),r=n.call(a,"finallyLoc");if(s&&r){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var l=a?a.completion:{};return l.type=e,l.arg=t,a?(this.method="next",this.next=a.finallyLoc,c):this.complete(l)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=i}catch(e){Function("r","regeneratorRuntime = r")(i)}},function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),l=n(2),s=n.n(l),r=n(0),c=n.n(r),d=function(){function e(){a()(this,e)}return s()(e,[{key:"validateSchool",value:function(e){return""!==e?null:new Error(MSG.validator.errSchool)}},{key:"validateId",value:function(e){for(var t=0;t<4;t++)if(null==e[t])return new Error(MSG.validator.errId);return null}},{key:"validateAgeGroup",value:function(e){return void 0!==e?null:new Error(MSG.validator.errAgeGroup)}},{key:"validateGender",value:function(e){return void 0!==e?null:new Error(MSG.validator.errGender)}},{key:"validateActivityId",value:function(e){return""!==e?null:new Error(MSG.validator.errActivityId)}},{key:"hasErrors",value:function(e){for(var t=e.length,n=0;n<t;n++)if(null!=e[n])return!0;return!1}}]),e}(),u=function(){function e(){a()(this,e)}return s()(e,null,[{key:"getServerUrl",value:function(){return"http://localhost:12032"}}]),e}(),p=function(){function e(t){a()(this,e),c()(this,"username",null),c()(this,"password",null),c()(this,"currentlySelectedIcons",[null,null,null,null]),c()(this,"SIZE",4),c()(this,"icons",[{id:1,name:MSG.logging.person,html:'<span class="glyphicon icon-user"></span>'},{id:2,name:MSG.logging.dog,html:'<span class="glyphicon icon-dog"></span>'},{id:3,name:MSG.logging.car,html:'<span class="glyphicon icon-car"></span>'},{id:4,name:MSG.logging.camera,html:'<span class="glyphicon icon-camera"></span>'},{id:5,name:MSG.logging.heart,html:'<span class="glyphicon icon-heart"></span>'},{id:6,name:MSG.logging.plane,html:'<span class="glyphicon icon-plane"></span>'},{id:7,name:MSG.logging.house,html:'<span class="glyphicon icon-house"></span>'},{id:8,name:MSG.logging.umbrella,html:'<span class="glyphicon icon-umbrella"></span>'},{id:9,name:MSG.logging.star,html:'<span class="glyphicon icon-star"></span>'},{id:10,name:MSG.logging.money,html:'<span class="glyphicon icon-money"></span>'},{id:11,name:MSG.logging.gift,html:'<span class="glyphicon icon-gift"></span>'},{id:12,name:MSG.logging.keys,html:'<span class="glyphicon icon-keys"></span>'},{id:13,name:MSG.logging.music,html:'<span class="glyphicon icon-music"></span>'},{id:14,name:MSG.logging.snowflake,html:'<span class="glyphicon icon-snowflake"></span>'},{id:15,name:MSG.logging.fire,html:'<span class="glyphicon icon-fire"></span>'},{id:16,name:MSG.logging.envelope,html:'<span class="glyphicon icon-envelope"></span>'}]),c()(this,"schools",null),c()(this,"validator",null),c()(this,"eventLogger",null),this.validator=new d,this.eventLogger=t}return s()(e,[{key:"createInitialMenu",value:function(){this.createLoggingModalDialogWithoutFooter(MSG.logging.login),$("#loggingModalBody").append('<p id="loggingModalBody1"></p>'),$("#loggingModalBody").append('<div id="authentication_menu" class="tutorial_categories_wrapper"></div>'),$("#authentication_menu").append('<div id="authentication_new_user" class="tutorial_categories_item card"></div>'),$("#authentication_new_user").append('<div class="category_tag">'+MSG.logging.newuser+"</div>"),$("#authentication_new_user").append('<div id="new_user_img"></div>'),$("#authentication_menu").append('<div id="authentication_existing_user" class="tutorial_categories_item card"></div>'),$("#authentication_existing_user").append('<div class="category_tag">'+MSG.logging.login+"</div>"),$("#authentication_existing_user").append('<div id="school_user_img"></div>'),this.showDialog();var e=this;$("#authentication_new_user").click((function(){e.createUserMenu()})),$("#authentication_existing_user").click((function(){e.createLoginMenu()}))}},{key:"createLoginMenu",value:function(){var e=this;this.createLoggingModalDialog(MSG.logging.login),$("#loggingModalBody").append('<div id="inputUsername" class="ui-widget row mb-4">'),$("#inputUsername").append('<label for="myusernametag" class="col-md-3">'+MSG.logging.username+"</label>"),$("#inputUsername").append('<input id="myusernametag" name="myusernametag" class="col-md-8" placeholder="Enter username">'),e.createIconModule(),$("#loggingModalBody").append('<button id="reset_modal_dialog_button" type="button" class="btn btn-default mt-4">'+MSG.logging.reset+"</button>"),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),this.showDialog(),e.makeIconsResponsive(),$("#reset_modal_dialog_button").click((function(){e.resetSelectedIcons()})),$("#submit_modal_dialog_button").click((function(){e.login()}))}},{key:"login",value:function(){var e=this,t=[];if(User.username=$("input[name=myusernametag]").val(),User.password=JSON.stringify(e.currentlySelectedIcons),t.push(e.validator.validateId(e.currentlySelectedIcons)),e.validator.hasErrors(t))e.showErrors(t);else{var n={userId:User.username,password:JSON.stringify(e.currentlySelectedIcons)};$.ajax({type:"POST",url:u.getServerUrl()+"/authentication/authenticate",data:n}).done((function(t){e.eventLogger.setUserId(t.id),e.resetSelectedIcons(),e.removeDialog()})).fail((function(e,t){console.warn("Failed to log in:",t),console.log(e)}))}}},{key:"createUserMenu",value:function(){var e=this;e.createLoggingModalDialog(MSG.logging.newuser),$("#loggingModalBody").append('<div id="inputUsername" class="ui-widget row mb-4">'),$("#inputUsername").append('<label for="myusernametag" class="col-md-3">'+MSG.logging.username+"</label>"),$("#inputUsername").append('<input id="myusernametag" name="myusernametag" class="col-md-8" placeholder="'+MSG.logging.chooseUsername+'">'),e.createIconModule(),$("#loggingModalBody").append('<button id="reset_modal_dialog_button" type="button" class="btn btn-default mt-4">'+MSG.logging.reset+"</button>"),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),e.showDialog(),e.makeIconsResponsive(),$("#reset_modal_dialog_button").click((function(){e.resetSelectedIcons()})),$("#submit_modal_dialog_button").click((function(){e.registerUser()}))}},{key:"registerUser",value:function(){var e=this,t=[];if(User.username=$("input[name=myusernametag]").val(),User.password=JSON.stringify(e.currentlySelectedIcons),t.push(e.validator.validateId(e.currentlySelectedIcons)),e.validator.hasErrors(t))e.showErrors(t);else{var n={userId:User.username,password:JSON.stringify(e.currentlySelectedIcons)};$.ajax({type:"POST",url:u.getServerUrl()+"/authentication/new",data:n}).done((function(t){e.eventLogger.setUserId(e.username),e.resetSelectedIcons(),e.removeDialog(),e.showSettingsMenu()})).fail((function(e,t){console.log("Failed to register:",t)}))}}},{key:"showSettingsMenu",value:function(){var e=this;$.ajax({type:"GET",url:u.getServerUrl()+"/schools/"}).done((function(t){e.schools=t,e.createLoggingModalDialog(MSG.logging.setup),$("#loggingModalBody").append('<div id="inputSchool" class="ui-widget row mb-4">'),$("#inputSchool").append('<label for="myschooltags" class="col-md-2">'+MSG.logging.school+"</label>"),$("#inputSchool").append('<input id="myschooltags" name="myschooltags" class="form-control col-md-8" placeholder="'+MSG.logging.selectSchool+'">'),$("#loggingModalBody").append('<div id="inputAge" class="ui-widget row mb-4"></div>'),$("#inputAge").append('<label for="birth" class="col-md-3">'+MSG.logging.birth+"</label>"),$("#inputAge").append('<input type="date" class="form-control col-md-7" id="birth">'),$("#loggingModalBody").append('<div id="inputGender" class="ui-widget row mb-4"></div>'),$("#inputGender").append('<label for="birth" class="col-md-3">'+MSG.logging.gender+"</label>"),$("#inputGender").append('<div id="genderOptions" class="col-md-7">'),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="f">'+MSG.logging.gender1+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="m">'+MSG.logging.gender2+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="x">'+MSG.logging.gender3+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="na">'+MSG.logging.gender4+"</label>");var n=new Date,o=("0"+n.getDate()).slice(-2),a=("0"+(n.getMonth()+1)).slice(-2),l=n.getFullYear()+"-"+a+"-"+o;$("#birth").val(l),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),$("#loggingModal").modal("show"),e.schoolsAutocomplete=new autoComplete({selector:'input[name="myschooltags"]',minChars:2,source:function(e,n){e=e.toLowerCase();var o=t,a=[];for(i=0;i<o.length;i++)~o[i].naam.toLowerCase().indexOf(e)&&a.push(o[i].naam+", "+o[i].gemeente);n(a)}}),$("#submit_modal_dialog_button").click((function(){var t=[],n=$("input[name=myschooltags]").val(),i=$("#birth").val(),o=$("input[name=genderRadio]:checked").val();if(t.push(e.validator.validateSchool(n)),t.push(e.validator.validateGender(o)),e.validator.hasErrors(t))e.showErrors(t);else{e.eventLogger.setSchool(n),e.eventLogger.setDateOfBirth(i),e.eventLogger.setGender(o);var a={userId:User.username,password:User.password,school:n,dateOfBirth:i,gender:o};$.ajax({type:"POST",url:u.getServerUrl()+"/authentication/updateUser",data:a}).done((function(t){e.removeDialog(),console.log("[act;"+(e.eventLogger.dateOfBirth||"")+";"+(e.eventLogger.userId||"")+";"+(e.eventLogger.school||"")+"]")})).fail((function(e,t){console.warn("Failed to log in:",t)}))}}))})).fail((function(e,t){console.warn("Failed to fetch schools:",t)}))}},{key:"showDialog",value:function(){$("#loggingModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#loggingModal"),$(".modal-backdrop").remove()}},{key:"createLoggingModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="loggingModal" class="modal fade" role="dialog"></div>'),$("#loggingModal").append('<div id="loggingModalDialog" class="modal-dialog"></div>'),$("#loggingModalDialog").append('<div id="loggingModalContent" class="modal-content"></div>'),$("#loggingModalContent").append('<div id="loggingModalHeader" class="modal-header"></div>'),$("#loggingModalContent").append('<div id="loggingModalBody" class="modal-body"></div>'),$("#loggingModalContent").append('<div id="loggingModalFooter" class="modal-footer"></div>'),$("#loggingModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#loggingModalHeader").append('<h4 class="modal-title">'+e+"</h4>")}},{key:"createLoggingModalDialogWithoutFooter",value:function(e){this.removeDialog(),$("#db_body").append('<div id="loggingModal" class="modal fade" role="dialog"></div>'),$("#loggingModal").append('<div id="loggingModalDialog" class="modal-dialog"></div>'),$("#loggingModalDialog").append('<div id="loggingModalContent" class="modal-content"></div>'),$("#loggingModalContent").append('<div id="loggingModalHeader" class="modal-header"></div>'),$("#loggingModalContent").append('<div id="loggingModalBody" class="modal-body"></div>'),$("#loggingModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#loggingModalHeader").append('<h4 class="modal-title">'+e+"</h4>")}},{key:"showErrors",value:function(e){$("div").remove("#loggingModalErrors"),$("#loggingModalBody").append('<div id="loggingModalErrors" class="mt-4"></div>');for(var t=e.length,n=0;n<t;n++)null!=e[n]&&$("#loggingModalErrors").append("<p>"+e[n].message+"</p>")}},{key:"createIconModule",value:function(){$("#loggingModalBody").append('<div class="row"><div class="col-md-12 mt-4"><b>'+MSG.logging.choosePassword+"</b></div></div>"),$("#loggingModalBody").append('<div class="row"><div class="col-md-3 mt-4 mb-4">'+MSG.logging.currentlySelected+'</div><div class="col-md-8 mt-4 mb-4"><div id="currentlySelected" class="row"></div></div>'),$("#currentlySelected").append('<div id="currentlySelected0" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected1" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected2" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected3" class="col-2"></div>'),this.createIconGrid()}},{key:"makeIconsResponsive",value:function(){for(var e=this,t=function(t){for(var n=function(n){$("#r"+t+"c"+n).click((function(){e.addIconToId(t,n)}))},i=1;i<5;i++)n(i)},n=1;n<5;n++)t(n)}},{key:"createIconGrid",value:function(){$("#loggingModalBody").append('<div id="inputIcons"></div>'),$("#inputIcons").append('<div id="row1" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row2" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row3" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row4" class="ui-widget row ml-1"></div>');for(var e=1;e<5;e++)for(var t=1;t<5;t++){$("#row"+e).append('<div id="r'+e+"c"+t+'" class="col-md-2 authentication_item mr-1 mb-1"></div>');var n=4*(e-1)+t,i=this.icons[n-1];$("#r"+e+"c"+t).append('<div class="category_tag">'+i.name+"</div>"),$("#r"+e+"c"+t).append('<div id="school_user_img">'+i.html+"</div>")}}},{key:"resetSelectedIcons",value:function(){for(var e=0;e<4;e++)this.currentlySelectedIcons[e]=null,$("#currentlySelected"+e).html("")}},{key:"addIconToId",value:function(e,t){for(var n=0;n<4;n++)if(null==this.currentlySelectedIcons[n]){var i=4*(e-1)+t,o=this.icons[i-1];this.currentlySelectedIcons[n]=o.id,$("#currentlySelected"+n).html(o.name+"<p>"+o.html+"</p>");break}}}]),e}(),g=function(){function e(){a()(this,e),c()(this,"sessionId",null),c()(this,"tutorialId",null),c()(this,"school",null),c()(this,"userId",null),c()(this,"dataOfBirth",""),c()(this,"genderSetting",""),c()(this,"tutialIdSetting",""),c()(this,"computerId","-1"),c()(this,"workshopId","-1"),c()(this,"loggingModal",null),this.loggingModal=new p(this)}return s()(e,[{key:"init",value:function(){var e=this,t={};$(document).keydown((function(n){t[n.which]=!0,t[69]&&t[83]&&t[84]&&e.loggingModal.createInitialMenu()})),$(document).keyup((function(e){delete t[e.which]})),this.sessionId=window.sessionStorage.loadOnceSessionId,delete window.sessionStorage.loadOnceSessionId,this.sessionId||$.ajax({type:"GET",url:u.getServerUrl()+"/logging/id"}).done((function(t){e.sessionId=t})).fail((function(e,t){console.warn("Failed to fetch sessionId:",t)}))}},{key:"createEvent",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,a={timestamp:$.now(),name:t,simulatorState:o,selectedDifficulty:i,activeTutorial:e.tutorialIdSetting,groupId:e.activityIdSetting,computerId:e.computerId,workshopId:e.workshopId,data:n};return a}},{key:"recordEvent",value:function(t){var n={timestamp:$.now(),userId:e.userId,school:e.school,sessionId:e.sessionId,dateOfBirth:e.agegroupSetting,gender:e.genderSetting,event:t};console.log(t),void 0!==this.sessionId&&$.ajax({type:"POST",url:u.getServerUrl()+"/logging/event",data:n}).done((function(e){console.debug("Recording submitted",e)})).fail((function(e,t){console.warn("Failed to submit recording:",t)}))}},{key:"setUserId",value:function(e){this.userId=e}},{key:"setSchool",value:function(e){this.school=e}},{key:"setDateOfBirth",value:function(e){this.dateOfBirth=e}},{key:"setGender",value:function(e){this.genderSetting=e}}]),e}(),h=n(4),m=n.n(h),v=n(7),f=n.n(v),y=n(5),b=n.n(y),_=n(6),k=n.n(_),S=n(3),w=n.n(S),I=function(){function e(){a()(this,e)}return s()(e,null,[{key:"mapButtonIdToIndex",value:function(t){return e.map[t]}},{key:"mapIndexToButtonId",value:function(t){for(var n in e.map)if(e.map[n]===t)return n}},{key:"mapButtonPinNameToIndex",value:function(t){return e.pinMap[t]}},{key:"mapIndexToButtonPinName",value:function(t){for(var n in e.pinMap)if(e.pinMap[n]===t)return n}}]),e}();c()(I,"map",{sim_button_N:0,sim_button_W:1,sim_button_C:2,sim_button_E:3,sim_button_S:4}),c()(I,"pinMap",{SW_N:0,SW_W:1,SW_C:2,SW_E:3,SW_S:4});var M=function(){function e(){a()(this,e),c()(this,"pins",new Array(33)),c()(this,"pinMapping",{}),c()(this,"lcdContent",new Array(2));for(var t=0;t<24;++t)this.pinMapping[t+""]=t;for(var n=0;n<8;++n)this.pinMapping["A"+n]=24+n;this.pinMapping.SW_N=16,this.pinMapping.SW_E=17,this.pinMapping.SW_S=18,this.pinMapping.SW_W=19,this.pinMapping.SW_C=32,this.pinMapping.BUZZER=33,this.pinMapping.LCD_BACKLIGHT=20,this.pinMapping.DC_MOTOR_1=34,this.pinMapping.DC_MOTOR_2=35,this.pinMapping.SERVO_MOTOR_1=36,this.pinMapping.SERVO_MOTOR_2=37;for(var i=0;i<8;++i)this.pinMapping["LED"+i]=38+i;for(var o=33;o<45;o++)this.pinMapping[o+""]=o;this.pinMapping.LED13=13,this.lcdContent[0]=" ".repeat(16),this.lcdContent[1]=" ".repeat(16),this.resetBoard()}return s()(e,[{key:"resetBoard",value:function(){this.lcdContent=new Array(2),this.lcdContent[0]=" ".repeat(16),this.lcdContent[1]=" ".repeat(16);for(var e=0;e<24;++e)this.pins[this.pinMapping[e+""]]=0;for(var t=0;t<8;++t)this.pins[this.pinMapping["A"+t]]=0;this.pins[this.pinMapping.LCD_BACKLIGHT]=0,this.pins[this.pinMapping.BUZZER]=0,this.pins[this.pinMapping.DC_MOTOR_1]=0,this.pins[this.pinMapping.DC_MOTOR_2]=0,this.pins[this.pinMapping.SERVO_MOTOR_1]=0,this.pins[this.pinMapping.SERVO_MOTOR_2]=0;for(var n=0;n<8;++n)this.pins[this.pinMapping.LED0+n]=0;this.pins[this.pinMapping.LED13]=0,this.pins[this.pinMapping.SW_N]=1,this.pins[this.pinMapping.SW_E]=1,this.pins[this.pinMapping.SW_S]=1,this.pins[this.pinMapping.SW_W]=1,this.pins[this.pinMapping.SW_C]=1}},{key:"setTonePlaying",value:function(e){this.setTonePlayingOnPin(e,"BUZZER")}},{key:"getTonePlaying",value:function(){return this.getTonePlayingOnPin("BUZZER")}},{key:"setTonePlayingOnPin",value:function(e,t){this.pins[this.pinMapping[t]]=e}},{key:"getTonePlayingOnPin",value:function(e){return this.pins[this.pinMapping[e]]}},{key:"setLcdContent",value:function(e,t){var n=t;e<0||e>1||(t.length>16&&(n=t.substr(0,16)),this.lcdContent[e]=n)}},{key:"getLcdContent",value:function(e){if(e<0||e>1)throw new Error("This is not a valid line number");return this.lcdContent[e]}},{key:"setBacklight",value:function(e){if(1!=e&&0!=e)throw new Error("Invalid status");this.pins[this.pinMapping.LCD_BACKLIGHT]=e}},{key:"getBackLightStatus",value:function(){return this.pins[this.pinMapping.LCD_BACKLIGHT]}},{key:"setServoAngle",value:function(e,t){this.pins[this.pinMapping["SERVO_MOTOR_"+e]]=t,console.log("setServoAngle",this.pins[this.pinMapping["SERVO_MOTOR_"+e]])}},{key:"getServoAngle",value:function(e){return this.pins[this.pinMapping["SERVO_MOTOR_"+e]]}},{key:"setMotorSpeed",value:function(e,t){if(e>2||e<1)throw Error("No motor with this number");t>255&&(motorspeed=255),this.pins[this.pinMapping["DC_MOTOR_"+e]]=t}},{key:"getMotorSpeed",value:function(e){if(e>2||e<1)throw Error("No motor with this number");return this.pins[this.pinMapping["DC_MOTOR_"+e]]}},{key:"setLedState",value:function(e,t){8==e?this.pins[this.pinMapping.LED13]=t:this.pins[this.pinMapping["LED"+e]]=t}},{key:"getLedState",value:function(e){return 8==e?this.pins[this.pinMapping.LED13]:this.pins[this.pinMapping["LED"+e]]}},{key:"setButtonState",value:function(e,t){var n=I.mapIndexToButtonPinName(e);this.pins[this.pinMapping[n]]=t}},{key:"getButtonState",value:function(e){var t=I.mapIndexToButtonPinName(e);return this.pins[this.pinMapping[t]]}},{key:"setSonarDistance",value:function(e,t,n){this.setIoPinState(e,n),this.setIoPinState(t,n)}},{key:"getSonarDistance",value:function(e,t){return this.getIoPinState(t)}},{key:"setIoPinState",value:function(e,t){var n=e+"";this.pins[this.pinMapping[n]]=t}},{key:"getIoPinState",value:function(e){var t=e+"";return this.pins[this.pinMapping[t]]}},{key:"setAnalogIoPinState",value:function(e,t){if(!e.startsWith("A"))throw new Error("Not a valid analog pin name!");this.setIoPinState(e,t)}},{key:"getAnalogIoPinState",value:function(e){if(!e.startsWith("A"))throw new Error("Not a valid analog pin name!");return this.getIoPinState(e)}}]),e}(),x={motorRadius:10,motorDistance:380,nrOfSteps:200},T=function(){function e(t){a()(this,e),c()(this,"boardState",null),c()(this,"currentScenario",null),c()(this,"stepmotorQueue",[]),c()(this,"servoAngleQueue",[]),c()(this,"colorQueue",[]),c()(this,"stepperPins",[33,34]),c()(this,"penPositionPins",[36,37]),c()(this,"colorPin",35),c()(this,"stylusPosPin",38),c()(this,"drawingActive",!1),this.boardState=t}return s()(e,[{key:"setCurrentScenario",value:function(e){this.currentScenario=e}},{key:"clearLcd",value:function(){for(var e=0;e<2;e++)this.writeLcd(" ".repeat(16),e,1)}},{key:"writeLcd",value:function(e,t,n){this.boardState.setBacklight(1);var i=this.boardState.getLcdContent(t).substr(0,n),o=0;i.length<n&&(o=n-i.length),e=i+" ".repeat(o)+e.substring(0,16-n),this.boardState.getLcdContent(t).substr(e.length+n,16),this.boardState.setLcdContent(t,e)}},{key:"digitalWrite",value:function(e,t){var n=Number(e);n>=32&&n<=39||13===n?(n>=32&&n<=39&&(n-=32),"HIGH"===t||1==t?13===n?this.boardState.setLedState(8,1):this.boardState.setLedState(n,1):13===n?this.boardState.setLedState(8,0):this.boardState.setLedState(n,0)):this.boardState.setIoPinState(n,t)}},{key:"analogWrite",value:function(e,t){this.boardState.setAnalogIoPinState(e,t)}},{key:"digitalRead",value:function(e){if(e.startsWith("SW_")){var t=I.mapButtonPinNameToIndex(e);return this.boardState.getButtonState(t)}return(e=Number(e))>=32&&e<=39||13===e?(e>=32&&e<=39&&(e-=32),this.boardState.getButtonState(e)):1}},{key:"analogRead",value:function(e){return this.boardState.getAnalogIoPinState(e)}},{key:"setLeds",value:function(e){e=e.toString(2);for(var t=0;t<8;t++)this.digitalWrite(32+t,0);var n=8-e.length;n<0&&(n=0);for(t=0;t<Math.min(e.length,8);t++)this.digitalWrite(39-(n+t),e[t])}},{key:"tone",value:function(e,t){"BUZZER"===e&&this.boardState.setTonePlaying(t)}},{key:"noTone",value:function(e){"BUZZER"===e&&this.boardState.setTonePlaying(0)}},{key:"servo",value:function(e,t){t>180&&(t=180),t<0&&(t=0);var n=e+35;t!==this.boardState.getServoAngle(e)&&(this.boardState.setServoAngle(e,t),this.boardState.setIoPinState(n,t))}},{key:"servoWithPin",value:function(e,t){t!==this.boardState.getIoPinState(e)&&this.boardState.setIoPinState(e,t)}},{key:"startDcMotor",value:function(e,t){t>255&&(t=255),t<-255&&(t=-255),t!==this.boardState.getMotorSpeed(e)&&this.boardState.setMotorSpeed(e,t)}},{key:"sonar",value:function(e,t){return Math.round(this.boardState.getSonarDistance(e,t))}},{key:"pir",value:function(e){return this.boardState.getIoPinState(e)}},{key:"sleep",value:function(e){}},{key:"stepperMotorStep",value:function(e,t){var n=t>0?1:-1;this.boardState.setIoPinState(e,this.boardState.getIoPinState(e)+n)}},{key:"stepMotorSteps",value:function(e,t){for(var n=0;n<Math.abs(t);++n)this.stepperMotorStep(e,t)}},{key:"stepMotorsTo",value:function(e){for(var t=[0,0],n=0;n<t.length;++n)t[n]=this.boardState.getIoPinState(this.penPositionPins[n])+e[n];for(var i=this.coordinatesToSteps(t),o=0;o<i.length;++o)this.boardState.setIoPinState(this.stepperPins[o],i[o])}},{key:"coordinatesToSteps",value:function(e){var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),n=Math.sqrt(Math.pow(e[1],2)+Math.pow(x.motorDistance-e[0],2)),i=2*Math.PI*x.motorRadius/x.nrOfSteps;return[t/=i,n/=i]}},{key:"drawRobotCheckPosition",value:function(e){var t=DwenguinoSimulation.currentScenario;(e[0]<t.paper.position.x||e[0]>t.paper.position.x+t.paper.width||e[1]<t.paper.position.y||e[1]>t.paper.position.y+t.paper.height)&&(window.stepMotorError||(alert(MSG.bounds),DwenguinoSimulation.handleSimulationStop(),window.stepMotorError=!0))}},{key:"drawRobotLine",value:function(e,t,n){n&&(e+=20,t+=40);for(var i=[0,0],o=0;o<i.length;++o)i[o]=this.boardState.getIoPinState(this.penPositionPins[o]);var a=i,l=Math.atan((t-a[1])/(e-a[0])),s=Math.sqrt(Math.pow(a[0]-e,2)+Math.pow(a[1]-t,2)),r=Math.cos(l),c=Math.sin(l);this.update(s,r,c),this.drawingActive=!0}},{key:"update",value:function(e,t,n){var i=this;e>0?(this.stepMotorsTo([t,n]),this.currentScenario.updateScenario(this.boardState),setTimeout((function(){i.update(e-1,t,n)}),30)):this.drawingActive=!1}},{key:"drawRobotLowerStylus",value:function(){this.boardState.setIoPinState(this.stylusPosPin,0)}},{key:"drawRobotLiftStylus",value:function(){this.boardState.setIoPinState(this.stylusPosPin,90)}},{key:"changeColor",value:function(e){this.boardState.setIoPinState(this.colorPin,e)}}]),e}();function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var A,C=function(e){b()(n,e);var t=E(n);function n(e,i){var o;return a()(this,n),o=t.call(this),c()(m()(o),"logger",null),c()(m()(o),"workspace",null),c()(m()(o),"simulationViewContainerId","db_simulator_panes"),o.logger=e,o.workspace=i,o}return s()(n,[{key:"resetDwenguino",value:function(){f()(w()(n.prototype),"resetDwenguino",this).call(this),-1!==this.debugger.blocks.lastColours[0]&&this.debugger.blocks.lastBlocks[0].setColour(this.debugger.blocks.lastColours[0]),this.debugger.blocks.lastColours=[-1,-1],this.debugger.blocks.lastBlocks=[null,null]}},{key:"initScenario",value:function(){this.currentScenario.initSimulationState(this.board),this.currentScenario.initSimulationDisplay(this.simulationViewContainerId),this.currentScenario.updateScenario(this.board)}},{key:"initDebugger",value:function(){var e=Blockly.JavaScript.workspaceToCode(this.workspace);f()(w()(n.prototype),"initDebugger",this).call(this,e),this.mapBlocksToCode(),this.updateBlocklyColour()}},{key:"step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];f()(w()(n.prototype),"step",this).call(this,e),this.updateBlocklyColour()}},{key:"mapBlocksToCode",value:function(){for(var e=this,t=this.workspace.getAllBlocks()[0],n=0,i=this.debugger.code.split("\n"),o=[],a=function(){if(i[n].trim()===Blockly.JavaScript.blockToCode(l).split("\n")[0]&&(i[n].trim().startsWith("for")||i[n].trim().startsWith("while")||i[n].trim().startsWith("if"))?(o.push(l),e.debugger.blocks.blockMapping[n]=l,l=l.getInputTargetBlock("DO")||l.getInputTargetBlock("DO0")):i[n].trim()===Blockly.JavaScript.blockToCode(l).split("\n")[0]&&(e.debugger.blocks.blockMapping[n]=l,l=l.getNextBlock()),null===l&&o.length>0){var t=o.pop();l=t.getNextBlock(),n++}n++},l=t.getInputTargetBlock("SETUP");null!==l&&n<i.length;)a();for(;o.length>0;)o.pop(),n++;for(;n<i.length&&"while (true) {"!==i[n];)n++;for(n<i.length&&(this.debugger.blocks.blockMapping[n]=t,n++),l=t.getInputTargetBlock("LOOP");null!==l&&n<i.length;)a()}},{key:"updateBlocklyColour",value:function(){var e=this.debugger.debuggerjs.machine.getCurrentLoc().start.line-1;""!==this.debugger.code&&void 0!==this.debugger.blocks.blockMapping[e]&&(null!==this.debugger.blocks.lastBlocks[0]&&this.debugger.blocks.lastBlocks[0].setColour(this.debugger.blocks.lastColours[0]),this.debugger.blocks.lastBlocks[0]=this.debugger.blocks.lastBlocks[1],this.debugger.blocks.lastColours[0]=this.debugger.blocks.lastColours[1],this.debugger.blocks.lastBlocks[1]=this.debugger.blocks.blockMapping[e],this.debugger.blocks.lastColours[1]=this.debugger.blocks.blockMapping[e].getColour(),null!==this.debugger.blocks.lastBlocks[0]&&this.debugger.blocks.lastBlocks[0].setColour(210))}}]),n}(function(){function e(){a()(this,e),c()(this,"board",null),c()(this,"debugger",null),c()(this,"simulationSandbox",null),c()(this,"currentScenario",null),c()(this,"speedDelay",16),c()(this,"baseSpeedDelay",16),c()(this,"isSimulationRunning",!1),c()(this,"isSimulationPaused",!1),this.board=new M,this.simulationSandbox=new T(this.board),this.initDebuggerState()}return s()(e,[{key:"initDebuggerState",value:function(){this.debugger={debuggerjs:null,code:"",blocks:{lastBlocks:[null,null],lastColours:[-1,-1],blockMapping:{}}}}},{key:"setCurrentScenario",value:function(e){this.currentScenario=e,this.simulationSandbox.setCurrentScenario(this.currentScenario),this.resetDwenguino()}},{key:"initScenario",value:function(){this.currentScenario.initSimulationState(this.board),this.currentScenario.initSimulationDisplay(""),this.currentScenario.updateScenario(this.board)}},{key:"resetDwenguino",value:function(){this.debugger.debuggerjs=null,this.debugger.code="",this.debugger.blocks.blockMapping={},this.board.resetBoard(),this.initScenario()}},{key:"createDebugger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return debugjs.createDebugger(e)}},{key:"initDebugger",value:function(e){this.resetDwenguino(),this.debugger.code=e,this.debugger.debuggerjs=this.createDebugger({iframeParentElement:document.getElementById("debug"),sandbox:{DwenguinoSimulation:this.simulationSandbox}}),this.debugger.debuggerjs.machine.on("error",(function(e){console.log(e),console.error(e.message)}));this.debugger.debuggerjs.load(this.debugger.code,"DwenguinoSimulation"),this.debugger.debuggerjs.machine.step()}},{key:"step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isSimulationPaused){var t=this.debugger.debuggerjs.machine.getCurrentLoc().start.line-1;this.debugger.debuggerjs.machine.step();var n=void 0===this.debugger.code.split("\n")[t]?"":this.debugger.code.split("\n")[t];if(this.currentScenario.updateScenario(this.board),n.trim().startsWith("DwenguinoSimulation.sleep")){var i=Number(this.debugger.code.split("\n")[t].replace(/\D+/g,""));this.delayStepsTaken=0,this.delayStepsToTake=Math.floor(i/this.baseSpeedDelay),this.delayRemainingAfterSteps=i%this.baseSpeedDelay,this.performDelayLoop(e)}else e?this.isSimulationPaused=!0:setTimeout(this.step.bind(this),this.speedDelay);this.checkForEnd()}}},{key:"performDelayLoop",value:function(e){var t=this;this.delayStepsTaken<this.delayStepsToTake?(this.currentScenario.updateScenario(this.board),this.delayStepsTaken++,setTimeout((function(){t.performDelayLoop(e)}),this.speedDelay)):e?this.isSimulationPaused=!0:setTimeout((function(){t.step()}),this.delayRemainingAfterSteps)}},{key:"handleScope",value:function(){var e=this.debugger.debuggerjs.machine.getCurrentStackFrame().scope;for(var t in e){var n=e[t];this.debugger.debuggerjs.machine.$runner.gen.stackFrame.evalInScope(n.name)}}},{key:"checkForEnd",value:function(){(this.isSimulationRunning||this.isSimulationPaused)&&this.debugger.debuggerjs.machine.halted&&(this.isSimulationRunning=!1,this.isSimulationPaused=!1)}}]),e}()),O=Object.freeze((A={downloadClicked:"downloadClicked",blockyBlockCreate:"blocklyBlockCreate",blocklyBlockDelete:"blocklyBlockDelete",blocklyBlockMove:"blocklyBlockMove",blocklyVarCreate:"blocklyVarCreate",blocklyVarDelete:"blocklyVarDelete",blocklyVarRename:"blocklyVarRename",blocklyUI:"blocklyUI",blocklyChange:"blocklyChange",undo:"undo",uploadClicked:"uploadClicked",simButtonStateClicked:"simButtonStateClicked",runClicked:"runClicked",changedWorkspace:"changedWorkspace",downloadScenarioClicked:"downloadScenarioClicked",moveRobotComponent:"moveRobotComponent",addRobotComponent:"addRobotComponent",removeRobotComponent:"removeRobotComponent"},c()(A,"addRobotComponent","addRobotComponent"),c()(A,"changedScenario","changedScenario"),c()(A,"simStart","simStart"),c()(A,"simResume","simResume"),c()(A,"simPause","simPause"),c()(A,"simStopButtonClicked","simStopButtonClicked"),c()(A,"simStep","simStep"),c()(A,"simStop","simStop"),c()(A,"setSpeed","setSpeed"),c()(A,"startTutorial","startTutorial"),c()(A,"endTutorial","endTutorial"),c()(A,"tutorialNextStep","tutorialNextStep"),c()(A,"tutorialPrevStep","tutorialPrevStep"),A)),B=function(){function e(t,n,i){a()(this,e),c()(this,"simulationRunner",null),c()(this,"scenarioView","spyrograph"),c()(this,"scenarios",null),c()(this,"logger",null),this.logger=t,this.scenarios=i,this.simulationRunner=new C(this.logger,n),this.simulationRunner.setCurrentScenario(this.scenarios[this.scenarioView]),this.initSimulationControlsUI(i)}return s()(e,[{key:"initSimulationControlsUI",value:function(e){var t=this;$("#db_simulator_menu").empty(),$("#db_infopane").prepend('<div id="db_simulator_menu"></div>'),$("#db_simulator_menu").append('<div id="sim_menu"></div>'),$("#sim_menu").append('<div id="sim_start" class="sim_item"></div>'),$("#sim_menu").append('<div id="sim_pause" class="sim_item_disabled"></div>'),$("#sim_menu").append('<div id="sim_stop" class="sim_item_disabled"></div>'),$("#sim_menu").append('<div id="sim_step" class="sim_item"></div>'),$("#sim_menu").append('<div id="sim_scenarioTag" ></div>'),$("#sim_menu").append('<div id="sim_scenarios" class="btn-group btn-group-toggle" data-toggle="buttons"></div>'),$.each(Object.keys(this.scenarios),(function(e,n){var i='<label id="scenario_label_'+n+'" class="btn sim_scenario_btn"></label>',o='<input id="sim_scenario_'+n+'"type="radio" name="scenario_type" class="sim_scenario_radio" value="'+n+'" autocomplete="off"><img src="DwenguinoIDE/img/scenarios/scenario_'+n+'.png" class="scenario_image">';$("#sim_scenarios").append(i),$("#scenario_label_"+n).append(o),n==t.scenarioView&&($("#sim_scenario_"+n).attr("checked","checked"),$("#scenario_label_"+n).attr("class","btn sim_scenario_btn active"))})),this.translateSimulatorInterface(),$("#sim_speed").on("change",(function(){t.setSpeed()}));var n=this;$("input[name=scenario_type]:radio").change((function(){console.log($(this).val()),n.scenarioView=$(this).val(),n.translateSimulatorInterface(),n.handleSimulationStop(),n.simulationRunner.setCurrentScenario(n.scenarios[n.scenarioView]),n.logger.recordEvent(n.logger.createEvent(O.changedScenario,this.scenarioView))})),$("#sim_start").click((function(){t.setButtonsStart(),t.simulationRunner.isSimulationRunning||t.simulationRunner.isSimulationPaused?t.simulationRunner.isSimulationRunning||(t.logger.recordEvent(t.logger.createEvent(O.simResume,"")),t.simulationRunner.isSimulationPaused=!1,t.simulationRunner.isSimulationRunning=!0,t.resumeSimulation()):(t.simulationRunner.isSimulationRunning=!0,t.startSimulation(),t.logger.recordEvent(t.logger.createEvent(O.simStart,"")))})),$("#sim_pause").click((function(){t.logger.recordEvent(t.logger.createEvent(O.simPause,"")),t.simulationRunner.isSimulationRunning=!1,t.simulationRunner.isSimulationPaused=!0,t.setButtonsPause()})),$("#sim_stop").click((function(){t.logger.recordEvent(t.logger.createEvent(O.simStopButtonClicked,"")),t.handleSimulationStop()})),$("#sim_step").click((function(){t.setButtonsStep(),t.logger.recordEvent(t.logger.createEvent(O.simStep,"")),t.simulationRunner.isSimulationPaused||t.simulationRunner.isSimulationRunning?t.simulationRunner.isSimulationRunning||(t.simulationRunner.isSimulationPaused=!1,t.simulationRunner.step(!0),t.isSimulationPaused=!0):(t.startStepSimulation(),t.simulationRunner.isSimulationPaused=!0)}));var i=function(e,t,n){$.each(t,(function(e,t){var n=$(t.attr("href"));t.removeClass("active"),n.hide()})),$(e).addClass("active"),$(e.hash).show(),n.preventDefault()};$("a[href$='#db_code_pane']").click((function(e){i(this,[$("a[href$='#db_robot_pane']")],e)})),$("a[href$='#db_robot_pane']").click((function(e){i(this,[$("a[href$='#db_code_pane']")],e)})),$("a[href$='#db_robot_pane']").trigger("click")}},{key:"translateSimulatorInterface",value:function(){document.getElementById("sim_start").innerHTML="<span class='glyphicon glyphicon-play' alt='"+MSG.simulator.start+"'></span>",document.getElementById("sim_stop").innerHTML="<span class='glyphicon glyphicon-stop' alt='"+MSG.simulator.stop+"'></span>",document.getElementById("sim_pause").innerHTML="<span class='glyphicon glyphicon-pause' alt='"+MSG.simulator.pause+"'></span>",document.getElementById("sim_step").innerHTML="<span class='glyphicon glyphicon-step-forward' alt='"+MSG.simulator.step+"'></span>",document.getElementById("sim_scenarioTag").textContent=MSG.simulator.scenario+":"}},{key:"startSimulation",value:function(){this.startDebuggingView(),this.simulationRunner.initDebugger(),this.simulationRunner.step()}},{key:"startStepSimulation",value:function(){this.startDebuggingView(),this.simulationRunner.initDebugger(),this.simulationRunner.step(!0)}},{key:"stopSimulation",value:function(){this.stopDebuggingView(),this.simulationRunner.resetDwenguino()}},{key:"resumeSimulation",value:function(){this.simulationRunner.step()}},{key:"handleSimulationStop",value:function(){this.logger.recordEvent(this.logger.createEvent(O.simStop,"")),this.simulationRunner.isSimulationRunning=!1,this.simulationRunner.isSimulationPaused=!1,this.setButtonsStop(),this.stopSimulation()}},{key:"setButtonsStart",value:function(){document.getElementById("sim_pause").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_start").className="sim_item_disabled",document.getElementById("sim_step").className="sim_item_disabled"}},{key:"setButtonsPause",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"setButtonsStop",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item_disabled",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"setButtonsStep",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"startDebuggingView",value:function(){0!==document.getElementsByClassName("alertDebug").length&&document.getElementsByClassName("alertDebug")[0].remove();var e='<div class ="alertDebug">'+MSG.simulator.alertDebug+"</div>";$("#db_body").append(e),document.getElementsByClassName("alertDebug")[0].style.width=document.getElementById("blocklyDiv").style.width,document.querySelector('input[id="code_checkbox"]').checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible"):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("blocklyDiv").style.opacity="0.5",document.getElementById("db_code_pane").style.visibility="hidden"),document.getElementById("db_code_pane").style.opacity="0.5",document.getElementById("blocklyDiv").style.opacity="0.5"}},{key:"stopDebuggingView",value:function(){document.querySelector('input[id="code_checkbox"]').checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible"):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("db_code_pane").style.visibility="hidden"),document.getElementById("db_code_pane").style.opacity="1",document.getElementById("blocklyDiv").style.opacity="1",document.getElementById("blocklyDiv").style.pointerEvents="auto",0!==document.getElementsByClassName("alertDebug").length&&document.getElementsByClassName("alertDebug")[0].remove()}},{key:"setSpeed",value:function(){var e=document.getElementById("sim_speed"),t=e.options[e.selectedIndex].value;switch(this.logger.recordEvent(this.logger.createEvent(O.setSpeed,t)),t){case"veryslow":this.simulationRunner.speedDelay=600;break;case"slow":this.simulationRunner.speedDelay=300;break;case"medium":this.simulationRunner.speedDelay=150;break;case"fast":this.simulationRunner.speedDelay=75;break;case"veryfast":this.simulationRunner.speedDelay=32;break;case"realtime":this.simulationRunner.speedDelay=16}}}]),e}(),P=n(8),D=n.n(P),R=function(){function e(){a()(this,e)}return s()(e,[{key:"render",value:function(e){this.clearCanvases(),this.drawLcd(e),this.drawLeds(e),this.drawServos(e),this.drawPirs(e),this.drawSonars(e),this.drawSoundSensors(e),this.drawLightSensors(e)}},{key:"drawLcd",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==re.LCD){for(var n=0;n<2;++n)$("#sim_lcd_row"+n).text(e[t].getState()[n]),null!==document.getElementById("sim_lcd_row"+n)&&(document.getElementById("sim_lcd_row"+n).innerHTML=document.getElementById("sim_lcd_row"+n).innerHTML.replace(/ /g,"&nbsp;"));var i=document.getElementById("sim_lcds");null!==i&&(i.style.display="none",i.offsetHeight,i.style.display="block")}}},{key:"initializeCanvas",value:function(e,t){var n=t.getCanvasId(),i=document.getElementById(n);null!==i&&(this.configureCanvasDimensions(i),this.render(e))}},{key:"clearCanvases",value:function(){for(var e=document.getElementsByClassName("sim_canvas"),t=0;t<e.length;t++){if(e.item(t).getContext)e.item(t).getContext("2d").clearRect(0,0,e.item(t).width,e.item(t).height)}}},{key:"clearCanvas",value:function(e){var t=document.getElementById(e);t.getContext&&t.getContext("2d").clearRect(0,0,t.width,t.height)}},{key:"drawLeds",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==re.LED){var n=document.getElementById(e[t].getCanvasId());this.drawLed(e[t],n)}}},{key:"drawLed",value:function(e,t){if(t.getContext){var n=t.getContext("2d");n.beginPath(),n.arc(t.width/2,t.height/2,e.getRadius(),0,2*Math.PI),1===e.getState()?n.fillStyle=e.getOnColor():n.fillStyle=e.getOffColor(),n.fill(),n.fillStyle=e.getBorderColor(),n.stroke()}else console.log(t,"This canvas has no context")}},{key:"drawServos",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==re.SERVO){var n=document.getElementById(e[t].getCanvasId());this.clearCanvas(e[t].getCanvasId()),this.drawServo(e[t],n)}}},{key:"drawServo",value:function(e,t){if(t.getContext){var n=this;e.getServoBackground().onload=function(){var i=t.getContext("2d");switch(e.getCostume()){case"plain":n.drawServoBackground(i,e),n.drawRotatedServohead(i,e)}},e.getImage(0).onload=function(){var i=t.getContext("2d");switch(i.fillStyle=e.getBackgroundColor(),e.getCostume()){case"plain":n.drawRotatedServohead(i,e);break;case"eye":n.drawEye(i,e,t);break;case"righthand":i.fillRect(e.getX()+100,e.getY()+30,e.getWidth()-100,e.getHeight()-60),n.drawRightHand(i,e);break;case"lefthand":i.fillRect(e.getX()+10,e.getY()+30,e.getWidth()-28,e.getHeight()-60),n.drawLeftHand(i,e)}};var i=t.getContext("2d");switch(i.fillStyle=e.getBackgroundColor(),e.getCostume()){case"plain":n.drawServoBackground(i,e),n.drawRotatedServohead(i,e);break;case"eye":n.drawEye(i,e,t);break;case"righthand":i.fillRect(e.getX()+100,e.getY()+30,e.getWidth()-100,e.getHeight()-60),n.drawRightHand(i,e);break;case"lefthand":i.fillRect(e.getX()+10,e.getY()+30,e.getWidth()-28,e.getHeight()-60),n.drawLeftHand(i,e)}}else console.log(t,"This canvas has no context")}},{key:"drawPirs",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==re.PIR){var n=document.getElementById(e[t].getCanvasId());this.drawPir(e[t],n)}}},{key:"drawPir",value:function(e,t){if(t.getContext){e.getImage().onload=function(){t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())},t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())}else console.log(t,"This canvas has no context")}},{key:"drawSonars",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==re.SONAR){var n=document.getElementById(e[t].getCanvasId());this.drawSonar(e[t],n)}}},{key:"drawSonar",value:function(e,t){if(t.getContext){e.getImage().onload=function(){t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())},t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())}else console.log(t,"This canvas has no context")}},{key:"drawServoBackground",value:function(e,t){e.translate(0,t.getY()),e.drawImage(t.getServoBackground(),0,0,t.getWidth(),t.getHeight()),e.translate(0,-t.getY())}},{key:"drawRotatedServohead",value:function(e,t){var n=this.getDirection(t.getPrevAngle(),t.getAngle()),i=t.getAngle()-t.getPrevAngle();if(0!=i)if(i>5||i<-5){var o=t.getPrevAngle()+5*n;t.setPrevAngle(o),e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(t.getPrevAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(-t.getPrevAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}else{var a=t.getPrevAngle()+i;t.setPrevAngle(a),e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(-t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}else e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(-t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}},{key:"drawEye",value:function(e,t,n){this.renderEyeBall(e,t,n),this.renderIris(e,t,n)}},{key:"renderEyeBall",value:function(e,t,n){var i=t.getImage(0);e.drawImage(i,0,0,100,100)}},{key:"renderIris",value:function(e,t,n){var i=t.getImage(1);i.src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";var o=this.getDirection(t.getPrevAngle(),t.getAngle()),a=t.getAngle()-t.getPrevAngle();if(0!=a){var l=t.getPrevAngle()/120*(n.width-60)+5;if(a>5||a<-5){var s=t.getPrevAngle()+5*o;t.setPrevAngle(s),t.getPrevAngle()>=0&t.getPrevAngle()<=120?e.drawImage(i,l,n.height/2-30,60,60):t.getPrevAngle()<=130&&(l=n.width-60+5,e.drawImage(i,l,n.height/2-30,60,60))}else{var r=t.getPrevAngle()+a;t.setPrevAngle(r),t.getPrevAngle()>=0&t.getPrevAngle()<=120?e.drawImage(i,l,n.height/2-30,60,60):t.getPrevAngle()<=130&&(l=n.width-60+5,e.drawImage(i,l,n.height/2-30,60,60))}}else{l=t.getAngle()/120*(n.width-60)+5;t.getAngle()>=0&t.getAngle()<=120?e.drawImage(i,l,n.height/2-30,60,60):t.getAngle()<=130&&(l=n.width-60+5,e.drawImage(i,l,n.height/2-30,60,60))}}},{key:"drawRightHand",value:function(e,t){var n=t.getAngle()-t.getPrevAngle();n>0?this.drawDown(e,t):n<0?this.drawUp(e,t):(e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2))}},{key:"drawDown",value:function(e,t){var n=t.getAngle()-t.getPrevAngle();if(n>=5){var i=t.getPrevAngle()+5;t.setPrevAngle(i),e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getPrevAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getPrevAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2)}else{var o=t.getPrevAngle()+n;t.setPrevAngle(o),e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2)}}},{key:"drawUp",value:function(e,t){var n=t.getPrevAngle()-t.getAngle();if(n>=5){var i=t.getPrevAngle()-5;t.setPrevAngle(i),e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getPrevAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getPrevAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2)}else{var o=t.getPrevAngle()-n;t.setPrevAngle(o),e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2)}}},{key:"drawLeftHand",value:function(e,t){var n=this.getDirection(t.getPrevAngle(),t.getAngle()),i=t.getAngle()-t.getPrevAngle();if(0!=i)if(i>5||i<-5){var o=t.getPrevAngle()+5*n;t.setPrevAngle(o),e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(-t.getPrevAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getPrevAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}else{var a=t.getPrevAngle()+i;t.setPrevAngle(a),e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}else e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}},{key:"drawSoundSensors",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==re.SOUND){var n=document.getElementById(e[t].getCanvasId());this.drawSoundSensor(e[t],n)}}},{key:"drawSoundSensor",value:function(e,t){if(t.getContext){e.getImage().onload=function(){t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())},t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())}else console.log(t,"This canvas has no context")}},{key:"drawLightSensors",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==re.LIGHT){var n=document.getElementById(e[t].getCanvasId());this.drawLightSensor(e[t],n)}}},{key:"drawLightSensor",value:function(e,t){if(t.getContext){e.getImage().onload=function(){t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())},t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())}else console.log(t,"This canvas has no context")}},{key:"configureCanvasDimensions",value:function(e){var t=window.devicePixelRatio||1,n=e.getBoundingClientRect();(e.width=n.width*t,e.height=n.height*t,e.getContext)&&e.getContext("2d").scale(t,t)}},{key:"getDirection",value:function(e,t){return t-e>0?1:-1}}]),e}(),L=function(){function e(t,n){if(a()(this,e),this._eventBus=t,this._htmlClasses=n,void 0===this.toString)throw new Error("You have to implement the method toString");if(void 0===this.toggleVisibility)throw new Error("You have to implement the method toggleVisibility");if(void 0===this.reset)throw new Error("You have to implement the method reset");if(void 0===this.insertHtml)throw new Error("You have to implement the method insertHtml to add the component to the simulation container");if(void 0===this.removeHtml)throw new Error("You have to implement the method removeHtml to remove the component from the simulation container");if(void 0===this.toXml)throw new Error("You have to implement the method toXml to save the robot component to an XML file")}return s()(e,[{key:"setHtmlClasses",value:function(e){this._htmlClasses=e}},{key:"getHtmlClasses",value:function(){return this._htmlClasses}}]),e}(),N={SAVE:"save",INITIALIZECANVAS:"initializecanvas",CLEARCANVAS:"clearcanvas"};Object.freeze(N);var H=function(){function e(t){a()(this,e),this.name=t,this.callbacks=[]}return s()(e,[{key:"registerCallback",value:function(e){this.callbacks.push(e)}}]),e}();function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var G={PLAIN:"plain",EYE:"eye",MOUTH:"mouth",RIGHTHAND:"righthand",LEFTHAND:"lefthand"};Object.freeze(G);var F=function(e){b()(n,e);var t=W(n);function n(e,i,o,l,s,r,c,d,u,p,g,h,m){var v;switch(a()(this,n),(v=t.call(this,e,m))._id=i,v._type=re.SERVO,v._width=u,v._height=p,v._x=c,v._y=d,v._offset={left:g,top:h},v._angle=s,v._prevAngle=0,v._image=[new Image,new Image],v._backgroundImage=new Image,v._backgroundImageRotated=new Image,v._backgroundImage.src="./DwenguinoIDE/img/socialrobot/servo_background.png",v._backgroundImageRotated.src="./DwenguinoIDE/img/socialrobot/servo_background_rotated.png",l){case G.PLAIN:v._image[0].src="./DwenguinoIDE/img/socialrobot/servo_head.png";break;case G.EYE:v._image[0].src="./DwenguinoIDE/img/socialrobot/eye1_background.svg",v._image[1].src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";break;case G.RIGHTHAND:v._image[0].src="./DwenguinoIDE/img/socialrobot/righthand.png";break;case G.LEFTHAND:v._image[0].src="./DwenguinoIDE/img/socialrobot/lefthand.png"}return v._backgroundColor="#206499",v._pin=o,v._costume=l,v._canvasId="sim_servo_canvas"+v._id,v.insertHtml(),v.toggleVisibility(r),v}return s()(n,[{key:"toString",value:function(){var e="";return e=(e=(e=(e=(e=(e=e.concat(this.getType()," ")).concat(this.getId()," ")).concat("Angle ",this.getAngle()," ")).concat("Costume ",this.getCostume()," ")).concat("Pin ",this.getPin()," ")).concat("CanvasId ",this.getCanvasId()," ")}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.servoOptions),e.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toggleVisibility",value:function(e){e?$("#sim_servo"+this.getId()).css("visibility","visible"):$("#sim_servo"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Angle='",this.getAngle(),"'")).concat(" PrevAngle='",this.getPrevAngle(),"'")).concat(" Pin='",parseInt(this.getPin()),"'")).concat(" Costume='",this.getCostume(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(30),this.setAngle(0),this.setPrevAngle(0)}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog(),this.createCostumeOptionsDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossibleServoPins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i);1==this.getId()?($(".pinButton").prop("disabled",!0),$(".pinButton").addClass("option_button_disabled"),$("#pin36.pinButton").prop("disabled",!1),$("#pin36.pinButton").removeClass("option_button_disabled"),$("#pin36.pinButton").addClass("option_button_selected")):2==this.getId()?($(".pinButton").prop("disabled",!0),$(".pinButton").addClass("option_button_disabled"),$("#pin37.pinButton").prop("disabled",!1),$("#pin37.pinButton").removeClass("option_button_disabled"),$("#pin37.pinButton").addClass("option_button_selected")):($(".pinButton").removeClass("option_button_disabled"),$("#pin36.pinButton").prop("disabled",!0),$("#pin37.pinButton").prop("disabled",!0),$("#pin36.pinButton").addClass("option_button_disabled"),$("#pin37.pinButton").addClass("option_button_disabled"))}},{key:"getAllPossibleServoPins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,36,37]}},{key:"createCostumeOptionsDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsCostume" class="ui-widget row mb-4">'),$("#componentOptionsCostume").append('<div class="col-md-2">'+MSG.servoCostume+"</div>"),$("#componentOptionsCostume").append('<div id="costume" class="col-md-10"></div>');for(var t={plain:"./DwenguinoIDE/img/socialrobot/servo.png",eye:"./DwenguinoIDE/img/socialrobot/eye.png",mouth:"./DwenguinoIDE/img/socialrobot/mouth.png",righthand:"./DwenguinoIDE/img/socialrobot/righthand_icon.png",lefthand:"./DwenguinoIDE/img/socialrobot/lefthand_icon.png"},n=function(){var n=D()(o[i],2),a=(n[0],n[1]);console.log(a),$("#costume").append('<div id="costume_inner" class="row"></div>'),$("#costume_inner").append("<div id=costume"+a+" name="+a+' class="col-lg-3 col-md-2 col-sm-3 col-xs-4 ml-2 mb-2 costumeButton"></div>'),$("#costume"+a).append('<img src="'+t[a]+'" class="img-responsive">');var l=document.getElementById("costume"+a);l.addEventListener("click",(function(){e._eventBus.dispatchEvent(N.CLEARCANVAS,e.getCanvasId());var t=l.getAttribute("name");switch(t){case G.PLAIN:e.setHtmlClasses("sim_canvas servo_canvas"),e.setCostume(t),e.setWidth(100),e.setHeight(50);break;case G.EYE:e.setHtmlClasses("servo_canvas"),e.setCostume(t),e.setWidth(35),e.setHeight(35);break;case G.RIGHTHAND:case G.LEFTHAND:e.setHtmlClasses("servo_canvas hand_canvas"),e.setCostume(t),e.setWidth(64),e.setHeight(149)}document.getElementById(e.getCanvasId()).className="",document.getElementById(e.getCanvasId()).className=e.getHtmlClasses(),e._eventBus.dispatchEvent(N.INITIALIZECANVAS,e),e._eventBus.dispatchEvent(N.SAVE)}))},i=0,o=Object.entries(G);i<o.length;i++)n()}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(e){return this._height}},{key:"setX",value:function(e){this._x=e}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(e){this._y=e}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setAngle",value:function(e){this._angle=e}},{key:"getAngle",value:function(){return this._angle}},{key:"setPrevAngle",value:function(e){this._prevAngle=e}},{key:"getPrevAngle",value:function(){return this._prevAngle}},{key:"setImage",value:function(e,t){this._image[e].src=t}},{key:"getImage",value:function(e){return this._image[e]}},{key:"setBackgroundColor",value:function(e){this._backgroundColor=e}},{key:"getBackgroundColor",value:function(){return this._backgroundColor}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setCostume",value:function(e){switch(this._costume=e,e){case G.PLAIN:this._image[0].src="./DwenguinoIDE/img/socialrobot/servo_head.png";break;case G.EYE:this._image[0].src="./DwenguinoIDE/img/socialrobot/eye1_background.svg",this._image[1].src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";break;case G.RIGHTHAND:this._image[0].src="./DwenguinoIDE/img/socialrobot/righthand.png";break;case G.LEFTHAND:this._image[0].src="./DwenguinoIDE/img/socialrobot/lefthand.png"}}},{key:"getServoBackground",value:function(){return this._backgroundImage}},{key:"getServoBackgroundRotated",value:function(){return this._backgroundImageRotated}},{key:"getCostume",value:function(){return this._costume}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(L);function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Y={red:"red",yellow:"yellow",blue:"blue",green:"#72f542"};Object.freeze(Y);var X=function(e){b()(n,e);var t=V(n);function n(e,i,o,l,s,r,c,d,u,p,g,h,m,v){var f;return a()(this,n),(f=t.call(this,e,v))._id=i,f._type=re.LED,f._radius=r,f._x=c,f._y=d,f._offset={left:u,top:p},f._onColor=g,f._offColor=h,f._borderColor=m,f._pin=o,f._state=l,f._canvasId="sim_led_canvas"+f._id,f.insertHtml(),f.toggleVisibility(s),f}return s()(n,[{key:"toString",value:function(){return"led"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.ledOptions),e.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.toString()+this.getId()).remove()}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Radius='",this.getRadius(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" OnColor='",this.getOnColor(),"'")).concat(" OffColor='",this.getOffColor(),"'")).concat(" BorderColor='",this.getBorderColor(),"'")).concat(" Pin='",this.getPin(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(0),this.setState(0)}},{key:"toggleVisibility",value:function(e){e?$("#sim_led"+this.getId()).css("visibility","visible"):$("#sim_led"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog(),this.createColorOptionsDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"createColorOptionsDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsColor" class="ui-widget row mb-4">'),$("#componentOptionsColor").append('<div class="col-md-2">Color</div>'),$("#componentOptionsColor").append('<div id="color" class="col-md-10"></div>');for(var t=function(){var t=D()(i[n],2),o=t[0],a=t[1];$("#color").append('<button type="button" id=color'+a+" name="+o+' class="col-md-1 ml-2 mb-2 colorButton"></buttons>');var l=document.getElementById("color"+a);l.classList.add(o),e.getOnColor()==o&&l.classList.add("colorButton_selected"),l.addEventListener("click",(function(){e._eventBus.dispatchEvent(N.CLEARCANVAS,e.getCanvasId());var t=l.getAttribute("name");e.setOnColor(t),$(".colorButton").removeClass("colorButton_selected"),l.classList.add("colorButton_selected"),e._eventBus.dispatchEvent(N.INITIALIZECANVAS,e),e._eventBus.dispatchEvent(N.SAVE)}))},n=0,i=Object.entries(Y);n<i.length;n++)t()}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setRadius",value:function(e){this._radius=e}},{key:"getRadius",value:function(){return this._radius}},{key:"setX",value:function(e){this._x=e}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(e){this._y=e}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setOnColor",value:function(e){this._onColor=e}},{key:"getOnColor",value:function(){return this._onColor}},{key:"setOffColor",value:function(e){this._offColor=e}},{key:"getOffColor",value:function(){return this._offColor}},{key:"setBorderColor",value:function(e){this._borderColor=e}},{key:"getBorderColor",value:function(){return this._borderColor}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(L);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var K=function(e){b()(n,e);var t=U(n);function n(e,i){var o,l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return a()(this,n),(o=t.call(this,e,c))._id=i,o._type=re.LCD,o._offset={left:s,top:r},o._state=new Array(2),o.insertHtml(),o.toggleVisibility(l),o}return s()(n,[{key:"toString",value:function(){return"lcd"}},{key:"insertHtml",value:function(){$("#sim_container").append("<div id='sim_lcd"+this.getId()+"' class='sim_element sim_element_lcd draggable'><div><span class='grippy'></span>Lcd</div></div>"),$("#sim_lcd"+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_lcd"+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_lcd"+this.getId()).append("<div id='sim_element_lcd_img'></div>"),$("#sim_element_lcd_img").append('<div class="lcd" id="sim_lcd_row0"></div>'),$("#sim_element_lcd_img").append('<div class="lcd" id="sim_lcd_row1"></div>')}},{key:"removeHtml",value:function(){$("#sim_lcd"+this.getId()).remove()}},{key:"toXml",value:function(){var e="";e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){}},{key:"toggleVisibility",value:function(e){e?$("#sim_lcd"+this.getId()).css("visibility","visible"):$("#sim_lcd"+this.getId()).css("visibility","hidden")}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setState",value:function(e,t){this._state[0]=e,this._state[1]=t}},{key:"getState",value:function(){return this._state}}]),n}(L),j=function(){function e(t,n,i,o,l){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"";a()(this,e),this._id=t,this._parentId=n,this._minValue=i,this._maxValue=o,this._initialValue=l,this._label=s,this._valuePrefix=r,this._valueSuffix=c,this._sliderId="slider_"+this._id,this._sliderLabelId="slider_"+this._id+"_label",this._sliderValueId="slider_"+this._id+"_value",this._sliderRangeId="slider_"+this._id+"_range",this._classes=d,this.insert()}return s()(e,[{key:"toString",value:function(){return"sonar"}},{key:"insert",value:function(){document.getElementById(this.getSliderRangeId())?console.log("already exists"):(""!=this.getLabel()&&this.insertLabel(),$("#"+this.getParentId()).append('<div id="'+this.getSliderValueId()+'" class="">'+this.getValuePrefix()+this.getInitialValue()+this.getValueSuffix()+"</div>"),$("#"+this.getParentId()).append('<div id="'+this.getSliderId()+'" class="slidecontainer '+this.getClasses()+'"></div>'),$("#"+this.getSliderId()).append('<input id="'+this.getSliderRangeId()+'" type="range" min="'+this.getMinValue()+'" max="'+this.getMaxValue()+'" value="'+this.getInitialValue()+'" class="slider"></input>'))}},{key:"insertLabel",value:function(){var e='<div id="'+this.getSliderLabelId()+'" class="slider_label">'+this.getLabel()+"</div>";$("#"+this.getParentId()).append(e)}},{key:"updateValueLabel",value:function(e){document.getElementById(this.getSliderValueId()).innerHTML=this.getValuePrefix()+e+this.getValueSuffix()}},{key:"remove",value:function(){$("#"+this.getSliderLabelId()).remove(),$("#"+this.getSliderValueId()).remove(),$("#"+this.getSliderId()).remove()}},{key:"getParentId",value:function(){return this._parentId}},{key:"getSliderElement",value:function(){return document.getElementById(this.getSliderRangeId())}},{key:"getInitialValue",value:function(){return this._initialValue}},{key:"getMinValue",value:function(){return this._minValue}},{key:"getMaxValue",value:function(){return this._maxValue}},{key:"getLabel",value:function(){return this._label}},{key:"getValuePrefix",value:function(){return this._valuePrefix}},{key:"getValueSuffix",value:function(){return this._valueSuffix}},{key:"getSliderId",value:function(){return this._sliderId}},{key:"getSliderLabelId",value:function(){return this._sliderLabelId}},{key:"getSliderValueId",value:function(){return this._sliderValueId}},{key:"getSliderRangeId",value:function(){return this._sliderRangeId}},{key:"getClasses",value:function(){return this._classes}}]),e}();function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Z=function(e){b()(n,e);var t=z(n);function n(e,i){var o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:58,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,g=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"sim_canvas sonar_canvas";return a()(this,n),(o=t.call(this,e,h))._id=i,o._type=re.SONAR,o._width=d,o._height=u,o._offset={left:p,top:g},o._image=new Image,o._image.src="./DwenguinoIDE/img/board/sonar.png",o._echoPin=l,o._triggerPin=s,o._state=r,console.log(o._state,"state"),o._stateUpdated=!1,o._canvasId="sim_sonar_canvas"+o._id,o.insertHtml(),o.toggleVisibility(c),o}return s()(n,[{key:"toString",value:function(){return"sonar"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var t=MSG.sonarSliderLabel+" "+this.getId();this._slider=new j(this.getId(),"sensor_options",0,200,0,t,""," cm","sonar_slider"),console.log(this._slider.getInitialValue(),"initial value");var n=this;this._slider.getSliderElement().oninput=function(){var e=n.getId();console.log(this.value,"new value updated"),n.changeSonarDistance(this.value,e),n._slider.updateValueLabel(this.value)},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.sonarOptions),e.showDialog()}))}},{key:"changeSonarDistance",value:function(e){this.setState(e),this._stateUpdated=!0,this._eventBus.dispatchEvent(N.SAVE)}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove(),$("#"+this.getSliderLabelId()).remove(),$("#"+this.getSliderValueId()).remove(),$("#"+this.getSliderId()).remove()}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" EchoPin='",this.getEchoPin(),"'")).concat(" TriggerPin='",this.getTriggerPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){}},{key:"toggleVisibility",value:function(e){e?$("#sim_sonar"+this.getId()).css("visibility","visible"):$("#sim_sonar"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsTriggerPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsTriggerPin").append('<div class="col-md-2">Trigger pin</div>'),$("#componentOptionsTriggerPin").append('<div id="triggerPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsEchoPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsEchoPin").append('<div class="col-md-2">Echo pin</div>'),$("#componentOptionsEchoPin").append('<div id="echoPin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=0;n<t.length;n++)$("#triggerPin").append('<button type="button" id=triggerPin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 triggerPinButton pinButton option_button_enabled">'+t[n]+"</button>"),$("#echoPin").append('<button type="button" id=echoPin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 echoPinButton pinButton option_button_enabled">'+t[n]+"</button>");for(var i=function(n){e.getTriggerPin()==t[n]&&($("#triggerPin"+t[n]).addClass("option_button_selected"),$("#echoPin"+t[n]).addClass("option_button_disabled"),$("#echoPin"+t[n]).prop("disabled",!0)),e.getEchoPin()==t[n]&&($("#echoPin"+t[n]).addClass("option_button_selected"),$("#triggerPin"+t[n]).addClass("option_button_disabled"),$("#triggerPin"+t[n]).prop("disabled",!0));var i=document.getElementById("triggerPin"+t[n]),o=document.getElementById("echoPin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setTriggerPin(t),$(".triggerPinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE),$(".echoPinButton").removeClass("option_button_disabled"),$(".echoPinButton").prop("disabled",!1),$("#echoPin"+t).addClass("option_button_disabled"),$("#echoPin"+t).prop("disabled",!0)})),o.addEventListener("click",(function(){var t=o.name;e.setEchoPin(t),$(".echoPinButton").removeClass("option_button_selected"),o.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE),$(".triggerPinButton").removeClass("option_button_disabled"),$(".triggerPinButton").prop("disabled",!1),$("#triggerPin"+t).addClass("option_button_disabled"),$("#triggerPin"+t).prop("disabled",!0)}))},o=0;o<t.length;o++)i(o)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(e){this._image.src=e}},{key:"getImage",value:function(){return this._image}},{key:"setEchoPin",value:function(e){this._echoPin=e}},{key:"getEchoPin",value:function(){return this._echoPin}},{key:"setTriggerPin",value:function(e){this._triggerPin=e}},{key:"getTriggerPin",value:function(){return this._triggerPin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getSliderId",value:function(){return this._sliderId}},{key:"getSliderLabelId",value:function(){return this._sliderLabelId}},{key:"getSliderValueId",value:function(){return this._sliderValueId}},{key:"getSliderRangeId",value:function(){return this._sliderRangeId}}]),n}(L),J={SERVO:"servo",LED:"led",PIR:"pir",SONAR:"sonar",LCD:"lcd",SOUND:"sound",LIGHT:"light",BUZZER:"buzzer"};Object.freeze(J);var q=function e(){if(a()(this,e),void 0===this.toString)throw new Error("You have to implement the method toString");if(void 0===this.getType)throw new Error("You have to implement the method getType")};function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var ee=function(e){b()(n,e);var t=Q(n);function n(){return a()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"sound"}}],[{key:"getType",value:function(){return J.SOUND}},{key:"getDescription",value:function(){return""}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(q),te=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";a()(this,e),this._id=t,this._parentId=n,this._label=i,this._buttonLabelId="button_"+this._id+"_label",this._buttonId="button_"+this._id+"_button",this._labelClasses=o,this._activeClasses="dwenguino_button dwenguino_button_pushed",this._inactiveClasses="dwenguino_button",this.insert()}return s()(e,[{key:"toString",value:function(){return"sonar"}},{key:"insert",value:function(){document.getElementById(this.getButtonId())?console.log("A button with id ",this.getButtonId()," already exists."):(""!=this.getLabel()&&$("#"+this.getParentId()).append('<div id="'+this.getButtonLabelId()+'" class="'+this.getLabelClasses()+'">'+this.getLabel()+"</div>"),$("#"+this.getParentId()).append('<div id="'+this.getButtonId()+'" class="'+this.getInactiveClasses()+'"></div>'))}},{key:"update",value:function(){this.isInactive()?this.getButtonElement().className=this.getActiveClasses():this.getButtonElement().className=this.getInactiveClasses()}},{key:"remove",value:function(){$("#"+this.getButtonLabelId()).remove(),$("#"+this.getButtonId()).remove()}},{key:"getParentId",value:function(){return this._parentId}},{key:"getButtonElement",value:function(){return document.getElementById(this.getButtonId())}},{key:"getLabel",value:function(){return this._label}},{key:"getButtonLabelId",value:function(){return this._buttonLabelId}},{key:"getButtonId",value:function(){return this._buttonId}},{key:"getLabelClasses",value:function(){return this._labelClasses}},{key:"getInactiveClasses",value:function(){return this._inactiveClasses}},{key:"getActiveClasses",value:function(){return this._activeClasses}},{key:"isInactive",value:function(){return this.getButtonElement().className===this.getInactiveClasses()}},{key:"isActive",value:function(){return this.getButtonElement().className===this.getActiveClasses()}}]),e}();function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var ie=function(e){b()(n,e);var t=ne(n);function n(e,i,o,l,s,r,c,d,u,p){var g;return a()(this,n),(g=t.call(this,e,p))._id=i,g._type=re.PIR,g._width=r,g._height=c,g._offset={left:d,top:u},g._image=new Image,g._image.src="./DwenguinoIDE/img/socialrobot/pir_off.png",g._pin=o,g._state=l,g._stateUpdated=!1,g._canvasId="sim_pir_canvas"+g._id,g.insertHtml(),g.toggleVisibility(s),g}return s()(n,[{key:"toString",value:function(){return"pir"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var t=MSG.pirButtonLabel+" "+this.getId(),n=""+this.getType()+this.getId();this._button=new te(n,"sensor_options",t);var i=this;this._button.getButtonElement().onclick=function(){i._button.update(),i._button.isActive()?(i.setImage("./DwenguinoIDE/img/socialrobot/pir_on.png"),i.setState(1),i._stateUpdated=!0,i._eventBus.dispatchEvent(N.SAVE)):(i.setImage("./DwenguinoIDE/img/socialrobot/pir_off.png"),i.setState(0),i._stateUpdated=!0,i._eventBus.dispatchEvent(N.SAVE))},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.pirOptions),e.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_pir"+this.getId()).remove();var e="#button"+this.getId()+"_label",t="#pir_button"+this.getId();$(e).remove(),$(t).remove()}},{key:"toggleVisibility",value:function(e){e?$("#sim_pir"+this.getId()).css("visibility","visible"):$("#sim_pir"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(e){this._image.src=e}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(L);function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var ae=function(e){b()(n,e);var t=oe(n);function n(e,i,o,l,s,r,c,d,u,p){var g;return a()(this,n),(g=t.call(this,e,p))._id=i,g._type=re.SOUND,g._width=r,g._height=c,g._offset={left:d,top:u},g._image=new Image,g._image.src="./DwenguinoIDE/img/socialrobot/sound_sensor.png",g._pin=o,g._state=l,g._stateUpdated=!1,g._canvasId="sim_sound_canvas"+g._id,g.insertHtml(),g.toggleVisibility(s),g}return s()(n,[{key:"toString",value:function(){return"sound sensor"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var t=this.getType()+"_button"+this.getId()+"_label",n=this.getType()+"_button"+this.getId();document.getElementById(n)||($("#sensor_options").append("<div id='"+t+"' class='sensor_options_label' alt='Load'>"+MSG.soundButtonLabel+" "+this.getId()+"</div>"),$("#sensor_options").append("<div id='"+n+"' class='sound_button' alt='Load'></div>"),this.addSoundSensorEventHandler(n)),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.soundOptions),e.showDialog()}))}},{key:"addSoundSensorEventHandler",value:function(e){var t=this;$("#"+e).on("click",(function(){"sound_button"===document.getElementById(e).className?(document.getElementById(e).className="sound_button sound_button_pushed",t.setImage("./DwenguinoIDE/img/socialrobot/sound_sensor.png"),t.setState(1),t._stateUpdated=!0,t._eventBus.dispatchEvent(N.SAVE)):(document.getElementById(e).className="sound_button",t.setImage("./DwenguinoIDE/img/socialrobot/sound_sensor.png"),t.setState(0),t._stateUpdated=!0,t._eventBus.dispatchEvent(N.SAVE))}))}},{key:"removeHtml",value:function(){$("#sim_sound"+this.getId()).remove();var e="#"+this.getType()+"_button"+this.getId()+"_label",t="#"+this.getType()+"_button"+this.getId();$(e).remove(),$(t).remove()}},{key:"toggleVisibility",value:function(e){e?$("#sim_sound"+this.getId()).css("visibility","visible"):$("#sim_sound"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(e){this._image.src=e}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(L);function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var se=function(e){b()(n,e);var t=le(n);function n(e,i,o,l,s,r,c,d,u,p){var g;return a()(this,n),(g=t.call(this,e,p))._id=i,g._type=re.LIGHT,g._width=r,g._height=c,g._offset={left:d,top:u},g._image=new Image,g._image.src="./DwenguinoIDE/img/socialrobot/light_sensor.png",g._pin=o,g._state=l,g._stateUpdated=!1,g._canvasId="sim_light_canvas"+g._id,g.insertHtml(),g.toggleVisibility(s),g}return s()(n,[{key:"toString",value:function(){return"light sensor"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var t=this.getType()+"_button"+this.getId()+"_label",n=this.getType()+"_button"+this.getId();document.getElementById(n)||($("#sensor_options").append("<div id='"+t+"' class='sensor_options_label' alt='Load'>"+MSG.lightButtonLabel+" "+this.getId()+"</div>"),$("#sensor_options").append("<div id='"+n+"' class='light_button' alt='Load'></div>"),this.addLightSensorEventHandler(n)),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.lightOptions),e.showDialog()}))}},{key:"addLightSensorEventHandler",value:function(e){var t=this;$("#"+e).on("click",(function(){"light_button"===document.getElementById(e).className?(document.getElementById(e).className="light_button light_button_pushed",t.setImage("./DwenguinoIDE/img/socialrobot/light_sensor.png"),t.setState(1),t._stateUpdated=!0,t._eventBus.dispatchEvent(N.SAVE)):(document.getElementById(e).className="light_button",t.setImage("./DwenguinoIDE/img/socialrobot/light_sensor.png"),t.setState(0),t._stateUpdated=!0,t._eventBus.dispatchEvent(N.SAVE))}))}},{key:"removeHtml",value:function(){$("#sim_light"+this.getId()).remove();var e="#"+this.getType()+"_button"+this.getId()+"_label",t="#"+this.getType()+"_button"+this.getId();$(e).remove(),$(t).remove()}},{key:"toggleVisibility",value:function(e){e?$("#sim_light"+this.getId()).css("visibility","visible"):$("#sim_light"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(e){this._image.src=e}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(L),re={SERVO:"servo",LED:"led",PIR:"pir",SONAR:"sonar",LCD:"lcd",SOUND:"sound",LIGHT:"light"};Object.freeze(re);var ce=function(){function e(t,n,i){a()(this,e),c()(this,"logger",null),c()(this,"inputState",{pir:0,buttons:[1,1,1,1,1],sonarDistance:-1}),this.logger=n,this._eventBus=i,this._robot=[],this._numberOfComponentsOfType={},this.scenarioUtils=t,this.renderer=new R;for(var o=0,l=Object.entries(re);o<l.length;o++){var s=D()(l[o],2),r=(s[0],s[1]);this._numberOfComponentsOfType[r]=0}}return s()(e,[{key:"getRobot",value:function(){return this._robot}},{key:"resetSocialRobot",value:function(){for(var e=0;e<this._robot.length;e++)this._robot[e].reset()}},{key:"updateScenarioState",value:function(e){for(var t=0;t<this._robot.length;t++){var n=0;switch(this._robot[t].getType()){case re.SERVO:36===(n=this._robot[t].getPin())?this._robot[t].getAngle()!=e.getServoAngle(1)&&(this._robot[t].setPrevAngle(this._robot[t].getAngle()),this._robot[t].setAngle(e.getServoAngle(1))):37===n?this._robot[t].getAngle()!=e.getServoAngle(2)&&(this._robot[t].setPrevAngle(this._robot[t].getAngle()),this._robot[t].setAngle(e.getServoAngle(2))):this._robot[t].getAngle()!=e.getIoPinState(n)&&(this._robot[t].setPrevAngle(this._robot[t].getAngle()),this._robot[t].setAngle(e.getIoPinState(n)));break;case re.LED:n=this._robot[t].getPin(),this._robot[t].setState(e.getIoPinState(n));break;case re.PIR:n=this._robot[t].getPin(),this._robot[t].isStateUpdated()&&(e.setIoPinState(n,this._robot[t].getState()),this._robot[t]._stateUpdated=!1);break;case re.SONAR:var i=this._robot[t].getEchoPin(),o=this._robot[t].getTriggerPin();this._robot[t].isStateUpdated()&&(e.setIoPinState(i,this._robot[t].getState()),e.setIoPinState(o,this._robot[t].getState()),this._robot[t]._stateUpdated=!1);break;case re.LCD:this._robot[t].setState(e.getLcdContent(0),e.getLcdContent(1));break;case re.SOUND:n=this._robot[t].getPin(),console.log(n),this._robot[t].isStateUpdated()&&(e.setIoPinState(n,this._robot[t].getState()),this._robot[t]._stateUpdated=!1,console.log(this._robot[t].getState()));break;case re.LIGHT:n=this._robot[t].getPin(),this._robot[t].isStateUpdated()&&(e.setIoPinState(n,this._robot[t].getState()),this._robot[t]._stateUpdated=!1)}}}},{key:"getInputState",value:function(){return this.inputState}},{key:"getRobotComponentWithTypeAndId",value:function(e,t){for(var n=0;n<this._robot.length;n++)if(this._robot[n].getType()==e&&this._robot[n].getId()==t)return this._robot[n]}},{key:"removeRobotComponentWithTypeAndId",value:function(e,t){this.getRobotComponentWithTypeAndId(e,t).removeHtml();for(var n=0;n<this._robot.length;n++)this._robot[n].getType()==e&&this._robot[n].getId()==t&&(this._robot.splice(n,1),this.decrementNumberOf(e))}},{key:"addRobotComponent",value:function(e){switch(e){case re.SERVO:this.addServo();break;case re.LED:this.addLed();break;case re.PIR:this.addPir();break;case re.SONAR:this.addSonar();break;case re.LCD:this.addLcd();break;case re.SOUND:this.addSoundSensor();break;case re.LIGHT:this.addLightSensor()}}},{key:"removeRobotComponent",value:function(e){switch(e){case re.SERVO:this.removeServo();break;case re.LED:this.removeLed();break;case re.PIR:this.removePir();break;case re.SONAR:this.removeSonar();break;case re.LCD:this.removeLcd();break;case re.SOUND:this.removeSoundSensor();break;case re.LIGHT:this.removeLightSensor()}}},{key:"addRobotComponentFromXml",value:function(e){switch(e.getAttribute("Type")){case re.SERVO:var t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),a=parseInt(e.getAttribute("Angle")),l=parseInt(e.getAttribute("Pin")),s=e.getAttribute("Costume"),r=e.getAttribute("Classes");this.addServo(l,s,a,!0,0,0,t,n,i,o,r);break;case re.LED:var c=parseFloat(e.getAttribute("Radius")),d=(i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),e.getAttribute("OnColor")),u=e.getAttribute("OffColor"),p=e.getAttribute("BorderColor");l=parseInt(e.getAttribute("Pin")),r=e.getAttribute("Classes");this.addLed(l,0,!0,c,0,0,i,o,d,u,p,r);break;case re.PIR:t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),l=parseInt(e.getAttribute("Pin"));var g=parseInt(e.getAttribute("State"));r=e.getAttribute("Classes");this.addPir(l,g,!0,t,n,i,o,r);break;case re.SONAR:t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop"));var h=parseInt(e.getAttribute("EchoPin")),m=parseInt(e.getAttribute("TriggerPin"));g=parseInt(e.getAttribute("State")),r=e.getAttribute("Classes");this.addSonar(h,m,g,!0,t,n,i,o,r);break;case re.LCD:i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),r=e.getAttribute("Classes");this.addLcd(!0,i,o,r);break;case re.SOUND:t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),l=parseInt(e.getAttribute("Pin")),g=parseInt(e.getAttribute("State")),r=e.getAttribute("Classes");this.addSoundSensor(l,g,!0,t,n,i,o,r);break;case re.LIGHT:t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),l=parseInt(e.getAttribute("Pin")),g=parseInt(e.getAttribute("State")),r=e.getAttribute("Classes");this.addLightSensor(l,g,!0,t,n,i,o,r)}}},{key:"addServo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G.PLAIN,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:50,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"sim_canvas servo_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,re.SERVO)),this.incrementNumberOf(re.SERVO);var u=this._numberOfComponentsOfType[re.SERVO];1==u?e=36:2==u&&(e=37);var p=new F(this._eventBus,u,e,t,n,i,o,a,l,s,r,c,d);this._robot.push(p),this.renderer.initializeCanvas(this._robot,p)}},{key:"removeServo",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,re.SERVO));var e=this._numberOfComponentsOfType[re.SERVO];this.removeRobotComponentWithTypeAndId(re.SERVO,e)}},{key:"addLed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"yellow",c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"gray",d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"black",u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"sim_canvas led_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,re.LED)),this.incrementNumberOf(re.LED);var p=this._numberOfComponentsOfType[re.LED],g=new X(this._eventBus,p,e,t,n,i,o,a,l,s,r,c,d,u);this._robot.push(g),this.renderer.initializeCanvas(this._robot,g)}},{key:"removeLed",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,re.LED));var e=this._numberOfComponentsOfType[re.LED];this.removeRobotComponentWithTypeAndId(re.LED,e)}},{key:"addPir",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:75,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:75,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas pir_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,re.PIR)),this.incrementNumberOf(re.PIR);var r=this._numberOfComponentsOfType[re.PIR],c=new ie(this._eventBus,r,e,t,n,i,o,a,l,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removePir",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,re.PIR));var e=this._numberOfComponentsOfType[re.PIR];this.removeRobotComponentWithTypeAndId(re.PIR,e)}},{key:"addSonar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:58,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"sim_canvas sonar_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,re.SONAR)),this.incrementNumberOf(re.SONAR);var c=this._numberOfComponentsOfType[re.SONAR],d=new Z(this._eventBus,c,e,t,n,i,o,a,l,s,r);this._robot.push(d),this.renderer.initializeCanvas(this._robot,d)}},{key:"removeSonar",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,re.SONAR));var e=this._numberOfComponentsOfType[re.SONAR];this.removeRobotComponentWithTypeAndId(re.SONAR,e)}},{key:"addLcd",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,re.LCD)),this.incrementNumberOf(re.LCD);var o=this._numberOfComponentsOfType[re.LCD],a=new K(this._eventBus,o,e,t,n,i);this._robot.push(a)}},{key:"removeLcd",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,re.Lcd));var e=this._numberOfComponentsOfType[re.LCD];this.removeRobotComponentWithTypeAndId(re.LCD,e)}},{key:"addSoundSensor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:42,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas sound_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,re.SOUND)),this.incrementNumberOf(re.SOUND);var r=this._numberOfComponentsOfType[re.SOUND],c=new ae(this._eventBus,r,e,t,n,i,o,a,l,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removeSoundSensor",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,re.SOUND));var e=this._numberOfComponentsOfType[re.SOUND];this.removeRobotComponentWithTypeAndId(re.SOUND,e)}},{key:"addLightSensor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:45,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas light_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,re.LIGHT)),this.incrementNumberOf(re.LIGHT);var r=this._numberOfComponentsOfType[re.LIGHT],c=new se(this._eventBus,r,e,t,n,i,o,a,l,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removeLightSensor",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,re.LIGHT));var e=this._numberOfComponentsOfType[re.LIGHT];this.removeRobotComponentWithTypeAndId(re.LIGHT,e)}},{key:"incrementNumberOf",value:function(e){this._numberOfComponentsOfType[e]+=1}},{key:"decrementNumberOf",value:function(e){this._numberOfComponentsOfType[e]-=1}}]),e}(),de=function(){function e(){a()(this,e),this.events={}}return s()(e,[{key:"registerEvent",value:function(e){var t=new H(e);this.events[e]=t}},{key:"dispatchEvent",value:function(e,t){this.events[e].callbacks.forEach((function(e){e(t)}))}},{key:"addEventListener",value:function(e,t){this.events[e].registerCallback(t)}}]),e}(),ue=function(){function e(t){a()(this,e),c()(this,"socialRobotScenario",{}),this._eventBus=t,this._components=[{type:re.SERVO,maximumAmount:5},{type:re.LED,maximumAmount:3},{type:re.PIR,maximumAmount:2},{type:re.SONAR,maximumAmount:1},{type:re.LCD,maximumAmount:1},{type:re.SOUND,maximumAmount:2},{type:re.LIGHT,maximumAmount:2},{type:re.DECORATION,maximumAmount:10}]}return s()(e,[{key:"setupEnvironment",value:function(e){this.socialRobotScenario=e,console.log("setupEnvironment"),this.initMenu(),this.translateRobotComponents()}},{key:"initMenu",value:function(){$("#db_simulator_top_pane").append('<div id="robot_components_menu" class="scrolling-wrapper-flexbox"></div>'),$("#robot_components_menu").append('<div id="rc_servo" class="robot_components_item bg-c-4 card"></div>'),$("#rc_servo").append('<div id="rc_servo_tag" class="rc_tag"></div>'),$("#rc_servo").append('<div id="rc_servo_img"></div>'),$("#rc_servo").append('<div id="rc_servo_options"></div>'),$("#robot_components_menu").append('<div id="rc_led" class="robot_components_item bg-c-4 card"></div>'),$("#rc_led").append('<div id="rc_led_tag" class="rc_tag"></div>'),$("#rc_led").append('<div id="rc_led_img"></div>'),$("#rc_led").append('<div id="rc_led_options"></div>'),$("#robot_components_menu").append('<div id="rc_pir" class="robot_components_item bg-c-4 card"></div>'),$("#rc_pir").append('<div id="rc_pir_tag" class="rc_tag"></div>'),$("#rc_pir").append('<div id="rc_pir_img"></div>'),$("#rc_pir").append('<div id="rc_pir_value"></div>'),$("#rc_pir").append('<div id="rc_pir_options"></div>'),$("#robot_components_menu").append('<div id="rc_sonar" class="robot_components_item bg-c-4 card"></div>'),$("#rc_sonar").append('<div id="rc_sonar_tag" class="rc_tag"></div>'),$("#rc_sonar").append('<div id="rc_sonar_img"></div>'),$("#rc_sonar").append('<div id="rc_sonar_value"></div>'),$("#rc_sonar").append('<div id="rc_sonar_options"></div>'),$("#robot_components_menu").append('<div id="rc_lcd" class="robot_components_item bg-c-4 card"></div>'),$("#rc_lcd").append('<div id="rc_lcd_tag" class="rc_tag"></div>'),$("#rc_lcd").append('<div id="rc_lcd_img"></div>'),$("#rc_lcd").append('<div id="rc_lcd_options"></div>'),$("#robot_components_menu").append('<div id="rc_sound" class="robot_components_item bg-c-4 card"></div>'),$("#rc_sound").append('<div id="rc_sound_tag" class="rc_tag"></div>'),$("#rc_sound").append('<div id="rc_sound_img"></div>'),$("#rc_sound").append('<div id="rc_sound_options"></div>'),$("#robot_components_menu").append('<div id="rc_light" class="robot_components_item bg-c-4 card"></div>'),$("#rc_light").append('<div id="rc_light_tag" class="rc_tag"></div>'),$("#rc_light").append('<div id="rc_light_img"></div>'),$("#rc_light").append('<div id="rc_light_options"></div>'),$("#robot_components_menu").append('<div id="rc_decoration" class="robot_components_item bg-c-4 card"></div>'),$("#rc_decoration").append('<div id="rc_decoration_tag" class="rc_tag"></div>'),$("#rc_decoration").append('<div id="rc_decoration_img"></div>'),$("#rc_decoration").append('<div id="rc_decoration_options"></div>'),this.initButtons()}},{key:"initButtons",value:function(){var e=this.generateButtonTemplate(re.SERVO);$("#rc_servo_options").append(e);var t=this.generateButtonTemplate(re.LED);$("#rc_led_options").append(t);var n=this.generateButtonTemplate(re.PIR);$("#rc_pir_options").append(n);var i=this.generateButtonTemplate(re.SONAR);$("#rc_sonar_options").append(i);var o=this.generateButtonTemplate(re.LCD);$("#rc_lcd_options").append(o);var a=this.generateButtonTemplate(re.SOUND);$("#rc_sound_options").append(a);var l=this.generateButtonTemplate(re.LIGHT);$("#rc_light_options").append(l);var s=this;$(".btn-number").click((function(e){e.preventDefault();var t=$(this).attr("data-field"),n=$(this).attr("data-type"),i=$("input[name='"+t+"']"),o=parseInt(i.val());isNaN(o)?i.val(0):"minus"==n?(o>i.attr("min")&&(i.val(o-1).change(),s.removeRobotComponent(e.target.id)),parseInt(i.val())==i.attr("min")&&$(this).attr("disabled",!0)):"plus"==n&&(o<i.attr("max")&&(i.val(o+1).change(),s.addRobotComponent(e.target.id)),parseInt(i.val())==i.attr("max")&&$(this).attr("disabled",!0))})),$(".input-number").focusin((function(){$(this).data("oldValue",$(this).val())})),$(".input-number").change((function(){var e=parseInt($(this).attr("min")),t=parseInt($(this).attr("max")),n=parseInt($(this).val()),i=$(this).attr("name");n>=e?$(".component_item_input[data-type='minus'][data-field='"+i+"']").removeAttr("disabled"):$(this).val($(this).data("oldValue")),n<=t?$(".component_item_input[data-type='plus'][data-field='"+i+"']").removeAttr("disabled"):$(this).val($(this).data("oldValue"))})),$(".input-number").keydown((function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,190])||65==e.keyCode&&!0===e.ctrlKey||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}))}},{key:"resetButtons",value:function(){for(var e=0,t=Object.entries(re);e<t.length;e++){var n=D()(t[e],2),i=(n[0],n[1]);$("input[name='"+i+"']").val(0).change()}}},{key:"changeValue",value:function(e,t){var n=$("input[name='"+e+"']"),i=parseInt(n.val());n.val(i+t).change()}},{key:"translateRobotComponents",value:function(){for(var e=0,t=Object.entries(re);e<t.length;e++){var n=D()(t[e],2),i=(n[0],n[1]);document.getElementById("rc_"+i+"_tag").textContent=MSG.simulator[i]}}},{key:"generateButtonTemplate",value:function(e){var t="";return this._components.forEach((function(n){n.type==e&&(t='<fieldset><button type="button" id="rc_'+e+'_minus_button" class="component_item_input btn-number" disabled="disabled" data-type="minus" data-field="'+e+'"><span class="glyphicon glyphicon-minus" id="rc_'+e+'_minus_button"></span></button><input type="text" name="'+e+'" class="component_item_input input-number" size="2" value="0" min="0" max="'+n.maximumAmount+'"><button type="button" id="rc_'+e+'_plus_button" class="component_item_input btn-number" data-type="plus" data-field="'+e+'"><span class="glyphicon glyphicon-plus" id="rc_'+e+'_plus_button"></span></button></fieldset>')})),t}},{key:"addRobotComponent",value:function(e){switch(e){case"rc_servo_plus_button":this.socialRobotScenario.addRobotComponent(re.SERVO);break;case"rc_led_plus_button":this.socialRobotScenario.addRobotComponent(re.LED);break;case"rc_pir_plus_button":this.socialRobotScenario.addRobotComponent(re.PIR);break;case"rc_sonar_plus_button":this.socialRobotScenario.addRobotComponent(re.SONAR);break;case"rc_decoration_plus_button":this.socialRobotScenario.addRobotComponent(re.DECORATION);break;case"rc_lcd_plus_button":this.socialRobotScenario.addRobotComponent(re.LCD);break;case"rc_sound_plus_button":this.socialRobotScenario.addRobotComponent(re.SOUND);break;case"rc_light_plus_button":this.socialRobotScenario.addRobotComponent(re.LIGHT)}this._eventBus.dispatchEvent(N.SAVE)}},{key:"removeRobotComponent",value:function(e){switch(e){case"rc_servo_minus_button":this.socialRobotScenario.removeRobotComponent(re.SERVO);break;case"rc_led_minus_button":this.socialRobotScenario.removeRobotComponent(re.LED);break;case"rc_pir_minus_button":this.socialRobotScenario.removeRobotComponent(re.PIR);break;case"rc_sonar_minus_button":this.socialRobotScenario.removeRobotComponent(re.SONAR);break;case"rc_decoration_minus_button":this.socialRobotScenario.removeRobotComponent(re.DECORATION);break;case"rc_lcd_minus_button":this.socialRobotScenario.removeRobotComponent(re.LCD);break;case"rc_sound_minus_button":this.socialRobotScenario.removeRobotComponent(re.SOUND);break;case"rc_light_minus_button":this.socialRobotScenario.removeRobotComponent(re.LIGHT)}this._eventBus.dispatchEvent(N.SAVE)}}]),e}(),pe=function(){function e(t){a()(this,e),c()(this,"logger",null),this.logger=t,console.log("Constructor")}return s()(e,[{key:"initSimulationState",value:function(e){console.log("initSimulationState")}},{key:"initSimulationDisplay",value:function(e){$("#".concat(e)).empty()}},{key:"updateScenario",value:function(e){}},{key:"updateScenarioState",value:function(e){}},{key:"updateScenarioDisplay",value:function(e){}}]),e}(),ge=function(){function e(t,n){a()(this,e),c()(this,"socialRobotScenario",null),this.socialRobotScenario=t,this._eventBus=n,this.setupInteract(),window.dragMoveListener=this.dragMoveListener}return s()(e,[{key:"setupInteract",value:function(){var e=this;interact(".draggable").draggable({inertia:!0,modifiers:[interact.modifiers.restrictRect({restriction:"parent",endOnly:!0})],autoScroll:!0,onmove:this.dragMoveListener,onend:function(t){var n=t.target.querySelector("p");n&&(n.textContent="moved a distance of "+Math.sqrt(Math.pow(t.pageX-t.x0,2)+Math.pow(t.pageY-t.y0,2)|0).toFixed(2)+"px"),e._eventBus.dispatchEvent(N.SAVE),e.socialRobotScenario.logger.recordEvent(e.socialRobotScenario.logger.createEvent(O.moveRobotComponent,t.target.id))}})}},{key:"dragMoveListener",value:function(e){var t=e.target,n=(parseFloat(t.getAttribute("data-x"))||0)+e.dx,i=(parseFloat(t.getAttribute("data-y"))||0)+e.dy;t.style.webkitTransform=t.style.transform="translate("+n+"px, "+i+"px)",t.setAttribute("data-x",n),t.setAttribute("data-y",i)}},{key:"fireCustomEvent",value:function(e,t,n){var i;n=n||{},document.createEvent?(i=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(i=document.createEventObject()).eventType=e,i.eventName=e,i=$.extend(i,n),document.createEvent?t.dispatchEvent(i):t.fireEvent("on"+i.eventType,i)}}]),e}(),he=n(9),me=n.n(he),ve=n(10),fe=n.n(ve),ye=function(){function e(){a()(this,e)}return s()(e,[{key:"download",value:function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"uploadXml",value:function(){return new Promise((function(e,t){var n="";if(window.File&&window.FileReader&&window.FileList&&window.Blob){console.log("yay, files supported"),$("div").remove("#dropzoneModal"),$("#blocklyDiv").append('<div id="dropzoneModal" class="modal fade" role="dialog"></div>'),$("#dropzoneModal").append('<div id="modalDialog" class="modal-dialog"></div>'),$("#modalDialog").append('<div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Upload</h4></div>'),$("#modalDialog").append('<div class="modal-body">'+MSG.dropzone.dictSelectFile+'<input type="file" id="fileInput"><div id="filedrag">'+MSG.dropzone.dictDefaultMessage+'</div><pre id="fileDisplayArea"><pre></div>'),$("#modalDialog").append('<div class="modal-footer"><button id="submit_upload_modal_dialog_button" type="button" class="btn btn-default" data-dismiss="modal">Ok</button></div>'),$("#dropzoneModal").modal("show");var i=function(e){if(e.type.match(/text.*/)){var t=new FileReader;t.onload=function(i){a.innerText=e.name,n=t.result},t.readAsText(e)}else a.innerText="File not supported!"},o=document.getElementById("fileInput"),a=document.getElementById("fileDisplayArea");o.addEventListener("change",(function(e){var t=o.files[0];i(t)}));var l=function(e){e.stopPropagation(),e.preventDefault(),e.target.className="dragover"==e.type?"hover":""},s=document.getElementById("filedrag");s.addEventListener("dragover",l,!1),s.addEventListener("dragleave",l,!1),s.addEventListener("drop",(function(e){l(e);var t=(e.target.files||e.dataTransfer.files)[0];i(t)}),!1),s.style.display="block",$("#dropzoneModal").on("click",(function(e){var n=$(e.target);console.log(n),(n.is("button.close")||n.is("div#dropzoneModal.modal.fade"))&&(console.log("closed"),t("Dialog closed without result"))})),$("#submit_upload_modal_dialog_button").click((function(){e(n)}))}else t("File IO libraries not supported")}))}}]),e}(),be=function(){function e(t,n){a()(this,e),c()(this,"ioController",null),this.scenario=t,this._eventBus=n,this.ioController=new ye}var t;return s()(e,[{key:"saveScenario",value:function(e){console.log("save scenario"),this.ioController.download("scenario.xml",e),this.scenario.logger.recordEvent(this.scenario.logger.createEvent(O.downloadScenarioClicked,""))}},{key:"loadScenario",value:(t=fe()(me.a.mark((function e(){var t;return me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.ioController.uploadXml();case 3:t=e.sent,this.scenario.xmlToRobot(t),this._eventBus.dispatchEvent(N.SAVE),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return t.apply(this,arguments)})},{key:"textToDom",value:function(e){var t=(new DOMParser).parseFromString(e,"text/xml");return t&&t.firstChild&&"xml"==t.firstChild.nodeName.toLowerCase()&&t.firstChild===t.lastChild||goog.asserts.fail("Blockly.Xml.textToDom did not obtain a valid XML tree."),t.firstChild}}]),e}();function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var ke=function(e){b()(n,e);var t=_e(n);function n(e){var i;return a()(this,n),i=t.call(this,e),c()(m()(i),"simulationComponentsMenu",null),c()(m()(i),"simulationRobotComponents",null),i._eventBus=new de,i._eventBus.registerEvent(N.SAVE),i._eventBus.addEventListener(N.SAVE,(function(){i.saveRobot()})),i.simulationRobotComponents=new ge(m()(i),i._eventBus),i.simulationComponentsMenu=new ue(i._eventBus),i}return s()(n,[{key:"initSimulationState",value:function(e){var t=this;f()(w()(n.prototype),"initSimulationState",this).call(this,e),this.renderer=new R,this.scenarioUtils=new be(this,this._eventBus),this.robotComponentsFactory=new ce(this.scenarioUtils,this.logger,this._eventBus),this._eventBus.registerEvent(N.CLEARCANVAS),this._eventBus.addEventListener(N.CLEARCANVAS,(function(e){t.renderer.clearCanvas(e)})),this._eventBus.registerEvent(N.INITIALIZECANVAS),this._eventBus.addEventListener(N.INITIALIZECANVAS,(function(e){t.renderer.initializeCanvas(t.robotComponentsFactory.getRobot(),e)}))}},{key:"initSimulationDisplay",value:function(e){f()(w()(n.prototype),"initSimulationDisplay",this).call(this);var t=$("#".concat(e));t.empty();var i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane");t.append(i).append(o),this.simulationComponentsMenu.setupEnvironment(this),this.initSimulation(e);var a=this;$("#sim_stop").click((function(){setTimeout((function(){a.resetSocialRobot(),a.renderer.render(a.robotComponentsFactory.getRobot())}),500)})),this.setBackground(),this.initScenarioOptions(),this.setSensorOptions(),this.loadRobot()}},{key:"initScenarioOptions",value:function(){var e=this,t=this,n=$("<div>").attr("id","scenario_options");$("#sim_container").append(n),n.append("<div id='load_scenario' class='glyphicon glyphicon-cloud-upload' alt='Load'></div>"),n.append("<div id='save_scenario' class='glyphicon glyphicon-cloud-download' alt='Save'></div>"),n.append("<div id='switch_background' class='glyphicon glyphicon-refresh'></div>"),$("#load_scenario").click((function(){t.scenarioUtils.loadScenario()})),$("#save_scenario").click((function(){var e=t.loadToXml();t.scenarioUtils.saveScenario(e)})),document.getElementById("switch_background").addEventListener("click",(function(){e.switchBackground()}))}},{key:"initSimulation",value:function(e){console.log("init simulation display");var t=$("#".concat(e));$("#db_simulator_top_pane").css("height","25%"),$("#db_simulator_bottom_pane").css("height","75%");var n=$("<div>").attr("id","sim_container").attr("style","margin: auto"),i=this;new ResizeSensor(n,(function(){i.containerWidth=n.width(),i.containerHeight=n.height()})),t.append(n)}},{key:"updateScenario",value:function(e){f()(w()(n.prototype),"updateScenario",this).call(this,e),this.updateScenarioState(e),this.updateScenarioDisplay(e)}},{key:"updateScenarioState",value:function(e){f()(w()(n.prototype),"updateScenarioState",this).call(this,e),this.robotComponentsFactory.updateScenarioState(e)}},{key:"updateScenarioDisplay",value:function(e){f()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e),this.renderer.render(this.robotComponentsFactory.getRobot())}},{key:"setSensorOptions",value:function(){if(!document.getElementById("sensor_options")){var e=$("<div>").attr("id","sensor_options");$("#sim_container").append(e)}}},{key:"setBackground",value:function(){console.log("set background"),$("#sim_container").append("<div id='sim_background' class='sim_element row'></div>"),$("#sim_background").append("<div id='sim_background_img' class='background1'></div>"),this._background=1;var e=$("#sensor_options").width(),t=($("#sim_background").width()-e-$("#sim_background_img").width())/2;$("#sim_background_img").css("top","0px"),$("#sim_background_img").css("margin-left",t+"px")}},{key:"switchBackground",value:function(){this._background<3?this._background+=1:this._background=1,document.getElementById("sim_background_img").className="",document.getElementById("sim_background_img").className="background"+this._background,this._eventBus.dispatchEvent(N.SAVE)}},{key:"backgroundToXml",value:function(){var e="";return e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='","background","'")).concat(" Class='",document.getElementById("sim_background_img").className,"'")).concat(" Id='",this._background,"'")).concat("></Item>")}},{key:"resetSocialRobot",value:function(e){this.robotComponentsFactory.resetSocialRobot()}},{key:"addRobotComponent",value:function(e){this.robotComponentsFactory.addRobotComponent(e)}},{key:"removeRobotComponent",value:function(e){this.robotComponentsFactory.removeRobotComponent(e),this.renderer.render(this.robotComponentsFactory.getRobot())}},{key:"setLedColor",value:function(e,t){var n=this.robotComponentsFactory.getRobotComponentWithTypeAndId(re.LED,e);void 0!==n&&n.setOnColor(t)}},{key:"loadToXml",value:function(){if(window.localStorage){if(window.localStorage.getItem("socialRobotScenario"))return this.robotToXml()}}},{key:"robotToXml",value:function(){var e='<xml xmlns="http://www.w3.org/1999/xhtml">';e=e.concat(this.backgroundToXml());for(var t=this.robotComponentsFactory.getRobot(),n=0;n<t.length;n++)e=e.concat(t[n].toXml());return e=e.concat("</xml>")}},{key:"xmlToRobot",value:function(e){for(var t=this.scenarioUtils.textToDom(e),n=t.childNodes.length,i=0;i<n;i++){var o=t.childNodes[i],a=o.getAttribute("Type");"background"!==a?(this.robotComponentsFactory.addRobotComponentFromXml(o),this.simulationComponentsMenu.changeValue(a,1)):(this._background=parseInt(o.getAttribute("Id")),document.getElementById("sim_background_img").className=o.getAttribute("Class"))}}},{key:"saveRobot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e?"permanentDwenguinoSocialRobot"+t:"dwenguinoSocialRobot"+t;console.log("%c saving robot","color: green");var i=window.localStorage;if(i){var o=this.robotToXml();i.setItem(n,o)}}},{key:"loadRobot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e?"permanentDwenguinoSocialRobot"+t:"dwenguinoSocialRobot"+t;console.log("%c loading robot","color: green");var i=window.localStorage;if(i){var o=i.getItem(n);o&&this.xmlToRobot(o)}}},{key:"clearRobot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="dwenguinoSocialRobot"+e;console.log("%c clearing robot","color: green");var n=window.localStorage;n&&n.removeItem(t)}}]),n}(pe);function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var we=function(e){b()(n,e);var t=Se(n);function n(e){var i;return a()(this,n),i=t.call(this,e),c()(m()(i),"inputsState",null),c()(m()(i),"audiocontext",null),c()(m()(i),"osc",null),c()(m()(i),"audioStarted",!1),c()(m()(i),"muted",!0),c()(m()(i),"prevFreq",0),c()(m()(i),"boardDisplayWidth","80%"),c()(m()(i),"componentsTopOffset","0%"),c()(m()(i),"rightSimComponentsPosition","auto"),c()(m()(i),"sonarDistance",0),c()(m()(i),"sonarInputChanged",!1),c()(m()(i),"sonarFieldBeingEdited",!1),i.inputsState={buttons:[1,1,1,1,1],reset:1},i}return s()(n,[{key:"setBoardDisplayWidthWidth",value:function(e){this.boardDisplayWidth=e}},{key:"setComponentsTopOffset",value:function(e){this.componentsTopOffset=e}},{key:"setComponentsRightPosition",value:function(e){this.rightSimComponentsPosition=e}},{key:"initAudioContext",value:function(){try{this.audiocontext=new AudioContext}catch(e){console.log("Web Audio API is not supported in this browser")}}},{key:"initSimulationState",value:function(e){}},{key:"initSimulationDisplay",value:function(e){var t=this;$("#".concat(e)).append('<div id="db_simulator_pane"></div>'),$("#db_simulator_pane").append('<div id="debug"></div>'),$("#db_simulator_pane").append('<div id="sim_components"></div>');var n=$("<div>").css({position:"absolute",display:"inline-block",width:this.boardDisplayWidth,"max-width":"30vw",right:0}),i=$("<div>").attr("id","dummy").css({"margin-top":"70%"}),o=$("<div>").attr("id","sim_board").css({position:"absolute",right:0,bottom:0,left:0});n.append(i),n.append(o),$("#db_simulator_pane").append(n),$("#db_simulator_pane").append('<span id="db_simulator_mute"></span>'),$("#db_simulator_mute").attr("class","glyphicon glyphicon-volume-off");var a=$('<div id="sim_sonar" class="sim_sonar"></div>'),l=$('<div id="sim_sonar_distance" class="sim_sonar_distance"></div>'),s=$('<div id="sim_sonar_input"></div>').text("Sonar "+MSG.simulator.distance+":"),r=$('<button id="set_sonar_value"></button>').text("OK");$("#sim_components").append(a),$("#sim_components").append(l),$("#sim_components").append(s),$("#sim_components").append(r),$("#sim_components").css({"margin-top":this.componentsTopOffset,right:this.rightSimComponentsPosition}),$("#sim_sonar_input").append('<input type="text" id="sonar_input" name="sim_sonar_input" onkeypress="return event.charCode >= 48 && event.charCode <= 57">&nbsp;cm'),$("#sonar_input").on("keyup",(function(e){if("Enter"===e.key||13===e.keyCode){t.sonarInputChanged=!0;var n=$("#sonar_input").val();console.log(parseInt(n.trim())),t.sonarDistance=parseInt(n.trim())}})),$("#sonar_input").change((function(e){t.sonarInputChanged=!0;var n=$("#sonar_input").val();console.log(parseInt(n.trim())),t.sonarDistance=parseInt(n.trim())})),$("#set_sonar_value").click((function(e){var n=$("#sonar_input").val();console.log(parseInt(n.trim())),t.sonarDistance=parseInt(n.trim())})),$("#sonar_input").focus((function(){console.log("focus gained"),t.sonarFieldBeingEdited=!0})),$("#sonar_input").focusout((function(){console.log("focus lost"),t.sonarFieldBeingEdited=!1})),$("#sim_board").append('<div class="sim_light sim_light_off" id ="sim_light_13"></div>'),$("#sim_board").append('<div id="sim_lcds"></div>'),$("#sim_board").append('<div id="sim_lights"></div>'),$("#sim_board").append('<div id="sim_buttons"></div>'),$("#sim_board").append('<div id="sim_button_reset" class="sim_button"></div>'),$("#sim_lcds").append('<div class="sim_lcd" id="sim_lcd_row0"></div>'),$("#sim_lcds").append('<div class="sim_lcd" id="sim_lcd_row1"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_7"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_6"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_5"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_4"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_3"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_2"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_1"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_0"></div>'),$("#sim_buttons").append('<div id="sim_buttons_top"></div>'),$("#sim_buttons").append('<div id="sim_buttons_middle"></div>'),$("#sim_buttons").append('<div id="sim_buttons_bottom"></div>'),$("#sim_buttons_top").append('<div id="sim_button_N" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_W" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_C" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_E" class="sim_button"></div>'),$("#sim_buttons_bottom").append('<div id="sim_button_S" class="sim_button"></div>'),this.hideSonar();var c=this;$("#sim_button_N, #sim_button_E, #sim_button_C, #sim_button_S, #sim_button_W").on("mousedown",(function(){c.inputsState.buttons[I.mapButtonIdToIndex(this.id)]=0})),$("#sim_button_N, #sim_button_E, #sim_button_C, #sim_button_S, #sim_button_W").on("mouseup",(function(){c.inputsState.buttons[I.mapButtonIdToIndex(this.id)]=1})),$("#db_simulator_mute").on("click",(function(){null==t.audiocontext&&t.initAudioContext(),t.muted?(t.muted=!1,$("#db_simulator_mute").removeClass(),$("#db_simulator_mute").attr("class","glyphicon  glyphicon-volume-up")):(t.muted=!0,$("#db_simulator_mute").removeClass(),$("#db_simulator_mute").attr("class","glyphicon  glyphicon-volume-off"))}))}},{key:"showSonar",value:function(){$("#sim_sonar").show(),$("#sim_sonar_distance").show(),$("#sim_sonar_input").show()}},{key:"hideSonar",value:function(){$("#sim_sonar").hide(),$("#sim_sonar_distance").hide(),$("#sim_sonar_input").hide()}},{key:"updateScenarioState",value:function(e){for(var t=0;t<this.inputsState.buttons.length;++t)e.setButtonState(t,this.inputsState.buttons[t]);this.sonarInputChanged&&(e.setSonarDistance(11,12,this.sonarDistance),this.sonarInputChanged=!1),this.sonarDistance=e.getSonarDistance(11,12)}},{key:"updateScenario",value:function(e){this.updateScenarioState(e),this.updateScenarioDisplay(e)}},{key:"updateScenarioDisplay",value:function(e){var t=e.getSonarDistance(11,12);if(t<=-1)this.hideSonar();else{this.showSonar();var n=document.getElementById("sonar_input");void 0!==n&&null!=n?this.sonarFieldBeingEdited||(n.value=t):console.log("Sonar input element is undefined")}this.audiocontext&&(this.prevFreq!=e.getTonePlaying()&&0!=this.prevFreq&&0!=e.getTonePlaying&&(this.prevFreq=e.getTonePlaying(),this.osc.stop(this.audiocontext.currentTime),this.osc.disconnect(this.audiocontext.destination),this.osc=null,this.audioStarted=!1),0===e.getTonePlaying()||this.muted?this.audioStarted&&(console.log("stop"),this.audioStarted=!1,this.osc.stop(this.audiocontext.currentTime),this.osc.disconnect(this.audiocontext.destination),this.osc=null):0===e.getTonePlaying()||this.muted||this.audioStarted||(this.osc=this.audiocontext.createOscillator(),this.osc.frequency.value=e.getTonePlaying(),this.osc.start(this.audiocontext.currentTime),this.osc.connect(this.audiocontext.destination),console.log("start"),this.audioStarted=!0));for(var i=0;i<5;i++)0===e.getButtonState(i)?document.getElementById(I.mapIndexToButtonId(i)).className="sim_button sim_button_pushed":document.getElementById(I.mapIndexToButtonId(i)).className="sim_button";1==e.getBackLightStatus()?$("#sim_lcds").addClass("on"):$("#sim_lcds").removeClass("on");for(var o=0;o<2;++o)$("#sim_lcd_row"+o).text(e.getLcdContent(o)),null!==document.getElementById("sim_lcd_row"+o)&&(document.getElementById("sim_lcd_row"+o).innerHTML=document.getElementById("sim_lcd_row"+o).innerHTML.replace(/ /g,"&nbsp;"));var a=document.getElementById("sim_lcds");if(null!==a){a.style.display="none",a.offsetHeight,a.style.display="block";var l=$(".sim_lcd"),s=$("#sim_board").width()/16*1.25;l.css({"font-size":s})}for(var r=0;r<8;r++){var c="";c=0===e.getLedState(r)?"sim_light sim_light_off":"sim_light sim_light_on",document.getElementById("sim_light_"+r).className=c}0===e.getLedState(8)?document.getElementById("sim_light_13").className="sim_light sim_light_off":document.getElementById("sim_light_13").className="sim_light sim_light_on"}}]),n}(pe);function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Me=function(e){b()(n,e);var t=Ie(n);function n(e){var i;return a()(this,n),i=t.call(this,e),c()(m()(i),"dwenguinoBoardSimulation",null),i.dwenguinoBoardSimulation=new we(e),i.initSimulationState(null),i}return s()(n,[{key:"initSimulationState",value:function(e){f()(w()(n.prototype),"initSimulationState",this).call(this,e),this.robot={image:{width:65,height:83},start:{x:100,y:100,angle:0},position:{x:100,y:100,angle:0},collision:[{type:"circle",radius:25}]},this.containerWidth=0,this.containerHeight=0}},{key:"initSimulationDisplay",value:function(e){f()(w()(n.prototype),"initSimulationDisplay",this).call(this,e);var t=$("#".concat(e)),i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane"),a=$("<div>").attr("id","db_simulator_tab_selection"),l=$("<ul>").attr("class","tabs");a.append(l),o.append(a);var s=$("<div>").attr("id","db_robot_pane"),r=$("<div>").attr("id","sim_container"),c=$("<div>").attr("id","sim_animation");r.append(c),s.append(r),o.append(s),t.append(i).append(o),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("db_simulator_top_pane");var d=$("#db_robot_pane"),u=this;new ResizeSensor(r,(function(){console.log("myelement has been resized"),u.containerWidth=r.width(),u.containerHeight=r.height()}));var p=$("<div>").attr("id","sim_animation");r.append(p),d.append(r),$("#db_simulator_bottom_pane").css("display","flex").css("flex-direction","column"),$("#db_simulator_tab_selection").css("height","30px"),$("#db_robot_pane").css("flex: 1"),$("#sim_container").css("position","relative").css("width","80%").css("height","80%").css("box-sizing","border-box"),$("#sim_animation").css("width",this.robot.image.width+"px").css("height",this.robot.image.height+"px").css("maring-left","-25px").css("maring-right","-20px").css("position","absolute").css("background-image","url('DwenguinoIDE/img/board/robot.png')").css("background-size","100%").css("top",this.robot.position.y+"px").css("left",this.robot.position.x+"px")}},{key:"updateScenario",value:function(e){f()(w()(n.prototype),"updateScenario",this).call(this,e),this.updateScenarioState(e),this.updateScenarioDisplay(e),this.dwenguinoBoardSimulation.updateScenario(e)}},{key:"updateScenarioState",value:function(e){f()(w()(n.prototype),"updateScenarioState",this).call(this,e),this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height();var t=e.getMotorSpeed(1),i=e.getMotorSpeed(2),o=this.robot.position.x,a=this.robot.position.y,l=this.robot.position.angle,s=(t+i)/100;t!==i&&(l+=(i-t)/30),o+=s*Math.cos(Math.PI/180*l),a+=s*Math.sin(Math.PI/180*l),o>this.containerWidth?o=0:o<0&&(o=this.containerWidth),a>this.containerHeight?a=0:a<0&&(a=this.containerHeight),this.robot.position={x:o,y:a,angle:l}}},{key:"updateScenarioDisplay",value:function(e){f()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e);this.robot;var t=$("#sim_animation");this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height(),t.css("top",this.robot.position.y+"px").css("left",this.robot.position.x+"px").css("transform","rotate("+this.robot.position.angle+"deg)")}}]),n}(pe);function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Te=function(e){b()(n,e);var t=xe(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).initSimulationState(null),i}return s()(n,[{key:"initSimulationState",value:function(e){f()(w()(n.prototype),"initSimulationState",this).call(this,e)}},{key:"initSimulationDisplay",value:function(e){f()(w()(n.prototype),"initSimulationDisplay",this).call(this,e),$("#sim_container").css("border","solid").css("border-width","3px").css("border-color","black").css("max-width","80%").css("max-height","80%"),this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height()}},{key:"updateScenario",value:function(e){f()(w()(n.prototype),"updateScenario",this).call(this,e)}},{key:"updateScenarioState",value:function(e){f()(w()(n.prototype),"updateScenarioState",this).call(this,e);var t=e.getMotorSpeed(1),i=e.getMotorSpeed(2),o=this.robot.position.x,a=this.robot.position.y,l=this.robot.position.angle,s=(t+i)/100;t!==i&&(l+=(i-t)/30%360),o+=s*Math.cos(Math.PI/180*l),a+=s*Math.sin(Math.PI/180*l),o>this.containerWidth-this.robot.image.width?o=this.containerWidth-this.robot.image.width:o<0&&(o=0),a>this.containerHeight-this.robot.image.height?a=this.containerHeight-this.robot.image.height:a<0&&(a=0);var r=a;l=(l%360+360)%360;var c=o+this.robot.image.width/2*Math.cos(Math.PI/180*l),d=r+this.robot.image.width/2*Math.sin(Math.PI/180*l),u=[[this.containerWidth,this.containerHeight],[0,this.containerHeight],[0,0],[this.containerWidth,0]],p=[0,0],g=[0,0];if(90==l)p=g=[c,this.containerHeight];else if(270==l)p=g=[c,0];else if(180==l)p=g=[0,d];else if(0==l)p=g=[this.containerWidth,d];else{Math.tan(l);var h=u[Math.floor(l/90)%4];p=[h[0],Math.tan(l*Math.PI/180)*(h[0]-c)+d],g=[(h[1]-d)/Math.tan(l*Math.PI/180)+c,h[1]]}var m=Math.min(this.calcDistanceBetweenPoints(p,[c,d]),this.calcDistanceBetweenPoints(g,[c,d]));return e.setSonarDistance(11,12,Math.abs(m-25)),console.log(e.getSonarDistance(11,12)),this.robot.position={x:o,y:a,angle:l},e}},{key:"calcDistanceBetweenPoints",value:function(e,t){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}},{key:"updateScenarioDisplay",value:function(e){f()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e)}}]),n}(Me),Ee=function(){function e(t,n){a()(this,e),c()(this,"x",0),c()(this,"y",0),this.x=t,this.y=n}return s()(e,[{key:"getEuclideanDistanceTo",value:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e.beginPath(),e.arc(this.x,this.y,t,0,360),e.closePath(),e.stroke(),e.fill()}},{key:"getX",value:function(){return this.x}},{key:"setX",value:function(e){this.x=e}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(e){this.y=e}}]),e}(),Ae=function(){function e(t,n){a()(this,e),c()(this,"point1",null),c()(this,"point2",null),this.point1=t,this.point2=n}return s()(e,[{key:"getSlope",value:function(){return(this.point2.getY()-this.point1.getY())/(this.point2.getX()-this.point1.getX())}},{key:"getOffset",value:function(){return this.point1.getY()-this.getSlope()*this.point1.getX()}},{key:"getPointsPerpendicular",value:function(e,t){var n=1/this.getSlope()*-1;return this.getPointAtDistanceFromPointWithSlope(e,t,n)}},{key:"getPointAtDistanceFromPointWithSlope",value:function(e,t,n){var i=Math.atan(n),o=t*Math.cos(i),a=t*Math.sin(i);return[new Ee(e.getX()+o,e.getY()+a),new Ee(e.getX()-o,e.getY()-a)]}},{key:"getPointsOnLineAtSetDistanceFromOtherPointOnLine",value:function(e,t){return this.getPointAtDistanceFromPointWithSlope(e,t,this.getSlope())}}]),e}(),$e=function(){function e(){a()(this,e)}return s()(e,[{key:"drawRobotArm",value:function(e,t,n,i,o,a){this.drawConvexHull(e,t,n,o),this.drawArmHoles(e,t,n,i,a)}},{key:"drawArmHoles",value:function(e,t,n,i,o){var a=t.getEuclideanDistanceTo(n)/i,l=new Ae(t,n).getSlope(),s=Math.atan(l);t.getX()>n.getX()&&(s+=Math.PI);for(var r=t,c=0;c<i;++c){e.beginPath(),e.arc(r.getX(),r.getY(),o,0,360),e.closePath(),e.stroke();var d=a*Math.cos(s),u=a*Math.sin(s);r=new Ee(r.getX()+d,r.getY()+u)}}},{key:"drawConvexHull",value:function(e,t,n,i){var o=new Ae(t,n),a=o.getPointsPerpendicular(t,i/2),l=o.getPointsPerpendicular(n,i/2),s=o.getPointsOnLineAtSetDistanceFromOtherPointOnLine(t,i/2),r=o.getPointsOnLineAtSetDistanceFromOtherPointOnLine(n,i/2),c=[];c.push(a[0]),c.push(l[0]);var d=null;d=this.checkIfInnerPointOfLineBetweenPoints(t,n,r[0])?r[1]:r[0];var u=new Ee(d.getX()+(l[0].getX()-n.getX()),d.getY()+(l[0].getY()-n.getY()));c.push(u),c.push(d),u=new Ee(d.getX()+(l[1].getX()-n.getX()),d.getY()+(l[1].getY()-n.getY())),c.push(u),c.push(l[1]),c.push(a[1]),d=this.checkIfInnerPointOfLineBetweenPoints(t,n,s[0])?s[1]:s[0],u=new Ee(d.getX()+(a[1].getX()-t.getX()),d.getY()+(a[1].getY()-t.getY())),c.push(u),c.push(d),u=new Ee(d.getX()+(a[0].getX()-t.getX()),d.getY()+(a[0].getY()-t.getY())),c.push(u),e.beginPath(),e.moveTo(c[0].getX(),c[0].getY()),e.lineTo(c[1].getX(),c[1].getY()),e.quadraticCurveTo(c[2].getX(),c[2].getY(),c[3].getX(),c[3].getY()),e.quadraticCurveTo(c[4].getX(),c[4].getY(),c[5].getX(),c[5].getY()),e.lineTo(c[6].getX(),c[6].getY()),e.quadraticCurveTo(c[7].getX(),c[7].getY(),c[8].getX(),c[8].getY()),e.quadraticCurveTo(c[9].getX(),c[9].getY(),c[0].getX(),c[0].getY()),e.closePath(),e.stroke()}},{key:"drawBasePlate",value:function(e,t,n){this.drawConvexHull(e,t,n,80),e.fillStyle="#8bab42",e.font="40px Courier New",e.textAlign="center",e.textBaseline="middle",e.fillText("dwengo",t.getX()+(n.getX()-t.getX())/2,t.getY())}},{key:"checkIfInnerPointOfLineBetweenPoints",value:function(e,t,n){return n.getEuclideanDistanceTo(e)+n.getEuclideanDistanceTo(t)<=e.getEuclideanDistanceTo(t)+.1}}]),e}();function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Oe=function(e){b()(n,e);var t=Ce(n);function n(e){var i;return a()(this,n),i=t.call(this,e),c()(m()(i),"startScale",400),c()(m()(i),"currentScale",400),c()(m()(i),"currentColor","#4a9234"),c()(m()(i),"representationScale",{motorAxes:[[30,30],[280,30]],motorAngles:[0,0],segmentLengths:[30,20,150,170,120,150,160,150,50],segmentCount:[3,2,15,17,12,15,14,16,5],segmentRanges:[[2,3],[2,3],[10,20],[10,20],[5,15],[5,15],[5,15],[5,15],[0,2]],segmentIncrement:10,armWidth:10,holeDiameter:2.5,hinges:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]}),c()(m()(i),"drawingScale",{motorAxes:[[0,0],[0,0]],segmentLengths:[0,0,0,0,0,0,0,0,0],hinges:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],armWidth:0,holeDiameter:10}),c()(m()(i),"canvases",[]),c()(m()(i),"contexts",[]),c()(m()(i),"canvasNames",{SPYROGRAPH_CANVAS:0,SPYROGRAPH_DRAWING_CANVAS:1}),c()(m()(i),"container",null),c()(m()(i),"imageData",null),c()(m()(i),"graphicsLib",null),c()(m()(i),"dwenguinoBoardSimulation",null),c()(m()(i),"scaleFactorForDisplay",.8),i.initSimulationState(null),i.graphicsLib=new $e,i.dwenguinoBoardSimulation=new we(e),i.dwenguinoBoardSimulation.setBoardDisplayWidthWidth("100%"),i}return s()(n,[{key:"initSimulationState",value:function(e){f()(w()(n.prototype),"initSimulationState",this).call(this,e),this.representationScale.motorAngles=[0,0]}},{key:"initSimulationDisplay",value:function(e){var t=this;f()(w()(n.prototype),"initSimulationDisplay",this).call(this,e),this.canvases=[],this.contexts=[],this.initDrawingEnvironment(e),this.loadPreviousImageIfExists(),this.createControlsMenu(),this.convertToDisplayAndRender(!1),this.container=$("#".concat(e));var i=$("<div>").attr("id","boardContainer").css({position:"absolute",width:"40%",right:"10px",top:"10px"});this.container.append(i),this.dwenguinoBoardSimulation.setBoardDisplayWidthWidth("100%"),this.dwenguinoBoardSimulation.setComponentsTopOffset("55%"),this.dwenguinoBoardSimulation.setComponentsRightPosition("55px"),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("boardContainer"),new ResizeObserver((function(){for(var e=0;e<t.canvases.length;++e)t.canvases[e].width=t.container.width(),t.canvases[e].height=t.container.height();t.loadPreviousImageIfExists(),t.convertToDisplayAndRender(!0)})).observe(document.querySelector("#".concat(e)))}},{key:"initDrawingEnvironment",value:function(e){this.container=$("#".concat(e)),this.container.css({position:"relative"});for(var t=0,n=["spyrograph_canvas","spyrograph_drawing_canvas"];t<n.length;t++){var i=n[t];this.setupCanvas(i,this.container)}}},{key:"loadPreviousImageIfExists",value:function(){null!=this.imageData&&this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].putImageData(this.imageData,0,0)}},{key:"setupCanvas",value:function(e,t){var n=$("<canvas>").attr("id",e).css({position:"absolute",left:"10px",top:0})[0],i=n.getContext("2d");n.width=t.width(),n.height=t.height(),this.canvases.push(n),this.contexts.push(i),this.container.append(n)}},{key:"createControlsMenu",value:function(){var e=this,t=$("<span>").css({position:"absolute",right:0,bottom:0,width:"15%","text-align":"center","margin-right":"20px","margin-bottom":"20px"}),n=$("<input>").attr("type","color").attr("value",this.currentColor),i=this;n.on("change",(function(e){console.log($(this).val()),i.currentColor=$(this).val()})),t.append(n);var o=$("<button>").attr("value","Clear").html(MSG.clear).css({width:"90%","margin-top":"5px"});o.on("click",(function(t){e.contexts[e.canvasNames.SPYROGRAPH_DRAWING_CANVAS].clearRect(0,0,e.canvases[e.canvasNames.SPYROGRAPH_DRAWING_CANVAS].width,e.canvases[e.canvasNames.SPYROGRAPH_DRAWING_CANVAS].height),e.imageData=null})),t.append(o);var a=$("<button>").attr("value","Save").html(MSG.save).css({width:"90%","margin-top":"5px"});a.on("click",(function(t){var n=e.canvases[e.canvasNames.SPYROGRAPH_DRAWING_CANVAS].toDataURL("image/png"),i=document.createElement("a");i.download="tekening.png",i.href=n,i.click()})),t.append(a),this.container.append(t)}},{key:"createSlidersForSegments",value:function(e){for(var t=this,n=function(n){var i=$("<span>"),o=$("<span>").html("l"+n),a=$("<input>").attr("type","range").attr("min",t.representationScale.segmentRanges[n][0]).attr("max",t.representationScale.segmentRanges[n][1]).attr("value",t.representationScale.segmentCount[n]);a.css({"border-radius":"5px"});var l=t;a.on("change",(function(e){var t=parseInt($(this).val());console.log(t),l.representationScale.segmentCount[n]=t,l.representationScale.segmentLengths[n]=l.representationScale.segmentIncrement*t,l.calculateHingePoints(),l.convertToDisplayAndRender(!1)})),i.append(o),i.append(a),e.append(i)},i=0;i<this.representationScale.segmentLengths.length-1;++i)n(i)}},{key:"updateScenario",value:function(e){f()(w()(n.prototype),"updateScenario",this).call(this,e),this.updateScenarioState(e),this.updateScenarioDisplay(e),this.dwenguinoBoardSimulation.updateScenario(e)}},{key:"updateScenarioState",value:function(e){f()(w()(n.prototype),"updateScenarioState",this).call(this,e),this.timestep++;for(var t=0;t<2;t++)this.representationScale.motorAngles[t]+=e.getMotorSpeed(t+1)/3825;this.calculateHingePoints()}},{key:"calculateHingePoints",value:function(){for(var e=0;e<2;e++)this.representationScale.hinges[e]=[this.representationScale.motorAxes[e][0]+this.representationScale.segmentLengths[e]*Math.cos(this.representationScale.motorAngles[e]),this.representationScale.motorAxes[e][1]+this.representationScale.segmentLengths[e]*Math.sin(this.representationScale.motorAngles[e])];this.calulateFirstHingePoint(),this.calculateCentralHingePoints(),this.calculateFinalHingePoint()}},{key:"calulateFirstHingePoint",value:function(){var e=this.representationScale.segmentLengths[2],t=this.representationScale.segmentLengths[3],n=this.representationScale.hinges[0][0],i=this.representationScale.hinges[0][1],o=this.representationScale.hinges[1][0],a=this.representationScale.hinges[1][1],l=this.calculateHingePoint(n,i,o,a,e,t);this.representationScale.hinges[2][0]=l[0],this.representationScale.hinges[2][1]=l[1]}},{key:"calculateCentralHingePoints",value:function(){var e=this.representationScale.segmentLengths[3],t=this.representationScale.segmentLengths[4],n=this.representationScale.hinges[1][0],i=this.representationScale.hinges[1][1],o=this.representationScale.hinges[2][0],a=this.representationScale.hinges[2][1];this.representationScale.hinges[3][0]=n+(e+t)*(o-n)/e,this.representationScale.hinges[3][1]=i+(e+t)*(a-i)/e,e=this.representationScale.segmentLengths[2],t=this.representationScale.segmentLengths[5],n=this.representationScale.hinges[0][0],i=this.representationScale.hinges[0][1],o=this.representationScale.hinges[2][0],a=this.representationScale.hinges[2][1],this.representationScale.hinges[4][0]=n+(e+t)*(o-n)/e,this.representationScale.hinges[4][1]=i+(e+t)*(a-i)/e}},{key:"calculateFinalHingePoint",value:function(){var e=this.representationScale.hinges[3][0],t=this.representationScale.hinges[3][1],n=this.representationScale.hinges[4][0],i=this.representationScale.hinges[4][1],o=this.representationScale.segmentLengths[6],a=this.representationScale.segmentLengths[7],l=this.calculateHingePoint(e,t,n,i,o,a);this.representationScale.hinges[5][0]=l[0],this.representationScale.hinges[5][1]=l[1]}},{key:"calculateHingePoint",value:function(e,t,n,i,o,a){var l=a*a-o*o-n*n+e*e-i*i+t*t,s=2*(e-n),r=4*(i-t)*(i-t)/(s*s)+1,c=4*(i-t)*(i-t)+s*s,d=s*s,u=4*l*(i-t)/(s*s)-4*e*(i-t)/s-2*t,p=l*l/(s*s)-2*e*l/s+e*e+t*t-o*o,g=(-1*u+Math.sqrt(u*u-4*r*p))*d/(2*c),h=(-1*u-Math.sqrt(u*u-4*r*p))*d/(2*c);return g>h?[(2*g*(i-t)+l)/s,g]:[(2*h*(i-t)+l)/s,h]}},{key:"updateScenarioDisplay",value:function(e){f()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e),this.convertToDisplayAndRender(!0)}},{key:"convertToDisplayAndRender",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scaleRepresentationToDrawing(this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].width),this.mirrorDisplayVertically(this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].height),window.requestAnimationFrame((function(){e.render(t)}))}},{key:"mirrorDisplayVertically",value:function(e){for(var t=0;t<this.drawingScale.motorAxes.length;++t)this.drawingScale.motorAxes[t][1]=-1*this.drawingScale.motorAxes[t][1]+e;for(var n=0;n<this.drawingScale.hinges.length;++n)this.drawingScale.hinges[n][1]=-1*this.drawingScale.hinges[n][1]+e}},{key:"scaleRepresentationToDrawing",value:function(e){this.scaleSegementLengths(e),this.scaleHingePoints(e),this.scaleArmProperties(e)}},{key:"scaleArmProperties",value:function(e){this.drawingScale.armWidth=this.representationScale.armWidth/this.startScale*e,this.drawingScale.holeDiameter=this.representationScale.holeDiameter/this.startScale*e}},{key:"scaleHingePoints",value:function(e){for(var t=e*this.scaleFactorForDisplay,n=0;n<this.representationScale.motorAxes.length;++n)for(var i=0;i<this.representationScale.motorAxes[n].length;++i)this.drawingScale.motorAxes[n][i]=this.representationScale.motorAxes[n][i]/this.startScale*t;for(var o=0;o<this.representationScale.hinges.length;++o)for(var a=0;a<this.representationScale.hinges[o].length;++a)this.drawingScale.hinges[o][a]=this.representationScale.hinges[o][a]/this.startScale*t}},{key:"scaleSegementLengths",value:function(e){for(var t=e*this.scaleFactorForDisplay,n=0;n<this.representationScale.motorAxes.length;n++)for(var i=0;i<this.representationScale.motorAxes[n].length;i++)this.drawingScale.motorAxes[n][i]=this.representationScale.motorAxes[n][i]/this.startScale*t;for(var o=0;o<this.representationScale.segmentLengths.length;o++)this.drawingScale.segmentLengths[o]=this.representationScale.segmentLengths[o]/this.startScale*t;this.currentScale=t}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:TextTrackCueList,t=this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].width,n=this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].height;this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].clearRect(0,0,t,n),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fillStyle="#000000",this.graphicsLib.drawBasePlate(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ee(this.drawingScale.motorAxes[0][0],this.drawingScale.motorAxes[0][1]),new Ee(this.drawingScale.motorAxes[1][0],this.drawingScale.motorAxes[1][1])),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fillStyle="#FF0000";for(var i=this.drawingScale.hinges.concat(this.drawingScale.motorAxes),o=0;o<i.length;o++)this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].beginPath(),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].arc(i[o][0],i[o][1],3,0,360),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].closePath(),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fill();this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ee(this.drawingScale.motorAxes[0][0],this.drawingScale.motorAxes[0][1]),new Ee(this.drawingScale.hinges[0][0],this.drawingScale.hinges[0][1]),this.representationScale.segmentCount[0],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ee(this.drawingScale.motorAxes[1][0],this.drawingScale.motorAxes[1][1]),new Ee(this.drawingScale.hinges[1][0],this.drawingScale.hinges[1][1]),this.representationScale.segmentCount[1],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ee(this.drawingScale.hinges[0][0],this.drawingScale.hinges[0][1]),new Ee(this.drawingScale.hinges[4][0],this.drawingScale.hinges[4][1]),this.representationScale.segmentCount[2]+this.representationScale.segmentCount[5],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ee(this.drawingScale.hinges[1][0],this.drawingScale.hinges[1][1]),new Ee(this.drawingScale.hinges[3][0],this.drawingScale.hinges[3][1]),this.representationScale.segmentCount[3]+this.representationScale.segmentCount[4],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ee(this.drawingScale.hinges[3][0],this.drawingScale.hinges[3][1]),new Ee(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1]),this.representationScale.segmentCount[6],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ee(this.drawingScale.hinges[4][0],this.drawingScale.hinges[4][1]),new Ee(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1]),this.representationScale.segmentCount[7],this.drawingScale.armWidth,this.drawingScale.holeDiameter),e&&(this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].fillStyle=this.currentColor,this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].beginPath(),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].arc(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1],1,0,360),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].closePath(),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].fill()),this.imageData=this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].getImageData(0,0,this.container.width(),this.container.height())}}]),n}(pe);function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Pe=function(e){b()(n,e);var t=Be(n);function n(e){var i;return a()(this,n),i=t.call(this,e),c()(m()(i),"stepperMotorPins",[33,34]),c()(m()(i),"penPositionPins",[36,37]),c()(m()(i),"colorPin",35),c()(m()(i),"dwenguinoBoardSimulation",null),c()(m()(i),"previousProgramColor","#000"),c()(m()(i),"motor",{image:{radius:x.motorRadius},position:{xL:20,xR:20+x.motorDistance,y:20},settings:{nrOfSteps:x.nrOfSteps,currentSteps:[0,0]}}),c()(m()(i),"wireLengths",[300,200]),c()(m()(i),"startWireLengths",i.wireLengths),c()(m()(i),"stylus",{image:{radius:5},position:{x:80,y:80},prevPosition:{x:0,y:0},drawing:{radius:2,drawingColor:"#000",selectedColor:"#000",boardColor:"#000",liftStylus:!1}}),c()(m()(i),"paper",{height:(i.motor.position.xR-i.motor.position.xL)/Math.sqrt(2),width:i.motor.position.xR-i.motor.position.xL,position:{x:i.motor.position.xL,y:40}}),c()(m()(i),"containerWidth",0),c()(m()(i),"containerHeight",0),i.dwenguinoBoardSimulation=new we(e),i}return s()(n,[{key:"initSimulationState",value:function(e){f()(w()(n.prototype),"initSimulationState",this).call(this,e),this.caclulateStylusPoint(),e&&(e.setIoPinState(this.stepperMotorPins[0],this.wireLengths[0]/(2*Math.PI*x.motorRadius/x.nrOfSteps)),e.setIoPinState(this.stepperMotorPins[1],this.wireLengths[1]/(2*Math.PI*x.motorRadius/x.nrOfSteps)),e.setIoPinState(this.penPositionPins[0],this.stylus.position.x-this.motor.position.xL),e.setIoPinState(this.penPositionPins[1],this.stylus.position.y-this.motor.position.y))}},{key:"initSimulationDisplay",value:function(e){f()(w()(n.prototype),"initSimulationDisplay",this).call(this,e),this.initSimulationState(null);var t=$("#".concat(e)),i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane");t.append(i).append(o),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("db_simulator_top_pane"),o.append($("<canvas>").attr("id","sim_canvas").attr("class","canvas")),o.append($("<canvas>").attr("id","sim_canvas_drawing").attr("class","canvas")),o.append($("<canvas>").attr("id","sim_canvas_grid").attr("class","canvas")),o.append($("<div>").attr("id","sim_grid"));var a=$("<ul>").attr("id","sim_settings"),l=$("<li>").attr("class","sim_setting");$("<input />",{type:"checkbox",id:"cb_grid",value:"grid"}).prop("checked",!0).appendTo(l),$("<label />",{for:"cb_grid",id:"txt_grid",text:MSG.drawingrobotgrid}).appendTo(l),a.append(l);l=$("<li>").attr("class","sim_setting");$("#colorpicker");var s=$("<input />",{type:"color",id:"colorpicker",name:"colorpicker",value:this.stylus.drawing.drawingColor});s.appendTo(l),$("<label />",{for:"colorpicker",id:"txt_colorpicker",text:MSG.colorpicker}).appendTo(l),a.append(l);l=$("<li>").attr("class","sim_setting");$("<button />",{type:"button",id:"btn_saveImage",text:MSG.drawingrobotSaveImage}).appendTo(l),a.append(l),o.append(a);var r=this;s.on("change",(function(e){console.log($(this).val()),r.updateColor($(this).val())}));var c=$("#sim_canvas")[0],d=$("#sim_canvas_drawing")[0],u=$("#sim_canvas_grid")[0];$(".canvas").css("position","absolute").css("top","O").css("left","O"),$("#sim_settings").css("position","absolute").css("right","20px").css("top","0px").css("list-style","none"),$("#sim_grid").css("position","absolute").css("left",this.paper.position.x).css("top",this.paper.position.y).css("width",this.paper.width).css("height",this.paper.height),$(".sim_setting").css("vertical-align","middle"),this.containerWidth=o.width(),this.containerHeight=o.height(),c.width=this.containerWidth,c.height=this.containerHeight,d.width=this.containerWidth,d.height=this.containerHeight,u.width=this.containerWidth,u.height=this.containerHeight,this.drawGrid(),$("#cb_grid").click((function(){$("#svg_grid").toggle(this.checked),$("#sim_canvas_grid").toggle(this.checked)})),$("#btn_saveImage").click((function(){var e="image/png",t=$("#sim_canvas_drawing")[0].toDataURL(e),n=document.createElement("a");n.download=MSG.drawingrobotDrawing,n.href=t,n.dataset.downloadurl=[e,n.download,n.href].join(":"),document.body.appendChild(n),n.click(),document.body.removeChild(n)})),this.redraw()}},{key:"updateScenario",value:function(e){f()(w()(n.prototype),"updateScenarioState",this).call(this,e);this.updateScenarioState(e);this.updateScenarioDisplay(e)}},{key:"updateScenarioState",value:function(e){f()(w()(n.prototype),"updateScenarioState",this).call(this,e),this.updateServoAngle(e.getIoPinState(38)),this.previousProgramColor!=e.getIoPinState(this.colorPin)&&this.updateColor(e.getIoPinState(this.colorPin));var t=e.getIoPinState(this.stepperMotorPins[0]),i=e.getIoPinState(this.stepperMotorPins[1]);this.updateLengths([t,i]),this.caclulateStylusPoint(),e.setIoPinState(this.penPositionPins[0],this.stylus.position.x-this.motor.position.xL),e.setIoPinState(this.penPositionPins[1],this.stylus.position.y-this.motor.position.y)}},{key:"updateLengths",value:function(e){var t=this,n=e.map((function(e,n){var i=e*(2*Math.PI*t.motor.image.radius/t.motor.settings.nrOfSteps);return i>=0?i:0}));this.wireLengths=n}},{key:"calculateWireLengths",value:function(e){}},{key:"caclulateStylusPoint",value:function(){var e=this.wireLengths[0],t=this.wireLengths[1],n=this.motor.position.xR-this.motor.position.xL,i=(Math.pow(e,2)-Math.pow(t,2)+Math.pow(n,2))/(2*n);e+t>=n&&(this.stylus.position.x=this.motor.position.xL+i,this.stylus.position.y=this.motor.position.y+Math.sqrt(Math.pow(e,2)-Math.pow(i,2)))}},{key:"updateScenarioDisplay",value:function(e){f()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e),this.redraw()}},{key:"redraw",value:function(){var e=$("#sim_canvas")[0],t=e.getContext("2d"),n=$("#sim_canvas_drawing")[0].getContext("2d");t.clearRect(0,0,e.width,e.height),t.beginPath(),t.strokeStyle="#848484",t.moveTo(this.motor.position.xL,this.motor.position.y),t.lineTo(this.stylus.position.x,this.stylus.position.y),t.moveTo(this.motor.position.xR,this.motor.position.y),t.lineTo(this.stylus.position.x,this.stylus.position.y),t.stroke(),t.beginPath(),t.globalAlpha=.5,t.fillStyle=this.stylus.drawing.drawingColor,t.arc(this.stylus.position.x,this.stylus.position.y,this.stylus.image.radius,0,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="#848484",t.arc(this.motor.position.xL,this.motor.position.y,this.motor.image.radius,0,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="#848484",t.arc(this.motor.position.xR,this.motor.position.y,this.motor.image.radius,0,2*Math.PI),t.fill(),this.stylus.drawing.liftStylus||(n.beginPath(),n.fillStyle=this.stylus.drawing.drawingColor,n.arc(this.stylus.position.x,this.stylus.position.y,this.stylus.drawing.radius,0,2*Math.PI),n.fill())}},{key:"drawGrid",value:function(){var e=this.paper.position.x,t=this.paper.position.y,n=$("#sim_canvas_grid")[0].getContext("2d");n.font="10px Arial",n.fillText("0",e,t),n.fillText("100",e+100,t),n.fillText("200",e+200,t),n.fillText("300",e+300,t),n.fillText("300",e-15,t+100),n.fillText("200",e-15,t+200),n.fillText("100",e-15,t+300);$("#sim_grid").append('        <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" id="svg_grid">          <defs>            <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">            <path d="M 10 0 L 0 0 0 10" fill="none" stroke="gray" stroke-width="0.5"/>            </pattern>            <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">              <rect width="100" height="100" fill="url(#smallGrid)"/>              <path d="M 100 0 L 0 0 0 100" fill="none" stroke="gray" stroke-width="1"/>            </pattern>          </defs>          <rect width="100%" height="100%" fill="url(#grid)" />        </svg>')}},{key:"updateServoAngle",value:function(e){90===e&&(this.stylus.drawing.liftStylus=!0),0===e&&(this.stylus.drawing.liftStylus=!1)}},{key:"checkServoAngle",value:function(e,t){return(90!==e||!t.stylus.drawing.liftStylus)&&!(0===e&&!t.stylus.drawing.liftStylus)}},{key:"updateColor",value:function(e){0!=e&&(this.stylus.drawing.drawingColor=e)}}]),n}(pe),De=function(){function e(t,n){a()(this,e),c()(this,"logger",null),c()(this,"workspace",null),c()(this,"scenarios",null),this.scenarios={spyrograph:new Oe(t),moving:new Me(t),wall:new Te(t),socialrobot:new ke(t),plotter:new Pe(t)},this.logger=t,this.workspace=n,this.simControlsController=new B(this.logger,this.workspace,this.scenarios)}return s()(e,[{key:"open",value:function(){}},{key:"stop",value:function(){this.simControlsController.handleSimulationStop()}}]),e}();function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Le=function(e){b()(n,e);var t=Re(n);function n(){return a()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"buzzer"}}],[{key:"getType",value:function(){return J.BUZZER}},{key:"getDescription",value:function(){return MSG.simulator.buzzerDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return["frequency"]}}]),n}(q);function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var He=function(e){b()(n,e);var t=Ne(n);function n(){return a()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"lcd"}}],[{key:"getType",value:function(){return J.LCD}},{key:"getDescription",value:function(){return MSG.simulator.lcdDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(q);function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ge=function(e){b()(n,e);var t=We(n);function n(){return a()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"led"}}],[{key:"getType",value:function(){return J.LED}},{key:"getDescription",value:function(){return MSG.simulator.ledDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(q);function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ve=function(e){b()(n,e);var t=Fe(n);function n(){return a()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"light sensor"}}],[{key:"getType",value:function(){return J.LIGHT}},{key:"getDescription",value:function(){return""}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(q);function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Xe=function(e){b()(n,e);var t=Ye(n);function n(){return a()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"PIR sensor"}}],[{key:"getType",value:function(){return J.PIR}},{key:"getDescription",value:function(){return MSG.simulator.pirDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(q);function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ke=function(e){b()(n,e);var t=Ue(n);function n(){return a()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"Servo"}}],[{key:"getType",value:function(){return J.SERVO}},{key:"getDescription",value:function(){return MSG.simulator.servoDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return["angle"]}}]),n}(q);function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var ze=function(e){b()(n,e);var t=je(n);function n(){return a()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"Sonar"}}],[{key:"getType",value:function(){return J.SONAR}},{key:"getDescription",value:function(){return""}},{key:"getInputPins",value:function(){return["trigger"]}},{key:"getOutputPins",value:function(){return["echo"]}}]),n}(q),Ze={dwenguino:"db_menu_item_dwengo_robot_teacher_image",workspaceArea:"blocklyDiv",toolboxArea:"db_blocklyToolboxDiv",toolbox:"blocklyToolboxDiv",languageMenu:"db_menu_item_language",difficultyMenu:"db_menu_item_difficulty",dwengoBooksMenu:"db_tutorials",playButton:"db_menu_item_run",uploadButton:"db_menu_item_upload",openButton:"db_menu_item_upload",saveButton:"db_menu_item_download",simulatorButton:"db_menu_item_simulator",codeArea:"db_code_pane",simulatorArea:"db_simulator_pane",simulatorStartButton:"sim_start",simulatorStopButton:"sim_stop",simulatorScenarioTag:"sim_scenarioTag",simulatorBottomPane:"db_simulator_bottom_pane",simulatorScenarioSocialRobot:"sim_scenario",robotComponentsMenuLedPlusButton:"rc_led_plus_button",robotComponentsMenuLedMinusButton:"rc_led_minus_button",robotcomponentsMenuLedOptions:"rc_led_options",robotComponentsMenuLcdPlusbutton:"rc_lcd_plus_button",robotComponensMenu:"robot_components_menu"},Je={introduction:{category:"dwenguino",targets:[Ze.dwenguino,Ze.workspaceArea,"db_blocklyToolboxDiv","db_menu_item_language","db_menu_item_difficulty","books_dropdown","db_menu_item_run","db_menu_item_upload","db_menu_item_download","db_menu_item_simulator"],placements:["left","right","right","left","left","left","left","left","left","left"],nrOfSteps:10,xOffsets:[0,"center",0,0,0,0,0,0,0,0],yOffsets:[0,"center",0,0,0,0,0,0,0,0],steps:[],id:"tutsIntroduction",label:MSG.tutsIntroduction,initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.introduction.stepTitles[e],content:MSG.tutorials.introduction.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-88" y="-382"></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()}},avoidWall:{category:"ridingrobot",id:"tutsAvoidWall",label:MSG.tutsAvoidWall,targets:[Ze.simulatorButton,Ze.simulatorScenarioTab,Ze.simulatorScenarioSelection,Ze.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,-20,0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.avoidWall.stepTitles[e],content:MSG.tutorials.avoidWall.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-152" y="43"><statement name="LOOP"><block type="controls_if" id="@5_v({:-p!8Gi,2CfS*2"><mutation else="1"></mutation><value name="IF0"><block type="logic_compare" id="pO3`z[KM7dM91a$uJnV="><field name="OP">GTE</field><value name="A"><block type="char_type" id="r)z[m@Nos2|cpm^(MovD"><field name="BITMASK">30</field></block></value><value name="B"><block type="sonar_sensor" id="%Ha2KSwLpWq]5!^?mUn?"><value name="trig"><block type="char_type" id="t3zJd~XLa:~hNsD11;$("><field name="BITMASK">11</field></block></value><value name="echo"><block type="char_type" id="Ohz-(RX2RI34`HQmDv,s"><field name="BITMASK">12</field></block></value></block></value></block></value><statement name="DO0"><block type="dc_motor" id="7S)A(0|1NJY$trtQzX,3"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="mvt87=#!=N4y.]LDT2Tm"><value name="channel"><block type="math_number" id="H0_b%l*{mJ45Li+J+87l"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="Zt+djA7XMOi9Zp/%]??C"><field name="NUM">-100</field></block></value></block></next></block></statement><statement name="ELSE"><block type="dc_motor" id="{|*6o9^%o+R~*cTn_CfU"><value name="channel"><block type="math_number" id="P#QoZo*y11wAim[,gWvA"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="nB/xoT!1$Slx0jAKrT;n"><field name="NUM">255</field></block></value><next><block type="dc_motor" id="IENQp`U=)/.K^:61n`3K"><value name="channel"><block type="math_number" id="K[n0u(V:ugdW?t1.p!le"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="YDYgsSjexNArI#`f:@#V"><field name="NUM">255</field></block></value></block></next></block></statement><next><block type="dwenguino_delay" id="Ve-hN}})E6#/rWFaP`be"><value name="DELAY_TIME"><block type="char_type" id="W^^#Oxga@%ncB=Vi:coG"><field name="BITMASK">50</field></block></value></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()}},driveForward:{category:"ridingrobot",targets:[Ze.simulatorButton,Ze.simulatorScenarioTab,Ze.simulatorStartButton,Ze.dwenguino],placements:["left","left","left"],nrOfSteps:3,xOffsets:[0,0,0],yOffsets:[0,-20,0],steps:[],id:"tutsDriveForward",label:MSG.tutsDriveForward,initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.driveForward.stepTitles[e],content:MSG.tutorials.driveForward.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-88" y="-382"><statement name="LOOP"><block type="dc_motor" id="}m$#-.GS5+AKD-gI}OY,"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="cgSFVxrXN$Sgeiy15T;?"><value name="channel"><block type="math_number" id="oA@j2Jdo#=lH`r:+![%K"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="a[y,hG3rY^+Pk+cjv=8m"><field name="NUM">-100</field></block></value><next><block type="dwenguino_delay" id="to!Bxm`]gQzEi;K`Bx%s"><value name="DELAY_TIME"><block type="char_type" id="FsFIj~`KNGMlcHhp^^gj"><field name="BITMASK">100</field></block></value></block></next></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()}},rideInSquare:{category:"ridingrobot",id:"tutsRideInSquare",label:MSG.tutsRideInSquare,targets:[Ze.simulatorButton,Ze.simulatorScenarioTab,Ze.simulatorStartButton,Ze.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,0,0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.rideInSquare.stepTitles[e],content:MSG.tutorials.rideInSquare.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-187" y="-164"><statement name="LOOP"><block type="dc_motor" id="2~!yv!MW{1Hr7=a=q^aT"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="k|$W/{v:t)Ri*1iI2c]E"><value name="channel"><block type="math_number" id="wne%a{,$k%a@w,sKH?a]"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="{6ghh[Yn?Jc$jNeC)?wv"><field name="NUM">100</field></block></value><next><block type="dwenguino_delay" id="Un-0xX*gj~d[dzM2VPW{"><value name="DELAY_TIME"><block type="char_type" id="O8V/|K]MghjNUo^;u*Z7"><field name="BITMASK">1500</field></block></value><next><block type="dc_motor" id="#b8ipVpP2%f@GX{1*cEh"><value name="channel"><block type="math_number" id="1Bv@--r|;e:;{Tcs[0sp"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="W9onZYpkG)?oZXg+D.mP"><field name="NUM">-100</field></block></value><next><block type="dc_motor" id="br1l/`ornE`|7lUs0e!v"><value name="channel"><block type="math_number" id="spfET~H),:iUz7wM%7_}"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id=":v_5D%Zxo$8F9#*mn{T["><field name="NUM">172</field></block></value><next><block type="dwenguino_delay" id="fUAytMwz;AODn(w;=(]i"><value name="DELAY_TIME"><block type="char_type" id="N@OUe?*wdU4M64`^4oVM"><field name="BITMASK">100</field></block></value><next><block type="dc_motor" id="hqOS]]B(sc98`z/$0}ll"><value name="channel"><block type="math_number" id="5I?rQjd]q(-CC6U.,cBM"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="HA_k5I*sC`55]E:Y).[["><field name="NUM">100</field></block></value><next><block type="dc_motor" id="`D{WegX*xn@F]K5=@EvF"><value name="channel"><block type="math_number" id="oV,/.U@niXOwlvvM]WpC"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="9^4I@Scrp(K2+.J7^p0;"><field name="NUM">100</field></block></value><next><block type="dwenguino_delay" id="J2$2d,OC8RV:+T!Re6X0"><value name="DELAY_TIME"><block type="char_type" id="ZM@t|GIBj##i(0vS8r:k"><field name="BITMASK">1500</field></block></value><next><block type="dc_motor" id=";u/@8A47:TKzi6F#%CGb"><value name="channel"><block type="math_number" id="]X@nX0adD06-`$RZ{},G"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="I[_cmLEv4];|ZSX59LdP"><field name="NUM">-100</field></block></value><next><block type="dc_motor" id="|:Sz^|w6bvv%3`ReTx8|"><value name="channel"><block type="math_number" id="ay6tlwL/NUW^@z3Y`,1e"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id=")}wry~D^GS~nx+nJ4299"><field name="NUM">172</field></block></value><next><block type="dwenguino_delay" id="}]TPc%CK(bh,WY?va56["><value name="DELAY_TIME"><block type="char_type" id="XV0xogxOQ/+HvYzr}o5k"><field name="BITMASK">200</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()}},rideToWall:{category:"ridingrobot",id:"tutsRideToWall",label:MSG.tutsRideToWall,targets:[Ze.simulatorButton,Ze.simulatorScenarioTab,Ze.simulatorScenarioSelection,Ze.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,-20,0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.rideToWall.stepTitles[e],content:MSG.tutorials.rideToWall.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-48" y="-12"><statement name="LOOP"><block type="controls_if" id="@5_v({:-p!8Gi,2CfS*2"><mutation else="1"></mutation><value name="IF0"><block type="logic_compare" id="pO3`z[KM7dM91a$uJnV="><field name="OP">GTE</field><value name="A"><block type="char_type" id="`pUCfCWqQ-!Y8Hc4DFul"><field name="BITMASK">175</field></block></value><value name="B"><block type="sonar_sensor" id="%Ha2KSwLpWq]5!^?mUn?"><value name="trig"><block type="char_type" id="72"><field name="BITMASK">11</field></block></value><value name="echo"><block type="char_type" id="77"><field name="BITMASK">12</field></block></value></block></value></block></value><statement name="DO0"><block type="dc_motor" id="P4X+*n{_@l|O~^r3M$+P"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="b]=`Pdj9m@E^lqhSf+j7"><value name="channel"><block type="math_number" id="-w/)R/{#UU20.gVTQ:n)"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="KWy~7`w*vC_K}G@ma:$H"><field name="NUM">100</field></block></value></block></next></block></statement><statement name="ELSE"><block type="dc_motor" id="WF@SV9}kgwe`Dx1KEdfO"><value name="channel"><block type="math_number" id="p|~*dbxFy-j|.oB!i5$g"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="*Nynrtc$eF,g^0)az}^R"><field name="NUM">0</field></block></value><next><block type="dc_motor" id="oz9a#j`Kv,ZVyL35B{J6"><value name="channel"><block type="math_number" id="okt3fpvN^;FR?TW?wly|"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="vf/?P:IP6mI%GD-!biz~"><field name="NUM">0</field></block></value></block></next></block></statement><next><block type="dwenguino_delay" id="Ve-hN}})E6#/rWFaP`be"><value name="DELAY_TIME"><block type="char_type" id="r)z[m@Nos2|cpm^(MovD"><field name="BITMASK">100</field></block></value></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()}},introduceYourself:{category:"wegostem",targets:[Ze.simulatorButton,Ze.workspaceArea,Ze.simulatorStartButton,Ze.simulatorStopButton,Ze.workspaceArea,Ze.workspaceArea,Ze.simulatorStartButton,Ze.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.introduceYourself.stepTitles[e],content:MSG.tutorials.introduceYourself.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsIntroduceYourselfWeGoSTEM",label:MSG.tutsIntroduceYourselfWeGoSTEM,onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="0" y="0"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Hallo ik ben</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_lcd" id=",9zhGR,lzKr175:cPC*_"><value name="text"><block type="text" id="w8Id%a/kU}P]3_TQV1V^"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="VruQbfPoZ[O~4VG#:`[v"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="-7M*Tw!{?A}JvmAw(0_X"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="$W3lceEvUBsyDFFMM-Rf"><value name="DELAY_TIME"><block type="char_type" id="F-`0yf?Z6xT^qV5x(YV@"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a5X=ZhxL5lziaL[@+1q6"><next><block type="dwenguino_lcd" id="l`pv.^G_BTi%EpsWCp3d"><value name="text"><block type="text" id="L+/nc=~kAE0A)8hYW^b|"><field name="TEXT">en ik ben</field></block></value><value name="line_number"><block type="char_type" id=",9#]]M|vVX:X`i2FLYk9"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="IgSB;tv7Q63a*I/8c9xO"><field name="BITMASK">0</field></block></value><next><block type="clear_lcd" id="bV|!1IpEB|pF6zyTGedz"><next><block type="dwenguino_lcd" id="V_ap+n0Ve.h;yqUOiap]"><value name="text"><block type="text" id="FW[UnvsP|RyxEeB)*sw?"><field name="TEXT">27 jaar oud.</field></block></value><value name="line_number"><block type="char_type" id="?0+(u3VHL7RwnU6roe8o"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="g7)%Ze+Q`)7(XB?2H1g/"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="t*AwHh}[O0Oa:iWRf=Bi"><value name="DELAY_TIME"><block type="char_type" id="MT%/M(V*Sh@Lq?2s~|@C"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="B*^u3w%Jw`6F^5V~RI?!"></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()},onNext:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting))},onPrev:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting))}},lampOnOffWeGoSTEM:{category:"wegostem",targets:[Ze.simulatorButton,Ze.workspaceArea,Ze.simulatorStartButton,Ze.simulatorStopButton,Ze.workspaceArea,Ze.workspaceArea,Ze.simulatorStartButton,Ze.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.lampOnOffWeGoSTEM.stepTitles[e],content:MSG.tutorials.lampOnOffWeGoSTEM.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsLampOnOffWeGoSTEM",label:MSG.tutsLampOnOffWeGoSTEM,onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-312" y="822"><statement name="SETUP"><block type="dwenguino_set_led" id="JRP=z*2cxmd77C1]%2_j"><value name="LED"><block type="dwenguino_led_pins" id="`6(1#3#Z#$M@Xbq?1Xfd"><field name="LED_NUMBER">3</field></block></value><value name="LED_STATE"><block type="dwenguino_on_off" id="@5tkt/z/jAQ:%,nb:Bb-"><field name="LED_ON_OFF">ON</field></block></value><next><block type="dwenguino_delay" id="UY`BuwYMQ$Q@W/RBx4W6"><value name="DELAY_TIME"><block type="char_type" id="mj5fa8/DHdN^R`GxC1?-"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_set_led" id=";^M:Bzu.h.,8-bH|((6J"><value name="LED"><block type="dwenguino_led_pins" id="4fPa^^](u@WY76EvFzq3"><field name="LED_NUMBER">3</field></block></value><value name="LED_STATE"><block type="dwenguino_on_off" id="Vb]-SSu`gi!r(Jcf[GAP"><field name="LED_ON_OFF">OFF</field></block></value><next><block type="dwenguino_delay" id="b{y].+kK+[2Im*dxbNbG"><value name="DELAY_TIME"><block type="char_type" id="30LY_FvNethd98Kevj|b"><field name="BITMASK">500</field></block></value></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()},onNext:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting))},onPrev:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting))}},nameOnLcd:{category:"wegostem",targets:[Ze.simulatorButton,Ze.workspaceArea,Ze.simulatorStartButton,Ze.simulatorStopButton,Ze.workspaceArea,Ze.workspaceArea,Ze.simulatorStartButton,Ze.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:7,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.nameOnLcdWeGoSTEM.stepTitles[e],content:MSG.tutorials.nameOnLcdWeGoSTEM.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsNameOnLcdWeGoSTEM",label:MSG.tutsNameOnLcdWeGoSTEM,onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="V9/6@;rsE|D#Da%TQ1aq" x="-79" y="184"><statement name="SETUP"><block type="dwenguino_lcd" id="4[oLkNw/z5;Ou4dn-zdD"><value name="text"><block type="text" id="48"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()},onNext:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting))},onPrev:function(){et.recordEvent(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting))}},poem1:{category:"wegostem",targets:[Ze.simulatorButton,Ze.workspaceArea,Ze.simulatorStartButton,Ze.simulatorStopButton,Ze.workspaceArea,Ze.workspaceArea,Ze.simulatorStartButton,Ze.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.poem1.stepTitles[e],content:MSG.tutorials.poem1.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsPoem1",label:MSG.tutsPoem1,onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Ik fiets</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_delay" id="]ou@Z_|5^GvXMS68m4Y#"><value name="DELAY_TIME"><block type="char_type" id="LNrn.uWc!l{k)lWdw9xu"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="U37Ix-]Ulb(y%rp+HmMK"><value name="text"><block type="text" id="62=RnV.lI.d94k41Y|Wg"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="XPa1w4n/89hzWxAri?_Z"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Mj.b?|/ktlgxW9^Lv+GB"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="qA+kIka6dC`XK2Zat.^e"><value name="DELAY_TIME"><block type="char_type" id="WxmGodyzXxbbWo)/zP0j"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m5J96Dy^pC:gh?H)nGT#"><next><block type="dwenguino_delay" id="%?k#,bPe1-.s6Z7_S8qn"><value name="DELAY_TIME"><block type="char_type" id="!(gLCQ_G4;$(a`n7`O[="><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="TMkN#X]!w%McWa+(x=`9"><value name="text"><block type="text" id="IZ|[v`1EEX*`RQf+b5qF"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="iu*fPG%V5+ylVMoYt^jx"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="xL-yEduk#tQd$~t|1xBe"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="}KCE%K7;EC#vmey7^_Jo"><value name="DELAY_TIME"><block type="char_type" id="{Qw5:{GSy/lpM]ZiaD]!"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="FS#9!f68];h@Hgj8D`EH"><next><block type="dwenguino_delay" id="d,ppwLH6:]IWf8u,D}~S"><value name="DELAY_TIME"><block type="char_type" id="ve7y8sxdW$N[k3Lpj4K2"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="0j6gbZ`fQp^lzmur:H(i"><value name="text"><block type="text" id="-f]hE(|MCiW#54W#}kLK"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="K)vYa`Z)#deQ!1}q{H.Q"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="LrH3gTKol.2*[p4jH4D0"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="C0:#WaEgbVZ[r~G@q|8b"><value name="DELAY_TIME"><block type="char_type" id="gZQ`(0$Bx-3=@BNWMrxO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="%[VVkF7@588nv1he[fA+"><next><block type="dwenguino_delay" id="u-M}Ap5N:_2+,:-`@4?E"><value name="DELAY_TIME"><block type="char_type" id="+V7?6g(f`(Da3.R+Ok2-"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id="4;?GCk$#1]UKqc*JpCtJ"><value name="text"><block type="text" id=".p6;|WP*pK!5P)^Ibi,-"><field name="TEXT">tegen de wind.</field></block></value><value name="line_number"><block type="char_type" id="yWI%[,$r2zZ.PH0((f:i"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="t_H?BNzNHvT2@CNp%@#7"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="19c_V.(8_w+v6);fCwfb"><value name="DELAY_TIME"><block type="char_type" id="6WH|Q$Q])3;UFw!KD!T?"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_delay" id="TXE6?Wg@/oIBY$p[Ga`z"><value name="DELAY_TIME"><block type="char_type" id="%cORf5sbBjB-.(-iG@AH"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id=";DtXuybn,xF/FOwjCF:4"><value name="text"><block type="text" id="t^{u]hkT)4L^+p!F[G2["><field name="TEXT">Trappen</field></block></value><value name="line_number"><block type="char_type" id="0p`XD[NDyMNta|%A7t/3"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="X;|n1^p*Chsc^vz,C@eT"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="wJt.NHYCT?xxFT0a|l-S"><value name="DELAY_TIME"><block type="char_type" id="mo?t2aHT*Uo*nC.GuTk}"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m2JGGH-h$jb)lM9CXYe0"><next><block type="dwenguino_delay" id="j?55rb3}E;+|Co*S`hM="><value name="DELAY_TIME"><block type="char_type" id="1BqO7(NNgg),p%MZHjA,"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id=":(tHu6%DX8iR?metFeL4"><value name="text"><block type="text" id="OYCuh1oaO@[PhnMV)b[J"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="mXr+iQF]OYanHl6]k-vM"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="eqvW,Y~do5;yeOS16mZ!"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="jNUVPY(fkulqIW406a;S"><value name="DELAY_TIME"><block type="char_type" id="?T{RaN{N^O?S^,m2uL[F"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MyQf_q(vqm-4Kx_ho/$u"><next><block type="dwenguino_delay" id="VD_W^T{~dxNxg+ZJRrXi"><value name="DELAY_TIME"><block type="char_type" id="+{%R9Y^?n4lmJ)~5/cuF"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="/9?@iKh%N%b029DX4a/y"><value name="text"><block type="text" id="wfjtaN2m3P6y}W+m[1/e"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="INY`bm#sWx3kX0IL?kXK"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="I.bF136;-%aT?*HI$X+2"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="OB@:R;FWiU0/DWh~BdPW"><value name="DELAY_TIME"><block type="char_type" id="kZ[ges6!FQi[V[*cMA12"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="|O~qL_TJ__o~oivI7foI"><next><block type="dwenguino_delay" id="Qoi4Q0WT!4n-a04+G4%V"><value name="DELAY_TIME"><block type="char_type" id=";bjjtx40w|%CvcF`r~:j"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="@4@sN;=}m^8TF;t(nAer"><value name="text"><block type="text" id="ikdC`Zv[xMl0{]pR)fX#"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="lSH?~`gnf%JviI:2}XJa"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="CVE!tF8@md9U@rJgE4Dp"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="T%l(=V4s=SMhd}1vUxhO"><value name="DELAY_TIME"><block type="char_type" id="kvZqY}2@Wx=.oK}MQE*`"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="drLvsnCiFEO=F@]r#v4Q"><next><block type="dwenguino_delay" id="%MnMga`gWN]%+32u!RgU"><value name="DELAY_TIME"><block type="char_type" id="5kN0m5!C?@CWtjguYWE?"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="6s|0$NVe+8umnbfq{NMT"><value name="text"><block type="text" id="~L+6,{(?3yAP6xK,efvE"><field name="TEXT">tot ik de</field></block></value><value name="line_number"><block type="char_type" id="qKk!A~k$:Mfer04ru%qy"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="}4;f_3pfEL]+mV|2ERvU"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="5y|#JTSHq_7OSw}[$Xs2"><value name="DELAY_TIME"><block type="char_type" id="GK;j0.zlVIIBGr=*4/}D"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{peMF%hI`]z?9xGfcz:-"><next><block type="dwenguino_delay" id="h~OBWExeL3ARveT/(HrJ"><value name="DELAY_TIME"><block type="char_type" id="i4cO:Zk3g@8H.c~CE+p!"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="Tt-^0U-/AlU[zNYL*2i~"><value name="text"><block type="text" id="eU6fM4.r;iyJT%0QtE%X"><field name="TEXT">terugweg</field></block></value><value name="line_number"><block type="char_type" id=";A@Mjgew#J6ly=Rrne^J"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Zwb0f$9HU@EA`Csj`9X;"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="2,dHZC$8Bapou6cguPPq"><value name="DELAY_TIME"><block type="char_type" id=";$}G/:ENCQU,IZC7Ugeu"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a$8|j|+r8;K2l:531Ks8"><next><block type="dwenguino_delay" id="lYLnC,T[q.O{L{bGiaWj"><value name="DELAY_TIME"><block type="char_type" id="4=dUiv1|T{_Ka`gdQe3."><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="r;3ncPFmQh!eK_WX9#_A"><value name="text"><block type="text" id="wdH=[^XHUAYF,gw26L!P"><field name="TEXT">vind</field></block></value><value name="line_number"><block type="char_type" id="_3{h1-PT^:FLw[KYSgiR"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="8J87Y.-o)HM[~u{ma$p-"><field name="BITMASK">0</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()},onNext:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting))},onPrev:function(){et.logger.recordEvent(et.logger.createEvent(EVENT_NAMEStutorialPrevStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting))}},poem2:{category:"wegostem",targets:[Ze.simulatorButton,Ze.workspaceArea,Ze.simulatorStartButton,Ze.simulatorStopButton,Ze.workspaceArea,Ze.workspaceArea,Ze.simulatorStartButton,Ze.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.poem2.stepTitles[e],content:MSG.tutorials.poem2.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsPoem2",label:MSG.tutsPoem2,onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Luie</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_delay" id="]ou@Z_|5^GvXMS68m4Y#"><value name="DELAY_TIME"><block type="char_type" id="LNrn.uWc!l{k)lWdw9xu"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="U37Ix-]Ulb(y%rp+HmMK"><value name="text"><block type="text" id="62=RnV.lI.d94k41Y|Wg"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="XPa1w4n/89hzWxAri?_Z"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Mj.b?|/ktlgxW9^Lv+GB"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="qA+kIka6dC`XK2Zat.^e"><value name="DELAY_TIME"><block type="char_type" id="WxmGodyzXxbbWo)/zP0j"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m5J96Dy^pC:gh?H)nGT#"><next><block type="dwenguino_delay" id="%?k#,bPe1-.s6Z7_S8qn"><value name="DELAY_TIME"><block type="char_type" id="!(gLCQ_G4;$(a`n7`O[="><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="TMkN#X]!w%McWa+(x=`9"><value name="text"><block type="text" id="IZ|[v`1EEX*`RQf+b5qF"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="iu*fPG%V5+ylVMoYt^jx"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="xL-yEduk#tQd$~t|1xBe"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="}KCE%K7;EC#vmey7^_Jo"><value name="DELAY_TIME"><block type="char_type" id="{Qw5:{GSy/lpM]ZiaD]!"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="FS#9!f68];h@Hgj8D`EH"><next><block type="dwenguino_delay" id="d,ppwLH6:]IWf8u,D}~S"><value name="DELAY_TIME"><block type="char_type" id="ve7y8sxdW$N[k3Lpj4K2"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="0j6gbZ`fQp^lzmur:H(i"><value name="text"><block type="text" id="-f]hE(|MCiW#54W#}kLK"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="K)vYa`Z)#deQ!1}q{H.Q"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="LrH3gTKol.2*[p4jH4D0"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="C0:#WaEgbVZ[r~G@q|8b"><value name="DELAY_TIME"><block type="char_type" id="gZQ`(0$Bx-3=@BNWMrxO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="%[VVkF7@588nv1he[fA+"><next><block type="dwenguino_delay" id="u-M}Ap5N:_2+,:-`@4?E"><value name="DELAY_TIME"><block type="char_type" id="+V7?6g(f`(Da3.R+Ok2-"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id="4;?GCk$#1]UKqc*JpCtJ"><value name="text"><block type="text" id=".p6;|WP*pK!5P)^Ibi,-"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="yWI%[,$r2zZ.PH0((f:i"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="t_H?BNzNHvT2@CNp%@#7"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="19c_V.(8_w+v6);fCwfb"><value name="DELAY_TIME"><block type="char_type" id="6WH|Q$Q])3;UFw!KD!T?"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="Ycv@=wOlPFRmBR2e0=O/"><next><block type="dwenguino_delay" id="TXE6?Wg@/oIBY$p[Ga`z"><value name="DELAY_TIME"><block type="char_type" id="%cORf5sbBjB-.(-iG@AH"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id=";DtXuybn,xF/FOwjCF:4"><value name="text"><block type="text" id="t^{u]hkT)4L^+p!F[G2["><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="0p`XD[NDyMNta|%A7t/3"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="X;|n1^p*Chsc^vz,C@eT"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="wJt.NHYCT?xxFT0a|l-S"><value name="DELAY_TIME"><block type="char_type" id="mo?t2aHT*Uo*nC.GuTk}"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m2JGGH-h$jb)lM9CXYe0"><next><block type="dwenguino_delay" id="j?55rb3}E;+|Co*S`hM="><value name="DELAY_TIME"><block type="char_type" id="1BqO7(NNgg),p%MZHjA,"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id=":(tHu6%DX8iR?metFeL4"><value name="text"><block type="text" id="OYCuh1oaO@[PhnMV)b[J"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="mXr+iQF]OYanHl6]k-vM"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="eqvW,Y~do5;yeOS16mZ!"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="jNUVPY(fkulqIW406a;S"><value name="DELAY_TIME"><block type="char_type" id="?T{RaN{N^O?S^,m2uL[F"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MyQf_q(vqm-4Kx_ho/$u"><next><block type="dwenguino_delay" id="VD_W^T{~dxNxg+ZJRrXi"><value name="DELAY_TIME"><block type="char_type" id="+{%R9Y^?n4lmJ)~5/cuF"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="z2G$,+(O8MXqsG@%H11H"><value name="text"><block type="text" id="]`3zL$n)c4Iq*xzBgH.T"><field name="TEXT">Trui</field></block></value><value name="line_number"><block type="char_type" id="pS%A*`i=OI[^JkNaC7BV"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="r/BGRl]k^1B9);lmYZA+"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id=")lfqScQ#!=TX.Ue)taec"><value name="DELAY_TIME"><block type="char_type" id="iiD^.IY_C*84m;faJ,`o"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="cH7Pj9[Ip;DY!r7!v?dc"><next><block type="dwenguino_delay" id="#U+By.Ih$=e?BFb,FO7l"><value name="DELAY_TIME"><block type="char_type" id="p%akSl+Egf)|/q!XnJ(i"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="/9?@iKh%N%b029DX4a/y"><value name="text"><block type="text" id="wfjtaN2m3P6y}W+m[1/e"><field name="TEXT">ze wil</field></block></value><value name="line_number"><block type="char_type" id="INY`bm#sWx3kX0IL?kXK"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="I.bF136;-%aT?*HI$X+2"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="OB@:R;FWiU0/DWh~BdPW"><value name="DELAY_TIME"><block type="char_type" id="kZ[ges6!FQi[V[*cMA12"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="|O~qL_TJ__o~oivI7foI"><next><block type="dwenguino_delay" id="Qoi4Q0WT!4n-a04+G4%V"><value name="DELAY_TIME"><block type="char_type" id=";bjjtx40w|%CvcF`r~:j"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="@4@sN;=}m^8TF;t(nAer"><value name="text"><block type="text" id="ikdC`Zv[xMl0{]pR)fX#"><field name="TEXT">een beetje</field></block></value><value name="line_number"><block type="char_type" id="lSH?~`gnf%JviI:2}XJa"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="CVE!tF8@md9U@rJgE4Dp"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="T%l(=V4s=SMhd}1vUxhO"><value name="DELAY_TIME"><block type="char_type" id="kvZqY}2@Wx=.oK}MQE*`"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="drLvsnCiFEO=F@]r#v4Q"><next><block type="dwenguino_delay" id="%MnMga`gWN]%+32u!RgU"><value name="DELAY_TIME"><block type="char_type" id="5kN0m5!C?@CWtjguYWE?"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="6s|0$NVe+8umnbfq{NMT"><value name="text"><block type="text" id="~L+6,{(?3yAP6xK,efvE"><field name="TEXT">water</field></block></value><value name="line_number"><block type="char_type" id="qKk!A~k$:Mfer04ru%qy"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="}4;f_3pfEL]+mV|2ERvU"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="5y|#JTSHq_7OSw}[$Xs2"><value name="DELAY_TIME"><block type="char_type" id="GK;j0.zlVIIBGr=*4/}D"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{peMF%hI`]z?9xGfcz:-"><next><block type="dwenguino_delay" id="h~OBWExeL3ARveT/(HrJ"><value name="DELAY_TIME"><block type="char_type" id="i4cO:Zk3g@8H.c~CE+p!"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="Tt-^0U-/AlU[zNYL*2i~"><value name="text"><block type="text" id="eU6fM4.r;iyJT%0QtE%X"><field name="TEXT">dus wacht ze</field></block></value><value name="line_number"><block type="char_type" id=";A@Mjgew#J6ly=Rrne^J"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Zwb0f$9HU@EA`Csj`9X;"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="2,dHZC$8Bapou6cguPPq"><value name="DELAY_TIME"><block type="char_type" id=";$}G/:ENCQU,IZC7Ugeu"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a$8|j|+r8;K2l:531Ks8"><next><block type="dwenguino_delay" id="lYLnC,T[q.O{L{bGiaWj"><value name="DELAY_TIME"><block type="char_type" id="4=dUiv1|T{_Ka`gdQe3."><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="w1KB0pSAA!d(biO9]JkD"><value name="text"><block type="text" id="a=y!$ACL_i[bntAB)aJu"><field name="TEXT">en</field></block></value><value name="line_number"><block type="char_type" id="QzOY1(6flDF2U:wxct=a"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="c]_+qZCDBN^6RLN!y!1C"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="9(?sJuxj6j@;x@7Asi|c"><value name="DELAY_TIME"><block type="char_type" id="BxwWPv_K3%X$BG3e|_Oc"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{f]kzKN1KgQ04-`ne1;7"><next><block type="dwenguino_delay" id="cuokpl:?{2A@~M@7`OJP"><value name="DELAY_TIME"><block type="char_type" id="ko.6d~(W|RHjt!.[oc+3"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="d(2/Uxt1k-Am7ShkBH:_"><value name="text"><block type="text" id="uQWlQI8MXKv]upN92?^4"><field name="TEXT">wacht ze</field></block></value><value name="line_number"><block type="char_type" id="gA1O7dtGAkwnDPod-qkJ"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="0T3suk9E8^[zKtWs$1u{"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="!#wStl5v`X#o+LT2yZ)l"><value name="DELAY_TIME"><block type="char_type" id="^OUEa:xd}n%%%I5XhxM:"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="rhu,trF%un+^egaUO:^4"><next><block type="dwenguino_delay" id="gv~6C5Lw@BAwk_,Y`cHx"><value name="DELAY_TIME"><block type="char_type" id="(E2[@~[ye`E^:b/%Cc6Y"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="r;3ncPFmQh!eK_WX9#_A"><value name="text"><block type="text" id="wdH=[^XHUAYF,gw26L!P"><field name="TEXT">en</field></block></value><value name="line_number"><block type="char_type" id="_3{h1-PT^:FLw[KYSgiR"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="8J87Y.-o)HM[~u{ma$p-"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="y0GhV=5]ABe?=zbLvf7v"><value name="DELAY_TIME"><block type="char_type" id=":}QFXZ7`nnXwB`(V_ad:"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="?K(I5BVBS^ur(9~DAn8Q"><next><block type="dwenguino_delay" id="5F(mmk#|BZA{FYK9FA5P"><value name="DELAY_TIME"><block type="char_type" id="_B*H^I#x3LH,lvRige]$"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="fI_KQvo@Jc?tO(O(oG]Z"><value name="text"><block type="text" id="m%o7bigf~!hj.k^Nba?p"><field name="TEXT">wacht ze</field></block></value><value name="line_number"><block type="char_type" id="+4$/h26osEjf,+J@?aGm"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="1)uzWjEHVqs!UVQm{Z^o"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="EH(/x2ezA[g-/$RE4X2q"><value name="DELAY_TIME"><block type="char_type" id="jvuTJE+;=/uEEAr@)/yO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MZWY%~bbn2ZRrpOv3vE!"><next><block type="dwenguino_delay" id="c{6-WNdwSti%V+Pwq9c0"><value name="DELAY_TIME"><block type="char_type" id="nl3)@R}ab?$2DCPhHyDx"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="u15(rgZKNp)p,^*nLK0X"><value name="text"><block type="text" id="}Dbqsn@^U.iCAi9j(hKK"><field name="TEXT">op een bui.</field></block></value><value name="line_number"><block type="char_type" id="8Hzg*-d1C7l@rJvfCHq@"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="lBM0=O*pNp!41R{!k/My"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="Kg*!@evlzIz/1~B3%,-7"><value name="DELAY_TIME"><block type="char_type" id="Xp-Oiku[1GMpeTsaBWbK"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="o!TOAVQ.XXt%|lX4EF;-"><next><block type="dwenguino_delay" id="-E@C,!R2MbOs5Psn9nNK"><value name="DELAY_TIME"><block type="char_type" id="pN@k9d(?_Lq:20,9tVW]"><field name="BITMASK">2000</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()},onNext:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting))},onPrev:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting))}},showNameAndDisappear:{category:"wegostem",targets:[Ze.simulatorButton,Ze.workspaceArea,Ze.simulatorStartButton,Ze.simulatorStopButton,Ze.workspaceArea,Ze.workspaceArea,Ze.simulatorStartButton,Ze.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.showNameAndDisappear.stepTitles[e],content:MSG.tutorials.showNameAndDisappear.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsShowNameAndDisappearWeGoSTEM",label:MSG.tutsShowNameAndDisappearWeGoSTEM,onStart:function(){et.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="SETUP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">7000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"></block></next></block></next></block></statement></block></xml>')},onEnd:function(){et.tutorialMenu.endTutorial()},onNext:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialNextStep,et.logger.tutorialIdSetting))},onPrev:function(){et.logger.recordEvent(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting)),console.log(et.logger.createEvent(O.tutorialPrevStep,et.logger.tutorialIdSetting))}}},qe=function(){function e(t){a()(this,e),c()(this,"tutorialCategory",""),c()(this,"eventLogger",null),this.eventLogger=t,this.initTutorialMenu()}return s()(e,[{key:"initTutorialMenu",value:function(){var e=this;$("#db_tutorials").click((function(){e.loadTutorialDialog(),e.addTutorialDialogEventHandlers(),e.showTutorialDialog()}))}},{key:"loadTutorialDialog",value:function(){$("#tutorialModal .modal-header").text(MSG.tutorialMenu.header),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="tutorial_label">'+MSG.tutorialMenu.chooseCategory+"</div>"),$("#tutorialModal .modal-body .message").append('<div id="tutorialModal_categories_menu" class="tutorial_categories_wrapper"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_dwenguino_components" class="tutorial_categories_item card"></div>'),$("#tutorial_category_dwenguino_components").append('<div class="category_tag">'+MSG.tutorialMenu.catDwenguinoComponents+"</div>"),$("#tutorial_category_dwenguino_compoentns").append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_wegostem" class="tutorial_categories_item card"></div>'),$("#tutorial_category_wegostem").append('<div class="category_tag">'+MSG.tutorialMenu.catWeGoStem+"</div>"),$("#tutorial_category_wegostem").append('<div id="tutorial_categories_wegostem_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_dwenguino" class="tutorial_categories_item card"></div>'),$("#tutorial_category_dwenguino").append('<div class="category_tag">'+MSG.tutorialMenu.catDwenguino+"</div>"),$("#tutorial_category_dwenguino").append('<div id="tutorial_categories_dwenguino_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_riding_robot" class="tutorial_categories_item card"></div>'),$("#tutorial_category_riding_robot").append('<div class="category_tag">'+MSG.tutorialMenu.catRidingRobot+"</div>"),$("#tutorial_category_riding_robot").append('<div id="tutorial_categories_riding_robot_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_social_robot" class="tutorial_categories_item card"></div>'),$("#tutorial_category_social_robot").append('<div class="category_tag">'+MSG.tutorialMenu.catSocialRobot+"</div>"),$("#tutorial_category_social_robot").append('<div id="tutorial_categories_social_robot_img"></div>'),$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>")}},{key:"addTutorialDialogEventHandlers",value:function(){var e=this;$("#tutorial_category_dwenguino_components").click((function(){e.loadComponentsOverview()})),$("#tutorial_category_wegostem").click((function(){e.loadTutorialsMenu("wegostem")})),$("#tutorial_category_dwenguino").click((function(){e.loadTutorialsMenu("dwenguino")})),$("#tutorial_category_riding_robot").click((function(){e.loadTutorialsMenu("ridingrobot")})),$("#tutorial_category_social_robot").click((function(){e.loadTutorialsMenu("socialrobot")})),$(".close").click((function(){e.hideTutorialDialog()}))}},{key:"showTutorialDialog",value:function(){$("#tutorialModal").modal("show")}},{key:"hideTutorialDialog",value:function(){$("#tutorialModal").modal("hide")}},{key:"loadTutorialsMenu",value:function(e){var t=this;$("#tutorialModal .modal-header").text(MSG.tutorialMenu.header),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="tutorial_label">'+MSG.tutorialMenu.chooseTutorial+"</div>"),$("#tutorialModal .modal-body .message").append('<div id="tutorialModal_tutorials_menu"></div>'),$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="previous_tutorial_dialog" type="button" class="btn btn-default">'+MSG.tutorialMenu.previous+"</button>"),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>"),$("#previous_tutorial_dialog").click((function(){t.loadTutorialDialog(),t.addTutorialDialogEventHandlers()}));var n={username:User.username,password:User.password,category:e},i=this;$.ajax({type:"POST",url:u.getServerUrl()+"/tutorials/completedTutorials",data:n}).done((function(t){$.each(Je,(function(n,o){if(o.category==e){var a=!1;$.each(t,(function(e,t){o.id==t.tutorial_id&&(a=!0)})),i.addTutorial(o,a)}}))})).fail((function(t,n){console.warn("Failed to get completed tutorials:",n),$.each(Je,(function(t,n){if(n.category==e){i.addTutorial(n,!1)}}))}))}},{key:"loadComponentsOverview",value:function(){var e=this;$("#tutorialModal .modal-header").text(MSG.tutorialMenu.dwenguinoComponents),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="container"></div>'),$("#tutorialModal .modal-body .message .container").append('<div id="row1" class="row"></div>'),$("#row1").append("<h2>Sensors</h2>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_sensors_menu" class="components_overview row"></div>');for(var t=[ze,Ve,ee,Xe],n=0;n<t.length;n++)$("#tutorialModal_sensors_menu").append('<div id="tutorial_sensors_'+t[n].getType()+'" class="col-3 bg-c-4 card"></div>'),$("#tutorial_sensors_"+t[n].getType()).append('<div class="category_tag">'+MSG.simulator[t[n].getType()]+"</div>"),$("#tutorial_sensors_"+t[n].getType()).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_sensors_"+t[n].getType()).append("<div>"+t[n].getDescription()+"</div>"),$("#tutorial_sensors_"+t[n].getType()).append('<div id="input_pins'+t[n].getType()+'">IN: </div>'),$("#tutorial_sensors_"+t[n].getType()).append('<div id="output_pins'+t[n].getType()+'">OUT: </div>'),$("#tutorial_sensors_"+t[n].getType()).append('<div id="circuit_pins'+t[n].getType()+'">CIRCUIT: </div>');$("#tutorialModal .modal-body .message .container").append('<div id="row2" class="row"></div>'),$("#row2").append("<h2>Actuators</h2>"),$("#tutorialModal .modal-body .message .container").append('<div id="row3" class="row"></div>'),$("#row3").append("<h3>Movement</h3>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_movement_menu" class="components_overview row"></div>');for(var i=[Ke],o=0;o<i.length;o++)$("#tutorialModal_movement_menu").append('<div id="tutorial_movement_'+i[o].getType()+'" class="col-3 bg-c-11 card"></div>'),$("#tutorial_movement_"+i[o].getType()).append('<div class="category_tag">'+MSG.simulator[i[o].getType()]+"</div>"),$("#tutorial_movement_"+i[o].getType()).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_movement_"+i[o].getType()).append("<div>"+i[o].getDescription()+"</div>"),$("#tutorial_movement_"+i[o].getType()).append('<div id="input_pins'+i[o].getType()+'">IN: </div>'),$("#tutorial_movement_"+i[o].getType()).append('<div id="output_pins'+i[o].getType()+'">OUT: </div>'),$("#tutorial_movement_"+i[o].getType()).append('<div id="circuit_pins'+i[o].getType()+'">CIRCUIT: </div>');$("#tutorialModal .modal-body .message .container").append('<div id="row4" class="row"></div>'),$("#row4").append("<h3>Display</h3>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_display_menu" class="components_overview row"></div>');for(var a=[He,Ge],l=0;l<a.length;l++)$("#tutorialModal_display_menu").append('<div id="tutorial_display_'+a[l].getType()+'" class="col-3 bg-c-6 card"></div>'),$("#tutorial_display_"+a[l].getType()).append('<div class="category_tag">'+MSG.simulator[a[l].getType()]+"</div>"),$("#tutorial_display_"+a[l].getType()).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_display_"+a[l].getType()).append("<div>"+a[l].getDescription()+"</div>"),$("#tutorial_display_"+a[l].getType()).append('<div id="input_pins'+a[l].getType()+'">IN: </div>'),$("#tutorial_display_"+a[l].getType()).append('<div id="output_pins'+a[l].getType()+'">OUT: </div>'),$("#tutorial_display_"+a[l].getType()).append('<div id="circuit_pins'+a[l].getType()+'">CIRCUIT: </div>');$("#tutorialModal .modal-body .message .container").append('<div id="row5" class="row"></div>'),$("#row5").append("<h3>Audio</h3>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_audio_menu" class="components_overview row"></div>');for(var s=[Le],r=0;r<s.length;r++)$("#tutorialModal_audio_menu").append('<div id="tutorial_audio_'+s[r].getType()+'" class="col-3 bg-c-3 card"></div>'),$("#tutorial_audio_"+s[r].getType()).append('<div class="category_tag">'+MSG.simulator[s[r].getType()]+"</div>"),$("#tutorial_audio_"+s[r].getType()).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_audio_"+s[r].getType()).append("<div>"+s[r].getDescription()+"</div>"),$("#tutorial_audio_"+s[r].getType()).append('<div id="input_pins'+s[r].getType()+'">IN: </div>'),$("#tutorial_audio_"+s[r].getType()).append('<div id="output_pins'+s[r].getType()+'">OUT: </div>'),$("#tutorial_audio_"+s[r].getType()).append('<div id="circuit_pins'+s[r].getType()+'">CIRCUIT: </div>');for(var c=t.concat(i).concat(a).concat(s),d=0;d<c.length;d++){for(var u=c[d].getInputPins(),p=0;p<u.length;p++)$("#input_pins"+c[d].getType()).append('<span class="badge badge-pill">'+u[p]+"</span> ");for(var g=c[d].getOutputPins(),h=0;h<g.length;h++)$("#output_pins"+c[d].getType()).append('<span class="badge badge-pill">'+g[h]+"</span> ");$("#circuit_pins"+c[d].getType()).append('<span class="badge badge-pill">5V</span> '),$("#circuit_pins"+c[d].getType()).append('<span class="badge badge-pill">GND</span> ')}$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="previous_tutorial_dialog" type="button" class="btn btn-default">'+MSG.tutorialMenu.previous+"</button>"),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>"),$("#previous_tutorial_dialog").click((function(){e.loadTutorialDialog(),e.addTutorialDialogEventHandlers()}))}},{key:"addTutorial",value:function(e,t){var n=this,i=$("<div>").attr("class","tutorial_item row").attr("id",e.id).attr("role","presentation");$("#tutorialModal_tutorials_menu").append(i),i.click((function(){n.eventLogger.tutorialId=e.id,n.tutorialCategory=e.category,n.eventLogger.tutorialIdSetting=e.id,e.initSteps(),hopscotch.configure({showPrevButton:"true"}),n.hideTutorialDialog(),hopscotch.startTour(e),n.eventLogger.recordEvent(n.eventLogger.createEvent(O.startTutorial,e.id))})),t?($("#"+e.id).append('<div class="glyphicon glyphicon-ok c-6 col-auto"></div>'),$("#"+e.id).append('<div class="col-auto">'+e.label+"</div>")):($("#"+e.id).append('<div class="glyphicon glyphicon-remove c-1 col-auto"></div>'),$("#"+e.id).append('<div class="col-auto">'+e.label+"</div>"))}},{key:"endTutorial",value:function(){this.saveCompleteTutorial(this.tutorialId,this.tutorialCategory),this.eventLogger.tutorialId="",this.eventLogger.tutorialIdSetting="",this.tutorialCategory="",this.eventLogger.recordEvent(this.eventLogger.createEvent(O.endTutorial,"")),this.showTutorialDialog()}},{key:"saveCompleteTutorial",value:function(e,t){console.log(e,t);var n={username:User.username,password:User.password,tutorialId:e,category:t};void 0!==this.eventLogger.sessionId&&$.ajax({type:"POST",url:u.getServerUrl()+"/tutorials/completeTutorial",data:n}).done((function(e){console.debug("Recording submitted",e)})).fail((function(e,t){console.warn("Failed to submit recording:",t)}))}}]),e}(),Qe={simButtonStateClicked:!1,workspace:null,recording:"",difficultyLevel:1,simulatorState:"off",xmlLoadedFromFile:"",xmlFromScenario:"",logger:null,simulationEnvironment:null,tutorialMenu:null,fileIOController:null,initDwenguinoBlockly:function(e){this.workspace=e,this.setWorkspaceBlockFromXml('<xml id="startBlocks" style="display: none">'+document.getElementById("startBlocks").innerHTML+"</xml>"),this.fileIOController=new ye,this.logger=new g,this.logger.init();var t=this;this.tutorialMenu=new qe(this.logger),this.simulationEnvironment=new De(this.logger,this.workspace),Qe.recording=window.sessionStorage.loadOnceRecording||"",delete window.sessionStorage.loadOnceRecording,$("#db_menu_item_difficulty_slider").slider({value:0,min:0,max:2,step:1,slide:function(e,n){Qe.setDifficultyLevel(n.value),console.log(n.value),t.logger.recordEvent(t.logger.createEvent("setDifficultyLevel",n.value))}}),$("#db_menu_item_difficulty_slider_input").val("$"+$("#db_menu_item_difficulty_slider").slider("value")),$("#db_blockly").resizable({handles:"e"}),$("#db_blockly").resize((function(){Qe.onresize(),Blockly.svgResize(Qe.workspace)})),$("#db_menu_item_simulator").click((function(){Qe.toggleSimulator()})),Qe.toggleSimulator(),$("#db_menu_item_run").click((function(){var e=Blockly.Arduino.workspaceToCode(Qe.workspace);Qe.runEventHandler(e)})),$("#db_menu_item_upload").click((function(){if(window.File&&window.FileReader&&window.FileList&&window.Blob){console.log("yay, files supported"),$("div").remove("#dropzoneModal"),$("#blocklyDiv").append('<div id="dropzoneModal" class="modal fade" role="dialog"></div>'),$("#dropzoneModal").append('<div id="modalDialog" class="modal-dialog"></div>'),$("#modalDialog").append('<div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Upload</h4></div>'),$("#modalDialog").append('<div class="modal-body">'+MSG.dropzone.dictSelectFile+'<input type="file" id="fileInput"><div id="filedrag">'+MSG.dropzone.dictDefaultMessage+'</div><pre id="fileDisplayArea"><pre></div>'),$("#modalDialog").append('<div class="modal-footer"><button id="submit_upload_modal_dialog_button" type="button" class="btn btn-default" data-dismiss="modal">Ok</button></div>'),$("#dropzoneModal").modal("show");var e=function(e){if(e.type.match(/text.*/)){var t=new FileReader;t.onload=function(i){n.innerText=e.name,Qe.xmlLoadedFromFile=t.result},t.readAsText(e)}else n.innerText="File not supported!"},t=document.getElementById("fileInput"),n=document.getElementById("fileDisplayArea");t.addEventListener("change",(function(n){var i=t.files[0];e(i)}));var i=function(e){e.stopPropagation(),e.preventDefault(),e.target.className="dragover"==e.type?"hover":""},o=document.getElementById("filedrag");o.addEventListener("dragover",i,!1),o.addEventListener("dragleave",i,!1),o.addEventListener("drop",(function(t){i(t);var n=(t.target.files||t.dataTransfer.files)[0];e(n)}),!1),o.style.display="block",$("#submit_upload_modal_dialog_button").click((function(){Qe.restoreFromXml(Blockly.Xml.textToDom(Qe.xmlLoadedFromFile))}))}else alert("The File APIs are not fully supported in this browser.")})),$("#db_menu_item_download").click((function(){var e=Blockly.Xml.workspaceToDom(Qe.workspace),n=Blockly.Xml.domToText(e);console.log(n),localStorage.workspaceXml=n,Qe.download("blocks.xml",n),Qe.logger.recordEvent(t.logger.createEvent(O.downloadClicked,""))})),$("#db_menu_item_clear").click((function(){Qe.simulationEnvironment.stop();Qe.runEventHandler('#include <Wire.h>\n#include <Dwenguino.h>\n#include <LiquidCrystal.h>\n\nvoid setup(){\ninitDwenguino();\ndwenguinoLCD.setCursor(2,0);\ndwenguinoLCD.print(String("WeGoSTEM ;)"));\n}\n\nvoid loop(){}\n')})),$("#blocklyDiv").click((function(){Qe.simulationEnvironment.stop()})),Qe.workspace.addChangeListener((function(e){if(console.log("blockly event"),"create"==e.type){var t={xml:e.xml,ids:e.ids};t=JSON.stringify(t),Qe.logger.recordEvent(Qe.logger.createEvent(O.blocklyBlockCreate,t))}else if("delete"==e.type){t={oldXml:e.oldXml,ids:e.ids};t=JSON.stringify(t),Qe.logger.recordEvent(Qe.logger.createEvent(O.blocklyBlockDelete,t))}else if("move"==e.type){t={oldParentId:e.oldParentId,oldInputName:e.oldInputName,oldCoordinate:e.oldCoordinate,newParentId:e.newParentId,newInputName:e.newInputName,newCoordinate:e.newCoordinate};t=JSON.stringify(t),Qe.logger.recordEvent(Qe.logger.createEvent(O.blocklyBlockMove,t))}else if("createVar"==e.type){t={varType:e.varType,varName:e.varName,varId:e.varId};t=JSON.stringify(t),Qe.logger.recordEvent(Qe.logger.createEvent(O.blocklyVarCreate,t))}else if("deleteVar"==e.type){t={varType:e.varType,varName:e.varName,varId:e.varId};t=JSON.stringify(t),Qe.logger.recordEvent(Qe.logger.createEvent(O.blocklyVarDelete,t))}else if(e.type==Blockly.Events.VAR_RENAME){t={oldName:e.oldName,newName:e.newName,varId:e.varId};t=JSON.stringify(t),Qe.logger.recordEvent(Qe.logger.createEvent(O.blocklyVarRename,t))}else if(e.type==Blockly.Events.UI){t={element:e.element,oldValue:e.oldValue,newValue:e.newValue};t=JSON.stringify(t),Qe.logger.recordEvent(Qe.logger.createEvent(O.blocklyUI,t))}else if(e.type==Blockly.Events.CHANGE){t={element:e.element,name:e.name,oldValue:e.oldValue,newValue:e.newValue};t=JSON.stringify(t),Qe.logger.recordEvent(Qe.logger.createEvent(O.blocklyChange,t))}else if(e.type==Blockly.Events.UNDO){console.log(e);t={};Qe.logger.recordEvent(Qe.logger.createEvent(O.undo,t))}}))},restoreFromXml:function(e){Qe.workspace.clear(),Blockly.Xml.domToWorkspace(e,Qe.workspace);Qe.workspace.getAllBlocks().length;Qe.logger.recordEvent(Qe.logger.createEvent(O.uploadClicked,e))},download:function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},toggleSimulator:function(){var e=[];this.simButtonStateClicked?(e=["100%","off",!1],Qe.simulationEnvironment.stop()):(e=["50%","on",!0],Qe.simulationEnvironment.open()),$("#db_blockly").width(e[0]),this.simButtonStateClicked=e[2],Qe.simulatorState=e[1],Qe.logger.recordEvent(Qe.logger.createEvent(O.simButtonStateClicked,Qe.simulatorState)),Qe.onresize(),Blockly.svgResize(Qe.workspace)},runEventHandler:function(e){Qe.disableRunButton(),$.ajax({url:u.getServerUrl()+"/utilities/run",dataType:"json",type:"post",contentType:"application/x-www-form-urlencoded",data:{code:e},success:function(e,t,n){console.log("succes"),console.log(e),"error"===e.status&&Qe.showModalErrorDialog(e),Qe.resetRunButton()},error:function(e,t,n){console.log(n),Qe.resetRunButton()}}),console.log(e.replace(/\r?\n|\r/g,"\n")),Qe.logger.recordEvent(Qe.logger.createEvent(O.runClicked,""))},showModalErrorDialog:function(e){$("#errorModal .modal-header").html(MSG.runError),"Upload failed"===e.info?$("#errorModal .modal-body .message").html(MSG.uploadError):"Compilation failed"===e.info?$("#errorModal .modal-body .message").html(MSG.compileError):"Clean failed"===e.info?$("#errorModal .modal-body .message").html(MSG.cleanError):$("#errorModal .modal-body .message").html(MSG.uploadError),$("#errorModal .modal-body .console").hide(),$("#errorModal .modal-body .error_details").off("click"),$("#errorModal .modal-body .error_details").click((function(){console.log("toggle console"),$("#errorModal .modal-body .console").toggle()})),"SIGTERM"===e.message.signal?$("#errorModal .modal-body .console").html("Operation timed out"):$("#errorModal .modal-body .console").html(e.trace),$("#errorModal").modal("show")},disableRunButton:function(){$("#db_menu_item_run").off("click"),$("#db_menu_item_clear").off("click"),$("#db_menu_item_dwengo_robot_teacher_image").attr("src","DwenguinoIDE/img/gear_animation.gif"),$("#db_menu_item_dwengo_robot_teacher_image").css({padding:"10px 25px",maxHeight:"100%",float:"right"}),$("#db_menu_item_run").css({color:"gray"}),$("#db_menu_item_clear").css({color:"gray"})},resetRunButton:function(){$("#db_menu_item_run").click((function(){var e=Blockly.Arduino.workspaceToCode(Qe.workspace);Qe.runEventHandler(e)})),$("#db_menu_item_clear").click((function(){Qe.runEventHandler('#include <Wire.h>\n#include <Dwenguino.h>\n#include <LiquidCrystal.h>\n\nvoid setup(){\ninitDwenguino();\ndwenguinoLCD.setCursor(2,0);\ndwenguinoLCD.print(String("WeGoSTEM ;)"));\n}\n\nvoid loop(){}\n')})),$("#db_menu_item_run").css({color:"black"}),$("#db_menu_item_run").hover((function(){$(this).css({color:"#8bab42"})})),$("#db_menu_item_run").mouseleave((function(){$(this).css({color:"black"})})),$("#db_menu_item_clear").css({color:"black"}),$("#db_menu_item_clear").hover((function(){$(this).css({color:"#8bab42"})})),$("#db_menu_item_clear").mouseleave((function(){$(this).css({color:"black"})})),$("#db_menu_item_dwengo_robot_teacher_image").css({padding:"10px",maxHeight:"100%",float:"right"}),$("#db_menu_item_dwengo_robot_teacher_image").attr("src","DwenguinoIDE/img/dwengo_robot_plain.svg")},prevWorkspaceXml:"",takeSnapshotOfWorkspace:function(){console.log("taking snapshot");var e=Blockly.Xml.workspaceToDom(Qe.workspace),t=Blockly.Xml.domToText(e);if(t!=Qe.prevWorkspaceXml){var n={blocksXml:t,blocksJsCode:Blockly.JavaScript.workspaceToCode(Qe.workspace)},i=JSON.stringify(n);Qe.prevWorkspaceXml=t,Qe.logger.recordEvent(this.logger.createEvent(O.changedWorkspace,i))}},logCodeChange:function(e){Qe.takeSnapshotOfWorkspace()},previouslyRenderedCode:null,renderCode:function(){Qe.logCodeChange();var e=Blockly.Arduino.workspaceToCode(Qe.workspace);if(null===Qe.previouslyRenderedCode)document.getElementById("db_arduino_code").innerHTML=prettyPrintOne(e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),"cpp",!1),Qe.previouslyRenderedCode=e;else if(e!==Qe.previouslyRenderedCode){for(var t=JsDiff.diffWords(Qe.previouslyRenderedCode,e),n=[],i=0;i<t.length;i++)if(!t[i].removed){var o=t[i].value.replace(/</g,"&lt;").replace(/>/g,"&gt;");t[i].added?n.push('<span class="code_highlight_new">'+o+"</span>"):n.push(o)}document.getElementById("db_arduino_code").innerHTML=prettyPrintOne(n.join(""),"cpp",!1),Qe.previouslyRenderedCode=e}},setDifficultyLevel:function(e){Qe.difficultyLevel=e,$("#toolbox").load("./DwenguinoIDE/levels/lvl"+e+".xml",(function(){Qe.doTranslation(),Qe.workspace.updateToolbox(document.getElementById("toolbox"))}))},loadFileXmlIntoWorkspace:function(e){console.log("loading into workspace"),Qe.setWorkspaceBlockFromXml(e)},onresize:function(){var e=document.getElementById("db_blockly"),t=document.getElementById("blocklyDiv"),n=e,i=0,o=0;do{i+=n.offsetLeft,o+=n.offsetTop,n=n.offsetParent}while(n);t.style.left=i+"px",t.style.top=o+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px"},injectBlockly:function(){document.getElementById("db_blockly");var e=document.getElementById("blocklyDiv"),t=Blockly.inject(e,{toolbox:document.getElementById("toolbox"),media:"DwenguinoIDE/img/",zoom:{controls:!0,wheel:!0},undo:!0});window.addEventListener("resize",Qe.onresize,!1),Qe.onresize(),Blockly.svgResize(t),t.addChangeListener(Qe.renderCode);return t.registerButtonCallback("createVariableCallback",(function(e){console.log("Creating new variable")})),t.registerToolboxCategoryCallback("DWB_VARIABLES",(function(){var e=t.getAllVariables(),n=[];n.push('<block type="variables_declare_set_int"></block>'),n.push('<block type="variables_get_int"></block>'),n.push('<block type="variables_declare_set_string"></block>'),n.push('<block type="variables_get_string"></block>'),console.log(e);for(var i=0;i<e.length;i++){var o='<block type="variables_get'+("Number"==e[i].type?"_int":"String"==e[i].type?"_string":"")+'"><field name="VAR" id="';o=(o=(o=o+e[i].id_+'" variabletype="')+e[i].type+'">')+e[i].name+"</field></block>",console.log(o),n.push(o)}var a=[];for(i=0;i<n.length;i++)a.push(Blockly.Xml.textToDom(n[i]));return a})),t},changeLanguage:function(){if("undefined"!=typeof Blockly&&window.sessionStorage){var e=Blockly.Xml.workspaceToDom(Qe.workspace),t=Blockly.Xml.domToText(e);window.sessionStorage.loadOnceBlocks=t,window.sessionStorage.loadOnceRecording=Qe.recording,window.sessionStorage.loadOnceSessionId=Qe.sessionId}var n=document.getElementById("db_menu_item_language_selection"),i=encodeURIComponent(n.options[n.selectedIndex].value),o=window.location.search;o=o.length<=1?"?lang="+i:o.match(/[?&]lang=[^&]*/)?o.replace(/([?&]lang=)[^&]*/,"$1"+i):o.replace(/\?/,"?lang="+i+"&"),window.location=window.location.protocol+"//"+window.location.host+window.location.pathname+o},LANG:DwenguinoBlocklyLanguageSettings.getLang(),isRtl:function(){return!1},initLanguage:function(){var e=Qe.isRtl();document.dir=e?"rtl":"ltr",document.head.parentElement.setAttribute("lang",Qe.LANG);var t=[];for(var n in DwenguinoBlocklyLanguageSettings.LANGUAGE_NAME)t.push([DwenguinoBlocklyLanguageSettings.LANGUAGE_NAME[n],n]);t.sort((function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}));var i=document.getElementById("db_menu_item_language_selection");i.options.length=0;for(var o=0;o<t.length;o++){var a=t[o],l=(n=a[a.length-1],new Option(a[0],n));n===Qe.LANG&&(l.selected=!0),i.options.add(l)}i.addEventListener("change",Qe.changeLanguage,!0)},doTranslation:function(){document.title+=" "+MSG.title,document.getElementById("db_menu_item_upload").title=MSG.loadBlocksFileTooltip,document.getElementById("db_menu_item_download").title=MSG.saveBlocksFileTooltip,document.getElementById("db_menu_item_simulator").title=MSG.toggleSimulator;for(var e,t=["catLogic","catLoops","catMath","catText","catLists","catColour","catVariables","catFunctions","catBoardIO","catDwenguino","catSocialRobot","catArduino","catComments"],n=0;e=t[n];n++){var i=document.getElementById(e);i&&i.setAttribute("name",MSG[e])}var o,a=document.getElementsByClassName("textVar");for(n=0;o=a[n];n++)o.textContent=MSG.textVariable;var l,s=document.getElementsByClassName("listVar");for(n=0;l=s[n];n++)l.textContent=MSG.listVariable},loadBlocks:function(e){try{var t=window.sessionStorage.loadOnceBlocks}catch(e){t=null}if("BlocklyStorage"in window&&window.location.hash.length>1)BlocklyStorage.retrieveXml(window.location.hash.substring(1));else if(t){delete window.sessionStorage.loadOnceBlocks;var n=Blockly.Xml.textToDom(t);Blockly.Xml.domToWorkspace(n,Qe.workspace)}else if(e){n=Blockly.Xml.textToDom(e);Blockly.Xml.domToWorkspace(n,Qe.workspace),Qe.recording=""}else"BlocklyStorage"in window&&window.setTimeout(BlocklyStorage.restoreBlocks,0)},setWorkspaceBlockFromXml:function(e){Qe.workspace.clear();try{var t=Blockly.Xml.textToDom(e)}catch(e){return void console.log("invalid xml")}Blockly.Xml.domToWorkspace(t,Qe.workspace)},setupEnvironment:function(){Qe.initLanguage();var e=Qe.injectBlockly();Qe.initDwenguinoBlockly(e),Qe.doTranslation(),Qe.setDifficultyLevel(0),Qe.takeSnapshotOfWorkspace(),$(window).resize((function(){Qe.onresize(),Blockly.svgResize(Qe.workspace)}));var t=document.querySelector('input[id="code_checkbox"]');t.addEventListener("change",(function(){t.checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible",Qe.renderCode()):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("db_code_pane").style.visibility="hidden")}))},tearDownEnvironment:function(){}};$(document).ready((function(){Qe.setupEnvironment()}));var et=t.default=Qe}]);