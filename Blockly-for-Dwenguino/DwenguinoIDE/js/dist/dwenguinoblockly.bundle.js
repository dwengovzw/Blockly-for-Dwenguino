!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=21)}([function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}},function(t,e,n){var i=n(12);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}},function(t,e,n){var i=n(13),o=n(6);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?o(t):e}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){var i=n(11);function o(e,n,a){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=o=Reflect.get:t.exports=o=function(t,e,n){var o=i(t,e);if(o){var a=Object.getOwnPropertyDescriptor(o,e);return a.get?a.get.call(n):a.value}},o(e,n,a||e)}t.exports=o},function(t,e,n){var i=n(14),o=n(15),a=n(16),r=n(18);t.exports=function(t,e){return i(t)||o(t,e)||a(t,e)||r()}},function(t,e,n){t.exports=n(20)},function(t,e){function n(t,e,n,i,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(i,o)}t.exports=function(t){return function(){var e=this,i=arguments;return new Promise((function(o,a){var r=t.apply(e,i);function s(t){n(r,o,a,s,l,"next",t)}function l(t){n(r,o,a,s,l,"throw",t)}s(void 0)}))}}},function(t,e,n){var i=n(2);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t}},function(t,e){function n(e,i){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,i)}t.exports=n},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){o=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return n}}},function(t,e,n){var i=n(17);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=32)}([function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var i=n(6),o=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=d;var a=n(5);a.inherits=n(2);var r=n(23),s=n(14);a.inherits(d,r);for(var l=o(s.prototype),c=0;c<l.length;c++){var u=l[c];d.prototype[u]||(d.prototype[u]=s.prototype[u])}function d(t){if(!(this instanceof d))return new d(t);r.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",p)}function p(){this.allowHalfOpen||this._writableState.ended||i.nextTick(h,this)}function h(t){t.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),d.prototype._destroy=function(t,e){this.push(null),this.end(),i.nextTick(e,t)}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=n(38),o=n(39),a=n(40);function r(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return c(this,t,e,n)}function c(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i),l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=p(t,e),t}(t,e,n,i):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|g(e,n),o=(t=s(t,i)).write(e,n);return o!==i&&(t=t.slice(0,o)),t}(t,e,n):function(t,e){if(l.isBuffer(e)){var n=0|h(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?s(t,0):p(t,e);if("Buffer"===e.type&&a(e.data))return p(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e){if(u(e),t=s(t,e<0?0:0|h(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function p(t,e){var n=e.length<0?0:0|h(e.length);t=s(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function h(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function g(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(t).length;default:if(i)return j(t).length;e=(""+e).toLowerCase(),i=!0}}function f(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function m(t,e,n,i,o){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=l.from(e,i)),l.isBuffer(e))return 0===e.length?-1:v(t,e,n,i,o);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,i,o);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,i,o){var a,r=1,s=t.length,l=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;r=2,s/=2,l/=2,n/=2}function c(t,e){return 1===r?t[e]:t.readUInt16BE(e*r)}if(o){var u=-1;for(a=n;a<s;a++)if(c(t,a)===c(e,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===l)return u*r}else-1!==u&&(a-=a-u),u=-1}else for(n+l>s&&(n=s-l),a=n;a>=0;a--){for(var d=!0,p=0;p<l;p++)if(c(t,a+p)!==c(e,p)){d=!1;break}if(d)return a}return-1}function _(t,e,n,i){n=Number(n)||0;var o=t.length-n;i?(i=Number(i))>o&&(i=o):i=o;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var r=0;r<i;++r){var s=parseInt(e.substr(2*r,2),16);if(isNaN(s))return r;t[n+r]=s}return r}function y(t,e,n,i){return U(j(e,t.length-n),t,n,i)}function b(t,e,n,i){return U(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function k(t,e,n,i){return b(t,e,n,i)}function w(t,e,n,i){return U(H(e),t,n,i)}function S(t,e,n,i){return U(function(t,e){for(var n,i,o,a=[],r=0;r<t.length&&!((e-=2)<0);++r)i=(n=t.charCodeAt(r))>>8,o=n%256,a.push(o),a.push(i);return a}(e,t.length-n),t,n,i)}function x(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function E(t,e,n){n=Math.min(t.length,n);for(var i=[],o=e;o<n;){var a,r,s,l,c=t[o],u=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(a=t[o+1]))&&(l=(31&c)<<6|63&a)>127&&(u=l);break;case 3:a=t[o+1],r=t[o+2],128==(192&a)&&128==(192&r)&&(l=(15&c)<<12|(63&a)<<6|63&r)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:a=t[o+1],r=t[o+2],s=t[o+3],128==(192&a)&&128==(192&r)&&128==(192&s)&&(l=(15&c)<<18|(63&a)<<12|(63&r)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),o+=d}return function(t){var e=t.length;if(e<=C)return String.fromCharCode.apply(String,t);for(var n="",i=0;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=C));return n}(i)}e.Buffer=l,e.SlowBuffer=function(t){return+t!=t&&(t=0),l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=r(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return c(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return function(t,e,n,i){return u(e),e<=0?s(t,e):void 0!==n?"string"==typeof i?s(t,e).fill(n,i):s(t,e).fill(n):s(t,e)}(null,t,e,n)},l.allocUnsafe=function(t){return d(null,t)},l.allocUnsafeSlow=function(t){return d(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,o=0,a=Math.min(n,i);o<a;++o)if(t[o]!==e[o]){n=t[o],i=e[o];break}return n<i?-1:i<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=l.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var r=t[n];if(!l.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(i,o),o+=r.length}return i},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)f(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)f(this,e,e+3),f(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)f(this,e,e+7),f(this,e+1,e+6),f(this,e+2,e+5),f(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):function(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return M(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return T(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return x(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,i,o){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),e<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=n)return 0;if(i>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(o>>>=0)-(i>>>=0),r=(n>>>=0)-(e>>>=0),s=Math.min(a,r),c=this.slice(i,o),u=t.slice(e,n),d=0;d<s;++d)if(c[d]!==u[d]){a=c[d],r=u[d];break}return a<r?-1:r<a?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},l.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return y(this,t,e,n);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return k(this,t,e,n);case"base64":return w(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function T(t,e,n){var i="";n=Math.min(t.length,n);for(var o=e;o<n;++o)i+=String.fromCharCode(127&t[o]);return i}function I(t,e,n){var i="";n=Math.min(t.length,n);for(var o=e;o<n;++o)i+=String.fromCharCode(t[o]);return i}function M(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var o="",a=e;a<n;++a)o+=N(t[a]);return o}function P(t,e,n){for(var i=t.slice(e,n),o="",a=0;a<i.length;a+=2)o+=String.fromCharCode(i[a]+256*i[a+1]);return o}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function $(t,e,n,i,o,a){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<a)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function A(t,e,n,i){e<0&&(e=65535+e+1);for(var o=0,a=Math.min(t.length-n,2);o<a;++o)t[n+o]=(e&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function R(t,e,n,i){e<0&&(e=4294967295+e+1);for(var o=0,a=Math.min(t.length-n,4);o<a;++o)t[n+o]=e>>>8*(i?o:3-o)&255}function B(t,e,n,i,o,a){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(t,e,n,i,a){return a||B(t,0,n,4),o.write(t,e,n,i,23,4),n+4}function L(t,e,n,i,a){return a||B(t,0,n,8),o.write(t,e,n,i,52,8),n+8}l.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var o=e-t;n=new l(o,void 0);for(var a=0;a<o;++a)n[a]=this[a+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var i=this[t],o=1,a=0;++a<e&&(o*=256);)i+=this[t+a]*o;return i},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var i=this[t+--e],o=1;e>0&&(o*=256);)i+=this[t+--e]*o;return i},l.prototype.readUInt8=function(t,e){return e||O(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||O(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||O(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var i=this[t],o=1,a=0;++a<e&&(o*=256);)i+=this[t+a]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var i=e,o=1,a=this[t+--i];i>0&&(o*=256);)a+=this[t+--i]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*e)),a},l.prototype.readInt8=function(t,e){return e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||O(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||O(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||O(t,4,this.length),o.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||O(t,4,this.length),o.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||O(t,8,this.length),o.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||O(t,8,this.length),o.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,i){t=+t,e|=0,n|=0,i||$(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,a=0;for(this[e]=255&t;++a<n&&(o*=256);)this[e+a]=t/o&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,i){t=+t,e|=0,n|=0,i||$(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,a=1;for(this[e+o]=255&t;--o>=0&&(a*=256);)this[e+o]=t/a&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):A(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):A(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var o=Math.pow(2,8*n-1);$(this,t,e,n,o-1,-o)}var a=0,r=1,s=0;for(this[e]=255&t;++a<n&&(r*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/r>>0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var o=Math.pow(2,8*n-1);$(this,t,e,n,o-1,-o)}var a=n-1,r=1,s=0;for(this[e+a]=255&t;--a>=0&&(r*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/r>>0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):A(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):A(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return D(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return D(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var o,a=i-n;if(this===t&&n<e&&e<i)for(o=a-1;o>=0;--o)t[o+e]=this[o+n];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},l.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var r=l.isBuffer(t)?t:j(new l(t,i).toString()),s=r.length;for(a=0;a<n-e;++a)this[a+e]=r[a%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function N(t){return t<16?"0"+t.toString(16):t.toString(16)}function j(t,e){var n;e=e||1/0;for(var i=t.length,o=null,a=[],r=0;r<i;++r){if((n=t.charCodeAt(r))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(r+1===i){(e-=3)>-1&&a.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&a.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function U(t,e,n,i){for(var o=0;o<i&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(0))},function(t,e){var n,i,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(t){i=r}}();var l,c=[],u=!1,d=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&h())}function h(){if(!u){var t=s(p);u=!0;for(var e=c.length;e;){for(l=c,c=[];++d<e;)l&&l[d].run();d=-1,e=c.length}l=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function f(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new g(t,e)),1!==c.length||u||s(h)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.prependListener=f,o.prependOnceListener=f,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){(function(t){function n(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===n(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===n(t)},e.isError=function(t){return"[object Error]"===n(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,i,o){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var a,r,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,n)}));case 3:return e.nextTick((function(){t.call(null,n,i)}));case 4:return e.nextTick((function(){t.call(null,n,i,o)}));default:for(a=new Array(s-1),r=0;r<a.length;)a[r++]=arguments[r];return e.nextTick((function(){t.apply(null,a)}))}}}:t.exports=e}).call(this,n(4))},function(t,e,n){var i=n(3),o=i.Buffer;function a(t,e){for(var n in t)e[n]=t[n]}function r(t,e,n){return o(t,e,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?t.exports=i:(a(i,e),e.Buffer=r),a(o,r),r.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return o(t,e,n)},r.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var i=o(t);return void 0!==e?"string"==typeof n?i.fill(e,n):i.fill(e):i.fill(0),i},r.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return o(t)},r.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i.SlowBuffer(t)}},function(t,e,n){var i=n(17)(Object,"create");t.exports=i},function(t,e,n){var i=n(31);t.exports=function(t,e){for(var n=t.length;n--;)if(i(t[n][0],e))return n;return-1}},function(t,e,n){var i=n(96);t.exports=function(t,e){var n=t.__data__;return i(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function a(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new a(o.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new a(o.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(35),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(0))},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,r,s,l,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(a(n=this._events[t]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),r=(c=n.slice()).length,l=0;l<r;l++)c[l].apply(this,s);return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){if(!i(e))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(t,o),n||(n=!0,e.apply(this,arguments))}return o.listener=e,this.on(t,o),this},n.prototype.removeListener=function(t,e){var n,a,r,s;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=(n=this._events[t]).length,a=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(s=r;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){a=s;break}if(a<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(a,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){(e=t.exports=n(23)).Stream=e,e.Readable=e,e.Writable=n(14),e.Duplex=n(1),e.Transform=n(27),e.PassThrough=n(45)},function(t,e,n){"use strict";(function(e,i,o){var a=n(6);function r(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var i=t.entry;for(t.entry=null;i;){var o=i.callback;e.pendingcb--,o(void 0),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=_;var s,l=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?i:a.nextTick;_.WritableState=v;var c=n(5);c.inherits=n(2);var u,d={deprecate:n(44)},p=n(24),h=n(7).Buffer,g=o.Uint8Array||function(){},f=n(25);function m(){}function v(t,e){s=s||n(1),t=t||{};var i=e instanceof s;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var o=t.highWaterMark,c=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:i&&(c||0===c)?c:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===t.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,i=n.sync,o=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,i,o){--e.pendingcb,n?(a.nextTick(o,i),a.nextTick(x,t,e),t._writableState.errorEmitted=!0,t.emit("error",i)):(o(i),t._writableState.errorEmitted=!0,t.emit("error",i),x(t,e))}(t,n,i,e,o);else{var r=w(n);r||n.corked||n.bufferProcessing||!n.bufferedRequest||k(t,n),i?l(b,t,n,r,o):b(t,n,r,o)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function _(t){if(s=s||n(1),!(u.call(_,this)||this instanceof s))return new _(t);this._writableState=new v(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),p.call(this)}function y(t,e,n,i,o,a,r){e.writelen=i,e.writecb=r,e.writing=!0,e.sync=!0,n?t._writev(o,e.onwrite):t._write(o,a,e.onwrite),e.sync=!1}function b(t,e,n,i){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,i(),x(t,e)}function k(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var i=e.bufferedRequestCount,o=new Array(i),a=e.corkedRequestsFree;a.entry=n;for(var s=0,l=!0;n;)o[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;o.allBuffers=l,y(t,e,!0,e.length,o,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new r(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,d=n.callback;if(y(t,e,!1,e.objectMode?1:c.length,c,u,d),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function w(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function S(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),x(t,e)}))}function x(t,e){var n=w(e);return n&&(function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,a.nextTick(S,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}c.inherits(_,p),v.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(v.prototype,"buffer",{get:d.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(_,Symbol.hasInstance,{value:function(t){return!!u.call(this,t)||this===_&&t&&t._writableState instanceof v}})):u=function(t){return t instanceof this},_.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},_.prototype.write=function(t,e,n){var i=this._writableState,o=!1,r=!i.objectMode&&function(t){return h.isBuffer(t)||t instanceof g}(t);return r&&!h.isBuffer(t)&&(t=function(t){return h.from(t)}(t)),"function"==typeof e&&(n=e,e=null),r?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof n&&(n=m),i.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),a.nextTick(e,n)}(this,n):(r||function(t,e,n,i){var o=!0,r=!1;return null===n?r=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r&&(t.emit("error",r),a.nextTick(i,r),o=!1),o}(this,i,t,n))&&(i.pendingcb++,o=function(t,e,n,i,o,a){if(!n){var r=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=h.from(e,n)),e}(e,i,o);i!==r&&(n=!0,o="buffer",i=r)}var s=e.objectMode?1:i.length;e.length+=s;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:o,isBuf:n,callback:a,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else y(t,e,!1,s,i,o,a);return l}(this,i,r,t,e,n)),o},_.prototype.cork=function(){this._writableState.corked++},_.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||k(this,t))},_.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),_.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},_.prototype._writev=null,_.prototype.end=function(t,e,n){var i=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(t,e,n){e.ending=!0,x(t,e),n&&(e.finished?a.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}(this,i,n)},Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),_.prototype.destroy=f.destroy,_.prototype._undestroy=f.undestroy,_.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(4),n(11).setImmediate,n(0))},function(t,e,n){(function(e,n,i){t.exports=function t(e,n,i){function o(r,s){if(!n[r]){if(!e[r]){var l="function"==typeof _dereq_&&_dereq_;if(!s&&l)return l(r,!0);if(a)return a(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};e[r][0].call(u.exports,(function(t){return o(e[r][1][t]||t)}),u,u.exports,t,e,n,i)}return n[r].exports}for(var a="function"==typeof _dereq_&&_dereq_,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(t,e,n){"use strict";e.exports=function(t){var e=t._SomePromiseArray;function n(t){var n=new e(t),i=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),i}t.any=function(t){return n(t)},t.prototype.any=function(){return n(this)}}},{}],2:[function(t,n,i){"use strict";var o;try{throw new Error}catch(t){o=t}var a=t("./schedule"),r=t("./queue"),s=t("./util");function l(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new r(16),this._normalQueue=new r(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=a}function c(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function u(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function d(t){this._normalQueue._pushOne(t),this._queueTick()}l.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},l.prototype.hasCustomScheduler=function(){return this._customScheduler},l.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},l.prototype.disableTrampolineIfNecessary=function(){s.hasDevTools&&(this._trampolineEnabled=!1)},l.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},l.prototype.fatalError=function(t,n){n?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),e.exit(2)):this.throwLater(t)},l.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout((function(){t(e)}),0);else try{this._schedule((function(){t(e)}))}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.hasDevTools?(l.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?c.call(this,t,e,n):this._schedule((function(){setTimeout((function(){t.call(e,n)}),100)}))},l.prototype.invoke=function(t,e,n){this._trampolineEnabled?u.call(this,t,e,n):this._schedule((function(){t.call(e,n)}))},l.prototype.settlePromises=function(t){this._trampolineEnabled?d.call(this,t):this._schedule((function(){t._settlePromises()}))}):(l.prototype.invokeLater=c,l.prototype.invoke=u,l.prototype.settlePromises=d),l.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),i=t.shift();e.call(n,i)}else e._settlePromises()}},l.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},l.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},l.prototype._reset=function(){this._isTickUsed=!1},n.exports=l,n.exports.firstLineError=o},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,i){var o=!1,a=function(t,e){this._reject(e)},r=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(a,a,null,this,t)},s=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},l=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(a){o||(o=!0,t.prototype._propagateFrom=i.propagateFromFunction(),t.prototype._boundValue=i.boundValueFunction());var c=n(a),u=new t(e);u._propagateFrom(this,1);var d=this._target();if(u._setBoundTo(c),c instanceof t){var p={promiseRejectionQueued:!1,promise:u,target:d,bindingPromise:c};d._then(e,r,void 0,u,p),c._then(s,l,void 0,u,p),u._setOnCancel(c)}else u._resolveCallback(d);return u},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";var i;"undefined"!=typeof Promise&&(i=Promise);var o=t("./promise")();o.noConflict=function(){try{Promise===o&&(Promise=i)}catch(t){}return o},e.exports=o},{"./promise":22}],5:[function(t,e,n){"use strict";var i=Object.create;if(i){var o=i(null),a=i(null);o[" size"]=a[" size"]=0}e.exports=function(e){var n=t("./util"),i=n.canEvaluate;function o(t){return function(t,i){var o;if(null!=t&&(o=t[i]),"function"!=typeof o){var a="Object "+n.classString(t)+" has no method '"+n.toString(i)+"'";throw new e.TypeError(a)}return o}(t,this.pop()).apply(t,this)}function a(t){return t[this]}function r(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}n.isIdentifier,e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(o,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e;if("number"==typeof t)e=r;else if(i){var n=(void 0)(t);e=null!==n?n:a}else e=a;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,i,o){var a=t("./util"),r=a.tryCatch,s=a.errorObj,l=e._async;e.prototype.break=e.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(a.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var i=r(t).call(this._boundValue());i===s&&(this._attachExtraTrace(i.e),l.throwLater(i.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),i=t("./es5").keys,o=n.tryCatch,a=n.errorObj;return function(t,r,s){return function(l){var c=s._boundValue();t:for(var u=0;u<t.length;++u){var d=t[u];if(d===Error||null!=d&&d.prototype instanceof Error){if(l instanceof d)return o(r).call(c,l)}else if("function"==typeof d){var p=o(d).call(c,l);if(p===a)return p;if(p)return o(r).call(c,l)}else if(n.isObject(l)){for(var h=i(d),g=0;g<h.length;++g){var f=h[g];if(d[f]!=l[f])continue t}return o(r).call(c,l)}}return e}}}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){var e=!1,n=[];function i(){this._trace=new i.CapturedTrace(o())}function o(){var t=n.length-1;if(t>=0)return n[t]}return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},i.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},i.prototype._popContext=function(){if(void 0!==this._trace){var t=n.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},i.CapturedTrace=null,i.create=function(){if(e)return new i},i.deactivateLongStackTraces=function(){},i.activateLongStackTraces=function(){var n=t.prototype._pushContext,a=t.prototype._popContext,r=t._peekContext,s=t.prototype._peekContext,l=t.prototype._promiseCreated;i.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=a,t._peekContext=r,t.prototype._peekContext=s,t.prototype._promiseCreated=l,e=!1},e=!0,t.prototype._pushContext=i.prototype._pushContext,t.prototype._popContext=i.prototype._popContext,t._peekContext=t.prototype._peekContext=o,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},i}},{}],9:[function(t,n,i){"use strict";n.exports=function(n,i){var o,a,r,s=n._getDomain,l=n._async,c=t("./errors").Warning,u=t("./util"),d=u.canAttachTrace,p=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,h=/\((?:timers\.js):\d+:\d+\)/,g=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,f=null,m=null,v=!1,_=!(0==u.env("BLUEBIRD_DEBUG")),y=!(0==u.env("BLUEBIRD_WARNINGS")||!_&&!u.env("BLUEBIRD_WARNINGS")),b=!(0==u.env("BLUEBIRD_LONG_STACK_TRACES")||!_&&!u.env("BLUEBIRD_LONG_STACK_TRACES")),k=0!=u.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(y||!!u.env("BLUEBIRD_W_FORGOTTEN_RETURN"));n.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var t=this;setTimeout((function(){t._notifyUnhandledRejection()}),1)}},n.prototype._notifyUnhandledRejectionIsHandled=function(){G("rejectionHandled",o,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),G("unhandledRejection",a,t,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},n.prototype._warn=function(t,e,n){return N(t,e,n||this)},n.onPossiblyUnhandledRejection=function(t){var e=s();a="function"==typeof t?null===e?t:u.domainBind(e,t):void 0},n.onUnhandledRejectionHandled=function(t){var e=s();o="function"==typeof t?null===e?t:u.domainBind(e,t):void 0};var w=function(){};n.longStackTraces=function(){if(l.haveItemsQueued()&&!Q.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!Q.longStackTraces&&V()){var t=n.prototype._captureStackTrace,e=n.prototype._attachExtraTrace;Q.longStackTraces=!0,w=function(){if(l.haveItemsQueued()&&!Q.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=t,n.prototype._attachExtraTrace=e,i.deactivateLongStackTraces(),l.enableTrampoline(),Q.longStackTraces=!1},n.prototype._captureStackTrace=L,n.prototype._attachExtraTrace=F,i.activateLongStackTraces(),l.disableTrampolineIfNecessary()}},n.hasLongStackTraces=function(){return Q.longStackTraces&&V()};var S=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return u.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!u.global.dispatchEvent(n)}}return"function"==typeof Event?(t=new Event("CustomEvent"),u.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!u.global.dispatchEvent(n)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),u.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!u.global.dispatchEvent(n)})}catch(t){}return function(){return!1}}(),x=u.isNode?function(){return e.emit.apply(e,arguments)}:u.global?function(t){var e="on"+t.toLowerCase(),n=u.global[e];return!!n&&(n.apply(u.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function E(t,e){return{promise:e}}var C={promiseCreated:E,promiseFulfilled:E,promiseRejected:E,promiseResolved:E,promiseCancelled:E,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:E},T=function(t){var e=!1;try{e=x.apply(null,arguments)}catch(t){l.throwLater(t),e=!0}var n=!1;try{n=S(t,C[t].apply(null,arguments))}catch(t){l.throwLater(t),n=!0}return n||e};function I(){return!1}function M(t,e,n){var i=this;try{t(e,n,(function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+u.toString(t));i._attachCancellationCallback(t)}))}catch(t){return t}}function P(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?u.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function O(){return this._onCancelField}function $(t){this._onCancelField=t}function A(){this._cancellationParent=void 0,this._onCancelField=void 0}function R(t,e){if(0!=(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}n.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?n.longStackTraces():!t.longStackTraces&&n.hasLongStackTraces()&&w()),"warnings"in t){var e=t.warnings;Q.warnings=!!e,k=Q.warnings,u.isObject(e)&&"wForgottenReturn"in e&&(k=!!e.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!Q.cancellation){if(l.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=A,n.prototype._propagateFrom=R,n.prototype._onCancel=O,n.prototype._setOnCancel=$,n.prototype._attachCancellationCallback=P,n.prototype._execute=M,B=R,Q.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!Q.monitoring?(Q.monitoring=!0,n.prototype._fireEvent=T):!t.monitoring&&Q.monitoring&&(Q.monitoring=!1,n.prototype._fireEvent=I)),n},n.prototype._fireEvent=I,n.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(t){},n.prototype._attachCancellationCallback=function(t){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(t,e){};var B=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)};function D(){var t=this._boundTo;return void 0!==t&&t instanceof n?t.isFulfilled()?t.value():void 0:t}function L(){this._trace=new z(this._peekContext())}function F(t,e){if(d(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var i=H(t);u.notEnumerableProp(t,"stack",i.message+"\n"+i.stack.join("\n")),u.notEnumerableProp(t,"__stackCleaned__",!0)}}}function N(t,e,i){if(Q.warnings){var o,a=new c(t);if(e)i._attachExtraTrace(a);else if(Q.longStackTraces&&(o=n._peekContext()))o.attachExtraTrace(a);else{var r=H(a);a.stack=r.message+"\n"+r.stack.join("\n")}T("warning",a)||U(a,"",!0)}}function j(t){for(var e=[],n=0;n<t.length;++n){var i=t[n],o="    (No stack trace)"===i||f.test(i),a=o&&X(i);o&&!a&&(v&&" "!==i.charAt(0)&&(i="    "+i),e.push(i))}return e}function H(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var i=e[n];if("    (No stack trace)"===i||f.test(i))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:j(e)}}function U(t,e,n){if("undefined"!=typeof console){var i;if(u.isObject(t)){var o=t.stack;i=e+m(o,t)}else i=e+String(t);"function"==typeof r?r(i,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(i)}}function G(t,e,n,i){var o=!1;try{"function"==typeof e&&(o=!0,"rejectionHandled"===t?e(i):e(n,i))}catch(t){l.throwLater(t)}"unhandledRejection"===t?T(t,n,i)||o||U(n,"Unhandled rejection "):T(t,i)}function W(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{if(e=t&&"function"==typeof t.toString?t.toString():u.toString(t),/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){return t.length<41?t:t.substr(0,38)+"..."}(e)+">, no stack trace)"}function V(){return"function"==typeof q}var X=function(){return!1},Y=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function K(t){var e=t.match(Y);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function z(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);q(this,z),e>32&&this.uncycle()}u.inherits(z,Error),i.CapturedTrace=z,z.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},i=0,o=this;void 0!==o;++i)e.push(o),o=o._parent;for(i=(t=this._length=i)-1;i>=0;--i){var a=e[i].stack;void 0===n[a]&&(n[a]=i)}for(i=0;i<t;++i){var r=n[e[i].stack];if(void 0!==r&&r!==i){r>0&&(e[r-1]._parent=void 0,e[r-1]._length=1),e[i]._parent=void 0,e[i]._length=1;var s=i>0?e[i-1]:this;r<t-1?(s._parent=e[r+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var l=s._length+1,c=i-2;c>=0;--c)e[c]._length=l,l++;return}}}},z.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=H(t),n=e.message,i=[e.stack],o=this;void 0!==o;)i.push(j(o.stack.split("\n"))),o=o._parent;!function(t){for(var e=t[0],n=1;n<t.length;++n){for(var i=t[n],o=e.length-1,a=e[o],r=-1,s=i.length-1;s>=0;--s)if(i[s]===a){r=s;break}for(s=r;s>=0;--s){var l=i[s];if(e[o]!==l)break;e.pop(),o--}e=i}}(i),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(i),u.notEnumerableProp(t,"stack",function(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}(n,i)),u.notEnumerableProp(t,"__stackCleaned__",!0)}};var q=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():W(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,f=t,m=e;var n=Error.captureStackTrace;return X=function(t){return p.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var i,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return f=/@/,m=e,v=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){i="stack"in t}return"stack"in o||!i||"number"!=typeof Error.stackTraceLimit?(m=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?W(e):e.toString()},null):(f=t,m=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(r=function(t){console.warn(t)},u.isNode&&e.stderr.isTTY?r=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:u.isNode||"string"!=typeof(new Error).stack||(r=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var Q={warnings:y,longStackTraces:!1,cancellation:!1,monitoring:!1};return b&&n.longStackTraces(),{longStackTraces:function(){return Q.longStackTraces},warnings:function(){return Q.warnings},cancellation:function(){return Q.cancellation},monitoring:function(){return Q.monitoring},propagateFromFunction:function(){return B},boundValueFunction:function(){return D},checkForgottenReturns:function(t,e,n,i,o){if(void 0===t&&null!==e&&k){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&i._bitField))return;n&&(n+=" ");var a="",r="";if(e._trace){for(var s=e._trace.stack.split("\n"),l=j(s),c=l.length-1;c>=0;--c){var u=l[c];if(!h.test(u)){var d=u.match(g);d&&(a="at "+d[1]+":"+d[2]+":"+d[3]+" ");break}}if(l.length>0){var p=l[0];for(c=0;c<s.length;++c)if(s[c]===p){c>0&&(r="\n"+s[c-1]);break}}}var f="a promise was created in a "+n+"handler "+a+"but was not returned from it, see http://goo.gl/rRqMUw"+r;i._warn(f,!0,e)}},setBounds:function(t,e){if(V()){for(var n,i,o=t.stack.split("\n"),a=e.stack.split("\n"),r=-1,s=-1,l=0;l<o.length;++l)if(c=K(o[l])){n=c.fileName,r=c.line;break}for(l=0;l<a.length;++l){var c;if(c=K(a[l])){i=c.fileName,s=c.line;break}}r<0||s<0||!n||!i||n!==i||r>=s||(X=function(t){if(p.test(t))return!0;var e=K(t);return!!(e&&e.fileName===n&&r<=e.line&&e.line<=s)})}},warn:N,deprecated:function(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),N(n)},CapturedTrace:z,fireDomEvent:S,fireGlobalEvent:x}}},{"./errors":12,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1];return this.caught(t,(function(){throw e}))},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var i=arguments[1];return i instanceof t&&i.suppressUnhandledRejections(),this.caught(n,(function(){return i}))}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.reduce,i=t.all;function o(){return i(this)}t.prototype.each=function(t){return n(this,t,e,0)._then(o,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,e,e)},t.each=function(t,i){return n(t,i,e,0)._then(o,void 0,void 0,t,void 0)},t.mapSeries=function(t,i){return n(t,i,e,e)}}},{}],12:[function(t,e,n){"use strict";var i,o,a=t("./es5"),r=a.freeze,s=t("./util"),l=s.inherits,c=s.notEnumerableProp;function u(t,e){function n(i){if(!(this instanceof n))return new n(i);c(this,"message","string"==typeof i?i:e),c(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return l(n,Error),n}var d=u("Warning","warning"),p=u("CancellationError","cancellation error"),h=u("TimeoutError","timeout error"),g=u("AggregateError","aggregate error");try{i=TypeError,o=RangeError}catch(t){i=u("TypeError","type error"),o=u("RangeError","range error")}for(var f="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<f.length;++m)"function"==typeof Array.prototype[f[m]]&&(g.prototype[f[m]]=Array.prototype[f[m]]);a.defineProperty(g.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),g.prototype.isOperational=!0;var v=0;function _(t){if(!(this instanceof _))return new _(t);c(this,"name","OperationalError"),c(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(c(this,"message",t.message),c(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}g.prototype.toString=function(){var t=Array(4*v+1).join(" "),e="\n"+t+"AggregateError of:\n";v++,t=Array(4*v+1).join(" ");for(var n=0;n<this.length;++n){for(var i=this[n]===this?"[Circular AggregateError]":this[n]+"",o=i.split("\n"),a=0;a<o.length;++a)o[a]=t+o[a];e+=(i=o.join("\n"))+"\n"}return v--,e},l(_,Error);var y=Error.__BluebirdErrorTypes__;y||(y=r({CancellationError:p,TimeoutError:h,OperationalError:_,RejectionError:_,AggregateError:g}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:y,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:i,RangeError:o,CancellationError:y.CancellationError,OperationalError:y.OperationalError,TimeoutError:y.TimeoutError,AggregateError:y.AggregateError,Warning:d}},{"./es5":13,"./util":36}],13:[function(t,e,n){var i=function(){"use strict";return void 0===this}();if(i)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,a={}.toString,r={}.constructor.prototype,s=function(t){var e=[];for(var n in t)o.call(t,n)&&e.push(n);return e};e.exports={isArray:function(t){try{return"[object Array]"===a.call(t)}catch(t){return!1}},keys:s,names:s,defineProperty:function(t,e,n){return t[e]=n.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return r}},isES5:i,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,i){return n(this,t,i,e)},t.filter=function(t,i,o){return n(t,i,o,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,i){var o=t("./util"),a=e.CancellationError,r=o.errorObj,s=t("./catch_filter")(i);function l(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function c(t){this.finallyHandler=t}function u(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function d(){return h.call(this,this.promise._target()._settledValue())}function p(t){if(!u(this,t))return r.e=t,r}function h(t){var o=this.promise,s=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?s.call(o._boundValue()):s.call(o._boundValue(),t);if(l===i)return l;if(void 0!==l){o._setReturnedNonUndefined();var h=n(l,o);if(h instanceof e){if(null!=this.cancelPromise){if(h._isCancelled()){var g=new a("late cancellation observer");return o._attachExtraTrace(g),r.e=g,r}h.isPending()&&h._attachCancellationCallback(new c(this))}return h._then(d,p,void 0,this,void 0)}}}return o.isRejected()?(u(this),r.e=t,r):(u(this),t)}return l.prototype.isFinallyHandler=function(){return 0===this.type},c.prototype._resultCancelled=function(){u(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,i){return"function"!=typeof t?this.then():this._then(n,i,void 0,new l(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,h,h)},e.prototype.tap=function(t){return this._passThrough(t,1,h)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,h);var i,a=new Array(n-1),r=0;for(i=0;i<n-1;++i){var l=arguments[i];if(!o.isObject(l))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+o.classString(l)));a[r++]=l}a.length=r;var c=arguments[i];return this._passThrough(s(a,c,this),1,void 0,h)},l}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,a,r){var s=t("./errors").TypeError,l=t("./util"),c=l.errorObj,u=l.tryCatch,d=[];function p(t,n,o,a){if(r.cancellation()){var s=new e(i),l=this._finallyPromise=new e(i);this._promise=s.lastly((function(){return l})),s._captureStackTrace(),s._setOnCancel(this)}else(this._promise=new e(i))._captureStackTrace();this._stack=a,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(d):d,this._yieldedPromise=null,this._cancellationPhase=!1}l.inherits(p,a),p.prototype._isResolved=function(){return null===this._promise},p.prototype._cleanup=function(){this._promise=this._generator=null,r.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},p.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=u(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=u(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},p.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=u(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},p.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=u(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},p.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},p.prototype.promise=function(){return this._promise},p.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},p.prototype._continue=function(t){var n=this._promise;if(t===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var i=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(i);var a=o(i,this._promise);if(a instanceof e||null!==(a=function(t,n,i){for(var a=0;a<n.length;++a){i._pushContext();var r=u(n[a])(t);if(i._popContext(),r===c){i._pushContext();var s=e.reject(c.e);return i._popContext(),s}var l=o(r,i);if(l instanceof e)return l}return null}(a,this._yieldHandlers,this._promise))){var r=(a=a._target())._bitField;0==(50397184&r)?(this._yieldedPromise=a,a._proxy(this,null)):0!=(33554432&r)?e._async.invoke(this._promiseFulfilled,this,a._value()):0!=(16777216&r)?e._async.invoke(this._promiseRejected,this,a._reason()):this._promiseCancelled()}else this._promiseRejected(new s("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(i))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(t,e){if("function"!=typeof t)throw new s("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,i=p,o=(new Error).stack;return function(){var e=t.apply(this,arguments),a=new i(void 0,void 0,n,o),r=a.promise();return a._generator=e,a._promiseFulfilled(void 0),r}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new s("expecting a function but got "+l.classString(t));d.push(t)},e.spawn=function(t){if(r.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=new p(t,this),o=i.promise();return i._run(e.spawn),o}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,a,r){var s=t("./util");s.canEvaluate,s.tryCatch,s.errorObj,e.join=function(){var t,e=arguments.length-1;e>0&&"function"==typeof arguments[e]&&(t=arguments[e]);var i=[].slice.call(arguments);t&&i.pop();var o=new n(i).promise();return void 0!==t?o.spread(t):o}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,a,r){var s=e._getDomain,l=t("./util"),c=l.tryCatch,u=l.errorObj,d=e._async;function p(t,e,n,i){this.constructor$(t),this._promise._captureStackTrace();var o=s();this._callback=null===o?e:l.domainBind(o,e),this._preservedValues=i===a?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}function h(t,n,o,a){if("function"!=typeof n)return i("expecting a function but got "+l.classString(n));var r=0;if(void 0!==o){if("object"!=typeof o||null===o)return e.reject(new TypeError("options argument must be an object but it is "+l.classString(o)));if("number"!=typeof o.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+l.classString(o.concurrency)));r=o.concurrency}return new p(t,n,r="number"==typeof r&&isFinite(r)&&r>=1?r:0,a).promise()}l.inherits(p,n),p.prototype._asyncInit=function(){this._init$(void 0,-2)},p.prototype._init=function(){},p.prototype._promiseFulfilled=function(t,n){var i=this._values,a=this.length(),s=this._preservedValues,l=this._limit;if(n<0){if(i[n=-1*n-1]=t,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return i[n]=t,this._queue.push(n),!1;null!==s&&(s[n]=t);var d=this._promise,p=this._callback,h=d._boundValue();d._pushContext();var g=c(p).call(h,t,n,a),f=d._popContext();if(r.checkForgottenReturns(g,f,null!==s?"Promise.filter":"Promise.map",d),g===u)return this._reject(g.e),!0;var m=o(g,this._promise);if(m instanceof e){var v=(m=m._target())._bitField;if(0==(50397184&v))return l>=1&&this._inFlight++,i[n]=m,m._proxy(this,-1*(n+1)),!1;if(0==(33554432&v))return 0!=(16777216&v)?(this._reject(m._reason()),!0):(this._cancel(),!0);g=m._value()}i[n]=g}return++this._totalResolved>=a&&(null!==s?this._filter(i,s):this._resolve(i),!0)},p.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var i=t.pop();this._promiseFulfilled(n[i],i)}},p.prototype._filter=function(t,e){for(var n=e.length,i=new Array(n),o=0,a=0;a<n;++a)t[a]&&(i[o++]=e[a]);i.length=o,this._resolve(i)},p.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return h(this,t,e,null)},e.map=function(t,e,n,i){return h(t,e,n,i)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,a){var r=t("./util"),s=r.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+r.classString(t));return function(){var i=new e(n);i._captureStackTrace(),i._pushContext();var o=s(t).apply(this,arguments),r=i._popContext();return a.checkForgottenReturns(o,r,"Promise.method",i),i._resolveFromSyncValue(o),i}},e.attempt=e.try=function(t){if("function"!=typeof t)return o("expecting a function but got "+r.classString(t));var i,l=new e(n);if(l._captureStackTrace(),l._pushContext(),arguments.length>1){a.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],u=arguments[2];i=r.isArray(c)?s(t).apply(u,c):s(t).call(u,c)}else i=s(t)();var d=l._popContext();return a.checkForgottenReturns(i,d,"Promise.try",l),l._resolveFromSyncValue(i),l},e.prototype._resolveFromSyncValue=function(t){t===r.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";var i=t("./util"),o=i.maybeWrapAsError,a=t("./errors").OperationalError,r=t("./es5"),s=/^(?:name|message|stack|cause)$/;function l(t){var e;if(function(t){return t instanceof Error&&r.getPrototypeOf(t)===Error.prototype}(t)){(e=new a(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=r.keys(t),o=0;o<n.length;++o){var l=n[o];s.test(l)||(e[l]=t[l])}return e}return i.markAsOriginatingFromRejection(t),t}e.exports=function(t,e){return function(n,i){if(null!==t){if(n){var a=l(o(n));t._attachExtraTrace(a),t._reject(a)}else if(e){var r=[].slice.call(arguments,1);t._fulfill(r)}else t._fulfill(i);t=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),i=e._async,o=n.tryCatch,a=n.errorObj;function r(t,e){if(!n.isArray(t))return s.call(this,t,e);var r=o(e).apply(this._boundValue(),[null].concat(t));r===a&&i.throwLater(r.e)}function s(t,e){var n=this._boundValue(),r=void 0===t?o(e).call(n,null):o(e).call(n,null,t);r===a&&i.throwLater(r.e)}function l(t,e){if(!t){var n=new Error(t+"");n.cause=t,t=n}var r=o(e).call(this._boundValue(),t);r===a&&i.throwLater(r.e)}e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var n=s;void 0!==e&&Object(e).spread&&(n=r),this._then(n,l,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,n,i){"use strict";n.exports=function(){var i=function(){return new g("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},o=function(){return new M.PromiseInspection(this._target())},a=function(t){return M.reject(new g(t))};function r(){}var s,l={},c=t("./util");s=c.isNode?function(){var t=e.domain;return void 0===t&&(t=null),t}:function(){return null},c.notEnumerableProp(M,"_getDomain",s);var u=t("./es5"),d=t("./async"),p=new d;u.defineProperty(M,"_async",{value:p});var h=t("./errors"),g=M.TypeError=h.TypeError;M.RangeError=h.RangeError;var f=M.CancellationError=h.CancellationError;M.TimeoutError=h.TimeoutError,M.OperationalError=h.OperationalError,M.RejectionError=h.OperationalError,M.AggregateError=h.AggregateError;var m=function(){},v={},_={},y=t("./thenables")(M,m),b=t("./promise_array")(M,m,y,a,r),k=t("./context")(M),w=k.create,S=t("./debuggability")(M,k),x=(S.CapturedTrace,t("./finally")(M,y,_)),E=t("./catch_filter")(_),C=t("./nodeback"),T=c.errorObj,I=c.tryCatch;function M(t){t!==m&&function(t,e){if(null==t||t.constructor!==M)throw new g("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new g("expecting a function but got "+c.classString(e))}(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function P(t){this.promise._resolveCallback(t)}function O(t){this.promise._rejectCallback(t,!1)}function $(t){var e=new M(m);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}return M.prototype.toString=function(){return"[object Promise]"},M.prototype.caught=M.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,i=new Array(e-1),o=0;for(n=0;n<e-1;++n){var r=arguments[n];if(!c.isObject(r))return a("Catch statement predicate: expecting an object but got "+c.classString(r));i[o++]=r}return i.length=o,t=arguments[n],this.then(void 0,E(i,t,this))}return this.then(void 0,t)},M.prototype.reflect=function(){return this._then(o,o,void 0,this,void 0)},M.prototype.then=function(t,e){if(S.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+c.classString(t);arguments.length>1&&(n+=", "+c.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},M.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},M.prototype.spread=function(t){return"function"!=typeof t?a("expecting a function but got "+c.classString(t)):this.all()._then(t,void 0,void 0,v,void 0)},M.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},M.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new b(this).promise()},M.prototype.error=function(t){return this.caught(c.originatesFromRejection,t)},M.getNewLibraryCopy=n.exports,M.is=function(t){return t instanceof M},M.fromNode=M.fromCallback=function(t){var e=new M(m);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=I(t)(C(e,n));return i===T&&e._rejectCallback(i.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},M.all=function(t){return new b(t).promise()},M.cast=function(t){var e=y(t);return e instanceof M||((e=new M(m))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},M.resolve=M.fulfilled=M.cast,M.reject=M.rejected=function(t){var e=new M(m);return e._captureStackTrace(),e._rejectCallback(t,!0),e},M.setScheduler=function(t){if("function"!=typeof t)throw new g("expecting a function but got "+c.classString(t));return p.setScheduler(t)},M.prototype._then=function(t,e,n,i,o){var a=void 0!==o,r=a?o:new M(m),l=this._target(),u=l._bitField;a||(r._propagateFrom(this,3),r._captureStackTrace(),void 0===i&&0!=(2097152&this._bitField)&&(i=0!=(50397184&u)?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,r));var d=s();if(0!=(50397184&u)){var h,g,v=l._settlePromiseCtx;0!=(33554432&u)?(g=l._rejectionHandler0,h=t):0!=(16777216&u)?(g=l._fulfillmentHandler0,h=e,l._unsetRejectionIsUnhandled()):(v=l._settlePromiseLateCancellationObserver,g=new f("late cancellation observer"),l._attachExtraTrace(g),h=e),p.invoke(v,l,{handler:null===d?h:"function"==typeof h&&c.domainBind(d,h),promise:r,receiver:i,value:g})}else l._addCallbacks(t,e,r,i,d);return r},M.prototype._length=function(){return 65535&this._bitField},M.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},M.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},M.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},M.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},M.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},M.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},M.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},M.prototype._isFinal=function(){return(4194304&this._bitField)>0},M.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},M.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},M.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},M.prototype._setAsyncGuaranteed=function(){p.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},M.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==l)return void 0===e&&this._isBound()?this._boundValue():e},M.prototype._promiseAt=function(t){return this[4*t-4+2]},M.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},M.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},M.prototype._boundValue=function(){},M.prototype._migrateCallback0=function(t){t._bitField;var e=t._fulfillmentHandler0,n=t._rejectionHandler0,i=t._promise0,o=t._receiverAt(0);void 0===o&&(o=l),this._addCallbacks(e,n,i,o,null)},M.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),i=t._rejectionHandlerAt(e),o=t._promiseAt(e),a=t._receiverAt(e);void 0===a&&(a=l),this._addCallbacks(n,i,o,a,null)},M.prototype._addCallbacks=function(t,e,n,i,o){var a=this._length();if(a>=65531&&(a=0,this._setLength(0)),0===a)this._promise0=n,this._receiver0=i,"function"==typeof t&&(this._fulfillmentHandler0=null===o?t:c.domainBind(o,t)),"function"==typeof e&&(this._rejectionHandler0=null===o?e:c.domainBind(o,e));else{var r=4*a-4;this[r+2]=n,this[r+3]=i,"function"==typeof t&&(this[r+0]=null===o?t:c.domainBind(o,t)),"function"==typeof e&&(this[r+1]=null===o?e:c.domainBind(o,e))}return this._setLength(a+1),a},M.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},M.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(i(),!1);var n=y(t,this);if(!(n instanceof M))return this._fulfill(t);e&&this._propagateFrom(n,2);var o=n._target();if(o!==this){var a=o._bitField;if(0==(50397184&a)){var r=this._length();r>0&&o._migrateCallback0(this);for(var s=1;s<r;++s)o._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(o)}else if(0!=(33554432&a))this._fulfill(o._value());else if(0!=(16777216&a))this._reject(o._reason());else{var l=new f("late cancellation observer");o._attachExtraTrace(l),this._reject(l)}}else this._reject(i())}},M.prototype._rejectCallback=function(t,e,n){var i=c.ensureErrorObject(t),o=i===t;if(!o&&!n&&S.warnings()){var a="a promise was rejected with a non-error: "+c.classString(t);this._warn(a,!0)}this._attachExtraTrace(i,!!e&&o),this._reject(t)},M.prototype._resolveFromExecutor=function(t){if(t!==m){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,i=this._execute(t,(function(t){e._resolveCallback(t)}),(function(t){e._rejectCallback(t,n)}));n=!1,this._popContext(),void 0!==i&&e._rejectCallback(i,!0)}},M.prototype._settlePromiseFromHandler=function(t,e,n,i){var o=i._bitField;if(0==(65536&o)){var a;i._pushContext(),e===v?n&&"number"==typeof n.length?a=I(t).apply(this._boundValue(),n):(a=T).e=new g("cannot .spread() a non-array: "+c.classString(n)):a=I(t).call(e,n);var r=i._popContext();0==(65536&(o=i._bitField))&&(a===_?i._reject(n):a===T?i._rejectCallback(a.e,!1):(S.checkForgottenReturns(a,r,"",i,this),i._resolveCallback(a)))}},M.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},M.prototype._followee=function(){return this._rejectionHandler0},M.prototype._setFollowee=function(t){this._rejectionHandler0=t},M.prototype._settlePromise=function(t,e,n,i){var a=t instanceof M,s=this._bitField,l=0!=(134217728&s);0!=(65536&s)?(a&&t._invokeInternalOnCancel(),n instanceof x&&n.isFinallyHandler()?(n.cancelPromise=t,I(e).call(n,i)===T&&t._reject(T.e)):e===o?t._fulfill(o.call(n)):n instanceof r?n._promiseCancelled(t):a||t instanceof b?t._cancel():n.cancel()):"function"==typeof e?a?(l&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,i,t)):e.call(n,i,t):n instanceof r?n._isResolved()||(0!=(33554432&s)?n._promiseFulfilled(i,t):n._promiseRejected(i,t)):a&&(l&&t._setAsyncGuaranteed(),0!=(33554432&s)?t._fulfill(i):t._reject(i))},M.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,i=t.receiver,o=t.value;"function"==typeof e?n instanceof M?this._settlePromiseFromHandler(e,i,o,n):e.call(i,o,n):n instanceof M&&n._reject(o)},M.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},M.prototype._settlePromise0=function(t,e,n){var i=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(i,t,o,e)},M.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},M.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=i();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():p.settlePromises(this))}},M.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return p.fatalError(t,c.isNode);(65535&e)>0?p.settlePromises(this):this._ensurePossibleRejectionHandled()}},M.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var i=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),a=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,i,a,e)}},M.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var i=this._rejectionHandlerAt(n),o=this._promiseAt(n),a=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,i,a,e)}},M.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var i=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,i,t),this._fulfillPromises(e,i)}this._setLength(0)}this._clearCancellationData()},M.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},M.defer=M.pending=function(){return S.deprecated("Promise.defer","new Promise"),{promise:new M(m),resolve:P,reject:O}},c.notEnumerableProp(M,"_makeSelfResolutionError",i),t("./method")(M,m,y,a,S),t("./bind")(M,m,y,S),t("./cancel")(M,b,a,S),t("./direct_resolve")(M),t("./synchronous_inspection")(M),t("./join")(M,b,y,m,p,s),M.Promise=M,M.version="3.5.1",t("./map.js")(M,b,a,y,m,S),t("./call_get.js")(M),t("./using.js")(M,a,y,w,m,S),t("./timers.js")(M,m,S),t("./generators.js")(M,a,m,y,r,S),t("./nodeify.js")(M),t("./promisify.js")(M,m),t("./props.js")(M,b,y,a),t("./race.js")(M,m,y,a),t("./reduce.js")(M,b,a,y,m,S),t("./settle.js")(M,b,S),t("./some.js")(M,b,a),t("./filter.js")(M,m),t("./each.js")(M,m),t("./any.js")(M),c.toFastProperties(M),c.toFastProperties(M.prototype),$({a:1}),$({b:2}),$({c:3}),$(1),$((function(){})),$(void 0),$(!1),$(new M(m)),S.setBounds(d.firstLineError,c.lastLineError),M}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,a){var r=t("./util");function s(t){var i=this._promise=new e(n);t instanceof e&&i._propagateFrom(t,3),i._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return r.isArray,r.inherits(s,a),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function t(n,a){var s=i(this._values,this._promise);if(s instanceof e){var l=(s=s._target())._bitField;if(this._values=s,0==(50397184&l))return this._promise._setAsyncGuaranteed(),s._then(t,this._reject,void 0,this,a);if(0==(33554432&l))return 0!=(16777216&l)?this._reject(s._reason()):this._cancel();s=s._value()}if(null!==(s=r.asArray(s)))0!==s.length?this._iterate(s):-5===a?this._resolveEmptyArray():this._resolve(function(t){switch(a){case-2:return[];case-3:return{};case-6:return new Map}}());else{var c=o("expecting an array or an iterable object but got "+r.classString(s)).reason();this._promise._rejectCallback(c,!1)}},s.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,a=!1,r=null,s=0;s<n;++s){var l=i(t[s],o);r=l instanceof e?(l=l._target())._bitField:null,a?null!==r&&l.suppressUnhandledRejections():null!==r?0==(50397184&r)?(l._proxy(this,s),this._values[s]=l):a=0!=(33554432&r)?this._promiseFulfilled(l._value(),s):0!=(16777216&r)?this._promiseRejected(l._reason(),s):this._promiseCancelled(s):a=this._promiseFulfilled(l,s)}a||o._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},s.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(t){return t},s}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){var i={},o=t("./util"),a=t("./nodeback"),r=o.withAppended,s=o.maybeWrapAsError,l=o.canEvaluate,c=t("./errors").TypeError,u={__isPromisified__:!0},d=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),p=function(t){return o.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function h(t){return!d.test(t)}function g(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function f(t,e,n){var i=o.getDataPropertyOrDefault(t,e+n,u);return!!i&&g(i)}function m(t,e,n,i){for(var a=o.inheritedDataKeys(t),r=[],s=0;s<a.length;++s){var l=a[s],u=t[l],d=i===p||p(l);"function"!=typeof u||g(u)||f(t,l,e)||!i(l,u,t,d)||r.push(l,u)}return function(t,e,n){for(var i=0;i<t.length;i+=2){var o=t[i];if(n.test(o))for(var a=o.replace(n,""),r=0;r<t.length;r+=2)if(t[r]===a)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}(r,e,n),r}var v=l?void 0:function(t,l,c,u,d,p){var h=function(){return this}(),g=t;function f(){var o=l;l===i&&(o=this);var c=new e(n);c._captureStackTrace();var u="string"==typeof g&&this!==h?this[g]:t,d=a(c,p);try{u.apply(o,r(arguments,d))}catch(t){c._rejectCallback(s(t),!0,!0)}return c._isFateSealed()||c._setAsyncGuaranteed(),c}return"string"==typeof g&&(t=u),o.notEnumerableProp(f,"__isPromisified__",!0),f};function _(t,e,n,a,r){for(var s=new RegExp(function(t){return t.replace(/([$])/,"\\$")}(e)+"$"),l=m(t,e,s,n),c=0,u=l.length;c<u;c+=2){var d=l[c],p=l[c+1],h=d+e;if(a===v)t[h]=v(d,i,d,p,e,r);else{var g=a(p,(function(){return v(d,i,d,p,e,r)}));o.notEnumerableProp(g,"__isPromisified__",!0),t[h]=g}}return o.toFastProperties(t),t}e.promisify=function(t,e){if("function"!=typeof t)throw new c("expecting a function but got "+o.classString(t));if(g(t))return t;var n=void 0===(e=Object(e)).context?i:e.context,a=!!e.multiArgs,r=function(t,e,n){return v(t,e,void 0,t,null,a)}(t,n);return o.copyDescriptors(t,r,h),r},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(e=Object(e)).multiArgs,i=e.suffix;"string"!=typeof i&&(i="Async");var a=e.filter;"function"!=typeof a&&(a=p);var r=e.promisifier;if("function"!=typeof r&&(r=v),!o.isIdentifier(i))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=o.inheritedDataKeys(t),l=0;l<s.length;++l){var u=t[s[l]];"constructor"!==s[l]&&o.isClass(u)&&(_(u.prototype,i,a,r,n),_(u,i,a,r,n))}return _(t,i,a,r,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,i,o){var a,r=t("./util"),s=r.isObject,l=t("./es5");"function"==typeof Map&&(a=Map);var c=function(){var t=0,e=0;function n(n,i){this[t]=n,this[t+e]=i,t++}return function(i){e=i.size,t=0;var o=new Array(2*i.size);return i.forEach(n,o),o}}();function u(t){var e,n=!1;if(void 0!==a&&t instanceof a)e=c(t),n=!0;else{var i=l.keys(t),o=i.length;e=new Array(2*o);for(var r=0;r<o;++r){var s=i[r];e[r]=t[s],e[r+o]=s}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function d(t){var n,a=i(t);return s(a)?(n=a instanceof e?a._then(e.props,void 0,void 0,void 0,void 0):new u(a).promise(),a instanceof e&&n._propagateFrom(a,2),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}r.inherits(u,n),u.prototype._init=function(){},u.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(t){for(var e=new a,n=t.length/2|0,i=0;i<n;++i){var o=t[n+i],r=t[i];e.set(o,r)}return e}(this._values);else{n={};for(var i=this.length(),o=0,r=this.length();o<r;++o)n[this._values[o+i]]=this._values[o]}return this._resolve(n),!0}return!1},u.prototype.shouldCopyValues=function(){return!1},u.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return d(this)},e.props=function(t){return d(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function i(t){this._capacity=t,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},i.prototype.push=function(t,e,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var o=this._front+i-3;this._checkCapacity(i);var a=this._capacity-1;this[o+0&a]=t,this[o+1&a]=e,this[o+2&a]=n,this._length=i},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,n,i,o){for(var a=0;a<o;++a)n[a+i]=t[a+0],t[a+0]=void 0}(this,0,this,e,this._front+this._length&e-1)},e.exports=i},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,i,o){var a=t("./util"),r=function(t){return t.then((function(e){return s(e,t)}))};function s(t,s){var l=i(t);if(l instanceof e)return r(l);if(null===(t=a.asArray(t)))return o("expecting an array or an iterable object but got "+a.classString(t));var c=new e(n);void 0!==s&&c._propagateFrom(s,3);for(var u=c._fulfill,d=c._reject,p=0,h=t.length;p<h;++p){var g=t[p];(void 0!==g||p in t)&&e.cast(g)._then(u,d,void 0,c,null)}return c}e.race=function(t){return s(t,void 0)},e.prototype.race=function(){return s(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,a,r){var s=e._getDomain,l=t("./util"),c=l.tryCatch;function u(t,n,i,o){this.constructor$(t);var r=s();this._fn=null===r?n:l.domainBind(r,n),void 0!==i&&(i=e.resolve(i))._attachCancellationCallback(this),this._initialValue=i,this._currentCancellable=null,this._eachValues=o===a?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function d(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function p(t,e,n,o){return"function"!=typeof e?i("expecting a function but got "+l.classString(e)):new u(t,e,n,o).promise()}function h(t){this.accum=t,this.array._gotAccum(t);var n=o(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(g,void 0,void 0,this,void 0)):g.call(this,n)}function g(t){var n,i=this.array,o=i._promise,a=c(i._fn);o._pushContext(),(n=void 0!==i._eachValues?a.call(o._boundValue(),t,this.index,this.length):a.call(o._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(i._currentCancellable=n);var s=o._popContext();return r.checkForgottenReturns(n,s,void 0!==i._eachValues?"Promise.each":"Promise.reduce",o),n}l.inherits(u,n),u.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==a&&this._eachValues.push(t)},u.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},u.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},u.prototype._iterate=function(t){var n,i;this._values=t;var o=t.length;if(void 0!==this._initialValue?(n=this._initialValue,i=0):(n=e.resolve(t[0]),i=1),this._currentCancellable=n,!n.isRejected())for(;i<o;++i){var a={accum:null,value:t[i],index:i,length:o,array:this};n=n._then(h,void 0,void 0,a,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(d,d,void 0,n,this)},e.prototype.reduce=function(t,e){return p(this,t,e,null)},e.reduce=function(t,e,n,i){return p(t,e,n,i)}}},{"./util":36}],29:[function(t,o,a){"use strict";var r,s=t("./util"),l=s.getNativePromise();if(s.isNode&&"undefined"==typeof MutationObserver){var c=n.setImmediate,u=e.nextTick;r=s.isRecentNode?function(t){c.call(n,t)}:function(t){u.call(e,t)}}else if("function"==typeof l&&"function"==typeof l.resolve){var d=l.resolve();r=function(t){d.then(t)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?void 0!==i?function(t){i(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var t=document.createElement("div"),e={attributes:!0},n=!1,i=document.createElement("div");return new MutationObserver((function(){t.classList.toggle("foo"),n=!1})).observe(i,e),function(o){var a=new MutationObserver((function(){a.disconnect(),o()}));a.observe(t,e),n||(n=!0,i.classList.toggle("foo"))}}();o.exports=r},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,i){var o=e.PromiseInspection;function a(t){this.constructor$(t)}t("./util").inherits(a,n),a.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseFulfilled=function(t,e){var n=new o;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},a.prototype._promiseRejected=function(t,e){var n=new o;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return i.deprecated(".settle()",".reflect()"),new a(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,i){var o=t("./util"),a=t("./errors").RangeError,r=t("./errors").AggregateError,s=o.isArray,l={};function c(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function u(t,e){if((0|e)!==e||e<0)return i("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new c(t),o=n.promise();return n.setHowMany(e),n.init(),o}o.inherits(c,n),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=s(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(t){this._howMany=t},c.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new r,e=this.length();e<this._values.length;++e)this._values[e]!==l&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(t){this._values.push(t)},c.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return u(t,e)},e.prototype.some=function(t){return u(this,t)},e._SomePromiseArray=c}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},a=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},r=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return r.call(this._target())},t.prototype.isRejected=function(){return a.call(this._target())},t.prototype.isFulfilled=function(){return o.call(this._target())},t.prototype.isResolved=function(){return s.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),i.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){var i=t("./util"),o=i.errorObj,a=i.isObject,r={}.hasOwnProperty;return function(t,s){if(a(t)){if(t instanceof e)return t;var l=function(t){try{return function(t){return t.then}(t)}catch(t){return o.e=t,o}}(t);if(l===o){s&&s._pushContext();var c=e.reject(l.e);return s&&s._popContext(),c}if("function"==typeof l)return function(t){try{return r.call(t,"_promise0")}catch(t){return!1}}(t)?(c=new e(n),t._then(c._fulfill,c._reject,void 0,c,null),c):function(t,a,r){var s=new e(n),l=s;r&&r._pushContext(),s._captureStackTrace(),r&&r._popContext();var c=!0,u=i.tryCatch(a).call(t,(function(t){s&&(s._resolveCallback(t),s=null)}),(function(t){s&&(s._rejectCallback(t,c,!0),s=null)}));return c=!1,s&&u===o&&(s._rejectCallback(u.e,!0,!0),s=null),l}(t,l,s)}return t}}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,i){var o=t("./util"),a=e.TimeoutError;function r(t){this.handle=t}r.prototype._resultCancelled=function(){clearTimeout(this.handle)};var s=function(t){return l(+this).thenReturn(t)},l=e.delay=function(t,o){var a,l;return void 0!==o?(a=e.resolve(o)._then(s,null,null,t,void 0),i.cancellation()&&o instanceof e&&a._setOnCancel(o)):(a=new e(n),l=setTimeout((function(){a._fulfill()}),+t),i.cancellation()&&a._setOnCancel(new r(l)),a._captureStackTrace()),a._setAsyncGuaranteed(),a};function c(t){return clearTimeout(this.handle),t}function u(t){throw clearTimeout(this.handle),t}e.prototype.delay=function(t){return l(t,this)},e.prototype.timeout=function(t,e){var n,s;t=+t;var l=new r(setTimeout((function(){n.isPending()&&function(t,e,n){var i;i="string"!=typeof e?e instanceof Error?e:new a("operation timed out"):new a(e),o.markAsOriginatingFromRejection(i),t._attachExtraTrace(i),t._reject(i),null!=n&&n.cancel()}(n,e,s)}),t));return i.cancellation()?(s=this.then(),(n=s._then(c,u,void 0,l,void 0))._setOnCancel(l)):n=this._then(c,u,void 0,l,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,i,o,a,r){var s=t("./util"),l=t("./errors").TypeError,c=t("./util").inherits,u=s.errorObj,d=s.tryCatch,p={};function h(t){setTimeout((function(){throw t}),0)}function g(t,n){var o=0,r=t.length,s=new e(a);return function a(){if(o>=r)return s._fulfill();var l=function(t){var e=i(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(t[o++]);if(l instanceof e&&l._isDisposable()){try{l=i(l._getDisposer().tryDispose(n),t.promise)}catch(t){return h(t)}if(l instanceof e)return l._then(a,h,null,null,null)}a()}(),s}function f(t,e,n){this._data=t,this._promise=e,this._context=n}function m(t,e,n){this.constructor$(t,e,n)}function v(t){return f.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function _(t){this.length=t,this.promise=null,this[t-1]=null}f.prototype.data=function(){return this._data},f.prototype.promise=function(){return this._promise},f.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():p},f.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var i=e!==p?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,i},f.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},c(m,f),m.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},_.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var i=this[n];i instanceof e&&i.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var o,a=arguments[t-1];if("function"!=typeof a)return n("expecting a function but got "+s.classString(a));var l=!0;2===t&&Array.isArray(arguments[0])?(t=(o=arguments[0]).length,l=!1):(o=arguments,t--);for(var c=new _(t),p=0;p<t;++p){var h=o[p];if(f.isDisposer(h)){var m=h;(h=h.promise())._setDisposable(m)}else{var y=i(h);y instanceof e&&(h=y._then(v,null,null,{resources:c,index:p},void 0))}c[p]=h}var b=new Array(c.length);for(p=0;p<b.length;++p)b[p]=e.resolve(c[p]).reflect();var k=e.all(b).then((function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return u.e=n.error(),u;if(!n.isFulfilled())return void k.cancel();t[e]=n.value()}w._pushContext(),a=d(a);var i=l?a.apply(void 0,t):a(t),o=w._popContext();return r.checkForgottenReturns(i,o,"Promise.using",w),i})),w=k.lastly((function(){var t=new e.PromiseInspection(k);return g(c,t)}));return c.promise=w,w._setOnCancel(c),w},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new m(t,this,o());throw new l}}},{"./errors":12,"./util":36}],36:[function(t,i,o){"use strict";var a,r=t("./es5"),s="undefined"==typeof navigator,l={e:{}},c="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:void 0!==this?this:null;function u(){try{var t=a;return a=null,t.apply(this,arguments)}catch(t){return l.e=t,l}}function d(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function p(t,e,n){if(d(t))return t;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return r.defineProperty(t,e,i),t}var h=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(r.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var i=[],o=Object.create(null);null!=t&&!e(t);){var a;try{a=n(t)}catch(t){return i}for(var s=0;s<a.length;++s){var l=a[s];if(!o[l]){o[l]=!0;var c=Object.getOwnPropertyDescriptor(t,l);null!=c&&null==c.get&&null==c.set&&i.push(l)}}t=r.getPrototypeOf(t)}return i}}var i={}.hasOwnProperty;return function(n){if(e(n))return[];var o=[];t:for(var a in n)if(i.call(n,a))o.push(a);else{for(var r=0;r<t.length;++r)if(i.call(t[r],a))continue t;o.push(a)}return o}}(),g=/this\s*\.\s*\S+\s*=/,f=/^[a-z$_][a-z$_0-9]*$/i;function m(t){try{return t+""}catch(t){return"[no string representation]"}}function v(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function _(t){return v(t)&&r.propertyIsWritable(t,"stack")}var y="stack"in new Error?function(t){return _(t)?t:new Error(m(t))}:function(t){if(_(t))return t;try{throw new Error(m(t))}catch(t){return t}};function b(t){return{}.toString.call(t)}var k=function(t){return r.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var w="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],i=t[Symbol.iterator]();!(e=i.next()).done;)n.push(e.value);return n};k=function(t){return r.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?w(t):null}}var S=void 0!==e&&"[object process]"===b(e).toLowerCase(),x=void 0!==e&&void 0!==e.env,E={isClass:function(t){try{if("function"==typeof t){var e=r.names(t.prototype),n=r.isES5&&e.length>1,i=e.length>0&&!(1===e.length&&"constructor"===e[0]),o=g.test(t+"")&&r.names(t).length>0;if(n||i||o)return!0}return!1}catch(t){return!1}},isIdentifier:function(t){return f.test(t)},inheritedDataKeys:h,getDataPropertyOrDefault:function(t,e,n){if(!r.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var i=Object.getOwnPropertyDescriptor(t,e);return null!=i?null==i.get&&null==i.set?i.value:n:void 0},thrower:function(t){throw t},isArray:r.isArray,asArray:k,notEnumerableProp:p,isPrimitive:d,isObject:function(t){return"function"==typeof t||"object"==typeof t&&null!==t},isError:v,canEvaluate:s,errorObj:l,tryCatch:function(t){return a=t,u},inherits:function(t,e){var n={}.hasOwnProperty;function i(){for(var i in this.constructor=t,this.constructor$=e,e.prototype)n.call(e.prototype,i)&&"$"!==i.charAt(i.length-1)&&(this[i+"$"]=e.prototype[i])}return i.prototype=e.prototype,t.prototype=new i,t.prototype},withAppended:function(t,e){var n,i=t.length,o=new Array(i+1);for(n=0;n<i;++n)o[n]=t[n];return o[n]=e,o},maybeWrapAsError:function(t){return d(t)?new Error(m(t)):t},toFastProperties:function(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t},filledRange:function(t,e,n){for(var i=new Array(t),o=0;o<t;++o)i[o]=e+o+n;return i},toString:m,canAttachTrace:_,ensureErrorObject:y,originatesFromRejection:function(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)},markAsOriginatingFromRejection:function(t){try{p(t,"isOperational",!0)}catch(t){}},classString:b,copyDescriptors:function(t,e,n){for(var i=r.names(t),o=0;o<i.length;++o){var a=i[o];if(n(a))try{r.defineProperty(e,a,r.getDescriptor(t,a))}catch(t){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:S,hasEnvVariables:x,env:function(t){return x?e.env[t]:void 0},global:c,getNativePromise:function(){if("function"==typeof Promise)try{var t=new Promise((function(){}));if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}},domainBind:function(t,e){return t.bind(e)}};E.isRecentNode=E.isNode&&function(){var t=e.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),E.isNode&&E.toFastProperties(e);try{throw new Error}catch(t){E.lastLineError=t}i.exports=E},{"./es5":13}]},{},[4])(4),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,n(4),n(0),n(11).setImmediate)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(!e.eol&&t)for(var n=0,i=t.length;n<i;n++)if("\r"===t[n]){if("\n"===t[n+1]){e.eol="\r\n";break}if(t[n+1]){e.eol="\r";break}}else if("\n"===t[n]){e.eol="\n";break}return e.eol||"\n"}},function(t,e,n){var i=n(65),o=n(73);t.exports=function(t,e){var n=o(t,e);return i(n)?n:void 0}},function(t,e,n){var i=n(19).Symbol;t.exports=i},function(t,e,n){var i=n(67),o="object"==typeof self&&self&&self.Object===Object&&self,a=i||o||Function("return this")();t.exports=a},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){var i=n(30),o=n(76);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==i(t)}},function(t,e,n){"use strict";(function(e,i){var o=n(6);t.exports=y;var a,r=n(37);y.ReadableState=_,n(12).EventEmitter;var s=function(t,e){return t.listeners(e).length},l=n(24),c=n(7).Buffer,u=e.Uint8Array||function(){},d=n(5);d.inherits=n(2);var p=n(41),h=void 0;h=p&&p.debuglog?p.debuglog("stream"):function(){};var g,f=n(42),m=n(25);d.inherits(y,l);var v=["error","close","destroy","pause","resume"];function _(t,e){t=t||{};var i=e instanceof(a=a||n(1));this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var o=t.highWaterMark,r=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:i&&(r||0===r)?r:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(g||(g=n(26).StringDecoder),this.decoder=new g(t.encoding),this.encoding=t.encoding)}function y(t){if(a=a||n(1),!(this instanceof y))return new y(t);this._readableState=new _(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),l.call(this)}function b(t,e,n,i,o){var a,r=t._readableState;return null===e?(r.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,x(t)}}(t,r)):(o||(a=function(t,e){var n;return function(t){return c.isBuffer(t)||t instanceof u}(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(r,e)),a?t.emit("error",a):r.objectMode||e&&e.length>0?("string"==typeof e||r.objectMode||Object.getPrototypeOf(e)===c.prototype||(e=function(t){return c.from(t)}(e)),i?r.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):k(t,r,e,!0):r.ended?t.emit("error",new Error("stream.push() after EOF")):(r.reading=!1,r.decoder&&!n?(e=r.decoder.write(e),r.objectMode||0!==e.length?k(t,r,e,!1):C(t,r)):k(t,r,e,!1))):i||(r.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(r)}function k(t,e,n,i){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&x(t)),C(t,e)}Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(t,e){this.push(null),e(t)},y.prototype.push=function(t,e){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof t&&((e=e||i.defaultEncoding)!==i.encoding&&(t=c.from(t,e),e=""),n=!0),b(this,t,e,!1,n)},y.prototype.unshift=function(t){return b(this,t,null,!0,!1)},y.prototype.isPaused=function(){return!1===this._readableState.flowing},y.prototype.setEncoding=function(t){return g||(g=n(26).StringDecoder),this._readableState.decoder=new g(t),this._readableState.encoding=t,this};var w=8388608;function S(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=w?t=w:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function x(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(h("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?o.nextTick(E,t):E(t))}function E(t){h("emit readable"),t.emit("readable"),P(t)}function C(t,e){e.readingMore||(e.readingMore=!0,o.nextTick(T,t,e))}function T(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(h("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function I(t){h("readable nexttick read 0"),t.read(0)}function M(t,e){e.reading||(h("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),P(t),e.flowing&&!e.reading&&t.read(0)}function P(t){var e=t._readableState;for(h("flow",e.flowing);e.flowing&&null!==t.read(););}function O(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var i;return t<e.head.data.length?(i=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):i=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,i=1,o=n.data;for(t-=o.length;n=n.next;){var a=n.data,r=t>a.length?a.length:t;if(r===a.length?o+=a:o+=a.slice(0,t),0==(t-=r)){r===a.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=a.slice(r));break}++i}return e.length-=i,o}(t,e):function(t,e){var n=c.allocUnsafe(t),i=e.head,o=1;for(i.data.copy(n),t-=i.data.length;i=i.next;){var a=i.data,r=t>a.length?a.length:t;if(a.copy(n,n.length-t,0,r),0==(t-=r)){r===a.length?(++o,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=a.slice(r));break}++o}return e.length-=o,n}(t,e),i}(t,e.buffer,e.decoder),n);var n}function $(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,o.nextTick(A,e,t))}function A(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function R(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}y.prototype.read=function(t){h("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return h("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?$(this):x(this),null;if(0===(t=S(t,e))&&e.ended)return 0===e.length&&$(this),null;var i,o=e.needReadable;return h("need readable",o),(0===e.length||e.length-t<e.highWaterMark)&&h("length less than watermark",o=!0),e.ended||e.reading?h("reading or ended",o=!1):o&&(h("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=S(n,e))),null===(i=t>0?O(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&$(this)),null!==i&&this.emit("data",i),i},y.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},y.prototype.pipe=function(t,e){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=t;break;case 1:a.pipes=[a.pipes,t];break;default:a.pipes.push(t)}a.pipesCount+=1,h("pipe count=%d opts=%j",a.pipesCount,e);var l=e&&!1===e.end||t===i.stdout||t===i.stderr?_:c;function c(){h("onend"),t.end()}a.endEmitted?o.nextTick(l):n.once("end",l),t.on("unpipe",(function e(i,o){h("onunpipe"),i===n&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,h("cleanup"),t.removeListener("close",m),t.removeListener("finish",v),t.removeListener("drain",u),t.removeListener("error",f),t.removeListener("unpipe",e),n.removeListener("end",c),n.removeListener("end",_),n.removeListener("data",g),d=!0,!a.awaitDrain||t._writableState&&!t._writableState.needDrain||u())}));var u=function(t){return function(){var e=t._readableState;h("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,P(t))}}(n);t.on("drain",u);var d=!1,p=!1;function g(e){h("ondata"),p=!1,!1!==t.write(e)||p||((1===a.pipesCount&&a.pipes===t||a.pipesCount>1&&-1!==R(a.pipes,t))&&!d&&(h("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function f(e){h("onerror",e),_(),t.removeListener("error",f),0===s(t,"error")&&t.emit("error",e)}function m(){t.removeListener("finish",v),_()}function v(){h("onfinish"),t.removeListener("close",m),_()}function _(){h("unpipe"),n.unpipe(t)}return n.on("data",g),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?r(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",f),t.once("close",m),t.once("finish",v),t.emit("pipe",n),a.flowing||(h("pipe resume"),n.resume()),t},y.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var i=e.pipes,o=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var a=0;a<o;a++)i[a].emit("unpipe",this,n);return this}var r=R(e.pipes,t);return-1===r||(e.pipes.splice(r,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},y.prototype.on=function(t,e){var n=l.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&x(this):o.nextTick(I,this))}return n},y.prototype.addListener=y.prototype.on,y.prototype.resume=function(){var t=this._readableState;return t.flowing||(h("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,o.nextTick(M,t,e))}(this,t)),this},y.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},y.prototype.wrap=function(t){var e=this,n=this._readableState,i=!1;for(var o in t.on("end",(function(){if(h("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(o){h("wrapped data"),n.decoder&&(o=n.decoder.write(o)),(!n.objectMode||null!=o)&&(n.objectMode||o&&o.length)&&(e.push(o)||(i=!0,t.pause()))})),t)void 0===this[o]&&"function"==typeof t[o]&&(this[o]=function(e){return function(){return t[e].apply(t,arguments)}}(o));for(var a=0;a<v.length;a++)t.on(v[a],this.emit.bind(this,v[a]));return this._read=function(e){h("wrapped _read",e),i&&(i=!1,t.resume())},this},Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),y._fromList=O}).call(this,n(0),n(4))},function(t,e,n){t.exports=n(12).EventEmitter},function(t,e,n){"use strict";var i=n(6);function o(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,a=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return a||r?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||i.nextTick(o,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(i.nextTick(o,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";var i=n(7).Buffer,o=i.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(i.isEncoding===o||!o(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=c,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=u,this.end=d,e=3;break;default:return this.write=p,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(e)}function r(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function s(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,""}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function u(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function d(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function p(t){return t.toString(this.encoding)}function h(t){return t&&t.length?this.write(t):""}e.StringDecoder=a,a.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},a.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e},a.prototype.text=function(t,e){var n=function(t,e,n){var i=e.length-1;if(i<n)return 0;var o=r(e[i]);return o>=0?(o>0&&(t.lastNeed=o-1),o):--i<n||-2===o?0:(o=r(e[i]))>=0?(o>0&&(t.lastNeed=o-2),o):--i<n||-2===o?0:(o=r(e[i]))>=0?(o>0&&(2===o?o=0:t.lastNeed=o-3),o):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var i=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)},a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";t.exports=a;var i=n(1),o=n(5);function a(t){if(!(this instanceof a))return new a(t);i.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),i(t);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",r)}function r(){var t=this;"function"==typeof this._flush?this._flush((function(e,n){s(t,e,n)})):s(this,null,null)}function s(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}o.inherits=n(2),o.inherits(a,i),a.prototype.push=function(t,e){return this._transformState.needTransform=!1,i.prototype.push.call(this,t,e)},a.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(t,e,n){var i=this._transformState;if(i.writecb=n,i.writechunk=t,i.writeencoding=e,!i.transforming){var o=this._readableState;(i.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},a.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},a.prototype._destroy=function(t,e){var n=this;i.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.bufFromString=function(e){var n=t.byteLength(e),i=t.allocUnsafe?t.allocUnsafe(n):new t(n);return i.write(e),i},e.emptyBuffer=function(){return t.allocUnsafe?t.allocUnsafe(0):new t(0)},e.filterArray=function(t,e){for(var n=[],i=0;i<t.length;i++)e.indexOf(i)>-1&&n.push(t[i]);return n},e.trimLeft=String.prototype.trimLeft?function(t){return t.trimLeft()}:function(t){return t.replace(/^\s+/,"")},e.trimRight=String.prototype.trimRight?function(t){return t.trimRight()}:function(t){return t.replace(/\s+$/,"")}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,n,i){var o=t.call(this,"Error: "+e+". JSON Line number: "+n+(i?" near: "+i:""))||this;return o.err=e,o.line=n,o.extra=i,o.name="CSV Parse Error",o}return i(e,t),e.column_mismatched=function(t,n){return new e("column_mismatched",t,n)},e.unclosed_quote=function(t,n){return new e("unclosed_quote",t,n)},e.fromJSON=function(t){return new e(t.err,t.line,t.extra)},e.prototype.toJSON=function(){return{err:this.err,line:this.line,extra:this.extra}},e}(Error);e.default=o},function(t,e,n){var i=n(18),o=n(68),a=n(69),r=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":r&&r in Object(t)?o(t):a(t)}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){t.exports=n(33)},function(t,e,n){"use strict";var i=n(34),o=function(t,e){return new i.Converter(t,e)};o.csv=o,o.Converter=i.Converter,t.exports=o},function(t,e,n){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(36),r=n(50),s=n(51),l=o(n(15)),c=n(52),u=n(105),d=function(e){function o(n,i){void 0===i&&(i={});var o=e.call(this,i)||this;return o.options=i,o.params=r.mergeParams(n),o.runtime=s.initParseRuntime(o),o.result=new u.Result(o),o.processor=new c.ProcessorLocal(o),o.once("error",(function(e){t((function(){o.result.processError(e),o.emit("done",e)}))})),o.once("done",(function(){o.processor.destroy()})),o}return i(o,e),o.prototype.preRawData=function(t){return this.runtime.preRawDataHook=t,this},o.prototype.preFileLine=function(t){return this.runtime.preFileLineHook=t,this},o.prototype.subscribe=function(t,e,n){return this.parseRuntime.subscribe={onNext:t,onError:e,onCompleted:n},this},o.prototype.fromFile=function(t,e){var i=this,o=n(!function(){var t=new Error("Cannot find module 'fs'");throw t.code="MODULE_NOT_FOUND",t}());return o.exists(t,(function(n){n?o.createReadStream(t,e).pipe(i):i.emit("error",new Error("File does not exist. Check to make sure the file path to your csv is correct."))})),this},o.prototype.fromStream=function(t){return t.pipe(this),this},o.prototype.fromString=function(t){t.toString();var e=new a.Readable,n=0;return e._read=function(e){if(n>=t.length)this.push(null);else{var i=t.substr(n,e);this.push(i),n+=e}},this.fromStream(e)},o.prototype.then=function(t,e){var n=this;return new l.default((function(i,o){n.parseRuntime.then={onfulfilled:function(e){i(t?t(e):e)},onrejected:function(t){e?i(e(t)):o(t)}}}))},Object.defineProperty(o.prototype,"parseParam",{get:function(){return this.params},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"parseRuntime",{get:function(){return this.runtime},enumerable:!0,configurable:!0}),o.prototype._transform=function(t,e,n){var i=this;this.processor.process(t).then((function(t){if(t.length>0)return i.runtime.started=!0,i.result.processResult(t)})).then((function(){i.emit("drained"),n()}),(function(t){i.runtime.hasError=!0,i.runtime.error=t,i.emit("error",t),n()}))},o.prototype._flush=function(t){var e=this;this.processor.flush().then((function(t){if(t.length>0)return e.result.processResult(t)})).then((function(){e.processEnd(t)}),(function(n){e.emit("error",n),t()}))},o.prototype.processEnd=function(t){this.result.endProcess(),this.emit("done"),t()},Object.defineProperty(o.prototype,"parsedLineNumber",{get:function(){return this.runtime.parsedLineNumber},enumerable:!0,configurable:!0}),o}(a.Transform);e.Converter=d}).call(this,n(11).setImmediate)},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,o=1,a={},r=!1,s=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){u(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&u(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),i=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){u(t.data)},i=function(e){t.port2.postMessage(e)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var t=s.documentElement;i=function(e){var n=s.createElement("script");n.onreadystatechange=function(){u(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():i=function(t){setTimeout(u,0,t)},l.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return a[o]=r,i(o),o++},l.clearImmediate=c}function c(t){delete a[t]}function u(t){if(r)setTimeout(u,0,t);else{var e=a[t];if(e){r=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{c(t),r=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(0),n(4))},function(t,e,n){t.exports=o;var i=n(12).EventEmitter;function o(){i.call(this)}n(2)(o,i),o.Readable=n(13),o.Writable=n(46),o.Duplex=n(47),o.Transform=n(48),o.PassThrough=n(49),o.Stream=o,o.prototype.pipe=function(t,e){var n=this;function o(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",o),t.on("drain",a),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",l));var r=!1;function s(){r||(r=!0,t.end())}function l(){r||(r=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(u(),0===i.listenerCount(this,"error"))throw t}function u(){n.removeListener("data",o),t.removeListener("drain",a),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",c),t.removeListener("error",c),n.removeListener("end",u),n.removeListener("close",u),t.removeListener("close",u)}return n.on("error",c),t.on("error",c),n.on("end",u),n.on("close",u),t.on("close",u),t.emit("pipe",n),t}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],i=e[1];return 3*(n+i)/4-i},e.toByteArray=function(t){for(var e,n=c(t),i=n[0],r=n[1],s=new a(3*(i+r)/4-r),l=0,u=r>0?i-4:i,d=0;d<u;d+=4)e=o[t.charCodeAt(d)]<<18|o[t.charCodeAt(d+1)]<<12|o[t.charCodeAt(d+2)]<<6|o[t.charCodeAt(d+3)],s[l++]=e>>16&255,s[l++]=e>>8&255,s[l++]=255&e;return 2===r&&(e=o[t.charCodeAt(d)]<<2|o[t.charCodeAt(d+1)]>>4,s[l++]=255&e),1===r&&(e=o[t.charCodeAt(d)]<<10|o[t.charCodeAt(d+1)]<<4|o[t.charCodeAt(d+2)]>>2,s[l++]=e>>8&255,s[l++]=255&e),s},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,a=[],r=0,s=n-o;r<s;r+=16383)a.push(d(t,r,r+16383>s?s:r+16383));return 1===o?(e=t[n-1],a.push(i[e>>2]+i[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),a.join("")};for(var i=[],o=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=r.length;s<l;++s)i[s]=r[s],o[r.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function u(t){return i[t>>18&63]+i[t>>12&63]+i[t>>6&63]+i[63&t]}function d(t,e,n){for(var i,o=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(u(i));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,i,o){var a,r,s=8*o-i-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?o-1:0,p=n?-1:1,h=t[e+d];for(d+=p,a=h&(1<<-u)-1,h>>=-u,u+=s;u>0;a=256*a+t[e+d],d+=p,u-=8);for(r=a&(1<<-u)-1,a>>=-u,u+=i;u>0;r=256*r+t[e+d],d+=p,u-=8);if(0===a)a=1-c;else{if(a===l)return r?NaN:1/0*(h?-1:1);r+=Math.pow(2,i),a-=c}return(h?-1:1)*r*Math.pow(2,a-i)},e.write=function(t,e,n,i,o,a){var r,s,l,c=8*a-o-1,u=(1<<c)-1,d=u>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=i?0:a-1,g=i?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,r=u):(r=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-r))<1&&(r--,l*=2),(e+=r+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=u?(s=0,r=u):r+d>=1?(s=(e*l-1)*Math.pow(2,o),r+=d):(s=e*Math.pow(2,d-1)*Math.pow(2,o),r=0));o>=8;t[n+h]=255&s,h+=g,s/=256,o-=8);for(r=r<<o|s,c+=o;c>0;t[n+h]=255&r,h+=g,r/=256,c-=8);t[n+h-g]|=128*f}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){},function(t,e,n){"use strict";var i=n(7).Buffer,o=n(43);function a(t,e,n){t.copy(e,n)}t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var e=i.allocUnsafe(t>>>0),n=this.head,o=0;n;)a(n.data,e,o),o+=n.data.length,n=n.next;return e},t}(),o&&o.inspect&&o.inspect.custom&&(t.exports.prototype[o.inspect.custom]=function(){var t=o.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),i=!0}return t.apply(this,arguments)}}}).call(this,n(0))},function(t,e,n){"use strict";t.exports=a;var i=n(27),o=n(5);function a(t){if(!(this instanceof a))return new a(t);i.call(this,t)}o.inherits=n(2),o.inherits(a,i),a.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(14)},function(t,e,n){t.exports=n(1)},function(t,e,n){t.exports=n(13).Transform},function(t,e,n){t.exports=n(13).PassThrough},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mergeParams=function(t){var e={delimiter:",",ignoreColumns:void 0,includeColumns:void 0,quote:'"',trim:!0,checkType:!1,ignoreEmpty:!1,noheader:!1,headers:void 0,flatKeys:!1,maxRowLength:0,checkColumn:!1,escape:'"',colParser:{},eol:void 0,alwaysSplitAtEOL:!1,output:"json",nullObject:!1,downstreamFormat:"line",needEmitAll:!0};for(var n in t||(t={}),t)t.hasOwnProperty(n)&&(Array.isArray(t[n])?e[n]=[].concat(t[n]):e[n]=t[n]);return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initParseRuntime=function(t){var e=t.parseParam,n={needProcessIgnoreColumn:!1,needProcessIncludeColumn:!1,selectedColumns:void 0,ended:!1,hasError:!1,error:void 0,delimiter:t.parseParam.delimiter,eol:t.parseParam.eol,columnConv:[],headerType:[],headerTitle:[],headerFlag:[],headers:void 0,started:!1,parsedLineNumber:0,columnValueSetter:[]};return e.ignoreColumns&&(n.needProcessIgnoreColumn=!0),e.includeColumns&&(n.needProcessIncludeColumn=!0),n}},function(t,e,n){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(53),r=o(n(15)),s=n(54),l=o(n(16)),c=n(57),u=n(28),d=n(58),p=o(n(59)),h=o(n(29)),g=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.rowSplit=new d.RowSplit(t.converter),t.eolEmitted=!1,t._needEmitEol=void 0,t.headEmitted=!1,t._needEmitHead=void 0,t}return i(n,e),n.prototype.flush=function(){var t=this;if(this.runtime.csvLineBuffer&&this.runtime.csvLineBuffer.length>0){var e=this.runtime.csvLineBuffer;return this.runtime.csvLineBuffer=void 0,this.process(e,!0).then((function(e){return t.runtime.csvLineBuffer&&t.runtime.csvLineBuffer.length>0?r.default.reject(h.default.unclosed_quote(t.runtime.parsedLineNumber,t.runtime.csvLineBuffer.toString())):r.default.resolve(e)}))}return r.default.resolve([])},n.prototype.destroy=function(){return r.default.resolve()},Object.defineProperty(n.prototype,"needEmitEol",{get:function(){return void 0===this._needEmitEol&&(this._needEmitEol=this.converter.listeners("eol").length>0),this._needEmitEol},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"needEmitHead",{get:function(){return void 0===this._needEmitHead&&(this._needEmitHead=this.converter.listeners("header").length>0),this._needEmitHead},enumerable:!0,configurable:!0}),n.prototype.process=function(t,e){var n,i=this;return void 0===e&&(e=!1),n=e?t.toString():s.prepareData(t,this.converter.parseRuntime),r.default.resolve().then((function(){return i.runtime.preRawDataHook?i.runtime.preRawDataHook(n):n})).then((function(t){return t&&t.length>0?i.processCSV(t,e):r.default.resolve([])}))},n.prototype.processCSV=function(t,e){var n=this,i=this.params,o=this.runtime;o.eol||l.default(t,o),this.needEmitEol&&!this.eolEmitted&&o.eol&&(this.converter.emit("eol",o.eol),this.eolEmitted=!0),i.ignoreEmpty&&!o.started&&(t=u.trimLeft(t));var a=c.stringToLines(t,o);return e?(a.lines.push(a.partial),a.partial=""):this.prependLeftBuf(u.bufFromString(a.partial)),a.lines.length>0?(o.preFileLineHook?this.runPreLineHook(a.lines):r.default.resolve(a.lines)).then((function(t){return o.started||n.runtime.headers?n.processCSVBody(t):n.processDataWithHead(t)})):r.default.resolve([])},n.prototype.processDataWithHead=function(t){if(this.params.noheader)this.params.headers?this.runtime.headers=this.params.headers:this.runtime.headers=[];else{for(var e="",n=[];t.length;){var i=e+t.shift(),o=this.rowSplit.parse(i);if(o.closed){n=o.cells,e="";break}e=i+l.default(i,this.runtime)}if(this.prependLeftBuf(u.bufFromString(e)),0===n.length)return[];this.params.headers?this.runtime.headers=this.params.headers:this.runtime.headers=n}return(this.runtime.needProcessIgnoreColumn||this.runtime.needProcessIncludeColumn)&&this.filterHeader(),this.needEmitHead&&!this.headEmitted&&(this.converter.emit("header",this.runtime.headers),this.headEmitted=!0),this.processCSVBody(t)},n.prototype.filterHeader=function(){if(this.runtime.selectedColumns=[],this.runtime.headers){for(var t=this.runtime.headers,e=0;e<t.length;e++)if(this.params.ignoreColumns)if(this.params.ignoreColumns.test(t[e])){if(!this.params.includeColumns||!this.params.includeColumns.test(t[e]))continue;this.runtime.selectedColumns.push(e)}else this.runtime.selectedColumns.push(e);else this.params.includeColumns?this.params.includeColumns.test(t[e])&&this.runtime.selectedColumns.push(e):this.runtime.selectedColumns.push(e);this.runtime.headers=u.filterArray(this.runtime.headers,this.runtime.selectedColumns)}},n.prototype.processCSVBody=function(t){if("line"===this.params.output)return t;var e=this.rowSplit.parseMultiLines(t);return this.prependLeftBuf(u.bufFromString(e.partial)),"csv"===this.params.output?e.rowsCells:p.default(e.rowsCells,this.converter)},n.prototype.prependLeftBuf=function(e){e&&(this.runtime.csvLineBuffer?this.runtime.csvLineBuffer=t.concat([e,this.runtime.csvLineBuffer]):this.runtime.csvLineBuffer=e)},n.prototype.runPreLineHook=function(t){var e=this;return new r.default((function(n,i){!function t(e,n,i,o){if(i>=e.length)o();else if(n.preFileLineHook){var a=e[i],r=n.preFileLineHook(a,n.parsedLineNumber+i);if(i++,r&&r.then)r.then((function(a){e[i-1]=a,t(e,n,i,o)}));else{for(e[i-1]=r;i<e.length;)e[i]=n.preFileLineHook(e[i],n.parsedLineNumber+i),i++;o()}}else o()}(t,e.runtime,0,(function(e){e?i(e):n(t)}))}))},n}(a.Processor);e.ProcessorLocal=g}).call(this,n(3).Buffer)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Processor=function(t){this.converter=t,this.params=t.parseParam,this.runtime=t.parseRuntime}},function(t,e,n){"use strict";(function(t){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(55));e.prepareData=function(e,n){var i=function(e,n){return n.csvLineBuffer&&n.csvLineBuffer.length>0?t.concat([n.csvLineBuffer,e]):e}(e,n);n.csvLineBuffer=void 0;var a=function(t,e){var n=t.length-1;if(0!=(128&t[n])){for(;128==(192&t[n]);)n--;n--}return n!=t.length-1?(e.csvLineBuffer=t.slice(n+1),t.slice(0,n+1)):t}(i,n).toString("utf8");return!1===n.started?o.default(a):a}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=n(56);t.exports=function(t){return"string"==typeof t&&65279===t.charCodeAt(0)?t.slice(1):e.isBuffer(t)&&i(t)&&239===t[0]&&187===t[1]&&191===t[2]?t.slice(3):t}}).call(this,n(3).Buffer)},function(t,e){t.exports=function(t){for(var e=0;e<t.length;)if(9==t[e]||10==t[e]||13==t[e]||32<=t[e]&&t[e]<=126)e+=1;else if(194<=t[e]&&t[e]<=223&&128<=t[e+1]&&t[e+1]<=191)e+=2;else if(224==t[e]&&160<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191||(225<=t[e]&&t[e]<=236||238==t[e]||239==t[e])&&128<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191||237==t[e]&&128<=t[e+1]&&t[e+1]<=159&&128<=t[e+2]&&t[e+2]<=191)e+=3;else{if(!(240==t[e]&&144<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191||241<=t[e]&&t[e]<=243&&128<=t[e+1]&&t[e+1]<=191&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191||244==t[e]&&128<=t[e+1]&&t[e+1]<=143&&128<=t[e+2]&&t[e+2]<=191&&128<=t[e+3]&&t[e+3]<=191))return!1;e+=4}return!0}},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(16));e.stringToLines=function(t,e){var n=o.default(t,e),i=t.split(n);return{lines:i,partial:i.pop()||""}}},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(16)),a=n(28),r=[",","|","\t",";",":"],s=function(){function t(t){this.conv=t,this.cachedRegExp={},this.delimiterEmitted=!1,this._needEmitDelimiter=void 0,this.quote=t.parseParam.quote,this.trim=t.parseParam.trim,this.escape=t.parseParam.escape}return Object.defineProperty(t.prototype,"needEmitDelimiter",{get:function(){return void 0===this._needEmitDelimiter&&(this._needEmitDelimiter=this.conv.listeners("delimiter").length>0),this._needEmitDelimiter},enumerable:!0,configurable:!0}),t.prototype.parse=function(t){if(0===t.length||this.conv.parseParam.ignoreEmpty&&0===t.trim().length)return{cells:[],closed:!0};var e=this.quote,n=this.trim;this.escape,(this.conv.parseRuntime.delimiter instanceof Array||"auto"===this.conv.parseRuntime.delimiter.toLowerCase())&&(this.conv.parseRuntime.delimiter=this.getDelimiter(t)),this.needEmitDelimiter&&!this.delimiterEmitted&&(this.conv.emit("delimiter",this.conv.parseRuntime.delimiter),this.delimiterEmitted=!0);var i=this.conv.parseRuntime.delimiter,o=t.split(i);if("off"===e){if(n)for(var a=0;a<o.length;a++)o[a]=o[a].trim();return{cells:o,closed:!0}}return this.toCSVRow(o,n,e,i)},t.prototype.toCSVRow=function(t,e,n,i){for(var o=[],r=!1,s="",l=0,c=t.length;l<c;l++){var u=t[l];!r&&e&&(u=a.trimLeft(u));var d=u.length;if(r)this.isQuoteClose(u)?(r=!1,s+=i+(u=u.substr(0,d-1)),s=this.escapeQuote(s),e&&(s=a.trimRight(s)),o.push(s),s=""):s+=i+u;else{if(2===d&&u===this.quote+this.quote){o.push("");continue}if(this.isQuoteOpen(u)){if(u=u.substr(1),this.isQuoteClose(u)){u=u.substring(0,u.lastIndexOf(n)),u=this.escapeQuote(u),o.push(u);continue}if(-1!==u.indexOf(n)){for(var p=0,h="",g=0,f=u;g<f.length;g++){var m=f[g];m===n&&h!==this.escape?(p++,h=""):h=m}if(p%2==1){e&&(u=a.trimRight(u)),o.push(n+u);continue}r=!0,s+=u;continue}r=!0,s+=u;continue}e&&(u=a.trimRight(u)),o.push(u)}}return{cells:o,closed:!r}},t.prototype.getDelimiter=function(t){var e;if("auto"===this.conv.parseParam.delimiter)e=r;else{if(!(this.conv.parseParam.delimiter instanceof Array))return this.conv.parseParam.delimiter;e=this.conv.parseParam.delimiter}var n=0,i=",";return e.forEach((function(e){var o=t.split(e).length;o>n&&(i=e,n=o)})),i},t.prototype.isQuoteOpen=function(t){var e=this.quote,n=this.escape;return t[0]===e&&(t[1]!==e||t[1]===n&&(t[2]===e||2===t.length))},t.prototype.isQuoteClose=function(t){var e=this.quote,n=this.escape;this.conv.parseParam.trim&&(t=a.trimRight(t));for(var i=0,o=t.length-1;t[o]===e||t[o]===n;)o--,i++;return i%2!=0},t.prototype.escapeQuote=function(t){var e="es|"+this.quote+"|"+this.escape;void 0===this.cachedRegExp[e]&&(this.cachedRegExp[e]=new RegExp("\\"+this.escape+"\\"+this.quote,"g"));var n=this.cachedRegExp[e];return t.replace(n,this.quote)},t.prototype.parseMultiLines=function(t){for(var e=[],n="";t.length;){var i=n+t.shift(),r=this.parse(i);0===r.cells.length&&this.conv.parseParam.ignoreEmpty||(r.closed||this.conv.parseParam.alwaysSplitAtEOL?(this.conv.parseRuntime.selectedColumns?e.push(a.filterArray(r.cells,this.conv.parseRuntime.selectedColumns)):e.push(r.cells),n=""):n=i+(o.default(i,this.conv.parseRuntime)||"\n"))}return{rowsCells:e,partial:n}},t}();e.RowSplit=s},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(29)),a=i(n(60)),r=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/;function s(t,e,n){if(e.parseParam.checkColumn&&e.parseRuntime.headers&&t.length!==e.parseRuntime.headers.length)throw o.default.column_mismatched(e.parseRuntime.parsedLineNumber+n);return function(t,e,n){for(var i=!1,o={},a=0,r=t.length;a<r;a++){var s=t[a];if(!n.parseParam.ignoreEmpty||""!==s){i=!0;var l=e[a];l&&""!==l||(l=e[a]="field"+(a+1));var d=c(l,a,n);if(d){var p=d(s,l,o,t,a);void 0!==p&&u(o,l,p,n,a)}else n.parseParam.checkType&&(s=h(s,l,a,n)(s)),void 0!==s&&u(o,l,s,n,a)}}return i?o:null}(t,e.parseRuntime.headers||[],e)||null}e.default=function(t,e){for(var n=[],i=0,o=t.length;i<o;i++){var a=s(t[i],e,i);a&&n.push(a)}return n};var l={string:f,number:g,omit:function(){}};function c(t,e,n){if(void 0!==n.parseRuntime.columnConv[e])return n.parseRuntime.columnConv[e];var i=n.parseParam.colParser[t];if(void 0===i)return n.parseRuntime.columnConv[e]=null;if("object"==typeof i&&(i=i.cellParser||"string"),"string"==typeof i){i=i.trim().toLowerCase();var o=l[i];return n.parseRuntime.columnConv[e]=o||null}return n.parseRuntime.columnConv[e]="function"==typeof i?i:null}function u(t,e,n,i,o){if(!i.parseRuntime.columnValueSetter[o])if(i.parseParam.flatKeys)i.parseRuntime.columnValueSetter[o]=d;else if(e.indexOf(".")>-1){for(var a=e.split("."),r=!0;a.length>0;)if(0===a.shift().length){r=!1;break}!r||i.parseParam.colParser[e]&&i.parseParam.colParser[e].flat?i.parseRuntime.columnValueSetter[o]=d:i.parseRuntime.columnValueSetter[o]=p}else i.parseRuntime.columnValueSetter[o]=d;!0===i.parseParam.nullObject&&"null"===n&&(n=null),i.parseRuntime.columnValueSetter[o](t,e,n)}function d(t,e,n){t[e]=n}function p(t,e,n){a.default(t,e,n)}function h(t,e,n,i){return i.parseRuntime.headerType[n]?i.parseRuntime.headerType[n]:e.indexOf("number#!")>-1?i.parseRuntime.headerType[n]=g:e.indexOf("string#!")>-1?i.parseRuntime.headerType[n]=f:i.parseParam.checkType?i.parseRuntime.headerType[n]=m:i.parseRuntime.headerType[n]=f}function g(t){var e=parseFloat(t);return isNaN(e)?t:e}function f(t){return t.toString()}function m(t){var e=t.trim();return""===e?f(t):r.test(e)?g(t):5===e.length&&"false"===e.toLowerCase()||4===e.length&&"true"===e.toLowerCase()?function(t){var e=t.trim();return 5!==e.length||"false"!==e.toLowerCase()}(t):"{"===e[0]&&"}"===e[e.length-1]||"["===e[0]&&"]"===e[e.length-1]?function(t){try{return JSON.parse(t)}catch(e){return t}}(t):f(t)}},function(t,e,n){var i=n(61);t.exports=function(t,e,n){return null==t?t:i(t,e,n)}},function(t,e,n){var i=n(62),o=n(74),a=n(103),r=n(20),s=n(104);t.exports=function(t,e,n,l){if(!r(t))return t;for(var c=-1,u=(e=o(e,t)).length,d=u-1,p=t;null!=p&&++c<u;){var h=s(e[c]),g=n;if(c!=d){var f=p[h];void 0===(g=l?l(f,h,p):void 0)&&(g=r(f)?f:a(e[c+1])?[]:{})}i(p,h,g),p=p[h]}return t}},function(t,e,n){var i=n(63),o=n(31),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var r=t[e];a.call(t,e)&&o(r,n)&&(void 0!==n||e in t)||i(t,e,n)}},function(t,e,n){var i=n(64);t.exports=function(t,e,n){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var i=n(17),o=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},function(t,e,n){var i=n(66),o=n(70),a=n(20),r=n(72),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,p=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||o(t))&&(i(t)?p:s).test(r(t))}},function(t,e,n){var i=n(30),o=n(20);t.exports=function(t){if(!o(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(0))},function(t,e,n){var i=n(18),o=Object.prototype,a=o.hasOwnProperty,r=o.toString,s=i?i.toStringTag:void 0;t.exports=function(t){var e=a.call(t,s),n=t[s];try{t[s]=void 0;var i=!0}catch(t){}var o=r.call(t);return i&&(e?t[s]=n:delete t[s]),o}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var i=n(71),o=function(){var t=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();t.exports=function(t){return!!o&&o in t}},function(t,e,n){var i=n(19)["__core-js_shared__"];t.exports=i},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var i=n(21),o=n(75),a=n(77),r=n(100);t.exports=function(t,e){return i(t)?t:o(t,e)?[t]:a(r(t))}},function(t,e,n){var i=n(21),o=n(22),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;t.exports=function(t,e){if(i(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||r.test(t)||!a.test(t)||null!=e&&t in Object(e)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=n(78)((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,(function(t,n,i,a){e.push(i?a.replace(o,"$1"):n||t)})),e}));t.exports=a},function(t,e,n){var i=n(79);t.exports=function(t){var e=i(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var i=n(80);function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var i=arguments,o=e?e.apply(this,i):i[0],a=n.cache;if(a.has(o))return a.get(o);var r=t.apply(this,i);return n.cache=a.set(o,r)||a,r};return n.cache=new(o.Cache||i),n}o.Cache=i,t.exports=o},function(t,e,n){var i=n(81),o=n(95),a=n(97),r=n(98),s=n(99);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=r,l.prototype.set=s,t.exports=l},function(t,e,n){var i=n(82),o=n(88),a=n(94);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(a||o),string:new i}}},function(t,e,n){var i=n(83),o=n(84),a=n(85),r=n(86),s=n(87);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=r,l.prototype.set=s,t.exports=l},function(t,e,n){var i=n(8);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var i=n(8),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(e,t)?e[t]:void 0}},function(t,e,n){var i=n(8),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:o.call(e,t)}},function(t,e,n){var i=n(8);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var i=n(89),o=n(90),a=n(91),r=n(92),s=n(93);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=r,l.prototype.set=s,t.exports=l},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var i=n(9),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=i(e,t);return!(n<0||(n==e.length-1?e.pop():o.call(e,n,1),--this.size,0))}},function(t,e,n){var i=n(9);t.exports=function(t){var e=this.__data__,n=i(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var i=n(9);t.exports=function(t){return i(this.__data__,t)>-1}},function(t,e,n){var i=n(9);t.exports=function(t,e){var n=this.__data__,o=i(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}},function(t,e,n){var i=n(17)(n(19),"Map");t.exports=i},function(t,e,n){var i=n(10);t.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var i=n(10);t.exports=function(t){return i(this,t).get(t)}},function(t,e,n){var i=n(10);t.exports=function(t){return i(this,t).has(t)}},function(t,e,n){var i=n(10);t.exports=function(t,e){var n=i(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}},function(t,e,n){var i=n(101);t.exports=function(t){return null==t?"":i(t)}},function(t,e,n){var i=n(18),o=n(102),a=n(21),r=n(22),s=i?i.prototype:void 0,l=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(a(e))return o(e,t)+"";if(r(e))return l?l.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(t,e){t.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,o=Array(i);++n<i;)o[n]=e(t[n],n,t);return o}},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var i=n(22);t.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(15)),a=n(106),r=function(){function t(t){this.converter=t,this.finalResult=[]}return Object.defineProperty(t.prototype,"needEmitLine",{get:function(){return!!this.converter.parseRuntime.subscribe&&!!this.converter.parseRuntime.subscribe.onNext||this.needPushDownstream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"needPushDownstream",{get:function(){return void 0===this._needPushDownstream&&(this._needPushDownstream=this.converter.listeners("data").length>0||this.converter.listeners("readable").length>0),this._needPushDownstream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"needEmitAll",{get:function(){return!!this.converter.parseRuntime.then&&this.converter.parseParam.needEmitAll},enumerable:!0,configurable:!0}),t.prototype.processResult=function(t){var e=this,n=this.converter.parseRuntime.parsedLineNumber;return this.needPushDownstream&&"array"===this.converter.parseParam.downstreamFormat&&0===n&&s(this.converter,"["+a.EOL),new o.default((function(n,i){e.needEmitLine?function t(e,n,i,o,a){if(i>=e.length)a();else if(n.parseRuntime.subscribe&&n.parseRuntime.subscribe.onNext){var r=n.parseRuntime.subscribe.onNext,l=e[i],c=r(l,n.parseRuntime.parsedLineNumber+i);if(i++,c&&c.then)c.then((function(){!function(e,n,i,o,a,r,l){a&&s(i,l),t(e,i,o,a,r)}(e,0,n,i,o,a,l)}),a);else{for(o&&s(n,l);i<e.length;){var u=e[i];r(u,n.parseRuntime.parsedLineNumber+i),i++,o&&s(n,u)}a()}}else{if(o)for(;i<e.length;)u=e[i++],s(n,u);a()}}(t,e.converter,0,e.needPushDownstream,(function(o){o?i(o):(e.appendFinalResult(t),n())})):(e.appendFinalResult(t),n())}))},t.prototype.appendFinalResult=function(t){this.needEmitAll&&(this.finalResult=this.finalResult.concat(t)),this.converter.parseRuntime.parsedLineNumber+=t.length},t.prototype.processError=function(t){this.converter.parseRuntime.subscribe&&this.converter.parseRuntime.subscribe.onError&&this.converter.parseRuntime.subscribe.onError(t),this.converter.parseRuntime.then&&this.converter.parseRuntime.then.onrejected&&this.converter.parseRuntime.then.onrejected(t)},t.prototype.endProcess=function(){this.converter.parseRuntime.then&&this.converter.parseRuntime.then.onfulfilled&&(this.needEmitAll?this.converter.parseRuntime.then.onfulfilled(this.finalResult):this.converter.parseRuntime.then.onfulfilled([])),this.converter.parseRuntime.subscribe&&this.converter.parseRuntime.subscribe.onCompleted&&this.converter.parseRuntime.subscribe.onCompleted(),this.needPushDownstream&&"array"===this.converter.parseParam.downstreamFormat&&s(this.converter,"]"+a.EOL)},t}();function s(t,e){if("object"!=typeof e||t.options.objectMode)t.push(e);else{var n=JSON.stringify(e);t.push(n+("array"===t.parseParam.downstreamFormat?","+a.EOL:a.EOL),"utf8")}}e.Result=r},function(t,e){e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!=typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}}])},function(t,e,n){var i=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function s(t,e,n,i){var o=e&&e.prototype instanceof u?e:u,a=Object.create(o.prototype),r=new w(i||[]);return a._invoke=function(t,e,n){var i="suspendedStart";return function(o,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw a;return x()}for(n.method=o,n.arg=a;;){var r=n.delegate;if(r){var s=y(r,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(t,n,r),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var c={};function u(){}function d(){}function p(){}var h={};h[o]=function(){return this};var g=Object.getPrototypeOf,f=g&&g(g(S([])));f&&f!==e&&n.call(f,o)&&(h=f);var m=p.prototype=u.prototype=Object.create(h);function v(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function _(t,e){var i;this._invoke=function(o,a){function r(){return new e((function(i,r){!function i(o,a,r,s){var c=l(t[o],t,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){i("next",t,r,s)}),(function(t){i("throw",t,r,s)})):e.resolve(d).then((function(t){u.value=t,r(u)}),(function(t){return i("throw",t,r,s)}))}s(c.arg)}(o,a,i,r)}))}return i=i?i.then(r,r):r()}}function y(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,y(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var i=l(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,c;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function w(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:x}}function x(){return{value:void 0,done:!0}}return d.prototype=m.constructor=p,p.constructor=d,p[r]=d.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,r in t||(t[r]="GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},v(_.prototype),_.prototype[a]=function(){return this},t.AsyncIterator=_,t.async=function(e,n,i,o,a){void 0===a&&(a=Promise);var r=new _(s(e,n,i,o),a);return t.isGeneratorFunction(n)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},v(m),m[r]="Generator",m[o]=function(){return this},m.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=S,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return r.type="throw",r.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],r=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var r=a?a.completion:{};return r.type=t,r.arg=e,a?(this.method="next",this.next=a.finallyLoc,c):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var o=i.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}},function(t,e,n){"use strict";n.r(e);var i=n(1),o=n.n(i),a=n(3),r=n.n(a),s=n(0),l=n.n(s),c=function(){function t(){o()(this,t)}return r()(t,null,[{key:"getServerUrl",value:function(){return"https://blockly-backend.dwengo.org"}}]),t}(),u=function(){function t(){o()(this,t),l()(this,"sessionId",null),l()(this,"tutorialId",null),l()(this,"tutialIdSetting",""),l()(this,"computerId","-1"),l()(this,"workshopId","-1")}return r()(t,[{key:"init",value:function(){this.sessionId=window.sessionStorage.loadOnceSessionId,delete window.sessionStorage.loadOnceSessionId,this.createNewSessionId()}},{key:"createNewSessionId",value:function(){var t=this;this.sessionId||$.ajax({type:"GET",url:c.getServerUrl()+"/logging/newSessionId"}).done((function(e){t.sessionId=e,console.debug(t.sessionId)})).fail((function(t,e){console.warn("Failed to fetch sessionId:",e,t)}))}},{key:"createEvent",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o={timestamp:$.now(),name:t,simulatorState:i,selectedDifficulty:n,activeTutorial:this.tutorialIdSetting,computerId:this.computerId,workshopId:this.workshopId,data:e};return o}},{key:"recordEvent",value:function(t){var e={timestamp:$.now(),sessionId:this.sessionId,event:t};console.debug("Record event "+t.name+" with data ",e),void 0!==this.sessionId&&$.ajax({type:"POST",url:c.getServerUrl()+"/logging/event",data:e}).done((function(t){console.debug("Recording submitted",t)})).fail((function(t,e){console.warn("Failed to submit recording:",e)}))}}]),t}(),d=n(6),p=n.n(d),h=n(7),g=n.n(h),f=n(4),m=n.n(f),v=n(5),_=n.n(v),y=n(2),b=n.n(y),k=function(){function t(){o()(this,t)}return r()(t,null,[{key:"mapButtonIdToIndex",value:function(e){return t.map[e]}},{key:"mapIndexToButtonId",value:function(e){for(var n in t.map)if(t.map[n]===e)return n}},{key:"mapButtonPinNameToIndex",value:function(e){return t.pinMap[e]}},{key:"mapIndexToButtonPinName",value:function(e){for(var n in t.pinMap)if(t.pinMap[n]===e)return n}}]),t}();l()(k,"map",{sim_button_N:0,sim_button_W:1,sim_button_C:2,sim_button_E:3,sim_button_S:4}),l()(k,"pinMap",{SW_N:0,SW_W:1,SW_C:2,SW_E:3,SW_S:4});var w,S=k,x=function(){function t(){o()(this,t),l()(this,"pins",new Array(44)),l()(this,"pinMapping",{}),l()(this,"lcdContent",new Array(2));for(var e=0;e<24;++e)this.pinMapping[e+""]=e;for(var n=0;n<8;++n)this.pinMapping["A"+n]=24+n;this.pinMapping.SW_N=16,this.pinMapping.SW_E=17,this.pinMapping.SW_S=18,this.pinMapping.SW_W=19,this.pinMapping.SW_C=32,this.pinMapping.BUZZER=33,this.pinMapping.LCD_BACKLIGHT=20,this.pinMapping.DC_MOTOR_1=34,this.pinMapping.DC_MOTOR_2=35,this.pinMapping.SERVO_MOTOR_1=40,this.pinMapping.SERVO_MOTOR_2=41;for(var i=0;i<8;++i)this.pinMapping["LED"+i]=38+i;for(var a=33;a<45;a++)this.pinMapping[a+""]=a;this.pinMapping.LED13=13,this.lcdContent[0]=" ".repeat(16),this.lcdContent[1]=" ".repeat(16),this.resetBoard()}return r()(t,[{key:"resetBoard",value:function(){this.lcdContent=new Array(2),this.lcdContent[0]=" ".repeat(16),this.lcdContent[1]=" ".repeat(16);for(var t=0;t<24;++t)this.pins[this.pinMapping[t+""]]=0;for(var e=0;e<8;++e)this.pins[this.pinMapping["A"+e]]=0;this.pins[this.pinMapping.LCD_BACKLIGHT]=0,this.pins[this.pinMapping.BUZZER]=0,this.pins[this.pinMapping.DC_MOTOR_1]=0,this.pins[this.pinMapping.DC_MOTOR_2]=0,this.pins[this.pinMapping.SERVO_MOTOR_1]=0,this.pins[this.pinMapping.SERVO_MOTOR_2]=0;for(var n=0;n<8;++n)this.pins[this.pinMapping.LED0+n]=0;this.pins[this.pinMapping.LED13]=0,this.pins[this.pinMapping.SW_N]=1,this.pins[this.pinMapping.SW_E]=1,this.pins[this.pinMapping.SW_S]=1,this.pins[this.pinMapping.SW_W]=1,this.pins[this.pinMapping.SW_C]=1}},{key:"setTonePlaying",value:function(t){this.setTonePlayingOnPin(t,"BUZZER")}},{key:"getTonePlaying",value:function(){return this.getTonePlayingOnPin("BUZZER")}},{key:"setTonePlayingOnPin",value:function(t,e){this.pins[this.pinMapping[e]]=t}},{key:"getTonePlayingOnPin",value:function(t){return this.pins[this.pinMapping[t]]}},{key:"setLcdContent",value:function(t,e){var n=e;t<0||t>1||(e.length>16&&(n=e.substr(0,16)),this.lcdContent[t]=n)}},{key:"getLcdContent",value:function(t){if(t<0||t>1)throw new Error("This is not a valid line number");return this.lcdContent[t]}},{key:"setBacklight",value:function(t){if(1!=t&&0!=t)throw new Error("Invalid status");this.pins[this.pinMapping.LCD_BACKLIGHT]=t}},{key:"getBackLightStatus",value:function(){return this.pins[this.pinMapping.LCD_BACKLIGHT]}},{key:"setServoAngle",value:function(t,e){this.pins[this.pinMapping["SERVO_MOTOR_"+t]]=e,console.log("setServoAngle",this.pins[this.pinMapping["SERVO_MOTOR_"+t]])}},{key:"getServoAngle",value:function(t){return this.pins[this.pinMapping["SERVO_MOTOR_"+t]]}},{key:"setMotorSpeed",value:function(t,e){if(t>2||t<1)throw Error("No motor with this number");e>255&&(motorspeed=255),this.pins[this.pinMapping["DC_MOTOR_"+t]]=e}},{key:"getMotorSpeed",value:function(t){if(t>2||t<1)throw Error("No motor with this number");return this.pins[this.pinMapping["DC_MOTOR_"+t]]}},{key:"setLedState",value:function(t,e){8==t?this.pins[this.pinMapping.LED13]=e:this.pins[this.pinMapping["LED"+t]]=e}},{key:"getLedState",value:function(t){return 8==t?this.pins[this.pinMapping.LED13]:this.pins[this.pinMapping["LED"+t]]}},{key:"setButtonState",value:function(t,e){var n=S.mapIndexToButtonPinName(t);this.pins[this.pinMapping[n]]=e}},{key:"getButtonState",value:function(t){var e=S.mapIndexToButtonPinName(t);return this.pins[this.pinMapping[e]]}},{key:"setSonarDistance",value:function(t,e,n){this.setIoPinState(t,n),this.setIoPinState(e,n)}},{key:"getSonarDistance",value:function(t,e){return this.getIoPinState(e)}},{key:"setIoPinState",value:function(t,e){var n=t+"";this.pins[this.pinMapping[n]]=e}},{key:"getIoPinState",value:function(t){var e=t+"";return this.pins[this.pinMapping[e]]}},{key:"isPWMPin",value:function(t){var e=t+"",n=this.pinMapping[e];return 15==n||14==n||11==n||6==n||5==n||3==n}},{key:"setAnalogIoPinState",value:function(t,e){if(!t.startsWith("A"))throw new Error("Not a valid analog pin name!");this.setIoPinState(t,e)}},{key:"getAnalogIoPinState",value:function(t){if(!t.startsWith("A"))throw new Error("Not a valid analog pin name!");return this.getIoPinState(t)}}]),t}(),E={motorRadius:10,motorDistance:380,nrOfSteps:200},C=function(){function t(e,n){if(o()(this,t),this._eventBus=e,this._htmlClasses=n,void 0===this.toString)throw new Error("You have to implement the method toString");if(void 0===this.toggleVisibility)throw new Error("You have to implement the method toggleVisibility");if(void 0===this.reset)throw new Error("You have to implement the method reset");if(void 0===this.insertHtml)throw new Error("You have to implement the method insertHtml to add the component to the simulation container");if(void 0===this.removeHtml)throw new Error("You have to implement the method removeHtml to remove the component from the simulation container");if(void 0===this.toXml)throw new Error("You have to implement the method toXml to save the robot component to an XML file")}return r()(t,[{key:"setHtmlClasses",value:function(t){this._htmlClasses=t}},{key:"getHtmlClasses",value:function(){return this._htmlClasses}}]),t}(),T=n(8),I=n.n(T),M=(n(19),function(){function t(){o()(this,t)}return r()(t,[{key:"render",value:function(t){this.clearCanvases(),this.drawLcd(t),this.drawLeds(t),this.drawRgbLeds(t),this.drawLedmatrices(t),this.drawLedmatricesSegments(t),this.drawServos(t),this.drawTouchSensors(t),this.drawPirs(t),this.drawSonars(t),this.drawSoundSensors(t),this.drawLightSensors(t)}},{key:"drawLcd",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.LCD){for(var n=0;n<2;++n)$("#sim_lcd_row"+n).text(t[e].getState()[n]),null!==document.getElementById("sim_lcd_row"+n)&&(document.getElementById("sim_lcd_row"+n).innerHTML=document.getElementById("sim_lcd_row"+n).innerHTML.replace(/ /g,"&nbsp;"));var i=document.getElementById("sim_lcds");null!==i&&(i.style.display="none",i.offsetHeight,i.style.display="block")}}},{key:"initializeCanvas",value:function(t,e){var n=e.getCanvasId(),i=document.getElementById(n);null!==i&&(this.configureCanvasDimensions(i),this.render(t))}},{key:"clearCanvases",value:function(){for(var t=document.getElementsByClassName("sim_canvas"),e=0;e<t.length;e++){if(t.item(e).getContext)t.item(e).getContext("2d").clearRect(0,0,t.item(e).width,t.item(e).height)}}},{key:"clearCanvas",value:function(t){var e=document.getElementById(t);e.getContext&&e.getContext("2d").clearRect(0,0,e.width,e.height)}},{key:"drawLeds",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.LED){var n=document.getElementById(t[e].getCanvasId());this.drawLed(t[e],n)}}},{key:"drawLed",value:function(t,e){if(e.getContext){var n=e.getContext("2d");n.beginPath(),n.arc(e.width/2,e.height/2,t.getRadius(),0,2*Math.PI),1===t.getState()?n.fillStyle=t.getOnColor():n.fillStyle=t.getOffColor(),n.fill(),n.fillStyle=t.getBorderColor(),n.stroke()}else console.log(e,"This canvas has no context")}},{key:"drawRgbLeds",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.RGBLED){var n=document.getElementById(t[e].getCanvasId());this.drawRgbLed(t[e],n)}}},{key:"drawRgbLed",value:function(t,e){if(e.getContext){var n=this;t.getLedBackground().onload=function(){var i=e.getContext("2d"),o=t.getLedBackground();i.drawImage(o,0,0,40,30),i.beginPath(),i.arc(25,15,t.getRadius(),0,2*Math.PI);var a=t.getState();if(0==a[0]&&0==a[1]&&0==a[2])i.fillStyle="#CCCCCC";else{var r=n.rgbToHex(a);i.fillStyle=r}i.fill(),i.translate(16,6);var s=t.getLedSvg();i.drawImage(s,0,0,18,18),i.translate(-16,-6)};var i=e.getContext("2d"),o=t.getLedBackground();i.drawImage(o,0,0,40,30),i.beginPath(),i.arc(25,15,t.getRadius(),0,2*Math.PI);var a=t.getState();if(0==a[0]&&0==a[1]&&0==a[2])i.fillStyle="#CCCCCC";else{var r=n.rgbToHex(a);i.fillStyle=r}i.fill(),i.translate(16,6);var s=t.getLedSvg();i.drawImage(s,0,0,18,18),i.translate(-16,-6)}else console.log(e,"This canvas has no context")}},{key:"rgbToHex",value:function(t){return"#"+this.componentToHex(t[0])+this.componentToHex(t[1])+this.componentToHex(t[2])}},{key:"componentToHex",value:function(t){var e=t.toString(16);return 1==e.length?"0"+e:e}},{key:"drawLedmatrices",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.LEDMATRIX){var n=document.getElementById(t[e].getCanvasId());this.drawLedmatrix(t[e],n)}}},{key:"drawLedmatrix",value:function(t,e){if(e.getContext){t.getLedmatrixBackground().onload=function(){e.getContext("2d").drawImage(t.getLedmatrixBackground(),0,0,296,70)},t.getLedSvg().onload=function(){for(var n=e.getContext("2d"),i=t.getLedOffsets(),o=t.getState(),a=0;a<4;a++)for(var r=0;r<8;r++)for(var s=0;s<8;s++)if(Array.isArray(o)&&1==o[a][s][r]){var l=i.left+i.led_x+s*i.led_between_x+a*i.matrix_segment_between_x,c=i.led_y+r*i.led_between_y,u=i.led_radius,d=i.led_radius;n.drawImage(t.getLedSvg(),l,c,u,d)}};var n=e.getContext("2d");n.drawImage(t.getLedmatrixBackground(),0,0,296,70);for(var i=t.getLedOffsets(),o=t.getState(),a=0;a<4;a++)for(var r=0;r<8;r++)for(var s=0;s<8;s++)if(Array.isArray(o)&&1==o[a][s][r]){var l=i.left+i.led_x+s*i.led_between_x+a*i.matrix_segment_between_x,c=i.led_y+r*i.led_between_y,u=i.led_radius,d=i.led_radius;n.drawImage(t.getLedSvg(),l,c,u,d)}}else console.log(e,"This canvas has no context")}},{key:"drawLedmatricesSegments",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.LEDMATRIXSEGMENT){var n=document.getElementById(t[e].getCanvasId());this.drawLedmatrixSegment(t[e],n)}}},{key:"drawLedmatrixSegment",value:function(t,e){if(e.getContext){t.getLedmatrixBackground().onload=function(){e.getContext("2d").drawImage(t.getLedmatrixBackground(),0,0,84,70)},t.getLedSvg().onload=function(){for(var n=e.getContext("2d"),i=t.getLedOffsets(),o=t.getState(),a=t.getId()-1,r=0;r<8;r++)for(var s=0;s<8;s++)if(Array.isArray(o)&&1==o[a][s][r]){var l=i.left+i.led_x+s*i.led_between_x,c=i.led_y+r*i.led_between_y,u=i.led_radius,d=i.led_radius;n.drawImage(t.getLedSvg(),l,c,u,d)}};var n=e.getContext("2d");n.drawImage(t.getLedmatrixBackground(),0,0,84,70);for(var i=t.getLedOffsets(),o=t.getState(),a=t.getId()-1,r=0;r<8;r++)for(var s=0;s<8;s++)if(Array.isArray(o)&&1==o[a][s][r]){var l=i.left+i.led_x+s*i.led_between_x,c=i.led_y+r*i.led_between_y,u=i.led_radius,d=i.led_radius;n.drawImage(t.getLedSvg(),l,c,u,d)}}else console.log(e,"This canvas has no context")}},{key:"drawServos",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.SERVO){var n=document.getElementById(t[e].getCanvasId());this.clearCanvas(t[e].getCanvasId()),this.drawServo(t[e],n)}}},{key:"drawServo",value:function(t,e){if(e.getContext){var n=this;t.getServoBackground().onload=function(){var i=e.getContext("2d");switch(t.getCostume()){case"plain":n.drawServoBackground(i,t)}},t.getImage(0).onload=function(){var i=e.getContext("2d");switch(i.fillStyle=t.getBackgroundColor(),t.getCostume()){case"plain":n.drawRotatedServohead(i,t);break;case"eye":n.drawEye(i,t,e);break;case"righthand":i.fillRect(t.getX()+100,t.getY()+30,t.getWidth()-100,t.getHeight()-60),n.drawRightHand(i,t);break;case"lefthand":i.fillRect(t.getX()+10,t.getY()+30,t.getWidth()-28,t.getHeight()-60),n.drawLeftHand(i,t)}};var i=e.getContext("2d");switch(i.fillStyle=t.getBackgroundColor(),t.getCostume()){case"plain":n.drawServoBackground(i,t),n.drawRotatedServohead(i,t);break;case"eye":n.drawEye(i,t,e);break;case"righthand":i.fillRect(t.getX()+100,t.getY()+30,t.getWidth()-100,t.getHeight()-60),n.drawRightHand(i,t);break;case"lefthand":i.fillRect(t.getX()+10,t.getY()+30,t.getWidth()-28,t.getHeight()-60),n.drawLeftHand(i,t)}}else console.log(e,"This canvas has no context")}},{key:"drawPirs",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.PIR){var n=document.getElementById(t[e].getCanvasId());this.drawPir(t[e],n)}}},{key:"drawPir",value:function(t,e){if(e.getContext){t.getImage().onload=function(){e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())},e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())}else console.log(e,"This canvas has no context")}},{key:"drawTouchSensors",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.TOUCH){var n=document.getElementById(t[e].getCanvasId());this.drawTouchSensor(t[e],n)}}},{key:"drawTouchSensor",value:function(t,e){if(e.getContext){t.getImage().onload=function(){e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())},e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())}else console.log(e,"This canvas has no context")}},{key:"drawSonars",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.SONAR){var n=document.getElementById(t[e].getCanvasId());this.drawSonar(t[e],n)}}},{key:"drawSonar",value:function(t,e){if(e.getContext){t.getImage().onload=function(){e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())},e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())}else console.log(e,"This canvas has no context")}},{key:"drawServoBackground",value:function(t,e){t.translate(0,e.getY()),t.drawImage(e.getServoBackground(),0,0,e.getWidth(),e.getHeight()),t.translate(0,-e.getY())}},{key:"drawRotatedServohead",value:function(t,e){var n=this.getDirection(e.getPrevAngle(),e.getAngle()),i=e.getAngle()-e.getPrevAngle();if(0!=i)if(i>5||i<-5){var o=e.getPrevAngle()+5*n;e.setPrevAngle(o),t.translate(e.getX()+e.getWidth()/2,e.getY()+e.getHeight()/2),t.rotate(e.getPrevAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(-e.getPrevAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2,-e.getY()-e.getHeight()/2)}else{var a=e.getPrevAngle()+i;e.setPrevAngle(a),t.translate(e.getX()+e.getWidth()/2,e.getY()+e.getHeight()/2),t.rotate(e.getAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(-e.getAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2,-e.getY()-e.getHeight()/2)}else t.translate(e.getX()+e.getWidth()/2,e.getY()+e.getHeight()/2),t.rotate(e.getAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(-e.getAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2,-e.getY()-e.getHeight()/2)}},{key:"drawEye",value:function(t,e,n){this.renderEyeBall(t,e,n),this.renderIris(t,e,n)}},{key:"renderEyeBall",value:function(t,e,n){var i=e.getImage(0);t.drawImage(i,0,0,100,100)}},{key:"renderIris",value:function(t,e,n){var i=e.getImage(1);i.src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";var o=this.getDirection(e.getPrevAngle(),e.getAngle()),a=e.getAngle()-e.getPrevAngle();if(0!=a){var r=e.getPrevAngle()/120*(n.width-60)+5;if(a>5||a<-5){var s=e.getPrevAngle()+5*o;e.setPrevAngle(s),e.getPrevAngle()>=0&e.getPrevAngle()<=120?t.drawImage(i,r,n.height/2-30,60,60):e.getPrevAngle()<=130&&(r=n.width-60+5,t.drawImage(i,r,n.height/2-30,60,60))}else{var l=e.getPrevAngle()+a;e.setPrevAngle(l),e.getPrevAngle()>=0&e.getPrevAngle()<=120?t.drawImage(i,r,n.height/2-30,60,60):e.getPrevAngle()<=130&&(r=n.width-60+5,t.drawImage(i,r,n.height/2-30,60,60))}}else{r=e.getAngle()/120*(n.width-60)+5;e.getAngle()>=0&e.getAngle()<=120?t.drawImage(i,r,n.height/2-30,60,60):e.getAngle()<=130&&(r=n.width-60+5,t.drawImage(i,r,n.height/2-30,60,60))}}},{key:"drawRightHand",value:function(t,e){var n=e.getAngle()-e.getPrevAngle();n>0?this.drawDown(t,e):n<0?this.drawUp(t,e):(t.translate(e.getX()+e.getWidth()/2+50,e.getY()+e.getHeight()/2),t.rotate(-e.getAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(e.getAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2-50,-e.getY()-e.getHeight()/2))}},{key:"drawDown",value:function(t,e){var n=e.getAngle()-e.getPrevAngle();if(n>=5){var i=e.getPrevAngle()+5;e.setPrevAngle(i),t.translate(e.getX()+e.getWidth()/2+50,e.getY()+e.getHeight()/2),t.rotate(-e.getPrevAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(e.getPrevAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2-50,-e.getY()-e.getHeight()/2)}else{var o=e.getPrevAngle()+n;e.setPrevAngle(o),t.translate(e.getX()+e.getWidth()/2+50,e.getY()+e.getHeight()/2),t.rotate(-e.getAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(e.getAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2-50,-e.getY()-e.getHeight()/2)}}},{key:"drawUp",value:function(t,e){var n=e.getPrevAngle()-e.getAngle();if(n>=5){var i=e.getPrevAngle()-5;e.setPrevAngle(i),t.translate(e.getX()+e.getWidth()/2+50,e.getY()+e.getHeight()/2),t.rotate(-e.getPrevAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(e.getPrevAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2-50,-e.getY()-e.getHeight()/2)}else{var o=e.getPrevAngle()-n;e.setPrevAngle(o),t.translate(e.getX()+e.getWidth()/2+50,e.getY()+e.getHeight()/2),t.rotate(-e.getAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(e.getAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2-50,-e.getY()-e.getHeight()/2)}}},{key:"drawLeftHand",value:function(t,e){var n=this.getDirection(e.getPrevAngle(),e.getAngle()),i=e.getAngle()-e.getPrevAngle();if(0!=i)if(i>5||i<-5){var o=e.getPrevAngle()+5*n;e.setPrevAngle(o),t.translate(e.getX()+e.getWidth()/2,e.getY()+e.getHeight()/2),t.rotate(-e.getPrevAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(e.getPrevAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2,-e.getY()-e.getHeight()/2)}else{var a=e.getPrevAngle()+i;e.setPrevAngle(a),t.translate(e.getX()+e.getWidth()/2,e.getY()+e.getHeight()/2),t.rotate(-e.getAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(e.getAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2,-e.getY()-e.getHeight()/2)}else t.translate(e.getX()+e.getWidth()/2,e.getY()+e.getHeight()/2),t.rotate(-e.getAngle()*Math.PI/180),t.drawImage(e.getImage(0),-e.getWidth()/2,-e.getHeight()/2,e.getWidth(),e.getHeight()),t.rotate(e.getAngle()*Math.PI/180),t.translate(-e.getX()-e.getWidth()/2,-e.getY()-e.getHeight()/2)}},{key:"drawSoundSensors",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.SOUND){var n=document.getElementById(t[e].getCanvasId());this.drawSoundSensor(t[e],n)}}},{key:"drawSoundSensor",value:function(t,e){if(e.getContext){t.getImage().onload=function(){e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())},e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())}else console.log(e,"This canvas has no context")}},{key:"drawLightSensors",value:function(t){for(var e=0;e<t.length;e++)if(t[e].getType()==dt.LIGHT){var n=document.getElementById(t[e].getCanvasId());this.drawLightSensor(t[e],n)}}},{key:"drawLightSensor",value:function(t,e){if(e.getContext){t.getImage().onload=function(){e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())},e.getContext("2d").drawImage(t.getImage(),0,0,t.getWidth(),t.getHeight())}else console.log(e,"This canvas has no context")}},{key:"configureCanvasDimensions",value:function(t){var e=window.devicePixelRatio||1,n=t.getBoundingClientRect();(t.width=n.width*e,t.height=n.height*e,t.getContext)&&t.getContext("2d").scale(e,e)}},{key:"getDirection",value:function(t,e){return e-t>0?1:-1}}]),t}()),P=Object.freeze((w={downloadClicked:"downloadClicked",blocklyBlockCreate:"blocklyBlockCreate",blocklyBlockDelete:"blocklyBlockDelete",blocklyBlockMove:"blocklyBlockMove",blocklyVarCreate:"blocklyVarCreate",blocklyVarDelete:"blocklyVarDelete",blocklyVarRename:"blocklyVarRename",blocklyUI:"blocklyUI",blocklyChange:"blocklyChange",difficultyLevel:"setDifficultyLevel",undo:"undo",uploadClicked:"uploadClicked",simButtonStateClicked:"simButtonStateClicked",runClicked:"runClicked",changedWorkspace:"changedWorkspace",downloadScenarioClicked:"downloadScenarioClicked",moveRobotComponent:"moveRobotComponent",addRobotComponent:"addRobotComponent",removeRobotComponent:"removeRobotComponent"},l()(w,"addRobotComponent","addRobotComponent"),l()(w,"changedScenario","changedScenario"),l()(w,"simStart","simStart"),l()(w,"simResume","simResume"),l()(w,"simPause","simPause"),l()(w,"simStopButtonClicked","simStopButtonClicked"),l()(w,"simStep","simStep"),l()(w,"simStop","simStop"),l()(w,"setSpeed","setSpeed"),l()(w,"startTutorial","startTutorial"),l()(w,"endTutorial","endTutorial"),l()(w,"tutorialNextStep","tutorialNextStep"),l()(w,"tutorialPrevStep","tutorialPrevStep"),w)),O={SAVE:"save",INITIALIZECANVAS:"initializecanvas",CLEARCANVAS:"clearcanvas"};Object.freeze(O);var A=function(){function t(e){o()(this,t),this.name=e,this.callbacks=[]}return r()(t,[{key:"registerCallback",value:function(t){this.callbacks.push(t)}}]),t}();function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var B={PLAIN:"plain",EYE:"eye",MOUTH:"mouth",RIGHTHAND:"righthand",LEFTHAND:"lefthand"};Object.freeze(B);var D=function(t){m()(n,t);var e=R(n);function n(t,i,a,r,s,l,c,u,d,p,h,g,f){var m;switch(o()(this,n),(m=e.call(this,t,f))._id=i,m._type=dt.SERVO,m._width=d,m._height=p,m._x=c,m._y=u,m._offset={left:h,top:g},m._angle=s,m._prevAngle=0,m._image=[new Image,new Image],m._backgroundImage=new Image,m._backgroundImageRotated=new Image,m._backgroundImage.src="./DwenguinoIDE/img/socialrobot/servo_background.png",m._backgroundImageRotated.src="./DwenguinoIDE/img/socialrobot/servo_background_rotated.png",r){case B.PLAIN:m._image[0].src="./DwenguinoIDE/img/socialrobot/servo_head.png";break;case B.EYE:m._image[0].src="./DwenguinoIDE/img/socialrobot/eye1_background.svg",m._image[1].src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";break;case B.RIGHTHAND:m._image[0].src="./DwenguinoIDE/img/socialrobot/righthand.png";break;case B.LEFTHAND:m._image[0].src="./DwenguinoIDE/img/socialrobot/lefthand.png"}return m._backgroundColor="#206499",m._pin=a,m._costume=r,m._canvasId="sim_servo_canvas"+m._id,m.insertHtml(),m.toggleVisibility(l),m}return r()(n,[{key:"toString",value:function(){var t="";return t=(t=(t=(t=(t=(t=t.concat(this.getType()," ")).concat(this.getId()," ")).concat("Angle ",this.getAngle()," ")).concat("Costume ",this.getCostume()," ")).concat("Pin ",this.getPin()," ")).concat("CanvasId ",this.getCanvasId()," ")}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["servoOptions"])),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toggleVisibility",value:function(t){t?$("#sim_servo"+this.getId()).css("visibility","visible"):$("#sim_servo"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Angle='",this.getAngle(),"'")).concat(" PrevAngle='",this.getPrevAngle(),"'")).concat(" Pin='",parseInt(this.getPin()),"'")).concat(" Costume='",this.getCostume(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(30),this.setAngle(0),this.setPrevAngle(0)}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog(),this.createCostumeOptionsDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var e=this.getAllPossibleServoPins(),n=function(n){$("#pin").append('<button type="button" id=pin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+e[n]+"</button>"),t.getPin()==e[n]&&$("#pin"+e[n]).addClass("option_button_selected");var i=document.getElementById("pin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setPin(e),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE)}))},i=0;i<e.length;i++)n(i);1==this.getId()?($(".pinButton").prop("disabled",!0),$(".pinButton").addClass("option_button_disabled"),$("#pin40.pinButton").prop("disabled",!1),$("#pin40.pinButton").removeClass("option_button_disabled"),$("#pin40.pinButton").addClass("option_button_selected")):2==this.getId()?($(".pinButton").prop("disabled",!0),$(".pinButton").addClass("option_button_disabled"),$("#pin41.pinButton").prop("disabled",!1),$("#pin41.pinButton").removeClass("option_button_disabled"),$("#pin41.pinButton").addClass("option_button_selected")):($(".pinButton").removeClass("option_button_disabled"),$("#pin40.pinButton").prop("disabled",!0),$("#pin41.pinButton").prop("disabled",!0),$("#pin40.pinButton").addClass("option_button_disabled"),$("#pin41.pinButton").addClass("option_button_disabled"))}},{key:"getAllPossibleServoPins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,40,41]}},{key:"createCostumeOptionsDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsCostume" class="ui-widget row mb-4">'),$("#componentOptionsCostume").append('<div class="col-md-2">'+DwenguinoBlocklyLanguageSettings.translate(["servoCostume"])+"</div>"),$("#componentOptionsCostume").append('<div id="costume" class="col-md-10"></div>');for(var e={plain:"./DwenguinoIDE/img/socialrobot/servo.png",eye:"./DwenguinoIDE/img/socialrobot/eye.png",mouth:"./DwenguinoIDE/img/socialrobot/mouth.png",righthand:"./DwenguinoIDE/img/socialrobot/righthand_icon.png",lefthand:"./DwenguinoIDE/img/socialrobot/lefthand_icon.png"},n=function(){var n=I()(o[i],2),a=(n[0],n[1]);console.log(a),$("#costume").append('<div id="costume_inner" class="row"></div>'),$("#costume_inner").append("<div id=costume"+a+" name="+a+' class="col-lg-3 col-md-2 col-sm-3 col-xs-4 ml-2 mb-2 costumeButton"></div>'),$("#costume"+a).append('<img src="'+e[a]+'" class="img-fluid">');var r=document.getElementById("costume"+a);r.addEventListener("click",(function(){t._eventBus.dispatchEvent(O.CLEARCANVAS,t.getCanvasId());var e=r.getAttribute("name");switch(e){case B.PLAIN:t.setHtmlClasses("sim_canvas servo_canvas"),t.setCostume(e),t.setWidth(100),t.setHeight(50);break;case B.EYE:t.setHtmlClasses("servo_canvas"),t.setCostume(e),t.setWidth(35),t.setHeight(35);break;case B.RIGHTHAND:case B.LEFTHAND:t.setHtmlClasses("servo_canvas hand_canvas"),t.setCostume(e),t.setWidth(64),t.setHeight(149)}document.getElementById(t.getCanvasId()).className="",document.getElementById(t.getCanvasId()).className=t.getHtmlClasses(),t._eventBus.dispatchEvent(O.INITIALIZECANVAS,t),t._eventBus.dispatchEvent(O.SAVE)}))},i=0,o=Object.entries(B);i<o.length;i++)n()}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(t){this._width=t}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){this._height=t}},{key:"getHeight",value:function(t){return this._height}},{key:"setX",value:function(t){this._x=t}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(t){this._y=t}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setAngle",value:function(t){this._angle=t}},{key:"getAngle",value:function(){return this._angle}},{key:"setPrevAngle",value:function(t){this._prevAngle=t}},{key:"getPrevAngle",value:function(){return this._prevAngle}},{key:"setImage",value:function(t,e){this._image[t].src=e}},{key:"getImage",value:function(t){return this._image[t]}},{key:"setBackgroundColor",value:function(t){this._backgroundColor=t}},{key:"getBackgroundColor",value:function(){return this._backgroundColor}},{key:"setPin",value:function(t){this._pin=t}},{key:"getPin",value:function(){return this._pin}},{key:"setCostume",value:function(t){switch(this._costume=t,t){case B.PLAIN:this._image[0].src="./DwenguinoIDE/img/socialrobot/servo_head.png";break;case B.EYE:this._image[0].src="./DwenguinoIDE/img/socialrobot/eye1_background.svg",this._image[1].src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";break;case B.RIGHTHAND:this._image[0].src="./DwenguinoIDE/img/socialrobot/righthand.png";break;case B.LEFTHAND:this._image[0].src="./DwenguinoIDE/img/socialrobot/lefthand.png"}}},{key:"getServoBackground",value:function(){return this._backgroundImage}},{key:"getServoBackgroundRotated",value:function(){return this._backgroundImageRotated}},{key:"getCostume",value:function(){return this._costume}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(C);function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var F={red:"red",yellow:"yellow",blue:"blue",green:"#72f542"};Object.freeze(F);var N=function(t){m()(n,t);var e=L(n);function n(t,i,a,r,s,l,c,u,d,p,h,g,f,m){var v;return o()(this,n),(v=e.call(this,t,m))._id=i,v._type=dt.LED,v._radius=l,v._x=c,v._y=u,v._offset={left:d,top:p},v._onColor=h,v._offColor=g,v._borderColor=f,v._pin=a,v._state=r,v._canvasId="sim_led_canvas"+v._id,v.insertHtml(),v.toggleVisibility(s),v}return r()(n,[{key:"toString",value:function(){return"led"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["ledOptions"])),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Radius='",this.getRadius(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" OnColor='",this.getOnColor(),"'")).concat(" OffColor='",this.getOffColor(),"'")).concat(" BorderColor='",this.getBorderColor(),"'")).concat(" Pin='",this.getPin(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(0),this.setState(0)}},{key:"toggleVisibility",value:function(t){t?$("#sim_led"+this.getId()).css("visibility","visible"):$("#sim_led"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog(),this.createColorOptionsDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var e=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+e[n]+"</button>"),t.getPin()==e[n]&&$("#pin"+e[n]).addClass("option_button_selected");var i=document.getElementById("pin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setPin(e),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE)}))},i=0;i<e.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"createColorOptionsDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsColor" class="ui-widget row mb-4">'),$("#componentOptionsColor").append('<div class="col-md-2">Color</div>'),$("#componentOptionsColor").append('<div id="color" class="col-md-10"></div>');for(var e=function(){var e=I()(i[n],2),o=e[0],a=e[1];$("#color").append('<button type="button" id=color'+a+" name="+o+' class="col-md-1 ml-2 mb-2 colorButton"></buttons>');var r=document.getElementById("color"+a);r.classList.add(o),t.getOnColor()==o&&r.classList.add("colorButton_selected"),r.addEventListener("click",(function(){t._eventBus.dispatchEvent(O.CLEARCANVAS,t.getCanvasId());var e=r.getAttribute("name");t.setOnColor(e),$(".colorButton").removeClass("colorButton_selected"),r.classList.add("colorButton_selected"),t._eventBus.dispatchEvent(O.INITIALIZECANVAS,t),t._eventBus.dispatchEvent(O.SAVE)}))},n=0,i=Object.entries(F);n<i.length;n++)e()}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setRadius",value:function(t){this._radius=t}},{key:"getRadius",value:function(){return this._radius}},{key:"setX",value:function(t){this._x=t}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(t){this._y=t}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setOnColor",value:function(t){this._onColor=t}},{key:"getOnColor",value:function(){return this._onColor}},{key:"setOffColor",value:function(t){this._offColor=t}},{key:"getOffColor",value:function(){return this._offColor}},{key:"setBorderColor",value:function(t){this._borderColor=t}},{key:"getBorderColor",value:function(){return this._borderColor}},{key:"setPin",value:function(t){this._pin=t}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(C);function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var H=function(t){m()(n,t);var e=j(n);function n(t,i){var a,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return o()(this,n),(a=e.call(this,t,c))._id=i,a._type=dt.LCD,a._offset={left:s,top:l},a._state=new Array(2),a.insertHtml(),a.toggleVisibility(r),a}return r()(n,[{key:"toString",value:function(){return"lcd"}},{key:"insertHtml",value:function(){$("#sim_container").append("<div id='sim_lcd"+this.getId()+"' class='sim_element sim_element_lcd draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_lcd"+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_lcd"+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_lcd"+this.getId()).append("<div id='sim_element_lcd_img'></div>"),$("#sim_element_lcd_img").append('<div class="lcd" id="sim_lcd_row0"></div>'),$("#sim_element_lcd_img").append('<div class="lcd" id="sim_lcd_row1"></div>')}},{key:"removeHtml",value:function(){$("#sim_lcd"+this.getId()).remove()}},{key:"toXml",value:function(){var t="";t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){}},{key:"toggleVisibility",value:function(t){t?$("#sim_lcd"+this.getId()).css("visibility","visible"):$("#sim_lcd"+this.getId()).css("visibility","hidden")}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setState",value:function(t,e){this._state[0]=t,this._state[1]=e}},{key:"getState",value:function(){return this._state}}]),n}(C),U=function(){function t(e,n,i,a,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"";o()(this,t),this._id=e,this._parentId=n,this._minValue=i,this._maxValue=a,this._initialValue=r,this._label=s,this._valuePrefix=l,this._valueSuffix=c,this._sliderId="slider_"+this._id,this._sliderLabelId="slider_"+this._id+"_label",this._sliderValueId="slider_"+this._id+"_value",this._sliderRangeId="slider_"+this._id+"_range",this._classes=u,this.insert()}return r()(t,[{key:"toString",value:function(){return"sonar"}},{key:"insert",value:function(){document.getElementById(this.getSliderRangeId())?console.log("already exists"):(""!=this.getLabel()&&this.insertLabel(),$("#"+this.getParentId()).append('<div id="'+this.getSliderValueId()+'" class="">'+this.getValuePrefix()+this.getInitialValue()+this.getValueSuffix()+"</div>"),$("#"+this.getParentId()).append('<div id="'+this.getSliderId()+'" class="slidecontainer '+this.getClasses()+'"></div>'),$("#"+this.getSliderId()).append('<input id="'+this.getSliderRangeId()+'" type="range" min="'+this.getMinValue()+'" max="'+this.getMaxValue()+'" value="'+this.getInitialValue()+'" class="slider"></input>'))}},{key:"insertLabel",value:function(){var t='<div id="'+this.getSliderLabelId()+'" class="slider_label">'+this.getLabel()+"</div>";$("#"+this.getParentId()).append(t)}},{key:"updateValueLabel",value:function(t){document.getElementById(this.getSliderValueId()).innerHTML=this.getValuePrefix()+t+this.getValueSuffix()}},{key:"remove",value:function(){$("#"+this.getSliderLabelId()).remove(),$("#"+this.getSliderValueId()).remove(),$("#"+this.getSliderId()).remove()}},{key:"getParentId",value:function(){return this._parentId}},{key:"getSliderElement",value:function(){return document.getElementById(this.getSliderRangeId())}},{key:"getInitialValue",value:function(){return this._initialValue}},{key:"getMinValue",value:function(){return this._minValue}},{key:"getMaxValue",value:function(){return this._maxValue}},{key:"getLabel",value:function(){return this._label}},{key:"getValuePrefix",value:function(){return this._valuePrefix}},{key:"getValueSuffix",value:function(){return this._valueSuffix}},{key:"getSliderId",value:function(){return this._sliderId}},{key:"getSliderLabelId",value:function(){return this._sliderLabelId}},{key:"getSliderValueId",value:function(){return this._sliderValueId}},{key:"getSliderRangeId",value:function(){return this._sliderRangeId}},{key:"getClasses",value:function(){return this._classes}}]),t}();function G(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var W=function(t){m()(n,t);var e=G(n);function n(t,i){var a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:58,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,g=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"sim_canvas sonar_canvas";return o()(this,n),(a=e.call(this,t,g))._id=i,a._type=dt.SONAR,a._width=u,a._height=d,a._offset={left:p,top:h},a._image=new Image,a._image.src="./DwenguinoIDE/img/board/sonar.png",a._echoPin=r,a._triggerPin=s,a._state=l,a._stateUpdated=!1,a._slider=null,a._canvasId="sim_sonar_canvas"+a._id,a.insertHtml(),a.toggleVisibility(c),a}return r()(n,[{key:"toString",value:function(){return"sonar"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var e=DwenguinoBlocklyLanguageSettings.translate(["sonarSliderLabel"])+" "+this.getId(),n=""+this.getType()+this.getId();this._slider=new U(n,"sensor_options",0,200,0,e,""," cm","sonar_slider");var i=this;this._slider.getSliderElement().oninput=function(){var t=i.getId();i.changeSonarDistance(this.value,t),i._slider.updateValueLabel(this.value)},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["sonarOptions"])),t.showDialog()}))}},{key:"changeSonarDistance",value:function(t){this.setState(t),this._stateUpdated=!0,this._eventBus.dispatchEvent(O.SAVE)}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove(),this.getSlider().remove()}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" EchoPin='",this.getEchoPin(),"'")).concat(" TriggerPin='",this.getTriggerPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){}},{key:"toggleVisibility",value:function(t){t?$("#sim_sonar"+this.getId()).css("visibility","visible"):$("#sim_sonar"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsTriggerPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsTriggerPin").append('<div class="col-md-2">Trigger pin</div>'),$("#componentOptionsTriggerPin").append('<div id="triggerPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsEchoPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsEchoPin").append('<div class="col-md-2">Echo pin</div>'),$("#componentOptionsEchoPin").append('<div id="echoPin" class="col-md-10"></div>');for(var e=this.getAllPossiblePins(),n=0;n<e.length;n++)$("#triggerPin").append('<button type="button" id=triggerPin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 triggerPinButton pinButton option_button_enabled">'+e[n]+"</button>"),$("#echoPin").append('<button type="button" id=echoPin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 echoPinButton pinButton option_button_enabled">'+e[n]+"</button>");for(var i=function(n){t.getTriggerPin()==e[n]&&($("#triggerPin"+e[n]).addClass("option_button_selected"),$("#echoPin"+e[n]).addClass("option_button_disabled"),$("#echoPin"+e[n]).prop("disabled",!0)),t.getEchoPin()==e[n]&&($("#echoPin"+e[n]).addClass("option_button_selected"),$("#triggerPin"+e[n]).addClass("option_button_disabled"),$("#triggerPin"+e[n]).prop("disabled",!0));var i=document.getElementById("triggerPin"+e[n]),o=document.getElementById("echoPin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setTriggerPin(e),$(".triggerPinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE),$(".echoPinButton").removeClass("option_button_disabled"),$(".echoPinButton").prop("disabled",!1),$("#echoPin"+e).addClass("option_button_disabled"),$("#echoPin"+e).prop("disabled",!0)})),o.addEventListener("click",(function(){var e=o.name;t.setEchoPin(e),$(".echoPinButton").removeClass("option_button_selected"),o.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE),$(".triggerPinButton").removeClass("option_button_disabled"),$(".triggerPinButton").prop("disabled",!1),$("#triggerPin"+e).addClass("option_button_disabled"),$("#triggerPin"+e).prop("disabled",!0)}))},o=0;o<e.length;o++)i(o)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(t){this._width=t}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){this._height=t}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(t){this._image.src=t}},{key:"getImage",value:function(){return this._image}},{key:"setEchoPin",value:function(t){this._echoPin=t}},{key:"getEchoPin",value:function(){return this._echoPin}},{key:"setTriggerPin",value:function(t){this._triggerPin=t}},{key:"getTriggerPin",value:function(){return this._triggerPin}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getSlider",value:function(){return this._slider}}]),n}(C),V={SERVO:"servo",DCMOTOR:"dcmotor",LED:"led",RGBLED:"rgbled",TOUCH:"touch",PIR:"pir",SONAR:"sonar",LCD:"lcd",SOUND:"sound",LIGHT:"light",BUZZER:"buzzer"};Object.freeze(V);var X=function t(){if(o()(this,t),void 0===this.toString)throw new Error("You have to implement the method toString");if(void 0===this.getType)throw new Error("You have to implement the method getType")};function Y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var K=function(t){m()(n,t);var e=Y(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"sound"}}],[{key:"getType",value:function(){return V.SOUND}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["sonarDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(X),z=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";o()(this,t),this._id=e,this._parentId=n,this._label=i,this._buttonLabelId="button_"+this._id+"_label",this._buttonId="button_"+this._id+"_button",this._labelClasses=a,this._activeClasses="dwenguino_button dwenguino_button_pushed",this._inactiveClasses="dwenguino_button",this.insert()}return r()(t,[{key:"toString",value:function(){return"sonar"}},{key:"insert",value:function(){document.getElementById(this.getButtonId())?console.log("A button with id ",this.getButtonId()," already exists."):(""!=this.getLabel()&&$("#"+this.getParentId()).append('<div id="'+this.getButtonLabelId()+'" class="'+this.getLabelClasses()+'">'+this.getLabel()+"</div>"),$("#"+this.getParentId()).append('<div id="'+this.getButtonId()+'" class="'+this.getInactiveClasses()+'"></div>'))}},{key:"update",value:function(){this.isInactive()?this.getButtonElement().className=this.getActiveClasses():this.getButtonElement().className=this.getInactiveClasses()}},{key:"remove",value:function(){$("#"+this.getButtonLabelId()).remove(),$("#"+this.getButtonId()).remove()}},{key:"getParentId",value:function(){return this._parentId}},{key:"getButtonElement",value:function(){return document.getElementById(this.getButtonId())}},{key:"getLabel",value:function(){return this._label}},{key:"getButtonLabelId",value:function(){return this._buttonLabelId}},{key:"getButtonId",value:function(){return this._buttonId}},{key:"getLabelClasses",value:function(){return this._labelClasses}},{key:"getInactiveClasses",value:function(){return this._inactiveClasses}},{key:"getActiveClasses",value:function(){return this._activeClasses}},{key:"isInactive",value:function(){return this.getButtonElement().className===this.getInactiveClasses()}},{key:"isActive",value:function(){return this.getButtonElement().className===this.getActiveClasses()}}]),t}();function q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Q=function(t){m()(n,t);var e=q(n);function n(t,i,a,r,s,l,c,u,d,p){var h;return o()(this,n),(h=e.call(this,t,p))._id=i,h._type=dt.PIR,h._width=l,h._height=c,h._offset={left:u,top:d},h._image=new Image,h._image.src="./DwenguinoIDE/img/socialrobot/pir_off.png",h._pin=a,h._state=r,h._stateUpdated=!1,h._canvasId="sim_pir_canvas"+h._id,h._button=null,h.insertHtml(),h.toggleVisibility(s),h}return r()(n,[{key:"toString",value:function(){return"pir"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var e=DwenguinoBlocklyLanguageSettings.translate(["pirButtonLabel"])+" "+this.getId(),n=""+this.getType()+this.getId();this._button=new z(n,"sensor_options",e);var i=this;this._button.getButtonElement().onclick=function(){i._button.update(),i._button.isActive()?(i.setImage("./DwenguinoIDE/img/socialrobot/pir_on.png"),i.setState(1),i._stateUpdated=!0,i._eventBus.dispatchEvent(O.SAVE)):(i.setImage("./DwenguinoIDE/img/socialrobot/pir_off.png"),i.setState(0),i._stateUpdated=!0,i._eventBus.dispatchEvent(O.SAVE))},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["pirOptions"])),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove(),this.getButton().remove()}},{key:"toggleVisibility",value:function(t){t?$("#sim_pir"+this.getId()).css("visibility","visible"):$("#sim_pir"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var e=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+e[n]+"</button>"),t.getPin()==e[n]&&$("#pin"+e[n]).addClass("option_button_selected");var i=document.getElementById("pin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setPin(e),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE)}))},i=0;i<e.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(t){this._width=t}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){this._height=t}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(t){this._image.src=t}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(t){this._pin=t}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getButton",value:function(){return this._button}}]),n}(C);function J(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Z=function(t){m()(n,t);var e=J(n);function n(t,i,a,r,s,l,c,u,d,p){var h;return o()(this,n),(h=e.call(this,t,p))._id=i,h._type=dt.SOUND,h._width=l,h._height=c,h._offset={left:u,top:d},h._image=new Image,h._image.src="./DwenguinoIDE/img/socialrobot/sound_sensor.png",h._pin=a,h._state=r,h._stateUpdated=!1,h._canvasId="sim_sound_canvas"+h._id,h._button=null,h.insertHtml(),h.toggleVisibility(s),h}return r()(n,[{key:"toString",value:function(){return"sound sensor"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var e=DwenguinoBlocklyLanguageSettings.translate(["soundButtonLabel"])+" "+this.getId(),n=""+this.getType()+this.getId();this._button=new z(n,"sensor_options",e);var i=this;this._button.getButtonElement().onclick=function(){i._button.update(),i._button.isActive()?(i.setImage("./DwenguinoIDE/img/socialrobot/sound_sensor.png"),i.setState(1),i._stateUpdated=!0,i._eventBus.dispatchEvent(O.SAVE)):(i.setImage("./DwenguinoIDE/img/socialrobot/sound_sensor.png"),i.setState(0),i._stateUpdated=!0,i._eventBus.dispatchEvent(O.SAVE))},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["soundOptions"])),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove(),this.getButton().remove()}},{key:"toggleVisibility",value:function(t){t?$("#sim_sound"+this.getId()).css("visibility","visible"):$("#sim_sound"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var e=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+e[n]+"</button>"),t.getPin()==e[n]&&$("#pin"+e[n]).addClass("option_button_selected");var i=document.getElementById("pin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setPin(e),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE)}))},i=0;i<e.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(t){this._width=t}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){this._height=t}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(t){this._image.src=t}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(t){this._pin=t}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getButton",value:function(){return this._button}}]),n}(C);function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var et=function(t){m()(n,t);var e=tt(n);function n(t,i,a,r,s,l,c,u,d,p){var h;return o()(this,n),(h=e.call(this,t,p))._id=i,h._type=dt.LIGHT,h._width=l,h._height=c,h._offset={left:u,top:d},h._image=new Image,h._image.src="./DwenguinoIDE/img/socialrobot/light_sensor.png",h._pin=a,h._state=r,h._stateUpdated=!1,h._canvasId="sim_light_canvas"+h._id,h._slider=null,h.insertHtml(),h.toggleVisibility(s),h}return r()(n,[{key:"toString",value:function(){return"light sensor"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var e=DwenguinoBlocklyLanguageSettings.translate(["lightSensorSliderLabel"])+" "+this.getId(),n=""+this.getType()+this.getId();this._slider=new U(n,"sensor_options",0,4095,0,e,"","","light_sensor_slider");var i=this;this._slider.getSliderElement().oninput=function(){var t=i.getId();i.changeLightSensorValue(this.value,t),i._slider.updateValueLabel(this.value)},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["lightOptions"])),t.showDialog()}))}},{key:"changeLightSensorValue",value:function(t){this.setState(t),this._stateUpdated=!0,this._eventBus.dispatchEvent(O.SAVE)}},{key:"removeHtml",value:function(){$("#sim_light"+this.getId()).remove(),this.getSlider().remove()}},{key:"toggleVisibility",value:function(t){t?$("#sim_light"+this.getId()).css("visibility","visible"):$("#sim_light"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var e=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+e[n]+"</button>"),t.getPin()==e[n]&&$("#pin"+e[n]).addClass("option_button_selected");var i=document.getElementById("pin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setPin(e),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE)}))},i=0;i<e.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return["A0","A1","A2","A3","A4","A5"]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(t){this._width=t}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){this._height=t}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(t){this._image.src=t}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(t){this._pin=t}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getSlider",value:function(){return this._slider}}]),n}(C);function nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var it=function(t){m()(n,t);var e=nt(n);function n(t,i,a,r,s,l,c,u,d,p,h,g,f){var m;return o()(this,n),(m=e.call(this,t,f))._id=i,m._type=dt.RGBLED,m._radius=u,m._x=d,m._y=p,m._offset={left:h,top:g},m._offColor="gray",m._redPin=a,m._greenPin=r,m._bluePin=s,m._state=l,m._canvasId="sim_rgbled_canvas"+m._id,m._ledSvg=new Image,m._ledSvg.src="./DwenguinoIDE/img/socialrobot/rgb_led_top.svg",m._ledBackground=new Image,m._ledBackground.src="./DwenguinoIDE/img/socialrobot/rgb_led_background.svg",m.insertHtml(),m.toggleVisibility(c),m}return r()(n,[{key:"toString",value:function(){return"RGB LED"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["rgbLedOptions"])),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Radius='",this.getRadius(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" RedPin='",this.getRedPin(),"'")).concat(" GreenPin='",this.getGreenPin(),"'")).concat(" BluePin='",this.getBluePin(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(0),this.setState([0,0,0])}},{key:"toggleVisibility",value:function(t){t?$("#sim_led"+this.getId()).css("visibility","visible"):$("#sim_led"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsRedPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsRedPin").append('<div class="col-md-2">Red pin</div>'),$("#componentOptionsRedPin").append('<div id="redPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsGreenPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsGreenPin").append('<div class="col-md-2">Green pin</div>'),$("#componentOptionsGreenPin").append('<div id="greenPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsBluePin" class="ui-widget row mb-4"></div>'),$("#componentOptionsBluePin").append('<div class="col-md-2">Blue pin</div>'),$("#componentOptionsBluePin").append('<div id="bluePin" class="col-md-10"></div>');for(var e=this.getAllPossiblePins(),n=0;n<e.length;n++)$("#redPin").append('<button type="button" id=redPin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 redPinButton pinButton option_button_enabled">'+e[n]+"</button>"),$("#greenPin").append('<button type="button" id=greenPin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 greenPinButton pinButton option_button_enabled">'+e[n]+"</button>"),$("#bluePin").append('<button type="button" id=bluePin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 bluePinButton pinButton option_button_enabled">'+e[n]+"</button>");for(var i=function(n){t.getRedPin()==e[n]&&($("#redPin"+e[n]).addClass("option_button_selected"),$("#greenPin"+e[n]).addClass("option_button_disabled"),$("#greenPin"+e[n]).prop("disabled",!0),$("#bluePin"+e[n]).addClass("option_button_disabled"),$("#bluePin"+e[n]).prop("disabled",!0)),t.getGreenPin()==e[n]&&($("#greenPin"+e[n]).addClass("option_button_selected"),$("#redPin"+e[n]).addClass("option_button_disabled"),$("#redPin"+e[n]).prop("disabled",!0),$("#bluePin"+e[n]).addClass("option_button_disabled"),$("#bluePin"+e[n]).prop("disabled",!0)),t.getBluePin()==e[n]&&($("#bluePin"+e[n]).addClass("option_button_selected"),$("#redPin"+e[n]).addClass("option_button_disabled"),$("#redPin"+e[n]).prop("disabled",!0),$("#greenPin"+e[n]).addClass("option_button_disabled"),$("#greenPin"+e[n]).prop("disabled",!0));var i=document.getElementById("redPin"+e[n]),o=document.getElementById("greenPin"+e[n]),a=document.getElementById("bluePin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setRedPin(e),$(".redPinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE),$(".greenPinButton").removeClass("option_button_disabled"),$(".greenPinButton").prop("disabled",!1),$("#greenPin"+e).addClass("option_button_disabled"),$("#greenPin"+e).prop("disabled",!0),$(".bluePinButton").removeClass("option_button_disabled"),$(".bluePinButton").prop("disabled",!1),$("#bluePin"+e).addClass("option_button_disabled"),$("#bluePin"+e).prop("disabled",!0)})),o.addEventListener("click",(function(){var e=o.name;t.setGreenPin(e),$(".greenPinButton").removeClass("option_button_selected"),o.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE),$(".redPinButton").removeClass("option_button_disabled"),$(".redPinButton").prop("disabled",!1),$("#redPin"+e).addClass("option_button_disabled"),$("#redPin"+e).prop("disabled",!0),$(".bluePinButton").removeClass("option_button_disabled"),$(".bluePinButton").prop("disabled",!1),$("#bluePin"+e).addClass("option_button_disabled"),$("#bluePin"+e).prop("disabled",!0)})),a.addEventListener("click",(function(){var e=i.name;t.setBluePin(e),$(".bluePinButton").removeClass("option_button_selected"),a.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE),$(".redPinButton").removeClass("option_button_disabled"),$(".redPinButton").prop("disabled",!1),$("#redPin"+e).addClass("option_button_disabled"),$("#redPin"+e).prop("disabled",!0),$(".greenPinButton").removeClass("option_button_disabled"),$(".greenPinButton").prop("disabled",!1),$("#greenPin"+e).addClass("option_button_disabled"),$("#greenPin"+e).prop("disabled",!0)}))},o=0;o<e.length;o++)i(o)}},{key:"getAllPossiblePins",value:function(){return["3","5","6","11","14","A0","A1","A2","A3","A4","A5"]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setRadius",value:function(t){this._radius=t}},{key:"getRadius",value:function(){return this._radius}},{key:"setX",value:function(t){this._x=t}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(t){this._y=t}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setRedPin",value:function(t){this._redPin=t}},{key:"getRedPin",value:function(){return this._redPin}},{key:"setGreenPin",value:function(t){this._greenPin=t}},{key:"getGreenPin",value:function(){return this._greenPin}},{key:"setBluePin",value:function(t){this._bluePin=t}},{key:"getBluePin",value:function(){return this._bluePin}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getLedSvg",value:function(){return this._ledSvg}},{key:"getLedBackground",value:function(){return this._ledBackground}}]),n}(C);function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var at=function(t){m()(n,t);var e=ot(n);function n(t,i,a,r,s,l,c,u,d,p){var h;return o()(this,n),(h=e.call(this,t,p))._id=i,h._type=dt.TOUCH,h._width=l,h._height=c,h._offset={left:u,top:d},h._image=new Image,h._image.src="./DwenguinoIDE/img/socialrobot/touch_sensor.svg",h._pin=a,h._state=r,h._stateUpdated=!1,h._canvasId="sim_touch_canvas"+h._id,h._button=null,h.insertHtml(),h.toggleVisibility(s),h}return r()(n,[{key:"toString",value:function(){return"touch sensor"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var e=DwenguinoBlocklyLanguageSettings.translate(["touchButtonLabel"])+" "+this.getId(),n=""+this.getType()+this.getId();this._button=new z(n,"sensor_options",e);var i=this;this._button.getButtonElement().onclick=function(){i._button.update(),i._button.isActive()?(i.setImage("./DwenguinoIDE/img/socialrobot/touch_sensor_on.svg"),i.setState(1),i._stateUpdated=!0,i._eventBus.dispatchEvent(O.SAVE)):(i.setImage("./DwenguinoIDE/img/socialrobot/touch_sensor.svg"),i.setState(0),i._stateUpdated=!0,i._eventBus.dispatchEvent(O.SAVE))},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(""),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove(),this.getButton().remove()}},{key:"toggleVisibility",value:function(t){t?$("#sim_touch"+this.getId()).css("visibility","visible"):$("#sim_touch"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var e=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+e[n]+"</button>"),t.getPin()==e[n]&&$("#pin"+e[n]).addClass("option_button_selected");var i=document.getElementById("pin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setPin(e),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE)}))},i=0;i<e.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(t){this._width=t}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){this._height=t}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(t){this._image.src=t}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(t){this._pin=t}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getButton",value:function(){return this._button}}]),n}(C);function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var st=function(t){m()(n,t);var e=rt(n);function n(t,i,a,r,s,l,c,u,d,p){var h;return o()(this,n),(h=e.call(this,t,p))._id=i,h._type=dt.BUTTON,h._width=l,h._height=c,h._offset={left:u,top:d},h._pin=a,h._state=r,h._stateUpdated=!1,h._canvasId="sim_button_canvas"+h._id,h._button=null,h.insertHtml(),h.toggleVisibility(s),h}return r()(n,[{key:"toString",value:function(){return"pir"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<div id='"+this.getCanvasId()+"' class='button_canvas_unpushed "+this.getHtmlClasses()+"'></div>"),console.log(this.getState());var e=this;this._button=document.getElementById(this.getCanvasId()),this._button.onmousedown=function(){e.set,e._button.className="button_canvas_pushed "+e.getHtmlClasses(),e.setState(1),e._stateUpdated=!0,console.log(e.getState(),"mousedown"),e._eventBus.dispatchEvent(O.SAVE)},this._button.onmouseup=function(){e.set,e._button.className="button_canvas_unpushed "+e.getHtmlClasses(),e.setState(0),e._stateUpdated=!0,console.log(e.getState(),"mouseup"),e._eventBus.dispatchEvent(O.SAVE)},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["buttonOptions"])),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toggleVisibility",value:function(t){t?$("#sim_button"+this.getId()).css("visibility","visible"):$("#sim_button"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var t="";t=(t=(t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var t=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var e=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+e[n]+" name="+e[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+e[n]+"</button>"),t.getPin()==e[n]&&$("#pin"+e[n]).addClass("option_button_selected");var i=document.getElementById("pin"+e[n]);i.addEventListener("click",(function(){var e=i.name;t.setPin(e),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),t._eventBus.dispatchEvent(O.SAVE)}))},i=0;i<e.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(t){this._width=t}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){this._height=t}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setPin",value:function(t){this._pin=t}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getButton",value:function(){return this._button}}]),n}(C);function lt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var ct={DISPLAY:"display",SEGMENT:"segment"};Object.freeze(ct);var ut=function(t){m()(n,t);var e=lt(n);function n(t,i,a,r,s,l,c,u,d,p,h){var g;return o()(this,n),(g=e.call(this,t,h))._id=i,g._type=dt.LEDMATRIXSEGMENT,g._x=c,g._y=u,g._offset={left:d,top:p},g._dataPin=a,g._csPin=r,g._clkPin=s,console.log("state adjusted"),g._state=n.getEmptyLedMatrix(),g._canvasId="sim_ledmatrixsegment_canvas"+g._id,g._ledSvg=new Image,g._ledSvg.src="./DwenguinoIDE/img/socialrobot/led_matrix_on.svg",g._ledOffsets={left:15,led_x:1.14,led_y:1.25,led_between_x:8.65,led_between_y:8.53,led_radius:6.35},g._ledmatrixBackground=new Image,g._ledmatrixBackground.src="./DwenguinoIDE/img/socialrobot/led_matrix_1x1.svg",g.insertHtml(),g.toggleVisibility(l),g}return r()(n,[{key:"toString",value:function(){return"LED MATRIX"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["ledmatrixOptions"])),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toXml",value:function(){var t="";t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" DataPin='",this.getDataPin(),"'")).concat(" CsPin='",this.getCsPin(),"'")).concat(" ClkPin='",this.getClkPin(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(0);var t={dataType:ct.DISPLAY,data:n.getEmptyLedMatrix()};this.setState(t)}},{key:"toggleVisibility",value:function(t){t?$("#sim_ledmatrix"+this.getId()).css("visibility","visible"):$("#sim_ledmatrix"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){$("#componentOptionsModalBody").append('<div id="componentOptionsDataPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsDataPin").append('<div class="col-md-2">Data pin</div>'),$("#componentOptionsDataPin").append('<div id="dataPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsCsPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsCsPin").append('<div class="col-md-2">Cs pin</div>'),$("#componentOptionsCsPin").append('<div id="csPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsClkPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsClkPin").append('<div class="col-md-2">Clk pin</div>'),$("#componentOptionsClkPin").append('<div id="clkPin" class="col-md-10"></div>');var t=this.getPossibleDataPin(),e=this.getPossibleCsPin(),n=this.getPossibleClkPin();$("#dataPin").append('<button type="button" id=dataPin'+t+" name="+t+' class="col-md-1 ml-2 mb-2 dataPinButton pinButton option_button_enabled">'+t+"</button>"),$("#dataPin"+t).addClass("option_button_selected"),$("#csPin").append('<button type="button" id=csPin'+e+" name="+e+' class="col-md-1 ml-2 mb-2 csPinButton pinButton option_button_enabled">'+e+"</button>"),$("#csPin"+e).addClass("option_button_selected"),$("#clkPin").append('<button type="button" id=clkPin'+n+" name="+n+' class="col-md-1 ml-2 mb-2 clkPinButton pinButton option_button_enabled">'+n+"</button>"),$("#clkPin"+n).addClass("option_button_selected")}},{key:"getPossibleDataPin",value:function(){return"2"}},{key:"getPossibleCsPin",value:function(){return"10"}},{key:"getPossibleClkPin",value:function(){return"13"}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setX",value:function(t){this._x=t}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(t){this._y=t}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setDataPin",value:function(t){this._dataPin=t}},{key:"getDataPin",value:function(){return this._dataPin}},{key:"setCsPin",value:function(t){this._csPin=t}},{key:"getCsPin",value:function(){return this._csPin}},{key:"setClkPin",value:function(t){this._clkPin=t}},{key:"getClkPin",value:function(){return this._clkPin}},{key:"setState",value:function(t){if(t.dataType==ct.DISPLAY)for(var e=0;e<4;e++)this._state[e]=t.data[e];else if(t.dataType==ct.SEGMENT){var n=t.data[0];this._state[n]=t.data[1]}}},{key:"getState",value:function(){return this._state}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getLedSvg",value:function(){return this._ledSvg}},{key:"getLedOffsets",value:function(){return this._ledOffsets}},{key:"getLedmatrixBackground",value:function(){return this._ledmatrixBackground}}],[{key:"getEmptyLedMatrix",value:function(){return[[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]]}}]),n}(C),dt={SERVO:"servo",LED:"led",RGBLED:"rgbled",LEDMATRIX:"ledmatrix",LEDMATRIXSEGMENT:"ledmatrixsegment",TOUCH:"touch",PIR:"pir",SONAR:"sonar",LCD:"lcd",SOUND:"sound",LIGHT:"light",BUTTON:"button"};Object.freeze(dt);var pt=function(){function t(e,n,i){o()(this,t),l()(this,"logger",null),l()(this,"inputState",{pir:0,buttons:[1,1,1,1,1],sonarDistance:-1}),this.logger=n,this._eventBus=i,this._robot=[],this._numberOfComponentsOfType={},this.scenarioUtils=e,this.renderer=new M;for(var a=0,r=Object.entries(dt);a<r.length;a++){var s=I()(r[a],2),c=(s[0],s[1]);this._numberOfComponentsOfType[c]=0}}return r()(t,[{key:"getRobot",value:function(){return this._robot}},{key:"resetSocialRobot",value:function(){for(var t=0;t<this._robot.length;t++)this._robot[t].reset()}},{key:"removeAllSocialRobotComponents",value:function(){for(var t=0;t<this._robot.length;t++)this.removeRobotComponent(this._robot[t])}},{key:"updateScenarioState",value:function(t){for(var e=0;e<this._robot.length;e++){var n=0,i=0;switch(this._robot[e].getType()){case dt.SERVO:n=this._robot[e].getPin(),this._robot[e].getAngle()!=t.getIoPinState(n)&&(this._robot[e].setPrevAngle(this._robot[e].getAngle()),this._robot[e].setAngle(t.getIoPinState(n)));break;case dt.LED:n=this._robot[e].getPin(),this._robot[e].setState(t.getIoPinState(n));break;case dt.RGBLED:var o=this._robot[e].getRedPin(),a=this._robot[e].getGreenPin(),r=this._robot[e].getBluePin();i=[t.getIoPinState(o),t.getIoPinState(a),t.getIoPinState(r)],this._robot[e].setState(i);break;case dt.LEDMATRIX:var s=this._robot[e].getDataPin();i=t.getIoPinState(s),this._robot[e].setState(i);break;case dt.LEDMATRIXSEGMENT:var l=this._robot[e].getDataPin();i=t.getIoPinState(l),this._robot[e].setState(i);break;case dt.TOUCH:n=this._robot[e].getPin(),this._robot[e].isStateUpdated()&&(t.setIoPinState(n,this._robot[e].getState()),this._robot[e]._stateUpdated=!1);break;case dt.BUTTON:n=this._robot[e].getPin(),this._robot[e].isStateUpdated()&&(console.log(this._robot[e].getState(),"updateScenarioState"),t.setIoPinState(n,this._robot[e].getState()),this._robot[e]._stateUpdated=!1);break;case dt.PIR:n=this._robot[e].getPin(),this._robot[e].isStateUpdated()&&(t.setIoPinState(n,this._robot[e].getState()),this._robot[e]._stateUpdated=!1);break;case dt.SONAR:var c=this._robot[e].getEchoPin(),u=this._robot[e].getTriggerPin();this._robot[e].isStateUpdated()&&(t.setIoPinState(c,this._robot[e].getState()),t.setIoPinState(u,this._robot[e].getState()),this._robot[e]._stateUpdated=!1);break;case dt.LCD:this._robot[e].setState(t.getLcdContent(0),t.getLcdContent(1));break;case dt.SOUND:case dt.LIGHT:n=this._robot[e].getPin(),this._robot[e].isStateUpdated()&&(t.setIoPinState(n,this._robot[e].getState()),this._robot[e]._stateUpdated=!1)}}}},{key:"getRobotComponentWithTypeAndId",value:function(t,e){for(var n=0;n<this._robot.length;n++)if(this._robot[n].getType()==t&&this._robot[n].getId()==e)return this._robot[n]}},{key:"removeRobotComponentWithTypeAndId",value:function(t,e){this.getRobotComponentWithTypeAndId(t,e).removeHtml();for(var n=0;n<this._robot.length;n++)this._robot[n].getType()==t&&this._robot[n].getId()==e&&(this._robot.splice(n,1),this.decrementNumberOf(t))}},{key:"addRobotComponent",value:function(t){switch(t){case dt.SERVO:this.addServo();break;case dt.LED:this.addLed();break;case dt.RGBLED:this.addRgbLed();break;case dt.LEDMATRIX:this.addLedmatrix();break;case dt.LEDMATRIXSEGMENT:this.addLedmatrixSegment();break;case dt.TOUCH:this.addTouchSensor();break;case dt.BUTTON:this.addButton();break;case dt.PIR:this.addPir();break;case dt.SONAR:this.addSonar();break;case dt.LCD:this.addLcd();break;case dt.SOUND:this.addSoundSensor();break;case dt.LIGHT:this.addLightSensor()}}},{key:"removeRobotComponent",value:function(t){switch(t){case dt.SERVO:this.removeServo();break;case dt.LED:this.removeLed();break;case dt.RGBLED:this.removeRgbLed();break;case dt.LEDMATRIX:this.removeLedmatrix();break;case dt.LEDMATRIXSEGMENT:this.removeLedmatrixSegment();break;case dt.TOUCH:this.removeTouchSensor();break;case dt.BUTTON:this.removeButton();break;case dt.PIR:this.removePir();break;case dt.SONAR:this.removeSonar();break;case dt.LCD:this.removeLcd();break;case dt.SOUND:this.removeSoundSensor();break;case dt.LIGHT:this.removeLightSensor()}}},{key:"addRobotComponentFromXml",value:function(t){switch(t.getAttribute("Type")){case dt.SERVO:var e=parseFloat(t.getAttribute("Width")),n=parseFloat(t.getAttribute("Height")),i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),a=parseInt(t.getAttribute("Angle")),r=parseInt(t.getAttribute("Pin")),s=t.getAttribute("Costume"),l=t.getAttribute("Classes");this.addServo(r,s,a,!0,0,0,e,n,i,o,l);break;case dt.LED:var c=parseFloat(t.getAttribute("Radius")),u=(i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),t.getAttribute("OnColor")),d=t.getAttribute("OffColor"),p=t.getAttribute("BorderColor");r=parseInt(t.getAttribute("Pin")),l=t.getAttribute("Classes");this.addLed(r,0,!0,c,0,0,i,o,u,d,p,l);break;case dt.RGBLED:c=parseFloat(t.getAttribute("Radius")),i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop"));var h=t.getAttribute("RedPin"),g=t.getAttribute("GreenPin"),f=t.getAttribute("BluePin");l=t.getAttribute("Classes");this.addRgbLed(h,g,f,[0,0,0],!0,c,0,0,i,o,l);break;case dt.LEDMATRIX:i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop"));var m=t.getAttribute("DataPin"),v=t.getAttribute("csPin"),_=t.getAttribute("clkPin");l=t.getAttribute("Classes");this.addLedmatrix(m,v,_,!0,0,0,i,o,l);break;case dt.LEDMATRIXSEGMENT:i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),m=t.getAttribute("DataPin"),v=t.getAttribute("csPin"),_=t.getAttribute("clkPin"),l=t.getAttribute("Classes");this.addLedmatrixSegment(m,v,_,!0,0,0,i,o,l);break;case dt.TOUCH:e=parseFloat(t.getAttribute("Width")),n=parseFloat(t.getAttribute("Height")),i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),r=parseInt(t.getAttribute("Pin"));var y=parseInt(t.getAttribute("State"));l=t.getAttribute("Classes");this.addTouchSensor(r,y,!0,e,n,i,o,l);break;case dt.BUTTON:e=parseFloat(t.getAttribute("Width")),n=parseFloat(t.getAttribute("Height")),i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),r=parseInt(t.getAttribute("Pin")),l=t.getAttribute("Classes");this.addButton(r,!0,e,n,i,o,l);break;case dt.PIR:e=parseFloat(t.getAttribute("Width")),n=parseFloat(t.getAttribute("Height")),i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),r=parseInt(t.getAttribute("Pin")),y=parseInt(t.getAttribute("State")),l=t.getAttribute("Classes");this.addPir(r,y,!0,e,n,i,o,l);break;case dt.SONAR:e=parseFloat(t.getAttribute("Width")),n=parseFloat(t.getAttribute("Height")),i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop"));var b=parseInt(t.getAttribute("EchoPin")),k=parseInt(t.getAttribute("TriggerPin"));y=parseInt(t.getAttribute("State")),l=t.getAttribute("Classes");this.addSonar(b,k,y,!0,e,n,i,o,l);break;case dt.LCD:i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),l=t.getAttribute("Classes");this.addLcd(!0,i,o,l);break;case dt.SOUND:e=parseFloat(t.getAttribute("Width")),n=parseFloat(t.getAttribute("Height")),i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),r=parseInt(t.getAttribute("Pin")),y=parseInt(t.getAttribute("State")),l=t.getAttribute("Classes");this.addSoundSensor(r,y,!0,e,n,i,o,l);break;case dt.LIGHT:e=parseFloat(t.getAttribute("Width")),n=parseFloat(t.getAttribute("Height")),i=parseFloat(t.getAttribute("OffsetLeft")),o=parseFloat(t.getAttribute("OffsetTop")),r=parseInt(t.getAttribute("Pin")),y=parseInt(t.getAttribute("State")),l=t.getAttribute("Classes");this.addLightSensor(r,y,!0,e,n,i,o,l)}}},{key:"addServo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B.PLAIN,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:50,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"sim_canvas servo_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.SERVO)),this.incrementNumberOf(dt.SERVO);var d=this._numberOfComponentsOfType[dt.SERVO];1==d?t=40:2==d&&(t=41);var p=new D(this._eventBus,d,t,e,n,i,o,a,r,s,l,c,u);this._robot.push(p),this.renderer.initializeCanvas(this._robot,p)}},{key:"removeServo",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.SERVO));var t=this._numberOfComponentsOfType[dt.SERVO];this.removeRobotComponentWithTypeAndId(dt.SERVO,t)}},{key:"addLed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"yellow",c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"gray",u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"black",d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"sim_canvas led_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.LED)),this.incrementNumberOf(dt.LED);var p=this._numberOfComponentsOfType[dt.LED],h=new N(this._eventBus,p,t,e,n,i,o,a,r,s,l,c,u,d);this._robot.push(h),this.renderer.initializeCanvas(this._robot,h)}},{key:"removeLed",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.LED));var t=this._numberOfComponentsOfType[dt.LED];this.removeRobotComponentWithTypeAndId(dt.LED,t)}},{key:"addRgbLed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"3",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"5",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"6",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"sim_canvas rgbled_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.RGBLED)),this.incrementNumberOf(dt.RGBLED);var d=this._numberOfComponentsOfType[dt.RGBLED],p=new it(this._eventBus,d,t,e,n,i,o,a,r,s,l,c,u);this._robot.push(p),this.renderer.initializeCanvas(this._robot,p)}},{key:"removeRgbLed",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.RGBLED));var t=this._numberOfComponentsOfType[dt.RGBLED];this.removeRobotComponentWithTypeAndId(dt.RGBLED,t)}},{key:"addLedmatrix",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"10",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"13",i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"sim_canvas ledmatrix_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.LEDMATRIX)),this.incrementNumberOf(dt.LEDMATRIX);var c=this._numberOfComponentsOfType[dt.LEDMATRIX],u=new ft(this._eventBus,c,t,e,n,i,o,a,r,s,l);this._robot.push(u),this.renderer.initializeCanvas(this._robot,u)}},{key:"removeLedmatrix",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.LEDMATRIX));var t=this._numberOfComponentsOfType[dt.LEDMATRIX];this.removeRobotComponentWithTypeAndId(dt.LEDMATRIX,t)}},{key:"addLedmatrixSegment",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"10",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"13",i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"sim_canvas ledmatrixsegment_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.LEDMATRIXSEGMENT)),this.incrementNumberOf(dt.LEDMATRIXSEGMENT);var c=this._numberOfComponentsOfType[dt.LEDMATRIXSEGMENT],u=new ut(this._eventBus,c,t,e,n,i,o,a,r,s,l);this._robot.push(u),this.renderer.initializeCanvas(this._robot,u)}},{key:"removeLedmatrixSegment",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.LEDMATRIXSEGMENT));var t=this._numberOfComponentsOfType[dt.LEDMATRIXSEGMENT];this.removeRobotComponentWithTypeAndId(dt.LEDMATRIXSEGMENT,t)}},{key:"addTouchSensor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:14,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:60,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:60,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas touch_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.TOUCH)),this.incrementNumberOf(dt.TOUCH);var l=this._numberOfComponentsOfType[dt.TOUCH],c=new at(this._eventBus,l,t,e,n,i,o,a,r,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removeTouchSensor",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.TOUCH));var t=this._numberOfComponentsOfType[dt.TOUCH];this.removeRobotComponentWithTypeAndId(dt.TOUCH,t)}},{key:"addButton",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"sim_canvas button_canvas",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.BUTTOn)),this.incrementNumberOf(dt.BUTTON);var l=this._numberOfComponentsOfType[dt.BUTTON],c=new st(this._eventBus,l,t,s,e,n,i,o,a,r);this._robot.push(c)}},{key:"removeButton",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.BUTTON));var t=this._numberOfComponentsOfType[dt.BUTTON];this.removeRobotComponentWithTypeAndId(dt.BUTTON,t)}},{key:"addPir",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:13,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:75,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:75,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas pir_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.PIR)),this.incrementNumberOf(dt.PIR);var l=this._numberOfComponentsOfType[dt.PIR],c=new Q(this._eventBus,l,t,e,n,i,o,a,r,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removePir",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.PIR));var t=this._numberOfComponentsOfType[dt.PIR];this.removeRobotComponentWithTypeAndId(dt.PIR,t)}},{key:"addSonar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:11,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:58,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"sim_canvas sonar_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.SONAR)),this.incrementNumberOf(dt.SONAR);var c=this._numberOfComponentsOfType[dt.SONAR],u=new W(this._eventBus,c,t,e,n,i,o,a,r,s,l);this._robot.push(u),this.renderer.initializeCanvas(this._robot,u)}},{key:"removeSonar",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.SONAR));var t=this._numberOfComponentsOfType[dt.SONAR];this.removeRobotComponentWithTypeAndId(dt.SONAR,t)}},{key:"addLcd",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.LCD)),this.incrementNumberOf(dt.LCD);var o=this._numberOfComponentsOfType[dt.LCD],a=new H(this._eventBus,o,t,e,n,i);this._robot.push(a)}},{key:"removeLcd",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.Lcd));var t=this._numberOfComponentsOfType[dt.LCD];this.removeRobotComponentWithTypeAndId(dt.LCD,t)}},{key:"addSoundSensor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:42,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas sound_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.SOUND)),this.incrementNumberOf(dt.SOUND);var l=this._numberOfComponentsOfType[dt.SOUND],c=new Z(this._eventBus,l,t,e,n,i,o,a,r,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removeSoundSensor",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.SOUND));var t=this._numberOfComponentsOfType[dt.SOUND];this.removeRobotComponentWithTypeAndId(dt.SOUND,t)}},{key:"addLightSensor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:45,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas light_canvas";this.logger.recordEvent(this.logger.createEvent(P.addRobotComponent,dt.LIGHT)),this.incrementNumberOf(dt.LIGHT);var l=this._numberOfComponentsOfType[dt.LIGHT],c=new et(this._eventBus,l,t,e,n,i,o,a,r,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removeLightSensor",value:function(){this.logger.recordEvent(this.logger.createEvent(P.removeRobotComponent,dt.LIGHT));var t=this._numberOfComponentsOfType[dt.LIGHT];this.removeRobotComponentWithTypeAndId(dt.LIGHT,t)}},{key:"incrementNumberOf",value:function(t){this._numberOfComponentsOfType[t]+=1}},{key:"decrementNumberOf",value:function(t){this._numberOfComponentsOfType[t]-=1}}]),t}();function ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var gt={DISPLAY:"display",SEGMENT:"segment"};Object.freeze(gt);var ft=function(t){m()(n,t);var e=ht(n);function n(t,i,a,r,s,l,c,u,d,p,h){var g;return o()(this,n),(g=e.call(this,t,h))._id=i,g._type=dt.LEDMATRIX,g._x=c,g._y=u,g._offset={left:d,top:p},g._dataPin=a,g._csPin=r,g._clkPin=s,console.log("state adjusted"),g._state=n.getEmptyLedMatrix(),g._canvasId="sim_ledmatrix_canvas"+g._id,g._ledSvg=new Image,g._ledSvg.src="./DwenguinoIDE/img/socialrobot/led_matrix_on.svg",g._ledOffsets={left:15,led_x:1.14,led_y:1.25,led_between_x:8.65,led_between_y:8.53,led_radius:6.35,matrix_segment_between_x:71.01},g._ledmatrixBackground=new Image,g._ledmatrixBackground.src="./DwenguinoIDE/img/socialrobot/led_matrix_1x4.svg",g.insertHtml(),g.toggleVisibility(l),g}return r()(n,[{key:"toString",value:function(){return"LED MATRIX"}},{key:"insertHtml",value:function(){var t=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[this.getType()])+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){t.createComponentOptionsModalDialog(DwenguinoBlocklyLanguageSettings.translate(["ledmatrixOptions"])),t.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toXml",value:function(){var t="";t=(t=(t=t.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'");var e="#sim_"+this.getType()+this.getId();return t=$(e).attr("data-x")?t.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(e).attr("data-x")),"'"):t.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),t=(t=(t=(t=(t=(t=$(e).attr("data-y")?t.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(e).attr("data-y")),"'"):t.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" DataPin='",this.getDataPin(),"'")).concat(" CsPin='",this.getCsPin(),"'")).concat(" ClkPin='",this.getClkPin(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(0);var t={dataType:gt.DISPLAY,data:n.getEmptyLedMatrix()};this.setState(t)}},{key:"toggleVisibility",value:function(t){t?$("#sim_ledmatrix"+this.getId()).css("visibility","visible"):$("#sim_ledmatrix"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){$("#componentOptionsModalBody").append('<div id="componentOptionsDataPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsDataPin").append('<div class="col-md-2">Data pin</div>'),$("#componentOptionsDataPin").append('<div id="dataPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsCsPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsCsPin").append('<div class="col-md-2">Cs pin</div>'),$("#componentOptionsCsPin").append('<div id="csPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsClkPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsClkPin").append('<div class="col-md-2">Clk pin</div>'),$("#componentOptionsClkPin").append('<div id="clkPin" class="col-md-10"></div>');var t=this.getPossibleDataPin(),e=this.getPossibleCsPin(),n=this.getPossibleClkPin();$("#dataPin").append('<button type="button" id=dataPin'+t+" name="+t+' class="col-md-1 ml-2 mb-2 dataPinButton pinButton option_button_enabled">'+t+"</button>"),$("#dataPin"+t).addClass("option_button_selected"),$("#csPin").append('<button type="button" id=csPin'+e+" name="+e+' class="col-md-1 ml-2 mb-2 csPinButton pinButton option_button_enabled">'+e+"</button>"),$("#csPin"+e).addClass("option_button_selected"),$("#clkPin").append('<button type="button" id=clkPin'+n+" name="+n+' class="col-md-1 ml-2 mb-2 clkPinButton pinButton option_button_enabled">'+n+"</button>"),$("#clkPin"+n).addClass("option_button_selected")}},{key:"getPossibleDataPin",value:function(){return"2"}},{key:"getPossibleCsPin",value:function(){return"10"}},{key:"getPossibleClkPin",value:function(){return"13"}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setX",value:function(t){this._x=t}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(t){this._y=t}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(t){this._offset=t}},{key:"getOffset",value:function(){return this._offset}},{key:"setDataPin",value:function(t){this._dataPin=t}},{key:"getDataPin",value:function(){return this._dataPin}},{key:"setCsPin",value:function(t){this._csPin=t}},{key:"getCsPin",value:function(){return this._csPin}},{key:"setClkPin",value:function(t){this._clkPin=t}},{key:"getClkPin",value:function(){return this._clkPin}},{key:"setState",value:function(t){if(t.dataType==gt.DISPLAY)for(var e=0;e<4;e++)this._state[e]=t.data[e];else if(t.dataType==gt.SEGMENT){var n=t.data[0];this._state[n]=t.data[1]}}},{key:"getState",value:function(){return this._state}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getLedSvg",value:function(){return this._ledSvg}},{key:"getLedOffsets",value:function(){return this._ledOffsets}},{key:"getLedmatrixBackground",value:function(){return this._ledmatrixBackground}}],[{key:"getEmptyLedMatrix",value:function(){return[[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]]}}]),n}(C),mt=function(){function t(e){o()(this,t),l()(this,"boardState",null),l()(this,"currentScenario",null),l()(this,"stepmotorQueue",[]),l()(this,"servoAngleQueue",[]),l()(this,"colorQueue",[]),l()(this,"stepperPins",[33,34]),l()(this,"penPositionPins",[36,37]),l()(this,"colorPin",35),l()(this,"stylusPosPin",38),l()(this,"drawingActive",!1),this.boardState=e}return r()(t,[{key:"setCurrentScenario",value:function(t){this.currentScenario=t}},{key:"clearLcd",value:function(){for(var t=0;t<2;t++)this.writeLcd(" ".repeat(16),t,0)}},{key:"writeLcd",value:function(t,e,n){this.boardState.setBacklight(1);var i=this.boardState.getLcdContent(e).substr(0,n),o=0;i.length<n&&(o=n-i.length),t=i+" ".repeat(o)+t.substring(0,16-n),this.boardState.getLcdContent(e).substr(t.length+n,16),this.boardState.setLcdContent(e,t)}},{key:"digitalWrite",value:function(t,e){var n=Number(t);n>=32&&n<=39||13===n?(n>=32&&n<=39&&(n-=32),"HIGH"===e||1==e?13===n?this.boardState.setLedState(8,1):this.boardState.setLedState(n,1):13===n?this.boardState.setLedState(8,0):this.boardState.setLedState(n,0)):this.boardState.setIoPinState(n,e)}},{key:"analogWrite",value:function(t,e){this.boardState.isPWMPin(t)?this.boardState.setIoPinState(t,e):this.boardState.setAnalogIoPinState(t,e)}},{key:"digitalRead",value:function(t){if(t.startsWith("SW_")){var e=S.mapButtonPinNameToIndex(t);return this.boardState.getButtonState(e)}return(t=Number(t))>=32&&t<=39||13===t?(t>=32&&t<=39&&(t-=32),this.boardState.getLedState(t)):this.boardState.getIoPinState(t)}},{key:"analogRead",value:function(t){return this.boardState.getAnalogIoPinState(t)}},{key:"setLeds",value:function(t){t=t.toString(2);for(var e=0;e<8;e++)this.digitalWrite(32+e,0);var n=8-t.length;n<0&&(n=0);for(e=0;e<Math.min(t.length,8);e++)this.digitalWrite(39-(n+e),t[e])}},{key:"tone",value:function(t,e){"BUZZER"===t&&this.boardState.setTonePlaying(e)}},{key:"noTone",value:function(t){"BUZZER"===t&&this.boardState.setTonePlaying(0)}},{key:"servo",value:function(t,e){e>180&&(e=180),e<0&&(e=0);var n=t+35;e!==this.boardState.getServoAngle(t)&&(this.boardState.setServoAngle(t,e),this.boardState.setIoPinState(n,e))}},{key:"servoWithPin",value:function(t,e){e!==this.boardState.getIoPinState(t)&&this.boardState.setIoPinState(t,e)}},{key:"startDcMotor",value:function(t,e){e>255&&(e=255),e<-255&&(e=-255),e!==this.boardState.getMotorSpeed(t)&&this.boardState.setMotorSpeed(t,e)}},{key:"sonar",value:function(t,e){return Math.round(this.boardState.getSonarDistance(t,e))}},{key:"pir",value:function(t){return this.boardState.getIoPinState(t)}},{key:"soundSensor",value:function(t){return this.boardState.getIoPinState(t)}},{key:"touchSensor",value:function(t){return this.boardState.getIoPinState(t)}},{key:"readButton",value:function(t){return console.log(this.boardState.getIoPinState(t)),this.boardState.getIoPinState(t)}},{key:"rgbLed",value:function(t,e){this.analogWrite(t[0],e[0]),this.analogWrite(t[1],e[1]),this.analogWrite(t[2],e[2])}},{key:"ledmatrixDisplaySegment",value:function(t){var e={dataType:gt.SEGMENT,data:t};this.boardState.setIoPinState(2,e)}},{key:"clearLedmatrixDisplaySegment",value:function(t){var e={dataType:gt.SEGMENT,data:[t,ft.getEmptyLedMatrix()[0]]};this.boardState.setIoPinState(2,e)}},{key:"clearLedmatrixDisplay",value:function(){var t={dataType:gt.DISPLAY,data:ft.getEmptyLedMatrix()};this.boardState.setIoPinState(2,t)}},{key:"sleep",value:function(t){}},{key:"stepperMotorStep",value:function(t,e){var n=e>0?1:-1;this.boardState.setIoPinState(t,this.boardState.getIoPinState(t)+n)}},{key:"stepMotorSteps",value:function(t,e){for(var n=0;n<Math.abs(e);++n)this.stepperMotorStep(t,e)}},{key:"stepMotorsTo",value:function(t){for(var e=[0,0],n=0;n<e.length;++n)e[n]=this.boardState.getIoPinState(this.penPositionPins[n])+t[n];for(var i=this.coordinatesToSteps(e),o=0;o<i.length;++o)this.boardState.setIoPinState(this.stepperPins[o],i[o])}},{key:"coordinatesToSteps",value:function(t){var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)),n=Math.sqrt(Math.pow(t[1],2)+Math.pow(E.motorDistance-t[0],2)),i=2*Math.PI*E.motorRadius/E.nrOfSteps;return[e/=i,n/=i]}},{key:"drawRobotCheckPosition",value:function(t){var e=DwenguinoSimulation.currentScenario;(t[0]<e.paper.position.x||t[0]>e.paper.position.x+e.paper.width||t[1]<e.paper.position.y||t[1]>e.paper.position.y+e.paper.height)&&(window.stepMotorError||(alert(MSG.bounds),DwenguinoSimulation.handleSimulationStop(),window.stepMotorError=!0))}},{key:"drawRobotLine",value:function(t,e,n){n&&(t+=20,e+=40);for(var i=[0,0],o=0;o<i.length;++o)i[o]=this.boardState.getIoPinState(this.penPositionPins[o]);var a=i,r=Math.atan((e-a[1])/(t-a[0])),s=Math.sqrt(Math.pow(a[0]-t,2)+Math.pow(a[1]-e,2)),l=Math.cos(r),c=Math.sin(r);this.update(s,l,c),this.drawingActive=!0}},{key:"update",value:function(t,e,n){var i=this;t>0?(this.stepMotorsTo([e,n]),this.currentScenario.updateScenario(this.boardState),setTimeout((function(){i.update(t-1,e,n)}),30)):this.drawingActive=!1}},{key:"drawRobotLowerStylus",value:function(){this.boardState.setIoPinState(this.stylusPosPin,0)}},{key:"drawRobotLiftStylus",value:function(){this.boardState.setIoPinState(this.stylusPosPin,90)}},{key:"changeColor",value:function(t){this.boardState.setIoPinState(this.colorPin,t)}}]),t}();function vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var _t=function(t){m()(n,t);var e=vt(n);function n(t,i){var a;return o()(this,n),a=e.call(this),l()(p()(a),"logger",null),l()(p()(a),"workspace",null),l()(p()(a),"simulationViewContainerId","db_simulator_panes"),a.logger=t,a.workspace=i,a}return r()(n,[{key:"resetDwenguino",value:function(){g()(b()(n.prototype),"resetDwenguino",this).call(this),-1!==this.debugger.blocks.lastColours[0]&&this.debugger.blocks.lastBlocks[0].setColour(this.debugger.blocks.lastColours[0]),this.debugger.blocks.lastColours=[-1,-1],this.debugger.blocks.lastBlocks=[null,null]}},{key:"initScenario",value:function(){this.currentScenario.initSimulationState(this.board),this.currentScenario.initSimulationDisplay(this.simulationViewContainerId),this.currentScenario.updateScenario(this.board)}},{key:"initDebugger",value:function(){var t=Blockly.JavaScript.workspaceToCode(this.workspace);g()(b()(n.prototype),"initDebugger",this).call(this,t),this.mapBlocksToCode(),this.updateBlocklyColour()}},{key:"step",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g()(b()(n.prototype),"step",this).call(this,t),(this.isDebugging||!this.isSimulationPaused&&this.isSimulationRunning)&&this.updateBlocklyColour()}},{key:"mapBlocksToCode",value:function(){for(var t=this,e=this.workspace.getAllBlocks()[0],n=0,i=this.debugger.code.split("\n"),o=[],a=function(){if(i[n].trim()===Blockly.JavaScript.blockToCode(r).split("\n")[0]&&(i[n].trim().startsWith("for")||i[n].trim().startsWith("while")||i[n].trim().startsWith("if"))?(o.push(r),t.debugger.blocks.blockMapping[n]=r,r=r.getInputTargetBlock("DO")||r.getInputTargetBlock("DO0")):i[n].trim()===Blockly.JavaScript.blockToCode(r).split("\n")[0]&&(t.debugger.blocks.blockMapping[n]=r,r=r.getNextBlock()),null===r&&o.length>0){var e=o.pop();r=e.getNextBlock(),n++}n++},r=e.getInputTargetBlock("SETUP");null!==r&&n<i.length;)a();for(;o.length>0;)o.pop(),n++;for(;n<i.length&&"while (true) {"!==i[n];)n++;for(n<i.length&&(this.debugger.blocks.blockMapping[n]=e,n++),r=e.getInputTargetBlock("LOOP");null!==r&&n<i.length;)a()}},{key:"updateBlocklyColour",value:function(){if(this.debugger.debuggerjs){var t=this.debugger.debuggerjs.machine.getCurrentLoc().start.line-1;""!==this.debugger.code&&void 0!==this.debugger.blocks.blockMapping[t]&&(null!==this.debugger.blocks.lastBlocks[0]&&this.debugger.blocks.lastBlocks[0].setColour(this.debugger.blocks.lastColours[0]),this.debugger.blocks.lastBlocks[0]=this.debugger.blocks.lastBlocks[1],this.debugger.blocks.lastColours[0]=this.debugger.blocks.lastColours[1],this.debugger.blocks.lastBlocks[1]=this.debugger.blocks.blockMapping[t],this.debugger.blocks.lastColours[1]=this.debugger.blocks.blockMapping[t].getColour(),null!==this.debugger.blocks.lastBlocks[0]&&this.debugger.blocks.lastBlocks[0].setColour(210))}}}]),n}(function(){function t(){o()(this,t),l()(this,"board",null),l()(this,"debugger",null),l()(this,"simulationSandbox",null),l()(this,"currentScenario",null),l()(this,"speedDelay",16),l()(this,"baseSpeedDelay",16),l()(this,"isSimulationRunning",!1),l()(this,"isSimulationPaused",!1),l()(this,"isDebugging",!1),this.board=new x,this.simulationSandbox=new mt(this.board),this.initDebuggerState()}return r()(t,[{key:"initDebuggerState",value:function(){this.debugger={debuggerjs:null,code:"",blocks:{lastBlocks:[null,null],lastColours:[-1,-1],blockMapping:{}}}}},{key:"setCurrentScenario",value:function(t){this.currentScenario=t,this.simulationSandbox.setCurrentScenario(this.currentScenario),this.resetDwenguino()}},{key:"initScenario",value:function(){this.currentScenario.initSimulationState(this.board),this.currentScenario.initSimulationDisplay(""),this.currentScenario.updateScenario(this.board)}},{key:"resetDwenguino",value:function(){this.debugger.debuggerjs=null,this.debugger.code="",this.debugger.blocks.blockMapping={},this.board.resetBoard(),this.initScenario()}},{key:"createDebugger",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return debugjs.createDebugger(t)}},{key:"initDebugger",value:function(t){this.resetDwenguino(),this.debugger.code=t,this.debugger.debuggerjs=this.createDebugger({iframeParentElement:document.getElementById("debug"),sandbox:{DwenguinoSimulation:this.simulationSandbox}}),this.debugger.debuggerjs.machine.on("error",(function(t){console.log(t),console.error(t.message)}));this.debugger.debuggerjs.load(this.debugger.code,"DwenguinoSimulation"),this.debugger.debuggerjs.machine.step()}},{key:"step",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isDebugging||!this.isSimulationPaused&&this.isSimulationRunning){if(this.debugger.debuggerjs){var e=this.debugger.debuggerjs.machine.getCurrentLoc().start.line-1;this.debugger.debuggerjs.machine.step()}var n=void 0===this.debugger.code.split("\n")[e]?"":this.debugger.code.split("\n")[e];if(this.currentScenario.updateScenario(this.board),n.trim().startsWith("DwenguinoSimulation.sleep")){var i=Number(this.debugger.code.split("\n")[e].replace(/\D+/g,""));this.delayStepsTaken=0,this.delayStepsToTake=Math.floor(i/this.baseSpeedDelay),this.delayRemainingAfterSteps=i%this.baseSpeedDelay,this.performDelayLoop(t)}else t?this.setIsSimulationPaused(!0):setTimeout(this.step.bind(this),this.speedDelay);this.checkForEnd()}}},{key:"performDelayLoop",value:function(t){var e=this;this.delayStepsTaken<this.delayStepsToTake?(this.currentScenario.updateScenario(this.board),this.delayStepsTaken++,setTimeout((function(){e.performDelayLoop(t)}),this.speedDelay)):t?this.setIsSimulationPaused(!0):setTimeout((function(){e.step()}),this.delayRemainingAfterSteps)}},{key:"handleScope",value:function(){var t=this.debugger.debuggerjs.machine.getCurrentStackFrame().scope;for(var e in t){var n=t[e];this.debugger.debuggerjs.machine.$runner.gen.stackFrame.evalInScope(n.name)}}},{key:"checkForEnd",value:function(){(this.isSimulationRunning||this.isSimulationPaused)&&this.debugger.debuggerjs.machine.halted&&(this.setIsSimulationRunning(!1),this.setIsSimulationPaused(!1))}},{key:"setIsSimulationRunning",value:function(t){this.isSimulationRunning=t,this.currentScenario.setIsSimulationRunning(this.isSimulationRunning)}},{key:"setIsSimulationPaused",value:function(t){this.isSimulationPaused=t}},{key:"setIsDebugging",value:function(t){this.isDebugging=t}}]),t}()),yt=function(){function t(e,n,i){o()(this,t),l()(this,"simulationRunner",null),l()(this,"scenarioView","spyrograph"),l()(this,"scenarios",null),l()(this,"logger",null),this.logger=e,this.scenarios=i,this.simulationRunner=new _t(this.logger,n),this.simulationRunner.setCurrentScenario(this.scenarios[this.scenarioView]),this.initSimulationControlsUI(i)}return r()(t,[{key:"initSimulationControlsUI",value:function(t){var e=this;$("#db_simulator_menu").empty(),$("#db_infopane").prepend('<div id="db_simulator_menu"></div>'),$("#db_simulator_menu").append('<div id="sim_menu"></div>'),$("#sim_menu").append('<div id="sim_menu_buttons"></div>'),$("#sim_menu_buttons").append('<div id="sim_start" class="sim_item"></div>'),$("#sim_menu_buttons").append('<div id="sim_pause" class="sim_item_disabled"></div>'),$("#sim_menu_buttons").append('<div id="sim_stop" class="sim_item_disabled"></div>'),$("#sim_menu_buttons").append('<div id="sim_step" class="sim_item"></div>'),$("#sim_menu").append('<div id="sim_scenarios" class="btn-group btn-group-toggle" data-toggle="buttons"></div>'),$("#sim_scenarios").append('<div id="sim_scenarioTag" ></div>'),$.each(Object.keys(this.scenarios),(function(t,n){var i='<div id="scenario_item_'+n+'" class="sim_scenario_item"></div>',o='<label id="scenario_label_'+n+'" class="btn sim_scenario_btn"></label>',a='<input id="sim_scenario_'+n+'"type="radio" name="scenario_type" class="sim_scenario_radio" value="'+n+'" autocomplete="off"><img src="DwenguinoIDE/img/scenarios/scenario_'+n+'.png" class="scenario_image">';$("#sim_scenarios").append(i),$("#scenario_item_"+n).append(o),$("#scenario_label_"+n).append(a),n==e.scenarioView&&($("#sim_scenario_"+n).attr("checked","checked"),$("#scenario_label_"+n).attr("class","btn sim_scenario_btn active"))})),this.translateSimulatorInterface(),$("#sim_speed").on("change",(function(){e.setSpeed()}));var n=this;$("input[name=scenario_type]:radio").change((function(){console.log($(this).val()),n.scenarioView=$(this).val(),n.translateSimulatorInterface(),n.handleSimulationStop(),n.simulationRunner.setCurrentScenario(n.scenarios[n.scenarioView]),n.logger.recordEvent(n.logger.createEvent(P.changedScenario,this.scenarioView))})),$("#sim_start").click((function(){e.setButtonsStart(),e.simulationRunner.isSimulationRunning||e.simulationRunner.isSimulationPaused?e.simulationRunner.isSimulationRunning||(e.logger.recordEvent(e.logger.createEvent(P.simResume,"")),e.simulationRunner.setIsSimulationPaused(!1),e.simulationRunner.setIsSimulationRunning(!0),e.resumeSimulation()):(e.simulationRunner.setIsSimulationRunning(!0),e.startSimulation(),e.logger.recordEvent(e.logger.createEvent(P.simStart,"")))})),$("#sim_pause").click((function(){e.logger.recordEvent(e.logger.createEvent(P.simPause,"")),e.simulationRunner.setIsSimulationRunning(!1),e.simulationRunner.setIsSimulationPaused(!0),e.setButtonsPause()})),$("#sim_stop").click((function(){e.logger.recordEvent(e.logger.createEvent(P.simStopButtonClicked,"")),e.handleSimulationStop()})),$("#sim_step").click((function(){e.setButtonsStep(),e.logger.recordEvent(e.logger.createEvent(P.simStep,"")),e.simulationRunner.isSimulationPaused||e.simulationRunner.isSimulationRunning?e.simulationRunner.isSimulationRunning||(e.simulationRunner.setIsDebugging(!0),e.simulationRunner.setIsSimulationPaused(!1),e.simulationRunner.step(!0),e.simulationRunner.setIsSimulationPaused(!0),e.simulationRunner.setIsDebugging(!1)):(e.simulationRunner.setIsDebugging(!0),e.startStepSimulation(),e.simulationRunner.setIsSimulationPaused(!0),e.simulationRunner.setIsDebugging(!1))}));var i=function(t,e,n){$.each(e,(function(t,e){var n=$(e.attr("href"));e.removeClass("active"),n.hide()})),$(t).addClass("active"),$(t.hash).show(),n.preventDefault()};$("a[href$='#db_code_pane']").click((function(t){i(this,[$("a[href$='#db_robot_pane']")],t)})),$("a[href$='#db_robot_pane']").click((function(t){i(this,[$("a[href$='#db_code_pane']")],t)})),$("a[href$='#db_robot_pane']").trigger("click")}},{key:"translateSimulatorInterface",value:function(){document.getElementById("sim_start").innerHTML="<span class='fas fa-play' alt='"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["start"])+"'></span>",document.getElementById("sim_stop").innerHTML="<span class='fas fa-stop' alt='"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["stop"])+"'></span>",document.getElementById("sim_pause").innerHTML="<span class='fas fa-pause' alt='"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["pause"])+"'></span>",document.getElementById("sim_step").innerHTML="<span class='fas fa-step-forward' alt='"+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["step"])+"'></span>",document.getElementById("sim_scenarioTag").textContent=DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["scenario"])+":"}},{key:"startSimulation",value:function(){this.startDebuggingView(),this.simulationRunner.initDebugger(),this.simulationRunner.step()}},{key:"startStepSimulation",value:function(){this.startDebuggingView(),this.simulationRunner.initDebugger(),this.simulationRunner.step(!0)}},{key:"stopSimulation",value:function(){this.stopDebuggingView(),this.simulationRunner.resetDwenguino()}},{key:"resumeSimulation",value:function(){this.simulationRunner.step()}},{key:"handleSimulationStop",value:function(){this.logger.recordEvent(this.logger.createEvent(P.simStop,"")),this.simulationRunner.setIsSimulationRunning(!1),this.simulationRunner.setIsSimulationPaused(!1),this.setButtonsStop(),this.stopSimulation()}},{key:"setButtonsStart",value:function(){document.getElementById("sim_pause").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_start").className="sim_item_disabled",document.getElementById("sim_step").className="sim_item_disabled"}},{key:"setButtonsPause",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"setButtonsStop",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item_disabled",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"setButtonsStep",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"startDebuggingView",value:function(){0!==document.getElementsByClassName("alertDebug").length&&document.getElementsByClassName("alertDebug")[0].remove();var t='<div class ="alertDebug">'+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["alertDebug"])+"</div>";$("#db_body").append(t),document.getElementsByClassName("alertDebug")[0].style.width=document.getElementById("blocklyDiv").style.width,document.querySelector('input[id="code_checkbox"]').checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible"):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("blocklyDiv").style.opacity="0.5",document.getElementById("db_code_pane").style.visibility="hidden"),document.getElementById("db_code_pane").style.opacity="0.5",document.getElementById("blocklyDiv").style.opacity="0.5"}},{key:"stopDebuggingView",value:function(){document.querySelector('input[id="code_checkbox"]').checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible"):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("db_code_pane").style.visibility="hidden"),document.getElementById("db_code_pane").style.opacity="1",document.getElementById("blocklyDiv").style.opacity="1",document.getElementById("blocklyDiv").style.pointerEvents="auto",0!==document.getElementsByClassName("alertDebug").length&&document.getElementsByClassName("alertDebug")[0].remove()}},{key:"setSpeed",value:function(){var t=document.getElementById("sim_speed"),e=t.options[t.selectedIndex].value;switch(this.logger.recordEvent(this.logger.createEvent(P.setSpeed,e)),e){case"veryslow":this.simulationRunner.speedDelay=600;break;case"slow":this.simulationRunner.speedDelay=300;break;case"medium":this.simulationRunner.speedDelay=150;break;case"fast":this.simulationRunner.speedDelay=75;break;case"veryfast":this.simulationRunner.speedDelay=32;break;case"realtime":this.simulationRunner.speedDelay=16}}}]),t}(),bt=function(){function t(){o()(this,t),this.events={}}return r()(t,[{key:"registerEvent",value:function(t){var e=new A(t);this.events[t]=e}},{key:"dispatchEvent",value:function(t,e){this.events[t].callbacks.forEach((function(t){t(e)}))}},{key:"addEventListener",value:function(t,e){this.events[t].registerCallback(e)}}]),t}(),kt=function(){function t(e){o()(this,t),l()(this,"socialRobotScenario",{}),this._eventBus=e,this._components=[{type:dt.SERVO,maximumAmount:5},{type:dt.LED,maximumAmount:3},{type:dt.RGBLED,maximumAmount:3},{type:dt.LEDMATRIX,maximumAmount:1},{type:dt.LEDMATRIXSEGMENT,maximumAmount:4},{type:dt.TOUCH,maximumAmount:3},{type:dt.BUTTON,maximumAmount:3},{type:dt.PIR,maximumAmount:2},{type:dt.SONAR,maximumAmount:1},{type:dt.LCD,maximumAmount:1},{type:dt.SOUND,maximumAmount:2},{type:dt.LIGHT,maximumAmount:2},{type:dt.DECORATION,maximumAmount:10}]}return r()(t,[{key:"setupEnvironment",value:function(t){this.socialRobotScenario=t,console.log("setupEnvironment"),this.initMenu(),this.translateRobotComponents()}},{key:"initMenu",value:function(){$("#db_simulator_top_pane").append('<div id="robot_components_menu" class="scrolling-wrapper-flexbox"></div>'),$("#robot_components_menu").append('<div id="rc_servo" class="robot_components_item bg-c-4 card"></div>'),$("#rc_servo").append('<div id="rc_servo_tag" class="rc_tag text-center"></div>'),$("#rc_servo").append('<div id="rc_servo_img" class="rc_img"></div>'),$("#rc_servo").append('<div id="rc_servo_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_led" class="robot_components_item bg-c-4 card"></div>'),$("#rc_led").append('<div id="rc_led_tag" class="rc_tag text-center"></div>'),$("#rc_led").append('<div id="rc_led_img" class="rc_img"></div>'),$("#rc_led").append('<div id="rc_led_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_rgbled" class="robot_components_item bg-c-4 card"></div>'),$("#rc_rgbled").append('<div id="rc_rgbled_tag" class="rc_tag text-center"></div>'),$("#rc_rgbled").append('<div id="rc_rgbled_img" class="rc_img"></div>'),$("#rc_rgbled").append('<div id="rc_rgbled_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_ledmatrix" class="robot_components_item bg-c-4 card"></div>'),$("#rc_ledmatrix").append('<div id="rc_ledmatrix_tag" class="rc_tag text-center"></div>'),$("#rc_ledmatrix").append('<div id="rc_ledmatrix_img" class="rc_img"></div>'),$("#rc_ledmatrix").append('<div id="rc_ledmatrix_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_ledmatrixsegment" class="robot_components_item bg-c-4 card"></div>'),$("#rc_ledmatrixsegment").append('<div id="rc_ledmatrixsegment_tag" class="rc_tag text-center"></div>'),$("#rc_ledmatrixsegment").append('<div id="rc_ledmatrixsegment_img" class="rc_img"></div>'),$("#rc_ledmatrixsegment").append('<div id="rc_ledmatrixsegment_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_touch" class="robot_components_item bg-c-4 card"></div>'),$("#rc_touch").append('<div id="rc_touch_tag" class="rc_tag text-center"></div>'),$("#rc_touch").append('<div id="rc_touch_img" class="rc_img"></div>'),$("#rc_touch").append('<div id="rc_touch_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_button" class="robot_components_item bg-c-4 card"></div>'),$("#rc_button").append('<div id="rc_button_tag" class="rc_tag text-center"></div>'),$("#rc_button").append('<div id="rc_button_img" class="rc_img"></div>'),$("#rc_button").append('<div id="rc_button_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_pir" class="robot_components_item bg-c-4 card"></div>'),$("#rc_pir").append('<div id="rc_pir_tag" class="rc_tag text-center"></div>'),$("#rc_pir").append('<div id="rc_pir_img" class="rc_img"></div>'),$("#rc_pir").append('<div id="rc_pir_value"></div>'),$("#rc_pir").append('<div id="rc_pir_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_sonar" class="robot_components_item bg-c-4 card"></div>'),$("#rc_sonar").append('<div id="rc_sonar_tag" class="rc_tag text-center"></div>'),$("#rc_sonar").append('<div id="rc_sonar_img" class="rc_img"></div>'),$("#rc_sonar").append('<div id="rc_sonar_value"></div>'),$("#rc_sonar").append('<div id="rc_sonar_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_lcd" class="robot_components_item bg-c-4 card"></div>'),$("#rc_lcd").append('<div id="rc_lcd_tag" class="rc_tag text-center"></div>'),$("#rc_lcd").append('<div id="rc_lcd_img" class="rc_img"></div>'),$("#rc_lcd").append('<div id="rc_lcd_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_sound" class="robot_components_item bg-c-4 card"></div>'),$("#rc_sound").append('<div id="rc_sound_tag" class="rc_tag text-center"></div>'),$("#rc_sound").append('<div id="rc_sound_img" class="rc_img"></div>'),$("#rc_sound").append('<div id="rc_sound_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_light" class="robot_components_item bg-c-4 card"></div>'),$("#rc_light").append('<div id="rc_light_tag" class="rc_tag text-center"></div>'),$("#rc_light").append('<div id="rc_light_img" class="rc_img"></div>'),$("#rc_light").append('<div id="rc_light_options" class="rc_options"></div>'),$("#robot_components_menu").append('<div id="rc_decoration" class="robot_components_item bg-c-4 card"></div>'),$("#rc_decoration").append('<div id="rc_decoration_tag" class="rc_tag text-center"></div>'),$("#rc_decoration").append('<div id="rc_decoration_img" class="rc_img"></div>'),$("#rc_decoration").append('<div id="rc_decoration_options" class="rc_options"></div>'),this.initButtons()}},{key:"initButtons",value:function(){var t=this.generateButtonTemplate(dt.SERVO);$("#rc_servo_options").append(t);var e=this.generateButtonTemplate(dt.LED);$("#rc_led_options").append(e);var n=this.generateButtonTemplate(dt.RGBLED);$("#rc_rgbled_options").append(n);var i=this.generateButtonTemplate(dt.LEDMATRIX);$("#rc_ledmatrix_options").append(i);var o=this.generateButtonTemplate(dt.LEDMATRIXSEGMENT);$("#rc_ledmatrixsegment_options").append(o);var a=this.generateButtonTemplate(dt.TOUCH);$("#rc_touch_options").append(a);var r=this.generateButtonTemplate(dt.BUTTON);$("#rc_button_options").append(r);var s=this.generateButtonTemplate(dt.PIR);$("#rc_pir_options").append(s);var l=this.generateButtonTemplate(dt.SONAR);$("#rc_sonar_options").append(l);var c=this.generateButtonTemplate(dt.LCD);$("#rc_lcd_options").append(c);var u=this.generateButtonTemplate(dt.SOUND);$("#rc_sound_options").append(u);var d=this.generateButtonTemplate(dt.LIGHT);$("#rc_light_options").append(d);var p=this;$(".btn-number").click((function(t){t.preventDefault();var e=$(this).attr("data-field"),n=$(this).attr("data-type"),i=$("input[name='"+e+"']"),o=parseInt(i.val());isNaN(o)?i.val(0):"minus"==n?(o>i.attr("min")&&(i.val(o-1).change(),p.removeRobotComponent(t.target.id)),parseInt(i.val())==i.attr("min")&&$(this).attr("disabled",!0)):"plus"==n&&(o<i.attr("max")&&(i.val(o+1).change(),p.addRobotComponent(t.target.id)),parseInt(i.val())==i.attr("max")&&$(this).attr("disabled",!0))})),$(".input-number").focusin((function(){$(this).data("oldValue",$(this).val())})),$(".input-number").change((function(){var t=parseInt($(this).attr("min")),e=parseInt($(this).attr("max")),n=parseInt($(this).val()),i=$(this).attr("name");n>=t?$(".component_item_input[data-type='minus'][data-field='"+i+"']").removeAttr("disabled"):$(this).val($(this).data("oldValue")),n<=e?$(".component_item_input[data-type='plus'][data-field='"+i+"']").removeAttr("disabled"):$(this).val($(this).data("oldValue"))})),$(".input-number").keydown((function(t){-1!==$.inArray(t.keyCode,[46,8,9,27,13,190])||65==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39||(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}))}},{key:"resetButtons",value:function(){for(var t=0,e=Object.entries(dt);t<e.length;t++){var n=I()(e[t],2),i=(n[0],n[1]);$("input[name='"+i+"']").val(0).change()}}},{key:"changeValue",value:function(t,e){var n=$("input[name='"+t+"']"),i=parseInt(n.val());n.val(i+e).change()}},{key:"translateRobotComponents",value:function(){for(var t=0,e=Object.entries(dt);t<e.length;t++){var n=I()(e[t],2),i=(n[0],n[1]);document.getElementById("rc_"+i+"_tag").textContent=DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[i])}}},{key:"generateButtonTemplate",value:function(t){var e="";return this._components.forEach((function(n){n.type==t&&(e='<fieldset><button type="button" id="rc_'+t+'_minus_button" class="component_item_input btn-number" disabled="disabled" data-type="minus" data-field="'+t+'"><span class="fas fa-minus" id="rc_'+t+'_minus_button"></span></button><input type="text" name="'+t+'" class="component_item_input input-number" size="2" value="0" min="0" max="'+n.maximumAmount+'"><button type="button" id="rc_'+t+'_plus_button" class="component_item_input btn-number float-right" data-type="plus" data-field="'+t+'"><span class="fas fa-plus" id="rc_'+t+'_plus_button"></span></button></fieldset>')})),e}},{key:"addRobotComponent",value:function(t){switch(t){case"rc_servo_plus_button":this.socialRobotScenario.addRobotComponent(dt.SERVO);break;case"rc_led_plus_button":this.socialRobotScenario.addRobotComponent(dt.LED);break;case"rc_rgbled_plus_button":this.socialRobotScenario.addRobotComponent(dt.RGBLED);break;case"rc_ledmatrix_plus_button":this.socialRobotScenario.addRobotComponent(dt.LEDMATRIX);break;case"rc_ledmatrixsegment_plus_button":this.socialRobotScenario.addRobotComponent(dt.LEDMATRIXSEGMENT);break;case"rc_touch_plus_button":this.socialRobotScenario.addRobotComponent(dt.TOUCH);break;case"rc_button_plus_button":this.socialRobotScenario.addRobotComponent(dt.BUTTON);break;case"rc_pir_plus_button":this.socialRobotScenario.addRobotComponent(dt.PIR);break;case"rc_sonar_plus_button":this.socialRobotScenario.addRobotComponent(dt.SONAR);break;case"rc_decoration_plus_button":this.socialRobotScenario.addRobotComponent(dt.DECORATION);break;case"rc_lcd_plus_button":this.socialRobotScenario.addRobotComponent(dt.LCD);break;case"rc_sound_plus_button":this.socialRobotScenario.addRobotComponent(dt.SOUND);break;case"rc_light_plus_button":this.socialRobotScenario.addRobotComponent(dt.LIGHT)}this._eventBus.dispatchEvent(O.SAVE)}},{key:"removeRobotComponent",value:function(t){switch(t){case"rc_servo_minus_button":this.socialRobotScenario.removeRobotComponent(dt.SERVO);break;case"rc_led_minus_button":this.socialRobotScenario.removeRobotComponent(dt.LED);break;case"rc_rgbled_minus_button":this.socialRobotScenario.removeRobotComponent(dt.RGBLED);break;case"rc_ledmatrix_minus_button":this.socialRobotScenario.removeRobotComponent(dt.LEDMATRIX);break;case"rc_ledmatrixsegment_minus_button":this.socialRobotScenario.removeRobotComponent(dt.LEDMATRIXSEGMENT);break;case"rc_touch_minus_button":this.socialRobotScenario.removeRobotComponent(dt.TOUCH);break;case"rc_button_minus_button":this.socialRobotScenario.removeRobotComponent(dt.BUTTON);break;case"rc_pir_minus_button":this.socialRobotScenario.removeRobotComponent(dt.PIR);break;case"rc_sonar_minus_button":this.socialRobotScenario.removeRobotComponent(dt.SONAR);break;case"rc_decoration_minus_button":this.socialRobotScenario.removeRobotComponent(dt.DECORATION);break;case"rc_lcd_minus_button":this.socialRobotScenario.removeRobotComponent(dt.LCD);break;case"rc_sound_minus_button":this.socialRobotScenario.removeRobotComponent(dt.SOUND);break;case"rc_light_minus_button":this.socialRobotScenario.removeRobotComponent(dt.LIGHT)}this._eventBus.dispatchEvent(O.SAVE)}}]),t}(),wt=function(){function t(e){o()(this,t),l()(this,"isSimulationRunning",!1),l()(this,"logger",null),l()(this,"audiocontext",null),l()(this,"osc",null),this.logger=e}return r()(t,[{key:"initSimulationState",value:function(t){console.log("initSimulationState")}},{key:"initSimulationDisplay",value:function(t){$("#".concat(t)).empty()}},{key:"updateScenario",value:function(t){}},{key:"updateScenarioState",value:function(t){}},{key:"updateScenarioDisplay",value:function(t){}},{key:"setIsSimulationRunning",value:function(t){this.isSimulationRunning=t}},{key:"getIsSimulationRunning",value:function(){return this.isSimulationRunning}}]),t}(),St=function(){function t(e,n){o()(this,t),l()(this,"socialRobotScenario",null),this.socialRobotScenario=e,this._eventBus=n,this.setupInteract(),window.dragMoveListener=this.dragMoveListener}return r()(t,[{key:"setupInteract",value:function(){var t=this;interact(".draggable").draggable({inertia:!0,modifiers:[interact.modifiers.restrictRect({restriction:"parent",endOnly:!0})],autoScroll:!0,onmove:this.dragMoveListener,onend:function(e){var n=e.target.querySelector("p");n&&(n.textContent="moved a distance of "+Math.sqrt(Math.pow(e.pageX-e.x0,2)+Math.pow(e.pageY-e.y0,2)|0).toFixed(2)+"px"),t._eventBus.dispatchEvent(O.SAVE),t.socialRobotScenario.logger.recordEvent(t.socialRobotScenario.logger.createEvent(P.moveRobotComponent,e.target.id))}})}},{key:"dragMoveListener",value:function(t){var e=t.target,n=(parseFloat(e.getAttribute("data-x"))||0)+t.dx,i=(parseFloat(e.getAttribute("data-y"))||0)+t.dy;e.style.webkitTransform=e.style.transform="translate("+n+"px, "+i+"px)",e.setAttribute("data-x",n),e.setAttribute("data-y",i)}},{key:"fireCustomEvent",value:function(t,e,n){var i;n=n||{},document.createEvent?(i=document.createEvent("HTMLEvents")).initEvent(t,!0,!0):(i=document.createEventObject()).eventType=t,i.eventName=t,i=$.extend(i,n),document.createEvent?e.dispatchEvent(i):e.fireEvent("on"+i.eventType,i)}}]),t}(),xt=n(9),Et=n.n(xt),Ct=n(10),Tt=n.n(Ct),It=function(){function t(){o()(this,t)}return r()(t,null,[{key:"download",value:function(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"uploadXml",value:function(){return new Promise((function(t,e){var n="";if(window.File&&window.FileReader&&window.FileList&&window.Blob){$("#dropzoneModal .modal-header").empty(),$("#dropzoneModal .modal-header").append('<h4 class="modal-title">Upload</h4>'),$("#dropzoneModal .modal-header").append('<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),$("#dropzoneModal .modal-body .message").empty(),$("#dropzoneModal .modal-body .message").append("<p>"+MSG.dropzone.dictSelectFile+"</p>"),$("#dropzoneModal .modal-body .message").append('<label for="fileInput" class="form-label">Choose file </label><input type="file" id="fileInput" class="form-control">'),$("#dropzoneModal .modal-body .message").append('<div id="filedrag">'+MSG.dropzone.dictDefaultMessage+"</div>"),$("#dropzoneModal .modal-body .message").append('<pre id="fileDisplayArea"></pre>'),$("#dropzoneModal .modal-footer").empty(),$("#dropzoneModal .modal-footer").append('<button id="submit_upload_modal_dialog_button" type="button" class="btn btn-default" data-dismiss="modal">Ok</button>'),$("#dropzoneModal").modal("show");var i=function(t){if(t.type.match(/text.*/)){var e=new FileReader;e.onload=function(i){a.innerText=t.name,n=e.result},e.readAsText(t)}else a.innerText=MSG.dropzone.dictFileNotSupported},o=document.getElementById("fileInput"),a=document.getElementById("fileDisplayArea");o.addEventListener("change",(function(t){var e=o.files[0];i(e)}));var r=function(t){t.stopPropagation(),t.preventDefault(),t.target.className="dragover"==t.type?"hover":""},s=document.getElementById("filedrag");s.addEventListener("dragover",r,!1),s.addEventListener("dragleave",r,!1),s.addEventListener("drop",(function(t){r(t);var e=(t.target.files||t.dataTransfer.files)[0];i(e)}),!1),s.style.display="block",$("#dropzoneModal").on("click",(function(t){var n=$(t.target);console.log(n),(n.is("button.close")||n.is("div#dropzoneModal.modal.fade"))&&e("Dialog closed without result")})),$("#submit_upload_modal_dialog_button").click((function(){t(n)}))}else e("File IO libraries not supported")}))}}]),t}(),Mt=function(){function t(e,n){o()(this,t),l()(this,"ioController",null),this.scenario=e,this._eventBus=n,this.ioController=new It}var e;return r()(t,[{key:"saveScenario",value:function(t){console.log("save scenario"),It.download("scenario.xml",t);var e=this.scenario.logger.createEvent(P.downloadScenarioClicked,"");this.scenario.logger.recordEvent(e)}},{key:"loadScenario",value:(e=Tt()(Et.a.mark((function t(){var e;return Et.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,It.uploadXml();case 3:e=t.sent,this.scenario.xmlToRobot(e),this._eventBus.dispatchEvent(O.SAVE),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return e.apply(this,arguments)})},{key:"textToDom",value:function(t){var e=(new DOMParser).parseFromString(t,"text/xml");return e&&e.firstChild&&"xml"==e.firstChild.nodeName.toLowerCase()&&e.firstChild===e.lastChild||goog.asserts.fail("Blockly.Xml.textToDom did not obtain a valid XML tree."),e.firstChild}}]),t}();function Pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Ot=function(t){m()(n,t);var e=Pt(n);function n(t){var i;return o()(this,n),i=e.call(this,t),l()(p()(i),"simulationComponentsMenu",null),l()(p()(i),"simulationRobotComponents",null),l()(p()(i),"audioStarted",!1),l()(p()(i),"prevFreq",0),i._eventBus=new bt,i._eventBus.registerEvent(O.SAVE),i._eventBus.addEventListener(O.SAVE,(function(){i.saveRobot()})),i.simulationRobotComponents=new St(p()(i),i._eventBus),i.simulationComponentsMenu=new kt(i._eventBus),i.initAudioContext(),i}return r()(n,[{key:"initSimulationState",value:function(t){var e=this;g()(b()(n.prototype),"initSimulationState",this).call(this,t),this.renderer=new M,this.scenarioUtils=new Mt(this,this._eventBus),this.robotComponentsFactory=new pt(this.scenarioUtils,this.logger,this._eventBus),this._eventBus.registerEvent(O.CLEARCANVAS),this._eventBus.addEventListener(O.CLEARCANVAS,(function(t){e.renderer.clearCanvas(t)})),this._eventBus.registerEvent(O.INITIALIZECANVAS),this._eventBus.addEventListener(O.INITIALIZECANVAS,(function(t){e.renderer.initializeCanvas(e.robotComponentsFactory.getRobot(),t)}))}},{key:"initSimulationDisplay",value:function(t){g()(b()(n.prototype),"initSimulationDisplay",this).call(this);var e=$("#".concat(t));e.empty();var i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane");e.append(i).append(o),this.simulationComponentsMenu.setupEnvironment(this),this.initSimulation(t);var a=this;$("#sim_stop").click((function(){setTimeout((function(){a.resetSocialRobot(),a.renderer.render(a.robotComponentsFactory.getRobot())}),500)})),this.setBackground(),this.initScenarioOptions(),this.setSensorOptions(),this.loadRobot()}},{key:"initScenarioOptions",value:function(){var t=this,e=this,n=$("<div>").attr("id","scenario_options");$("#sim_container").append(n),n.append("<div id='load_scenario' class='' alt='Load'><span class='fas fa-cloud-upload-alt'></span></div>"),n.append("<div id='save_scenario' class='fas fa-cloud-download-alt' alt='Save'></div>"),n.append("<div id='switch_background' class='fas fa-sync-alt'></div>"),$("#load_scenario").click((function(){e.removeSocialRobotComponents(),e.scenarioUtils.loadScenario()})),$("#save_scenario").click((function(){var t=e.loadToXml();e.scenarioUtils.saveScenario(t)})),document.getElementById("switch_background").addEventListener("click",(function(){t.switchBackground()}))}},{key:"initSimulation",value:function(t){var e=$("#".concat(t));$("#db_simulator_top_pane").css("height","25%"),$("#db_simulator_bottom_pane").css("height","75%");var n=$("<div>").attr("id","sim_container").attr("style","margin: auto"),i=this;new ResizeSensor(n,(function(){i.containerWidth=n.width(),i.containerHeight=n.height()})),e.append(n)}},{key:"updateScenario",value:function(t){g()(b()(n.prototype),"updateScenario",this).call(this,t),this.updateScenarioState(t),this.updateScenarioDisplay(t)}},{key:"updateScenarioState",value:function(t){g()(b()(n.prototype),"updateScenarioState",this).call(this,t),this.robotComponentsFactory.updateScenarioState(t)}},{key:"updateScenarioDisplay",value:function(t){g()(b()(n.prototype),"updateScenarioDisplay",this).call(this,t),this.renderer.render(this.robotComponentsFactory.getRobot()),this.renderAudio(t)}},{key:"renderAudio",value:function(t){this.audiocontext&&(this.prevFreq!=t.getTonePlaying()&&0!=this.prevFreq&&0!=t.getTonePlaying&&(this.prevFreq=t.getTonePlaying(),this.osc.stop(this.audiocontext.currentTime),this.osc.disconnect(this.audiocontext.destination),this.osc=null,this.audioStarted=!1),0===t.getTonePlaying()?this.audioStarted&&(this.audioStarted=!1,this.osc.stop(this.audiocontext.currentTime),this.osc.disconnect(this.audiocontext.destination),this.osc=null):0!==t.getTonePlaying()&&(this.audioStarted||(this.osc=this.audiocontext.createOscillator(),this.osc.frequency.value=t.getTonePlaying(),this.osc.start(this.audiocontext.currentTime),this.osc.connect(this.audiocontext.destination),this.audioStarted=!0)))}},{key:"initAudioContext",value:function(){if(null==this.audiocontext)try{this.audiocontext=new AudioContext}catch(t){console.log("Web Audio API is not supported in this browser")}}},{key:"setSensorOptions",value:function(){if(!document.getElementById("sensor_options")){var t=$("<div>").attr("id","sensor_options");$("#sim_container").append(t)}}},{key:"setBackground",value:function(){$("#sim_container").append("<div id='sim_background' class='sim_element row'></div>"),$("#sim_background").append("<div id='sim_background_img' class='background1'></div>"),this._background=1;var t=$("#sensor_options").width(),e=($("#sim_background").width()-t-$("#sim_background_img").width())/2;$("#sim_background_img").css("top","0px"),$("#sim_background_img").css("margin-left",e+"px")}},{key:"switchBackground",value:function(){this._background<3?this._background+=1:this._background=1,document.getElementById("sim_background_img").className="",document.getElementById("sim_background_img").className="background"+this._background,this._eventBus.dispatchEvent(O.SAVE)}},{key:"backgroundToXml",value:function(){var t="";return t=(t=(t=(t=(t=t.concat("<Item ")).concat(" Type='","background","'")).concat(" Class='",document.getElementById("sim_background_img").className,"'")).concat(" Id='",this._background,"'")).concat("></Item>")}},{key:"resetSocialRobot",value:function(t){this.robotComponentsFactory.resetSocialRobot()}},{key:"removeSocialRobotComponents",value:function(){this.robotComponentsFactory.removeAllSocialRobotComponents()}},{key:"addRobotComponent",value:function(t){this.robotComponentsFactory.addRobotComponent(t)}},{key:"removeRobotComponent",value:function(t){this.robotComponentsFactory.removeRobotComponent(t),this.renderer.render(this.robotComponentsFactory.getRobot())}},{key:"setLedColor",value:function(t,e){var n=this.robotComponentsFactory.getRobotComponentWithTypeAndId(dt.LED,t);void 0!==n&&n.setOnColor(e)}},{key:"loadToXml",value:function(){if(window.localStorage&&window.localStorage.getItem("dwenguinoSocialRobot"))return this.robotToXml()}},{key:"robotToXml",value:function(){var t='<xml xmlns="http://www.w3.org/1999/xhtml">';t=t.concat(this.backgroundToXml());for(var e=this.robotComponentsFactory.getRobot(),n=0;n<e.length;n++)t=t.concat(e[n].toXml());return t=t.concat("</xml>")}},{key:"xmlToRobot",value:function(t){for(var e=this.scenarioUtils.textToDom(t),n=e.childNodes.length,i=0;i<n;i++){var o=e.childNodes[i],a=o.getAttribute("Type");"background"!==a?(this.robotComponentsFactory.addRobotComponentFromXml(o),this.simulationComponentsMenu.changeValue(a,1)):(this._background=parseInt(o.getAttribute("Id")),document.getElementById("sim_background_img").className=o.getAttribute("Class"))}}},{key:"saveRobot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t?"permanentDwenguinoSocialRobot"+e:"dwenguinoSocialRobot"+e;console.log("%c saving robot","color: green");var i=window.localStorage;if(i){var o=this.robotToXml();i.setItem(n,o)}}},{key:"loadRobot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t?"permanentDwenguinoSocialRobot"+e:"dwenguinoSocialRobot"+e;console.log("%c loading robot","color: green");var i=window.localStorage;if(i){var o=i.getItem(n);o&&this.xmlToRobot(o)}}},{key:"clearRobot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e="dwenguinoSocialRobot"+t;console.log("%c clearing robot","color: green");var n=window.localStorage;n&&n.removeItem(e)}}]),n}(wt);function $t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var At=function(t){m()(n,t);var e=$t(n);function n(t){var i;return o()(this,n),i=e.call(this,t),l()(p()(i),"inputsState",null),l()(p()(i),"audioStarted",!1),l()(p()(i),"muted",!0),l()(p()(i),"prevFreq",0),l()(p()(i),"boardDisplayWidth","80%"),l()(p()(i),"componentsTopOffset","0%"),l()(p()(i),"rightSimComponentsPosition","auto"),l()(p()(i),"sonarDistance",0),l()(p()(i),"sonarInputChanged",!1),l()(p()(i),"sonarFieldBeingEdited",!1),i.inputsState={buttons:[1,1,1,1,1],reset:1},i}return r()(n,[{key:"setBoardDisplayWidthWidth",value:function(t){this.boardDisplayWidth=t}},{key:"setComponentsTopOffset",value:function(t){this.componentsTopOffset=t}},{key:"setComponentsRightPosition",value:function(t){this.rightSimComponentsPosition=t}},{key:"initAudioContext",value:function(){try{this.audiocontext=new AudioContext}catch(t){console.log("Web Audio API is not supported in this browser")}}},{key:"initSimulationDisplay",value:function(t){var e=this;$("#".concat(t)).append('<div id="db_simulator_pane"></div>'),$("#db_simulator_pane").append('<div id="debug"></div>'),$("#db_simulator_pane").append('<div id="sim_components"></div>');var n=$("<div>").css({position:"absolute",display:"inline-block",width:this.boardDisplayWidth,"max-width":"30vw",right:0}),i=$("<div>").attr("id","dummy").css({"margin-top":"70%"}),o=$("<div>").attr("id","sim_board");n.append(i),n.append(o),$("#db_simulator_pane").append(n),$("#db_simulator_pane").append('<span id="db_simulator_mute"></span>'),$("#db_simulator_mute").attr("class","fas fa-volume-mute");var a=$('<div id="sim_sonar" class="sim_sonar"></div>'),r=$('<div id="sim_sonar_distance" class="sim_sonar_distance"></div>'),s=$('<div id="sim_sonar_input"></div>').text("Sonar "+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["distance"])+":"),l=$('<button id="set_sonar_value"></button>').text("OK");$("#sim_components").append(a),$("#sim_components").append(r),$("#sim_components").append(s),$("#sim_components").append(l),$("#sim_components").css({"margin-top":this.componentsTopOffset,right:this.rightSimComponentsPosition}),$("#sim_sonar_input").append('<input type="text" id="sonar_input" size="3" name="sim_sonar_input" onkeypress="return event.charCode >= 48 && event.charCode <= 57">&nbsp;cm'),$("#sonar_input").on("keyup",(function(t){if("Enter"===t.key||13===t.keyCode){e.sonarInputChanged=!0;var n=$("#sonar_input").val();console.log(parseInt(n.trim())),e.sonarDistance=parseInt(n.trim())}})),$("#sonar_input").change((function(t){e.sonarInputChanged=!0;var n=$("#sonar_input").val();console.log(parseInt(n.trim())),e.sonarDistance=parseInt(n.trim())})),$("#set_sonar_value").click((function(t){var n=$("#sonar_input").val();console.log(parseInt(n.trim())),e.sonarDistance=parseInt(n.trim())})),$("#sonar_input").focus((function(){console.log("focus gained"),e.sonarFieldBeingEdited=!0})),$("#sonar_input").focusout((function(){console.log("focus lost"),e.sonarFieldBeingEdited=!1})),$("#sim_board").append('<div class="sim_light sim_light_off" id ="sim_light_13"></div>'),$("#sim_board").append('<div id="sim_lcds"></div>'),$("#sim_board").append('<div id="sim_lights"></div>'),$("#sim_board").append('<div id="sim_buttons"></div>'),$("#sim_board").append('<div id="sim_button_reset" class="sim_button"></div>'),$("#sim_lcds").append('<div class="sim_lcd" id="sim_lcd_row0"></div>'),$("#sim_lcds").append('<div class="sim_lcd" id="sim_lcd_row1"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_7"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_6"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_5"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_4"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_3"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_2"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_1"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_0"></div>'),$("#sim_buttons").append('<div id="sim_buttons_top"></div>'),$("#sim_buttons").append('<div id="sim_buttons_middle"></div>'),$("#sim_buttons").append('<div id="sim_buttons_bottom"></div>'),$("#sim_buttons_top").append('<div id="sim_button_N" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_W" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_C" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_E" class="sim_button"></div>'),$("#sim_buttons_bottom").append('<div id="sim_button_S" class="sim_button"></div>'),this.hideSonar();var c=this;$("#sim_button_N, #sim_button_E, #sim_button_C, #sim_button_S, #sim_button_W").on("mousedown",(function(){c.getIsSimulationRunning()&&(c.inputsState.buttons[S.mapButtonIdToIndex(this.id)]=0)})),$("#sim_button_N, #sim_button_E, #sim_button_C, #sim_button_S, #sim_button_W").on("mouseup",(function(){c.getIsSimulationRunning()&&(c.inputsState.buttons[S.mapButtonIdToIndex(this.id)]=1)})),$("#db_simulator_mute").on("click",(function(){null==e.audiocontext&&e.initAudioContext(),e.muted?(e.muted=!1,$("#db_simulator_mute").removeClass(),$("#db_simulator_mute").attr("class","fas fa-volume-up")):(e.muted=!0,$("#db_simulator_mute").removeClass(),$("#db_simulator_mute").attr("class","fas fa-volume-mute"))}))}},{key:"showSonar",value:function(){$("#sim_sonar").show(),$("#sim_sonar_distance").show(),$("#sim_sonar_input").show()}},{key:"hideSonar",value:function(){$("#sim_sonar").hide(),$("#sim_sonar_distance").hide(),$("#sim_sonar_input").hide()}},{key:"updateScenarioState",value:function(t){for(var e=0;e<this.inputsState.buttons.length;++e)t.setButtonState(e,this.inputsState.buttons[e]);this.sonarInputChanged&&(t.setSonarDistance(11,12,this.sonarDistance),this.sonarInputChanged=!1),this.sonarDistance=t.getSonarDistance(11,12)}},{key:"updateScenario",value:function(t){this.updateScenarioState(t),this.updateScenarioDisplay(t)}},{key:"updateScenarioDisplay",value:function(t){var e=t.getSonarDistance(11,12);if(e<=-1)this.hideSonar();else{this.showSonar();var n=document.getElementById("sonar_input");void 0!==n&&null!=n?this.sonarFieldBeingEdited||(n.value=e):console.log("Sonar input element is undefined")}this.audiocontext&&(this.prevFreq!=t.getTonePlaying()&&0!=this.prevFreq&&0!=t.getTonePlaying&&(this.prevFreq=t.getTonePlaying(),this.osc.stop(this.audiocontext.currentTime),this.osc.disconnect(this.audiocontext.destination),this.osc=null,this.audioStarted=!1),0===t.getTonePlaying()||this.muted?this.audioStarted&&(this.audioStarted=!1,this.osc.stop(this.audiocontext.currentTime),this.osc.disconnect(this.audiocontext.destination),this.osc=null):0===t.getTonePlaying()||this.muted||this.audioStarted||(this.osc=this.audiocontext.createOscillator(),this.osc.frequency.value=t.getTonePlaying(),this.osc.start(this.audiocontext.currentTime),this.osc.connect(this.audiocontext.destination),this.audioStarted=!0));for(var i=0;i<5;i++)0===t.getButtonState(i)?document.getElementById(S.mapIndexToButtonId(i)).className="sim_button sim_button_pushed":document.getElementById(S.mapIndexToButtonId(i)).className="sim_button";1==t.getBackLightStatus()?$("#sim_lcds").addClass("on"):$("#sim_lcds").removeClass("on");for(var o=0;o<2;++o)$("#sim_lcd_row"+o).text(t.getLcdContent(o)),null!==document.getElementById("sim_lcd_row"+o)&&(document.getElementById("sim_lcd_row"+o).innerHTML=document.getElementById("sim_lcd_row"+o).innerHTML.replace(/ /g,"&nbsp;"));var a=document.getElementById("sim_lcds");if(null!==a){a.style.display="none",a.offsetHeight,a.style.display="block";var r=$(".sim_lcd"),s=$("#sim_board").width()/16*1.25;r.css({"font-size":s})}for(var l=0;l<8;l++){var c="";c=0===t.getLedState(l)?"sim_light sim_light_off":"sim_light sim_light_on",document.getElementById("sim_light_"+l).className=c}0===t.getLedState(8)?document.getElementById("sim_light_13").className="sim_light sim_light_off":document.getElementById("sim_light_13").className="sim_light sim_light_on"}}]),n}(wt);function Rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Bt=function(t){m()(n,t);var e=Rt(n);function n(t){var i;return o()(this,n),i=e.call(this,t),l()(p()(i),"dwenguinoBoardSimulation",null),i.dwenguinoBoardSimulation=new At(t),i.initSimulationState(null),i}return r()(n,[{key:"initSimulationState",value:function(t){g()(b()(n.prototype),"initSimulationState",this).call(this,t),this.robot={image:{width:65,height:83},start:{x:100,y:100,angle:0},position:{x:100,y:100,angle:0},collision:[{type:"circle",radius:25}]},this.containerWidth=0,this.containerHeight=0}},{key:"initSimulationDisplay",value:function(t){g()(b()(n.prototype),"initSimulationDisplay",this).call(this,t);var e=$("#".concat(t)),i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane"),a=$("<div>").attr("id","db_robot_pane"),r=$("<div>").attr("id","sim_container"),s=$("<div>").attr("id","sim_animation");r.append(s),a.append(r),o.append(a),e.append(i).append(o),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("db_simulator_top_pane"),$("#sim_board").addClass("sim_board_row_placement");var l=$("#db_robot_pane"),c=this;new ResizeSensor(r,(function(){console.log("myelement has been resized"),c.containerWidth=r.width(),c.containerHeight=r.height()}));var u=$("<div>").attr("id","sim_animation");r.append(u),l.append(r),$("#db_simulator_bottom_pane").css("display","flex").css("flex-direction","column"),$("#db_robot_pane").css("flex: 1"),$("#sim_container").css("position","relative").css("width","80%").css("height","80%").css("box-sizing","border-box"),$("#sim_animation").css("width",this.robot.image.width+"px").css("height",this.robot.image.height+"px").css("maring-left","-25px").css("maring-right","-20px").css("position","absolute").css("background-image","url('DwenguinoIDE/img/board/robot.png')").css("background-size","100%").css("top",this.robot.position.y+"px").css("left",this.robot.position.x+"px")}},{key:"updateScenario",value:function(t){g()(b()(n.prototype),"updateScenario",this).call(this,t),this.updateScenarioState(t),this.updateScenarioDisplay(t),this.dwenguinoBoardSimulation.updateScenario(t)}},{key:"updateScenarioState",value:function(t){g()(b()(n.prototype),"updateScenarioState",this).call(this,t),this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height();var e=t.getMotorSpeed(1),i=t.getMotorSpeed(2),o=this.robot.position.x,a=this.robot.position.y,r=this.robot.position.angle,s=(e+i)/100;e!==i&&(r+=(i-e)/30),o+=s*Math.cos(Math.PI/180*r),a+=s*Math.sin(Math.PI/180*r),o>this.containerWidth?o=0:o<0&&(o=this.containerWidth),a>this.containerHeight?a=0:a<0&&(a=this.containerHeight),this.robot.position={x:o,y:a,angle:r}}},{key:"updateScenarioDisplay",value:function(t){g()(b()(n.prototype),"updateScenarioDisplay",this).call(this,t);this.robot;var e=$("#sim_animation");this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height(),e.css("top",this.robot.position.y+"px").css("left",this.robot.position.x+"px").css("transform","rotate("+this.robot.position.angle+"deg)")}},{key:"setIsSimulationRunning",value:function(t){this.isSimulationRunning=t,this.dwenguinoBoardSimulation.setIsSimulationRunning(t)}}]),n}(wt);function Dt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Lt=function(t){m()(n,t);var e=Dt(n);function n(t){var i;return o()(this,n),(i=e.call(this,t)).initSimulationState(null),i}return r()(n,[{key:"initSimulationState",value:function(t){g()(b()(n.prototype),"initSimulationState",this).call(this,t)}},{key:"initSimulationDisplay",value:function(t){g()(b()(n.prototype),"initSimulationDisplay",this).call(this,t),$("#sim_board").addClass("sim_board_row_placement"),$("#sim_container").css("border","solid").css("border-width","3px").css("border-color","black").css("max-width","80%").css("max-height","80%"),this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height()}},{key:"updateScenario",value:function(t){g()(b()(n.prototype),"updateScenario",this).call(this,t)}},{key:"updateScenarioState",value:function(t){var e=t.getMotorSpeed(1),n=t.getMotorSpeed(2),i=this.robot.position.x,o=this.robot.position.y,a=this.robot.position.angle,r=(e+n)/100;e!==n&&(a+=(n-e)/30%360),i+=r*Math.cos(Math.PI/180*a),o+=r*Math.sin(Math.PI/180*a),i>this.containerWidth-this.robot.image.width?i=this.containerWidth-this.robot.image.width:i<0&&(i=0),o>this.containerHeight-this.robot.image.height?o=this.containerHeight-this.robot.image.height:o<0&&(o=0);var s=o;a=(a%360+360)%360;var l=i+this.robot.image.width/2*Math.cos(Math.PI/180*a),c=s+this.robot.image.width/2*Math.sin(Math.PI/180*a),u=[[this.containerWidth,this.containerHeight],[0,this.containerHeight],[0,0],[this.containerWidth,0]],d=[0,0],p=[0,0];if(90==a)d=p=[l,this.containerHeight];else if(270==a)d=p=[l,0];else if(180==a)d=p=[0,c];else if(0==a)d=p=[this.containerWidth,c];else{Math.tan(a);var h=u[Math.floor(a/90)%4];d=[h[0],Math.tan(a*Math.PI/180)*(h[0]-l)+c],p=[(h[1]-c)/Math.tan(a*Math.PI/180)+l,h[1]]}var g=Math.min(this.calcDistanceBetweenPoints(d,[l,c]),this.calcDistanceBetweenPoints(p,[l,c]));return t.setSonarDistance(11,12,Math.abs(g-25)),this.robot.position={x:i,y:o,angle:a},t}},{key:"calcDistanceBetweenPoints",value:function(t,e){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}},{key:"updateScenarioDisplay",value:function(t){g()(b()(n.prototype),"updateScenarioDisplay",this).call(this,t)}},{key:"setIsSimulationRunning",value:function(t){this.isSimulationRunning=t,this.dwenguinoBoardSimulation.setIsSimulationRunning(t)}}]),n}(Bt),Ft=function(){function t(e,n){o()(this,t),l()(this,"x",0),l()(this,"y",0),this.x=e,this.y=n}return r()(t,[{key:"getEuclideanDistanceTo",value:function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;t.beginPath(),t.arc(this.x,this.y,e,0,360),t.closePath(),t.stroke(),t.fill()}},{key:"getX",value:function(){return this.x}},{key:"setX",value:function(t){this.x=t}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(t){this.y=t}}]),t}(),Nt=function(){function t(e,n){o()(this,t),l()(this,"point1",null),l()(this,"point2",null),this.point1=e,this.point2=n}return r()(t,[{key:"getSlope",value:function(){return(this.point2.getY()-this.point1.getY())/(this.point2.getX()-this.point1.getX())}},{key:"getOffset",value:function(){return this.point1.getY()-this.getSlope()*this.point1.getX()}},{key:"getPointsPerpendicular",value:function(t,e){var n=1/this.getSlope()*-1;return this.getPointAtDistanceFromPointWithSlope(t,e,n)}},{key:"getPointAtDistanceFromPointWithSlope",value:function(t,e,n){var i=Math.atan(n),o=e*Math.cos(i),a=e*Math.sin(i);return[new Ft(t.getX()+o,t.getY()+a),new Ft(t.getX()-o,t.getY()-a)]}},{key:"getPointsOnLineAtSetDistanceFromOtherPointOnLine",value:function(t,e){return this.getPointAtDistanceFromPointWithSlope(t,e,this.getSlope())}}]),t}(),jt=function(){function t(){o()(this,t)}return r()(t,[{key:"drawRobotArm",value:function(t,e,n,i,o,a){this.drawConvexHull(t,e,n,o),this.drawArmHoles(t,e,n,i,a)}},{key:"drawArmHoles",value:function(t,e,n,i,o){var a=e.getEuclideanDistanceTo(n)/i,r=new Nt(e,n).getSlope(),s=Math.atan(r);e.getX()>n.getX()&&(s+=Math.PI);for(var l=e,c=0;c<i;++c){t.beginPath(),t.arc(l.getX(),l.getY(),o,0,360),t.closePath(),t.stroke();var u=a*Math.cos(s),d=a*Math.sin(s);l=new Ft(l.getX()+u,l.getY()+d)}}},{key:"drawConvexHull",value:function(t,e,n,i){var o=new Nt(e,n),a=o.getPointsPerpendicular(e,i/2),r=o.getPointsPerpendicular(n,i/2),s=o.getPointsOnLineAtSetDistanceFromOtherPointOnLine(e,i/2),l=o.getPointsOnLineAtSetDistanceFromOtherPointOnLine(n,i/2),c=[];c.push(a[0]),c.push(r[0]);var u=null;u=this.checkIfInnerPointOfLineBetweenPoints(e,n,l[0])?l[1]:l[0];var d=new Ft(u.getX()+(r[0].getX()-n.getX()),u.getY()+(r[0].getY()-n.getY()));c.push(d),c.push(u),d=new Ft(u.getX()+(r[1].getX()-n.getX()),u.getY()+(r[1].getY()-n.getY())),c.push(d),c.push(r[1]),c.push(a[1]),u=this.checkIfInnerPointOfLineBetweenPoints(e,n,s[0])?s[1]:s[0],d=new Ft(u.getX()+(a[1].getX()-e.getX()),u.getY()+(a[1].getY()-e.getY())),c.push(d),c.push(u),d=new Ft(u.getX()+(a[0].getX()-e.getX()),u.getY()+(a[0].getY()-e.getY())),c.push(d),t.beginPath(),t.moveTo(c[0].getX(),c[0].getY()),t.lineTo(c[1].getX(),c[1].getY()),t.quadraticCurveTo(c[2].getX(),c[2].getY(),c[3].getX(),c[3].getY()),t.quadraticCurveTo(c[4].getX(),c[4].getY(),c[5].getX(),c[5].getY()),t.lineTo(c[6].getX(),c[6].getY()),t.quadraticCurveTo(c[7].getX(),c[7].getY(),c[8].getX(),c[8].getY()),t.quadraticCurveTo(c[9].getX(),c[9].getY(),c[0].getX(),c[0].getY()),t.closePath(),t.stroke()}},{key:"drawBasePlate",value:function(t,e,n){this.drawConvexHull(t,e,n,80),t.fillStyle="#8bab42",t.font="40px Courier New",t.textAlign="center",t.textBaseline="middle",t.fillText("dwengo",e.getX()+(n.getX()-e.getX())/2,e.getY())}},{key:"checkIfInnerPointOfLineBetweenPoints",value:function(t,e,n){return n.getEuclideanDistanceTo(t)+n.getEuclideanDistanceTo(e)<=t.getEuclideanDistanceTo(e)+.1}}]),t}();function Ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Ut=function(t){m()(n,t);var e=Ht(n);function n(t){var i;return o()(this,n),i=e.call(this,t),l()(p()(i),"startScale",400),l()(p()(i),"currentScale",400),l()(p()(i),"currentColor","#4a9234"),l()(p()(i),"representationScale",{motorAxes:[[30,30],[280,30]],motorAngles:[0,0],segmentLengths:[30,20,150,170,120,150,160,150,50],segmentCount:[3,2,15,17,12,15,14,16,5],segmentRanges:[[2,3],[2,3],[10,20],[10,20],[5,15],[5,15],[5,15],[5,15],[0,2]],segmentIncrement:10,armWidth:10,holeDiameter:2.5,hinges:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]}),l()(p()(i),"drawingScale",{motorAxes:[[0,0],[0,0]],segmentLengths:[0,0,0,0,0,0,0,0,0],hinges:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],armWidth:0,holeDiameter:10}),l()(p()(i),"canvases",[]),l()(p()(i),"contexts",[]),l()(p()(i),"canvasNames",{SPYROGRAPH_CANVAS:0,SPYROGRAPH_DRAWING_CANVAS:1}),l()(p()(i),"container",null),l()(p()(i),"imageData",null),l()(p()(i),"graphicsLib",null),l()(p()(i),"dwenguinoBoardSimulation",null),l()(p()(i),"scaleFactorForDisplay",.8),i.initSimulationState(null),i.graphicsLib=new jt,i.dwenguinoBoardSimulation=new At(t),i.dwenguinoBoardSimulation.setBoardDisplayWidthWidth("100%"),i}return r()(n,[{key:"initSimulationState",value:function(t){g()(b()(n.prototype),"initSimulationState",this).call(this,t),this.representationScale.motorAngles=[0,0]}},{key:"initSimulationDisplay",value:function(t){var e=this;g()(b()(n.prototype),"initSimulationDisplay",this).call(this,t),this.canvases=[],this.contexts=[],this.initDrawingEnvironment(t),this.loadPreviousImageIfExists(),this.createControlsMenu(),this.convertToDisplayAndRender(!1),this.container=$("#".concat(t));var i=$("<div>").attr("id","boardContainer").css({position:"absolute",width:"40%",right:"10px",top:"10px"});this.container.append(i),this.dwenguinoBoardSimulation.setBoardDisplayWidthWidth("100%"),this.dwenguinoBoardSimulation.setComponentsTopOffset("55%"),this.dwenguinoBoardSimulation.setComponentsRightPosition("55px"),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("boardContainer"),$("#sim_board").addClass("sim_board_column_placement"),new ResizeObserver((function(){for(var t=0;t<e.canvases.length;++t)e.canvases[t].width=e.container.width(),e.canvases[t].height=e.container.height();e.loadPreviousImageIfExists(),e.convertToDisplayAndRender(!0)})).observe(document.querySelector("#".concat(t)))}},{key:"initDrawingEnvironment",value:function(t){this.container=$("#".concat(t)),this.container.css({position:"relative"});for(var e=0,n=["spyrograph_canvas","spyrograph_drawing_canvas"];e<n.length;e++){var i=n[e];this.setupCanvas(i,this.container)}}},{key:"loadPreviousImageIfExists",value:function(){null!=this.imageData&&this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].putImageData(this.imageData,0,0)}},{key:"setupCanvas",value:function(t,e){var n=$("<canvas>").attr("id",t).css({position:"absolute",left:"10px",top:0})[0],i=n.getContext("2d");n.width=e.width(),n.height=e.height(),this.canvases.push(n),this.contexts.push(i),this.container.append(n)}},{key:"createControlsMenu",value:function(){var t=this,e=$("<span>").css({position:"absolute",right:0,bottom:0,width:"15%","text-align":"center","margin-right":"20px","margin-bottom":"20px"}),n=$("<input>").attr("type","color").attr("value",this.currentColor),i=this;n.on("change",(function(t){console.log($(this).val()),i.currentColor=$(this).val()})),e.append(n);var o=$("<button>").attr("value","Clear").html(MSG.clear).css({width:"90%","margin-top":"5px"});o.on("click",(function(e){t.contexts[t.canvasNames.SPYROGRAPH_DRAWING_CANVAS].clearRect(0,0,t.canvases[t.canvasNames.SPYROGRAPH_DRAWING_CANVAS].width,t.canvases[t.canvasNames.SPYROGRAPH_DRAWING_CANVAS].height),t.imageData=null})),e.append(o);var a=$("<button>").attr("value","Save").html(MSG.save).css({width:"90%","margin-top":"5px"});a.on("click",(function(e){var n=t.canvases[t.canvasNames.SPYROGRAPH_DRAWING_CANVAS].toDataURL("image/png"),i=document.createElement("a");i.download="tekening.png",i.href=n,i.click()})),e.append(a),this.container.append(e)}},{key:"createSlidersForSegments",value:function(t){for(var e=this,n=function(n){var i=$("<span>"),o=$("<span>").html("l"+n),a=$("<input>").attr("type","range").attr("min",e.representationScale.segmentRanges[n][0]).attr("max",e.representationScale.segmentRanges[n][1]).attr("value",e.representationScale.segmentCount[n]);a.css({"border-radius":"5px"});var r=e;a.on("change",(function(t){var e=parseInt($(this).val());console.log(e),r.representationScale.segmentCount[n]=e,r.representationScale.segmentLengths[n]=r.representationScale.segmentIncrement*e,r.calculateHingePoints(),r.convertToDisplayAndRender(!1)})),i.append(o),i.append(a),t.append(i)},i=0;i<this.representationScale.segmentLengths.length-1;++i)n(i)}},{key:"updateScenario",value:function(t){g()(b()(n.prototype),"updateScenario",this).call(this,t),this.updateScenarioState(t),this.updateScenarioDisplay(t),this.dwenguinoBoardSimulation.updateScenario(t)}},{key:"updateScenarioState",value:function(t){g()(b()(n.prototype),"updateScenarioState",this).call(this,t),this.timestep++;for(var e=0;e<2;e++)this.representationScale.motorAngles[e]+=t.getMotorSpeed(e+1)/3825;this.calculateHingePoints()}},{key:"calculateHingePoints",value:function(){for(var t=0;t<2;t++)this.representationScale.hinges[t]=[this.representationScale.motorAxes[t][0]+this.representationScale.segmentLengths[t]*Math.cos(this.representationScale.motorAngles[t]),this.representationScale.motorAxes[t][1]+this.representationScale.segmentLengths[t]*Math.sin(this.representationScale.motorAngles[t])];this.calulateFirstHingePoint(),this.calculateCentralHingePoints(),this.calculateFinalHingePoint()}},{key:"calulateFirstHingePoint",value:function(){var t=this.representationScale.segmentLengths[2],e=this.representationScale.segmentLengths[3],n=this.representationScale.hinges[0][0],i=this.representationScale.hinges[0][1],o=this.representationScale.hinges[1][0],a=this.representationScale.hinges[1][1],r=this.calculateHingePoint(n,i,o,a,t,e);this.representationScale.hinges[2][0]=r[0],this.representationScale.hinges[2][1]=r[1]}},{key:"calculateCentralHingePoints",value:function(){var t=this.representationScale.segmentLengths[3],e=this.representationScale.segmentLengths[4],n=this.representationScale.hinges[1][0],i=this.representationScale.hinges[1][1],o=this.representationScale.hinges[2][0],a=this.representationScale.hinges[2][1];this.representationScale.hinges[3][0]=n+(t+e)*(o-n)/t,this.representationScale.hinges[3][1]=i+(t+e)*(a-i)/t,t=this.representationScale.segmentLengths[2],e=this.representationScale.segmentLengths[5],n=this.representationScale.hinges[0][0],i=this.representationScale.hinges[0][1],o=this.representationScale.hinges[2][0],a=this.representationScale.hinges[2][1],this.representationScale.hinges[4][0]=n+(t+e)*(o-n)/t,this.representationScale.hinges[4][1]=i+(t+e)*(a-i)/t}},{key:"calculateFinalHingePoint",value:function(){var t=this.representationScale.hinges[3][0],e=this.representationScale.hinges[3][1],n=this.representationScale.hinges[4][0],i=this.representationScale.hinges[4][1],o=this.representationScale.segmentLengths[6],a=this.representationScale.segmentLengths[7],r=this.calculateHingePoint(t,e,n,i,o,a);this.representationScale.hinges[5][0]=r[0],this.representationScale.hinges[5][1]=r[1]}},{key:"calculateHingePoint",value:function(t,e,n,i,o,a){var r=a*a-o*o-n*n+t*t-i*i+e*e,s=2*(t-n),l=4*(i-e)*(i-e)/(s*s)+1,c=4*(i-e)*(i-e)+s*s,u=s*s,d=4*r*(i-e)/(s*s)-4*t*(i-e)/s-2*e,p=r*r/(s*s)-2*t*r/s+t*t+e*e-o*o,h=(-1*d+Math.sqrt(d*d-4*l*p))*u/(2*c),g=(-1*d-Math.sqrt(d*d-4*l*p))*u/(2*c);return h>g?[(2*h*(i-e)+r)/s,h]:[(2*g*(i-e)+r)/s,g]}},{key:"updateScenarioDisplay",value:function(t){g()(b()(n.prototype),"updateScenarioDisplay",this).call(this,t),this.convertToDisplayAndRender(!0)}},{key:"convertToDisplayAndRender",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scaleRepresentationToDrawing(this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].width),this.mirrorDisplayVertically(this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].height),window.requestAnimationFrame((function(){t.render(e)}))}},{key:"mirrorDisplayVertically",value:function(t){for(var e=0;e<this.drawingScale.motorAxes.length;++e)this.drawingScale.motorAxes[e][1]=-1*this.drawingScale.motorAxes[e][1]+t;for(var n=0;n<this.drawingScale.hinges.length;++n)this.drawingScale.hinges[n][1]=-1*this.drawingScale.hinges[n][1]+t}},{key:"scaleRepresentationToDrawing",value:function(t){this.scaleSegementLengths(t),this.scaleHingePoints(t),this.scaleArmProperties(t)}},{key:"scaleArmProperties",value:function(t){this.drawingScale.armWidth=this.representationScale.armWidth/this.startScale*t,this.drawingScale.holeDiameter=this.representationScale.holeDiameter/this.startScale*t}},{key:"scaleHingePoints",value:function(t){for(var e=t*this.scaleFactorForDisplay,n=0;n<this.representationScale.motorAxes.length;++n)for(var i=0;i<this.representationScale.motorAxes[n].length;++i)this.drawingScale.motorAxes[n][i]=this.representationScale.motorAxes[n][i]/this.startScale*e;for(var o=0;o<this.representationScale.hinges.length;++o)for(var a=0;a<this.representationScale.hinges[o].length;++a)this.drawingScale.hinges[o][a]=this.representationScale.hinges[o][a]/this.startScale*e}},{key:"scaleSegementLengths",value:function(t){for(var e=t*this.scaleFactorForDisplay,n=0;n<this.representationScale.motorAxes.length;n++)for(var i=0;i<this.representationScale.motorAxes[n].length;i++)this.drawingScale.motorAxes[n][i]=this.representationScale.motorAxes[n][i]/this.startScale*e;for(var o=0;o<this.representationScale.segmentLengths.length;o++)this.drawingScale.segmentLengths[o]=this.representationScale.segmentLengths[o]/this.startScale*e;this.currentScale=e}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:TextTrackCueList,e=this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].width,n=this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].height;this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].clearRect(0,0,e,n),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fillStyle="#000000",this.graphicsLib.drawBasePlate(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ft(this.drawingScale.motorAxes[0][0],this.drawingScale.motorAxes[0][1]),new Ft(this.drawingScale.motorAxes[1][0],this.drawingScale.motorAxes[1][1])),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fillStyle="#FF0000";for(var i=this.drawingScale.hinges.concat(this.drawingScale.motorAxes),o=0;o<i.length;o++)this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].beginPath(),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].arc(i[o][0],i[o][1],3,0,360),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].closePath(),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fill();this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ft(this.drawingScale.motorAxes[0][0],this.drawingScale.motorAxes[0][1]),new Ft(this.drawingScale.hinges[0][0],this.drawingScale.hinges[0][1]),this.representationScale.segmentCount[0],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ft(this.drawingScale.motorAxes[1][0],this.drawingScale.motorAxes[1][1]),new Ft(this.drawingScale.hinges[1][0],this.drawingScale.hinges[1][1]),this.representationScale.segmentCount[1],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ft(this.drawingScale.hinges[0][0],this.drawingScale.hinges[0][1]),new Ft(this.drawingScale.hinges[4][0],this.drawingScale.hinges[4][1]),this.representationScale.segmentCount[2]+this.representationScale.segmentCount[5],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ft(this.drawingScale.hinges[1][0],this.drawingScale.hinges[1][1]),new Ft(this.drawingScale.hinges[3][0],this.drawingScale.hinges[3][1]),this.representationScale.segmentCount[3]+this.representationScale.segmentCount[4],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ft(this.drawingScale.hinges[3][0],this.drawingScale.hinges[3][1]),new Ft(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1]),this.representationScale.segmentCount[6],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ft(this.drawingScale.hinges[4][0],this.drawingScale.hinges[4][1]),new Ft(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1]),this.representationScale.segmentCount[7],this.drawingScale.armWidth,this.drawingScale.holeDiameter),t&&(this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].fillStyle=this.currentColor,this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].beginPath(),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].arc(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1],1,0,360),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].closePath(),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].fill());try{this.imageData=this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].getImageData(0,0,this.container.width(),this.container.height())}catch(t){}}},{key:"setIsSimulationRunning",value:function(t){this.isSimulationRunning=t,this.dwenguinoBoardSimulation.setIsSimulationRunning(t)}}]),n}(wt);function Gt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Wt=function(t){m()(n,t);var e=Gt(n);function n(t){var i;return o()(this,n),i=e.call(this,t),l()(p()(i),"stepperMotorPins",[33,34]),l()(p()(i),"penPositionPins",[36,37]),l()(p()(i),"colorPin",35),l()(p()(i),"dwenguinoBoardSimulation",null),l()(p()(i),"previousProgramColor","#000"),l()(p()(i),"motor",{image:{radius:E.motorRadius},position:{xL:20,xR:20+E.motorDistance,y:20},settings:{nrOfSteps:E.nrOfSteps,currentSteps:[0,0]}}),l()(p()(i),"wireLengths",[300,200]),l()(p()(i),"startWireLengths",i.wireLengths),l()(p()(i),"stylus",{image:{radius:5},position:{x:80,y:80},prevPosition:{x:0,y:0},drawing:{radius:2,drawingColor:"#000",selectedColor:"#000",boardColor:"#000",liftStylus:!1}}),l()(p()(i),"paper",{height:(i.motor.position.xR-i.motor.position.xL)/Math.sqrt(2),width:i.motor.position.xR-i.motor.position.xL,position:{x:i.motor.position.xL,y:40}}),l()(p()(i),"containerWidth",0),l()(p()(i),"containerHeight",0),i.dwenguinoBoardSimulation=new At(t),i}return r()(n,[{key:"initSimulationState",value:function(t){g()(b()(n.prototype),"initSimulationState",this).call(this,t),this.caclulateStylusPoint(),t&&(t.setIoPinState(this.stepperMotorPins[0],this.wireLengths[0]/(2*Math.PI*E.motorRadius/E.nrOfSteps)),t.setIoPinState(this.stepperMotorPins[1],this.wireLengths[1]/(2*Math.PI*E.motorRadius/E.nrOfSteps)),t.setIoPinState(this.penPositionPins[0],this.stylus.position.x-this.motor.position.xL),t.setIoPinState(this.penPositionPins[1],this.stylus.position.y-this.motor.position.y))}},{key:"initSimulationDisplay",value:function(t){g()(b()(n.prototype),"initSimulationDisplay",this).call(this,t),this.initSimulationState(null);var e=$("#".concat(t)),i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane");e.append(i).append(o),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("db_simulator_top_pane"),$("#sim_board").addClass("sim_board_row_placement"),o.append($("<canvas>").attr("id","sim_canvas").attr("class","canvas")),o.append($("<canvas>").attr("id","sim_canvas_drawing").attr("class","canvas")),o.append($("<canvas>").attr("id","sim_canvas_grid").attr("class","canvas")),o.append($("<div>").attr("id","sim_grid"));var a=$("<ul>").attr("id","sim_settings"),r=$("<li>").attr("class","sim_setting");$("<input />",{type:"checkbox",id:"cb_grid",value:"grid"}).prop("checked",!0).appendTo(r),$("<label />",{for:"cb_grid",id:"txt_grid",text:MSG.drawingrobotgrid}).appendTo(r),a.append(r);r=$("<li>").attr("class","sim_setting");$("#colorpicker");var s=$("<input />",{type:"color",id:"colorpicker",name:"colorpicker",value:this.stylus.drawing.drawingColor});s.appendTo(r),$("<label />",{for:"colorpicker",id:"txt_colorpicker",text:MSG.colorpicker}).appendTo(r),a.append(r);r=$("<li>").attr("class","sim_setting");$("<button />",{type:"button",id:"btn_saveImage",text:MSG.drawingrobotSaveImage}).appendTo(r),a.append(r),o.append(a);var l=this;s.on("change",(function(t){console.log($(this).val()),l.updateColor($(this).val())}));var c=$("#sim_canvas")[0],u=$("#sim_canvas_drawing")[0],d=$("#sim_canvas_grid")[0];$(".canvas").css("position","absolute").css("top","O").css("left","O"),$("#sim_settings").css("position","absolute").css("right","20px").css("top","0px").css("list-style","none"),$("#sim_grid").css("position","absolute").css("left",this.paper.position.x).css("top",this.paper.position.y).css("width",this.paper.width).css("height",this.paper.height),$(".sim_setting").css("vertical-align","middle"),this.containerWidth=o.width(),this.containerHeight=o.height(),c.width=this.containerWidth,c.height=this.containerHeight,u.width=this.containerWidth,u.height=this.containerHeight,d.width=this.containerWidth,d.height=this.containerHeight,this.drawGrid(),$("#cb_grid").click((function(){$("#svg_grid").toggle(this.checked),$("#sim_canvas_grid").toggle(this.checked)})),$("#btn_saveImage").click((function(){var t="image/png",e=$("#sim_canvas_drawing")[0].toDataURL(t),n=document.createElement("a");n.download=MSG.drawingrobotDrawing,n.href=e,n.dataset.downloadurl=[t,n.download,n.href].join(":"),document.body.appendChild(n),n.click(),document.body.removeChild(n)})),this.redraw()}},{key:"updateScenario",value:function(t){g()(b()(n.prototype),"updateScenarioState",this).call(this,t);this.updateScenarioState(t);this.updateScenarioDisplay(t)}},{key:"updateScenarioState",value:function(t){g()(b()(n.prototype),"updateScenarioState",this).call(this,t),this.updateServoAngle(t.getIoPinState(38)),this.previousProgramColor!=t.getIoPinState(this.colorPin)&&this.updateColor(t.getIoPinState(this.colorPin));var e=t.getIoPinState(this.stepperMotorPins[0]),i=t.getIoPinState(this.stepperMotorPins[1]);this.updateLengths([e,i]),this.caclulateStylusPoint(),t.setIoPinState(this.penPositionPins[0],this.stylus.position.x-this.motor.position.xL),t.setIoPinState(this.penPositionPins[1],this.stylus.position.y-this.motor.position.y)}},{key:"updateLengths",value:function(t){var e=this,n=t.map((function(t,n){var i=t*(2*Math.PI*e.motor.image.radius/e.motor.settings.nrOfSteps);return i>=0?i:0}));this.wireLengths=n}},{key:"calculateWireLengths",value:function(t){}},{key:"caclulateStylusPoint",value:function(){var t=this.wireLengths[0],e=this.wireLengths[1],n=this.motor.position.xR-this.motor.position.xL,i=(Math.pow(t,2)-Math.pow(e,2)+Math.pow(n,2))/(2*n);t+e>=n&&(this.stylus.position.x=this.motor.position.xL+i,this.stylus.position.y=this.motor.position.y+Math.sqrt(Math.pow(t,2)-Math.pow(i,2)))}},{key:"updateScenarioDisplay",value:function(t){g()(b()(n.prototype),"updateScenarioDisplay",this).call(this,t),this.redraw()}},{key:"redraw",value:function(){var t=$("#sim_canvas")[0],e=t.getContext("2d"),n=$("#sim_canvas_drawing")[0].getContext("2d");e.clearRect(0,0,t.width,t.height),e.beginPath(),e.strokeStyle="#848484",e.moveTo(this.motor.position.xL,this.motor.position.y),e.lineTo(this.stylus.position.x,this.stylus.position.y),e.moveTo(this.motor.position.xR,this.motor.position.y),e.lineTo(this.stylus.position.x,this.stylus.position.y),e.stroke(),e.beginPath(),e.globalAlpha=.5,e.fillStyle=this.stylus.drawing.drawingColor,e.arc(this.stylus.position.x,this.stylus.position.y,this.stylus.image.radius,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="#848484",e.arc(this.motor.position.xL,this.motor.position.y,this.motor.image.radius,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="#848484",e.arc(this.motor.position.xR,this.motor.position.y,this.motor.image.radius,0,2*Math.PI),e.fill(),this.stylus.drawing.liftStylus||(n.beginPath(),n.fillStyle=this.stylus.drawing.drawingColor,n.arc(this.stylus.position.x,this.stylus.position.y,this.stylus.drawing.radius,0,2*Math.PI),n.fill())}},{key:"drawGrid",value:function(){var t=this.paper.position.x,e=this.paper.position.y,n=$("#sim_canvas_grid")[0].getContext("2d");n.font="10px Arial",n.fillText("0",t,e),n.fillText("100",t+100,e),n.fillText("200",t+200,e),n.fillText("300",t+300,e),n.fillText("300",t-15,e+100),n.fillText("200",t-15,e+200),n.fillText("100",t-15,e+300);$("#sim_grid").append('        <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" id="svg_grid">          <defs>            <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">            <path d="M 10 0 L 0 0 0 10" fill="none" stroke="gray" stroke-width="0.5"/>            </pattern>            <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">              <rect width="100" height="100" fill="url(#smallGrid)"/>              <path d="M 100 0 L 0 0 0 100" fill="none" stroke="gray" stroke-width="1"/>            </pattern>          </defs>          <rect width="100%" height="100%" fill="url(#grid)" />        </svg>')}},{key:"updateServoAngle",value:function(t){90===t&&(this.stylus.drawing.liftStylus=!0),0===t&&(this.stylus.drawing.liftStylus=!1)}},{key:"checkServoAngle",value:function(t,e){return(90!==t||!e.stylus.drawing.liftStylus)&&!(0===t&&!e.stylus.drawing.liftStylus)}},{key:"updateColor",value:function(t){0!=t&&(this.stylus.drawing.drawingColor=t)}},{key:"setIsSimulationRunning",value:function(t){this.isSimulationRunning=t,this.dwenguinoBoardSimulation.setIsSimulationRunning(t)}}]),n}(wt),Vt=function(){function t(e,n){o()(this,t),l()(this,"logger",null),l()(this,"workspace",null),l()(this,"scenarios",null),this.scenarios={spyrograph:new Ut(e),moving:new Bt(e),wall:new Lt(e),socialrobot:new Ot(e),plotter:new Wt(e)},this.logger=e,this.workspace=n,this.simControlsController=new yt(this.logger,this.workspace,this.scenarios)}return r()(t,[{key:"open",value:function(){}},{key:"stop",value:function(){this.simControlsController.handleSimulationStop()}}]),t}();function Xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Yt=function(t){m()(n,t);var e=Xt(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"buzzer"}}],[{key:"getType",value:function(){return V.BUZZER}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["buzzerDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return["frequency"]}}]),n}(X);function Kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var zt=function(t){m()(n,t);var e=Kt(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"lcd"}}],[{key:"getType",value:function(){return V.LCD}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["lcdDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(X);function qt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Qt=function(t){m()(n,t);var e=qt(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"led"}}],[{key:"getType",value:function(){return V.LED}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["ledDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(X);function Jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var Zt=function(t){m()(n,t);var e=Jt(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"light sensor"}}],[{key:"getType",value:function(){return V.LIGHT}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["lightDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(X);function te(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var ee=function(t){m()(n,t);var e=te(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"PIR sensor"}}],[{key:"getType",value:function(){return V.PIR}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["pirDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(X);function ne(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var ie=function(t){m()(n,t);var e=ne(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"Servo"}}],[{key:"getType",value:function(){return V.SERVO}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["servoDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return["angle"]}}]),n}(X);function oe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var ae=function(t){m()(n,t);var e=oe(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"Sonar"}}],[{key:"getType",value:function(){return V.SONAR}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["sonarDescription"])}},{key:"getInputPins",value:function(){return["trigger"]}},{key:"getOutputPins",value:function(){return["echo"]}}]),n}(X);function re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var se=function(t){m()(n,t);var e=re(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"touch sensor"}}],[{key:"getType",value:function(){return V.TOUCH}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["touchDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(X);function le(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var ce=function(t){m()(n,t);var e=le(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"rgbled"}}],[{key:"getType",value:function(){return V.RGBLED}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["rgbledDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(X);function ue(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=b()(t);if(e){var o=b()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _()(this,n)}}var de=function(t){m()(n,t);var e=ue(n);function n(){return o()(this,n),e.call(this)}return r()(n,[{key:"toString",value:function(){return"DC Motor"}}],[{key:"getType",value:function(){return V.DCMOTOR}},{key:"getDescription",value:function(){return DwenguinoBlocklyLanguageSettings.translateFrom("simulator",["DCMotorDescription"])}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return["speed"]}}]),n}(X),pe={dwenguino:"db_menu_item_dwengo_robot_teacher_image",workspaceArea:"blocklyDiv",toolboxArea:"db_blocklyToolboxDiv",toolbox:"blocklyToolboxDiv",languageMenu:"db_menu_item_language",difficultyMenu:"db_menu_item_difficulty",dwengoBooksMenu:"db_tutorials",playButton:"db_menu_item_run",uploadButton:"db_menu_item_upload",openButton:"db_menu_item_upload",saveButton:"db_menu_item_download",simulatorButton:"db_menu_item_simulator",codeArea:"db_code_pane",simulatorArea:"db_simulator_pane",simulatorStartButton:"sim_start",simulatorStopButton:"sim_stop",simulatorScenarioTag:"sim_scenarioTag",simulatorBottomPane:"db_simulator_bottom_pane",simulatorScenarioSocialRobot:"sim_scenario",robotComponentsMenuLedPlusButton:"rc_led_plus_button",robotComponentsMenuLedMinusButton:"rc_led_minus_button",robotcomponentsMenuLedOptions:"rc_led_options",robotComponentsMenuLcdPlusbutton:"rc_lcd_plus_button",robotComponensMenu:"robot_components_menu"},he={introduction:{category:"dwenguino",targets:[pe.dwenguino,pe.workspaceArea,"db_blocklyToolboxDiv","db_menu_item_language","db_menu_item_difficulty","books_dropdown","db_menu_item_run","db_menu_item_upload","db_menu_item_download","db_menu_item_simulator"],placements:["left","right","right","left","left","left","left","left","left","left"],nrOfSteps:10,xOffsets:[0,"center",0,0,0,0,0,0,0,0],yOffsets:[0,"center",0,0,0,0,0,0,0,0],steps:[],id:"tutsIntroduction",label:MSG.tutsIntroduction,initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.introduction.stepTitles[t],content:MSG.tutorials.introduction.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-88" y="-382"></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()}},avoidWall:{category:"ridingrobot",id:"tutsAvoidWall",label:MSG.tutsAvoidWall,targets:[pe.simulatorButton,pe.simulatorScenarioTab,pe.simulatorScenarioSelection,pe.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,-20,0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.avoidWall.stepTitles[t],content:MSG.tutorials.avoidWall.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-152" y="43"><statement name="LOOP"><block type="controls_if" id="@5_v({:-p!8Gi,2CfS*2"><mutation else="1"></mutation><value name="IF0"><block type="logic_compare" id="pO3`z[KM7dM91a$uJnV="><field name="OP">GTE</field><value name="A"><block type="char_type" id="r)z[m@Nos2|cpm^(MovD"><field name="BITMASK">30</field></block></value><value name="B"><block type="sonar_sensor" id="%Ha2KSwLpWq]5!^?mUn?"><value name="trig"><block type="char_type" id="t3zJd~XLa:~hNsD11;$("><field name="BITMASK">11</field></block></value><value name="echo"><block type="char_type" id="Ohz-(RX2RI34`HQmDv,s"><field name="BITMASK">12</field></block></value></block></value></block></value><statement name="DO0"><block type="dc_motor" id="7S)A(0|1NJY$trtQzX,3"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="mvt87=#!=N4y.]LDT2Tm"><value name="channel"><block type="math_number" id="H0_b%l*{mJ45Li+J+87l"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="Zt+djA7XMOi9Zp/%]??C"><field name="NUM">-100</field></block></value></block></next></block></statement><statement name="ELSE"><block type="dc_motor" id="{|*6o9^%o+R~*cTn_CfU"><value name="channel"><block type="math_number" id="P#QoZo*y11wAim[,gWvA"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="nB/xoT!1$Slx0jAKrT;n"><field name="NUM">255</field></block></value><next><block type="dc_motor" id="IENQp`U=)/.K^:61n`3K"><value name="channel"><block type="math_number" id="K[n0u(V:ugdW?t1.p!le"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="YDYgsSjexNArI#`f:@#V"><field name="NUM">255</field></block></value></block></next></block></statement><next><block type="dwenguino_delay" id="Ve-hN}})E6#/rWFaP`be"><value name="DELAY_TIME"><block type="char_type" id="W^^#Oxga@%ncB=Vi:coG"><field name="BITMASK">50</field></block></value></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()}},driveForward:{category:"ridingrobot",targets:[pe.simulatorButton,pe.simulatorScenarioTab,pe.simulatorStartButton,pe.dwenguino],placements:["left","left","left"],nrOfSteps:3,xOffsets:[0,0,0],yOffsets:[0,-20,0],steps:[],id:"tutsDriveForward",label:MSG.tutsDriveForward,initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.driveForward.stepTitles[t],content:MSG.tutorials.driveForward.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-88" y="-382"><statement name="LOOP"><block type="dc_motor" id="}m$#-.GS5+AKD-gI}OY,"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="cgSFVxrXN$Sgeiy15T;?"><value name="channel"><block type="math_number" id="oA@j2Jdo#=lH`r:+![%K"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="a[y,hG3rY^+Pk+cjv=8m"><field name="NUM">-100</field></block></value><next><block type="dwenguino_delay" id="to!Bxm`]gQzEi;K`Bx%s"><value name="DELAY_TIME"><block type="char_type" id="FsFIj~`KNGMlcHhp^^gj"><field name="BITMASK">100</field></block></value></block></next></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()}},rideInSquare:{category:"ridingrobot",id:"tutsRideInSquare",label:MSG.tutsRideInSquare,targets:[pe.simulatorButton,pe.simulatorScenarioTab,pe.simulatorStartButton,pe.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,0,0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.rideInSquare.stepTitles[t],content:MSG.tutorials.rideInSquare.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-187" y="-164"><statement name="LOOP"><block type="dc_motor" id="2~!yv!MW{1Hr7=a=q^aT"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="k|$W/{v:t)Ri*1iI2c]E"><value name="channel"><block type="math_number" id="wne%a{,$k%a@w,sKH?a]"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="{6ghh[Yn?Jc$jNeC)?wv"><field name="NUM">100</field></block></value><next><block type="dwenguino_delay" id="Un-0xX*gj~d[dzM2VPW{"><value name="DELAY_TIME"><block type="char_type" id="O8V/|K]MghjNUo^;u*Z7"><field name="BITMASK">1500</field></block></value><next><block type="dc_motor" id="#b8ipVpP2%f@GX{1*cEh"><value name="channel"><block type="math_number" id="1Bv@--r|;e:;{Tcs[0sp"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="W9onZYpkG)?oZXg+D.mP"><field name="NUM">-100</field></block></value><next><block type="dc_motor" id="br1l/`ornE`|7lUs0e!v"><value name="channel"><block type="math_number" id="spfET~H),:iUz7wM%7_}"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id=":v_5D%Zxo$8F9#*mn{T["><field name="NUM">172</field></block></value><next><block type="dwenguino_delay" id="fUAytMwz;AODn(w;=(]i"><value name="DELAY_TIME"><block type="char_type" id="N@OUe?*wdU4M64`^4oVM"><field name="BITMASK">100</field></block></value><next><block type="dc_motor" id="hqOS]]B(sc98`z/$0}ll"><value name="channel"><block type="math_number" id="5I?rQjd]q(-CC6U.,cBM"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="HA_k5I*sC`55]E:Y).[["><field name="NUM">100</field></block></value><next><block type="dc_motor" id="`D{WegX*xn@F]K5=@EvF"><value name="channel"><block type="math_number" id="oV,/.U@niXOwlvvM]WpC"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="9^4I@Scrp(K2+.J7^p0;"><field name="NUM">100</field></block></value><next><block type="dwenguino_delay" id="J2$2d,OC8RV:+T!Re6X0"><value name="DELAY_TIME"><block type="char_type" id="ZM@t|GIBj##i(0vS8r:k"><field name="BITMASK">1500</field></block></value><next><block type="dc_motor" id=";u/@8A47:TKzi6F#%CGb"><value name="channel"><block type="math_number" id="]X@nX0adD06-`$RZ{},G"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="I[_cmLEv4];|ZSX59LdP"><field name="NUM">-100</field></block></value><next><block type="dc_motor" id="|:Sz^|w6bvv%3`ReTx8|"><value name="channel"><block type="math_number" id="ay6tlwL/NUW^@z3Y`,1e"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id=")}wry~D^GS~nx+nJ4299"><field name="NUM">172</field></block></value><next><block type="dwenguino_delay" id="}]TPc%CK(bh,WY?va56["><value name="DELAY_TIME"><block type="char_type" id="XV0xogxOQ/+HvYzr}o5k"><field name="BITMASK">200</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()}},rideToWall:{category:"ridingrobot",id:"tutsRideToWall",label:MSG.tutsRideToWall,targets:[pe.simulatorButton,pe.simulatorScenarioTab,pe.simulatorScenarioSelection,pe.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,-20,0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.rideToWall.stepTitles[t],content:MSG.tutorials.rideToWall.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-48" y="-12"><statement name="LOOP"><block type="controls_if" id="@5_v({:-p!8Gi,2CfS*2"><mutation else="1"></mutation><value name="IF0"><block type="logic_compare" id="pO3`z[KM7dM91a$uJnV="><field name="OP">GTE</field><value name="A"><block type="char_type" id="`pUCfCWqQ-!Y8Hc4DFul"><field name="BITMASK">175</field></block></value><value name="B"><block type="sonar_sensor" id="%Ha2KSwLpWq]5!^?mUn?"><value name="trig"><block type="char_type" id="72"><field name="BITMASK">11</field></block></value><value name="echo"><block type="char_type" id="77"><field name="BITMASK">12</field></block></value></block></value></block></value><statement name="DO0"><block type="dc_motor" id="P4X+*n{_@l|O~^r3M$+P"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="b]=`Pdj9m@E^lqhSf+j7"><value name="channel"><block type="math_number" id="-w/)R/{#UU20.gVTQ:n)"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="KWy~7`w*vC_K}G@ma:$H"><field name="NUM">100</field></block></value></block></next></block></statement><statement name="ELSE"><block type="dc_motor" id="WF@SV9}kgwe`Dx1KEdfO"><value name="channel"><block type="math_number" id="p|~*dbxFy-j|.oB!i5$g"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="*Nynrtc$eF,g^0)az}^R"><field name="NUM">0</field></block></value><next><block type="dc_motor" id="oz9a#j`Kv,ZVyL35B{J6"><value name="channel"><block type="math_number" id="okt3fpvN^;FR?TW?wly|"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="vf/?P:IP6mI%GD-!biz~"><field name="NUM">0</field></block></value></block></next></block></statement><next><block type="dwenguino_delay" id="Ve-hN}})E6#/rWFaP`be"><value name="DELAY_TIME"><block type="char_type" id="r)z[m@Nos2|cpm^(MovD"><field name="BITMASK">100</field></block></value></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()}},introduceYourself:{category:"wegostem",targets:[pe.simulatorButton,pe.workspaceArea,pe.simulatorStartButton,pe.simulatorStopButton,pe.workspaceArea,pe.workspaceArea,pe.simulatorStartButton,pe.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.introduceYourself.stepTitles[t],content:MSG.tutorials.introduceYourself.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},id:"tutsIntroduceYourselfWeGoSTEM",label:MSG.tutsIntroduceYourselfWeGoSTEM,onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="0" y="0"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Hallo ik ben</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_lcd" id=",9zhGR,lzKr175:cPC*_"><value name="text"><block type="text" id="w8Id%a/kU}P]3_TQV1V^"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="VruQbfPoZ[O~4VG#:`[v"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="-7M*Tw!{?A}JvmAw(0_X"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="$W3lceEvUBsyDFFMM-Rf"><value name="DELAY_TIME"><block type="char_type" id="F-`0yf?Z6xT^qV5x(YV@"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a5X=ZhxL5lziaL[@+1q6"><next><block type="dwenguino_lcd" id="l`pv.^G_BTi%EpsWCp3d"><value name="text"><block type="text" id="L+/nc=~kAE0A)8hYW^b|"><field name="TEXT">en ik ben</field></block></value><value name="line_number"><block type="char_type" id=",9#]]M|vVX:X`i2FLYk9"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="IgSB;tv7Q63a*I/8c9xO"><field name="BITMASK">0</field></block></value><next><block type="clear_lcd" id="bV|!1IpEB|pF6zyTGedz"><next><block type="dwenguino_lcd" id="V_ap+n0Ve.h;yqUOiap]"><value name="text"><block type="text" id="FW[UnvsP|RyxEeB)*sw?"><field name="TEXT">27 jaar oud.</field></block></value><value name="line_number"><block type="char_type" id="?0+(u3VHL7RwnU6roe8o"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="g7)%Ze+Q`)7(XB?2H1g/"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="t*AwHh}[O0Oa:iWRf=Bi"><value name="DELAY_TIME"><block type="char_type" id="MT%/M(V*Sh@Lq?2s~|@C"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="B*^u3w%Jw`6F^5V~RI?!"></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()},onNext:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting))},onPrev:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting))}},lampOnOffWeGoSTEM:{category:"wegostem",targets:[pe.simulatorButton,pe.workspaceArea,pe.simulatorStartButton,pe.simulatorStopButton,pe.workspaceArea,pe.workspaceArea,pe.simulatorStartButton,pe.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.lampOnOffWeGoSTEM.stepTitles[t],content:MSG.tutorials.lampOnOffWeGoSTEM.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},id:"tutsLampOnOffWeGoSTEM",label:MSG.tutsLampOnOffWeGoSTEM,onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-312" y="822"><statement name="SETUP"><block type="dwenguino_set_led" id="JRP=z*2cxmd77C1]%2_j"><value name="LED"><block type="dwenguino_led_pins" id="`6(1#3#Z#$M@Xbq?1Xfd"><field name="LED_NUMBER">3</field></block></value><value name="LED_STATE"><block type="dwenguino_on_off" id="@5tkt/z/jAQ:%,nb:Bb-"><field name="LED_ON_OFF">ON</field></block></value><next><block type="dwenguino_delay" id="UY`BuwYMQ$Q@W/RBx4W6"><value name="DELAY_TIME"><block type="char_type" id="mj5fa8/DHdN^R`GxC1?-"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_set_led" id=";^M:Bzu.h.,8-bH|((6J"><value name="LED"><block type="dwenguino_led_pins" id="4fPa^^](u@WY76EvFzq3"><field name="LED_NUMBER">3</field></block></value><value name="LED_STATE"><block type="dwenguino_on_off" id="Vb]-SSu`gi!r(Jcf[GAP"><field name="LED_ON_OFF">OFF</field></block></value><next><block type="dwenguino_delay" id="b{y].+kK+[2Im*dxbNbG"><value name="DELAY_TIME"><block type="char_type" id="30LY_FvNethd98Kevj|b"><field name="BITMASK">500</field></block></value></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()},onNext:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting))},onPrev:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting))}},nameOnLcd:{category:"wegostem",targets:[pe.simulatorButton,pe.workspaceArea,pe.simulatorStartButton,pe.simulatorStopButton,pe.workspaceArea,pe.workspaceArea,pe.simulatorStartButton,pe.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:7,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.nameOnLcdWeGoSTEM.stepTitles[t],content:MSG.tutorials.nameOnLcdWeGoSTEM.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},id:"tutsNameOnLcdWeGoSTEM",label:MSG.tutsNameOnLcdWeGoSTEM,onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="V9/6@;rsE|D#Da%TQ1aq" x="-79" y="184"><statement name="SETUP"><block type="dwenguino_lcd" id="4[oLkNw/z5;Ou4dn-zdD"><value name="text"><block type="text" id="48"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()},onNext:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting))},onPrev:function(){ye.recordEvent(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting))}},poem1:{category:"wegostem",targets:[pe.simulatorButton,pe.workspaceArea,pe.simulatorStartButton,pe.simulatorStopButton,pe.workspaceArea,pe.workspaceArea,pe.simulatorStartButton,pe.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.poem1.stepTitles[t],content:MSG.tutorials.poem1.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},id:"tutsPoem1",label:MSG.tutsPoem1,onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Ik fiets</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_delay" id="]ou@Z_|5^GvXMS68m4Y#"><value name="DELAY_TIME"><block type="char_type" id="LNrn.uWc!l{k)lWdw9xu"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="U37Ix-]Ulb(y%rp+HmMK"><value name="text"><block type="text" id="62=RnV.lI.d94k41Y|Wg"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="XPa1w4n/89hzWxAri?_Z"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Mj.b?|/ktlgxW9^Lv+GB"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="qA+kIka6dC`XK2Zat.^e"><value name="DELAY_TIME"><block type="char_type" id="WxmGodyzXxbbWo)/zP0j"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m5J96Dy^pC:gh?H)nGT#"><next><block type="dwenguino_delay" id="%?k#,bPe1-.s6Z7_S8qn"><value name="DELAY_TIME"><block type="char_type" id="!(gLCQ_G4;$(a`n7`O[="><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="TMkN#X]!w%McWa+(x=`9"><value name="text"><block type="text" id="IZ|[v`1EEX*`RQf+b5qF"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="iu*fPG%V5+ylVMoYt^jx"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="xL-yEduk#tQd$~t|1xBe"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="}KCE%K7;EC#vmey7^_Jo"><value name="DELAY_TIME"><block type="char_type" id="{Qw5:{GSy/lpM]ZiaD]!"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="FS#9!f68];h@Hgj8D`EH"><next><block type="dwenguino_delay" id="d,ppwLH6:]IWf8u,D}~S"><value name="DELAY_TIME"><block type="char_type" id="ve7y8sxdW$N[k3Lpj4K2"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="0j6gbZ`fQp^lzmur:H(i"><value name="text"><block type="text" id="-f]hE(|MCiW#54W#}kLK"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="K)vYa`Z)#deQ!1}q{H.Q"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="LrH3gTKol.2*[p4jH4D0"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="C0:#WaEgbVZ[r~G@q|8b"><value name="DELAY_TIME"><block type="char_type" id="gZQ`(0$Bx-3=@BNWMrxO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="%[VVkF7@588nv1he[fA+"><next><block type="dwenguino_delay" id="u-M}Ap5N:_2+,:-`@4?E"><value name="DELAY_TIME"><block type="char_type" id="+V7?6g(f`(Da3.R+Ok2-"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id="4;?GCk$#1]UKqc*JpCtJ"><value name="text"><block type="text" id=".p6;|WP*pK!5P)^Ibi,-"><field name="TEXT">tegen de wind.</field></block></value><value name="line_number"><block type="char_type" id="yWI%[,$r2zZ.PH0((f:i"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="t_H?BNzNHvT2@CNp%@#7"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="19c_V.(8_w+v6);fCwfb"><value name="DELAY_TIME"><block type="char_type" id="6WH|Q$Q])3;UFw!KD!T?"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_delay" id="TXE6?Wg@/oIBY$p[Ga`z"><value name="DELAY_TIME"><block type="char_type" id="%cORf5sbBjB-.(-iG@AH"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id=";DtXuybn,xF/FOwjCF:4"><value name="text"><block type="text" id="t^{u]hkT)4L^+p!F[G2["><field name="TEXT">Trappen</field></block></value><value name="line_number"><block type="char_type" id="0p`XD[NDyMNta|%A7t/3"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="X;|n1^p*Chsc^vz,C@eT"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="wJt.NHYCT?xxFT0a|l-S"><value name="DELAY_TIME"><block type="char_type" id="mo?t2aHT*Uo*nC.GuTk}"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m2JGGH-h$jb)lM9CXYe0"><next><block type="dwenguino_delay" id="j?55rb3}E;+|Co*S`hM="><value name="DELAY_TIME"><block type="char_type" id="1BqO7(NNgg),p%MZHjA,"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id=":(tHu6%DX8iR?metFeL4"><value name="text"><block type="text" id="OYCuh1oaO@[PhnMV)b[J"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="mXr+iQF]OYanHl6]k-vM"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="eqvW,Y~do5;yeOS16mZ!"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="jNUVPY(fkulqIW406a;S"><value name="DELAY_TIME"><block type="char_type" id="?T{RaN{N^O?S^,m2uL[F"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MyQf_q(vqm-4Kx_ho/$u"><next><block type="dwenguino_delay" id="VD_W^T{~dxNxg+ZJRrXi"><value name="DELAY_TIME"><block type="char_type" id="+{%R9Y^?n4lmJ)~5/cuF"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="/9?@iKh%N%b029DX4a/y"><value name="text"><block type="text" id="wfjtaN2m3P6y}W+m[1/e"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="INY`bm#sWx3kX0IL?kXK"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="I.bF136;-%aT?*HI$X+2"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="OB@:R;FWiU0/DWh~BdPW"><value name="DELAY_TIME"><block type="char_type" id="kZ[ges6!FQi[V[*cMA12"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="|O~qL_TJ__o~oivI7foI"><next><block type="dwenguino_delay" id="Qoi4Q0WT!4n-a04+G4%V"><value name="DELAY_TIME"><block type="char_type" id=";bjjtx40w|%CvcF`r~:j"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="@4@sN;=}m^8TF;t(nAer"><value name="text"><block type="text" id="ikdC`Zv[xMl0{]pR)fX#"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="lSH?~`gnf%JviI:2}XJa"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="CVE!tF8@md9U@rJgE4Dp"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="T%l(=V4s=SMhd}1vUxhO"><value name="DELAY_TIME"><block type="char_type" id="kvZqY}2@Wx=.oK}MQE*`"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="drLvsnCiFEO=F@]r#v4Q"><next><block type="dwenguino_delay" id="%MnMga`gWN]%+32u!RgU"><value name="DELAY_TIME"><block type="char_type" id="5kN0m5!C?@CWtjguYWE?"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="6s|0$NVe+8umnbfq{NMT"><value name="text"><block type="text" id="~L+6,{(?3yAP6xK,efvE"><field name="TEXT">tot ik de</field></block></value><value name="line_number"><block type="char_type" id="qKk!A~k$:Mfer04ru%qy"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="}4;f_3pfEL]+mV|2ERvU"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="5y|#JTSHq_7OSw}[$Xs2"><value name="DELAY_TIME"><block type="char_type" id="GK;j0.zlVIIBGr=*4/}D"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{peMF%hI`]z?9xGfcz:-"><next><block type="dwenguino_delay" id="h~OBWExeL3ARveT/(HrJ"><value name="DELAY_TIME"><block type="char_type" id="i4cO:Zk3g@8H.c~CE+p!"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="Tt-^0U-/AlU[zNYL*2i~"><value name="text"><block type="text" id="eU6fM4.r;iyJT%0QtE%X"><field name="TEXT">terugweg</field></block></value><value name="line_number"><block type="char_type" id=";A@Mjgew#J6ly=Rrne^J"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Zwb0f$9HU@EA`Csj`9X;"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="2,dHZC$8Bapou6cguPPq"><value name="DELAY_TIME"><block type="char_type" id=";$}G/:ENCQU,IZC7Ugeu"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a$8|j|+r8;K2l:531Ks8"><next><block type="dwenguino_delay" id="lYLnC,T[q.O{L{bGiaWj"><value name="DELAY_TIME"><block type="char_type" id="4=dUiv1|T{_Ka`gdQe3."><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="r;3ncPFmQh!eK_WX9#_A"><value name="text"><block type="text" id="wdH=[^XHUAYF,gw26L!P"><field name="TEXT">vind</field></block></value><value name="line_number"><block type="char_type" id="_3{h1-PT^:FLw[KYSgiR"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="8J87Y.-o)HM[~u{ma$p-"><field name="BITMASK">0</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()},onNext:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting))},onPrev:function(){ye.logger.recordEvent(ye.logger.createEvent(EVENT_NAMEStutorialPrevStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting))}},poem2:{category:"wegostem",targets:[pe.simulatorButton,pe.workspaceArea,pe.simulatorStartButton,pe.simulatorStopButton,pe.workspaceArea,pe.workspaceArea,pe.simulatorStartButton,pe.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.poem2.stepTitles[t],content:MSG.tutorials.poem2.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},id:"tutsPoem2",label:MSG.tutsPoem2,onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Luie</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_delay" id="]ou@Z_|5^GvXMS68m4Y#"><value name="DELAY_TIME"><block type="char_type" id="LNrn.uWc!l{k)lWdw9xu"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="U37Ix-]Ulb(y%rp+HmMK"><value name="text"><block type="text" id="62=RnV.lI.d94k41Y|Wg"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="XPa1w4n/89hzWxAri?_Z"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Mj.b?|/ktlgxW9^Lv+GB"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="qA+kIka6dC`XK2Zat.^e"><value name="DELAY_TIME"><block type="char_type" id="WxmGodyzXxbbWo)/zP0j"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m5J96Dy^pC:gh?H)nGT#"><next><block type="dwenguino_delay" id="%?k#,bPe1-.s6Z7_S8qn"><value name="DELAY_TIME"><block type="char_type" id="!(gLCQ_G4;$(a`n7`O[="><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="TMkN#X]!w%McWa+(x=`9"><value name="text"><block type="text" id="IZ|[v`1EEX*`RQf+b5qF"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="iu*fPG%V5+ylVMoYt^jx"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="xL-yEduk#tQd$~t|1xBe"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="}KCE%K7;EC#vmey7^_Jo"><value name="DELAY_TIME"><block type="char_type" id="{Qw5:{GSy/lpM]ZiaD]!"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="FS#9!f68];h@Hgj8D`EH"><next><block type="dwenguino_delay" id="d,ppwLH6:]IWf8u,D}~S"><value name="DELAY_TIME"><block type="char_type" id="ve7y8sxdW$N[k3Lpj4K2"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="0j6gbZ`fQp^lzmur:H(i"><value name="text"><block type="text" id="-f]hE(|MCiW#54W#}kLK"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="K)vYa`Z)#deQ!1}q{H.Q"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="LrH3gTKol.2*[p4jH4D0"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="C0:#WaEgbVZ[r~G@q|8b"><value name="DELAY_TIME"><block type="char_type" id="gZQ`(0$Bx-3=@BNWMrxO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="%[VVkF7@588nv1he[fA+"><next><block type="dwenguino_delay" id="u-M}Ap5N:_2+,:-`@4?E"><value name="DELAY_TIME"><block type="char_type" id="+V7?6g(f`(Da3.R+Ok2-"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id="4;?GCk$#1]UKqc*JpCtJ"><value name="text"><block type="text" id=".p6;|WP*pK!5P)^Ibi,-"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="yWI%[,$r2zZ.PH0((f:i"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="t_H?BNzNHvT2@CNp%@#7"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="19c_V.(8_w+v6);fCwfb"><value name="DELAY_TIME"><block type="char_type" id="6WH|Q$Q])3;UFw!KD!T?"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="Ycv@=wOlPFRmBR2e0=O/"><next><block type="dwenguino_delay" id="TXE6?Wg@/oIBY$p[Ga`z"><value name="DELAY_TIME"><block type="char_type" id="%cORf5sbBjB-.(-iG@AH"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id=";DtXuybn,xF/FOwjCF:4"><value name="text"><block type="text" id="t^{u]hkT)4L^+p!F[G2["><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="0p`XD[NDyMNta|%A7t/3"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="X;|n1^p*Chsc^vz,C@eT"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="wJt.NHYCT?xxFT0a|l-S"><value name="DELAY_TIME"><block type="char_type" id="mo?t2aHT*Uo*nC.GuTk}"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m2JGGH-h$jb)lM9CXYe0"><next><block type="dwenguino_delay" id="j?55rb3}E;+|Co*S`hM="><value name="DELAY_TIME"><block type="char_type" id="1BqO7(NNgg),p%MZHjA,"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id=":(tHu6%DX8iR?metFeL4"><value name="text"><block type="text" id="OYCuh1oaO@[PhnMV)b[J"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="mXr+iQF]OYanHl6]k-vM"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="eqvW,Y~do5;yeOS16mZ!"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="jNUVPY(fkulqIW406a;S"><value name="DELAY_TIME"><block type="char_type" id="?T{RaN{N^O?S^,m2uL[F"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MyQf_q(vqm-4Kx_ho/$u"><next><block type="dwenguino_delay" id="VD_W^T{~dxNxg+ZJRrXi"><value name="DELAY_TIME"><block type="char_type" id="+{%R9Y^?n4lmJ)~5/cuF"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="z2G$,+(O8MXqsG@%H11H"><value name="text"><block type="text" id="]`3zL$n)c4Iq*xzBgH.T"><field name="TEXT">Trui</field></block></value><value name="line_number"><block type="char_type" id="pS%A*`i=OI[^JkNaC7BV"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="r/BGRl]k^1B9);lmYZA+"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id=")lfqScQ#!=TX.Ue)taec"><value name="DELAY_TIME"><block type="char_type" id="iiD^.IY_C*84m;faJ,`o"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="cH7Pj9[Ip;DY!r7!v?dc"><next><block type="dwenguino_delay" id="#U+By.Ih$=e?BFb,FO7l"><value name="DELAY_TIME"><block type="char_type" id="p%akSl+Egf)|/q!XnJ(i"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="/9?@iKh%N%b029DX4a/y"><value name="text"><block type="text" id="wfjtaN2m3P6y}W+m[1/e"><field name="TEXT">ze wil</field></block></value><value name="line_number"><block type="char_type" id="INY`bm#sWx3kX0IL?kXK"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="I.bF136;-%aT?*HI$X+2"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="OB@:R;FWiU0/DWh~BdPW"><value name="DELAY_TIME"><block type="char_type" id="kZ[ges6!FQi[V[*cMA12"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="|O~qL_TJ__o~oivI7foI"><next><block type="dwenguino_delay" id="Qoi4Q0WT!4n-a04+G4%V"><value name="DELAY_TIME"><block type="char_type" id=";bjjtx40w|%CvcF`r~:j"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="@4@sN;=}m^8TF;t(nAer"><value name="text"><block type="text" id="ikdC`Zv[xMl0{]pR)fX#"><field name="TEXT">een beetje</field></block></value><value name="line_number"><block type="char_type" id="lSH?~`gnf%JviI:2}XJa"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="CVE!tF8@md9U@rJgE4Dp"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="T%l(=V4s=SMhd}1vUxhO"><value name="DELAY_TIME"><block type="char_type" id="kvZqY}2@Wx=.oK}MQE*`"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="drLvsnCiFEO=F@]r#v4Q"><next><block type="dwenguino_delay" id="%MnMga`gWN]%+32u!RgU"><value name="DELAY_TIME"><block type="char_type" id="5kN0m5!C?@CWtjguYWE?"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="6s|0$NVe+8umnbfq{NMT"><value name="text"><block type="text" id="~L+6,{(?3yAP6xK,efvE"><field name="TEXT">water</field></block></value><value name="line_number"><block type="char_type" id="qKk!A~k$:Mfer04ru%qy"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="}4;f_3pfEL]+mV|2ERvU"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="5y|#JTSHq_7OSw}[$Xs2"><value name="DELAY_TIME"><block type="char_type" id="GK;j0.zlVIIBGr=*4/}D"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{peMF%hI`]z?9xGfcz:-"><next><block type="dwenguino_delay" id="h~OBWExeL3ARveT/(HrJ"><value name="DELAY_TIME"><block type="char_type" id="i4cO:Zk3g@8H.c~CE+p!"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="Tt-^0U-/AlU[zNYL*2i~"><value name="text"><block type="text" id="eU6fM4.r;iyJT%0QtE%X"><field name="TEXT">dus wacht ze</field></block></value><value name="line_number"><block type="char_type" id=";A@Mjgew#J6ly=Rrne^J"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Zwb0f$9HU@EA`Csj`9X;"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="2,dHZC$8Bapou6cguPPq"><value name="DELAY_TIME"><block type="char_type" id=";$}G/:ENCQU,IZC7Ugeu"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a$8|j|+r8;K2l:531Ks8"><next><block type="dwenguino_delay" id="lYLnC,T[q.O{L{bGiaWj"><value name="DELAY_TIME"><block type="char_type" id="4=dUiv1|T{_Ka`gdQe3."><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="w1KB0pSAA!d(biO9]JkD"><value name="text"><block type="text" id="a=y!$ACL_i[bntAB)aJu"><field name="TEXT">en</field></block></value><value name="line_number"><block type="char_type" id="QzOY1(6flDF2U:wxct=a"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="c]_+qZCDBN^6RLN!y!1C"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="9(?sJuxj6j@;x@7Asi|c"><value name="DELAY_TIME"><block type="char_type" id="BxwWPv_K3%X$BG3e|_Oc"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{f]kzKN1KgQ04-`ne1;7"><next><block type="dwenguino_delay" id="cuokpl:?{2A@~M@7`OJP"><value name="DELAY_TIME"><block type="char_type" id="ko.6d~(W|RHjt!.[oc+3"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="d(2/Uxt1k-Am7ShkBH:_"><value name="text"><block type="text" id="uQWlQI8MXKv]upN92?^4"><field name="TEXT">wacht ze</field></block></value><value name="line_number"><block type="char_type" id="gA1O7dtGAkwnDPod-qkJ"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="0T3suk9E8^[zKtWs$1u{"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="!#wStl5v`X#o+LT2yZ)l"><value name="DELAY_TIME"><block type="char_type" id="^OUEa:xd}n%%%I5XhxM:"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="rhu,trF%un+^egaUO:^4"><next><block type="dwenguino_delay" id="gv~6C5Lw@BAwk_,Y`cHx"><value name="DELAY_TIME"><block type="char_type" id="(E2[@~[ye`E^:b/%Cc6Y"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="r;3ncPFmQh!eK_WX9#_A"><value name="text"><block type="text" id="wdH=[^XHUAYF,gw26L!P"><field name="TEXT">en</field></block></value><value name="line_number"><block type="char_type" id="_3{h1-PT^:FLw[KYSgiR"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="8J87Y.-o)HM[~u{ma$p-"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="y0GhV=5]ABe?=zbLvf7v"><value name="DELAY_TIME"><block type="char_type" id=":}QFXZ7`nnXwB`(V_ad:"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="?K(I5BVBS^ur(9~DAn8Q"><next><block type="dwenguino_delay" id="5F(mmk#|BZA{FYK9FA5P"><value name="DELAY_TIME"><block type="char_type" id="_B*H^I#x3LH,lvRige]$"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="fI_KQvo@Jc?tO(O(oG]Z"><value name="text"><block type="text" id="m%o7bigf~!hj.k^Nba?p"><field name="TEXT">wacht ze</field></block></value><value name="line_number"><block type="char_type" id="+4$/h26osEjf,+J@?aGm"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="1)uzWjEHVqs!UVQm{Z^o"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="EH(/x2ezA[g-/$RE4X2q"><value name="DELAY_TIME"><block type="char_type" id="jvuTJE+;=/uEEAr@)/yO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MZWY%~bbn2ZRrpOv3vE!"><next><block type="dwenguino_delay" id="c{6-WNdwSti%V+Pwq9c0"><value name="DELAY_TIME"><block type="char_type" id="nl3)@R}ab?$2DCPhHyDx"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="u15(rgZKNp)p,^*nLK0X"><value name="text"><block type="text" id="}Dbqsn@^U.iCAi9j(hKK"><field name="TEXT">op een bui.</field></block></value><value name="line_number"><block type="char_type" id="8Hzg*-d1C7l@rJvfCHq@"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="lBM0=O*pNp!41R{!k/My"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="Kg*!@evlzIz/1~B3%,-7"><value name="DELAY_TIME"><block type="char_type" id="Xp-Oiku[1GMpeTsaBWbK"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="o!TOAVQ.XXt%|lX4EF;-"><next><block type="dwenguino_delay" id="-E@C,!R2MbOs5Psn9nNK"><value name="DELAY_TIME"><block type="char_type" id="pN@k9d(?_Lq:20,9tVW]"><field name="BITMASK">2000</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()},onNext:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting))},onPrev:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting))}},showNameAndDisappear:{category:"wegostem",targets:[pe.simulatorButton,pe.workspaceArea,pe.simulatorStartButton,pe.simulatorStopButton,pe.workspaceArea,pe.workspaceArea,pe.simulatorStartButton,pe.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var t;for(t=0;t<this.nrOfSteps;t++)this.steps.push({title:MSG.tutorials.showNameAndDisappear.stepTitles[t],content:MSG.tutorials.showNameAndDisappear.stepContents[t],target:this.targets[t],placement:this.placements[t],showCloseButton:"true",width:400,xOffset:this.xOffsets[t],yOffset:this.yOffsets[t]})},id:"tutsShowNameAndDisappearWeGoSTEM",label:MSG.tutsShowNameAndDisappearWeGoSTEM,onStart:function(){ye.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="SETUP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">7000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"></block></next></block></next></block></statement></block></xml>')},onEnd:function(){ye.tutorialMenu.endTutorial()},onNext:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialNextStep,ye.logger.tutorialIdSetting))},onPrev:function(){ye.logger.recordEvent(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting)),console.log(ye.logger.createEvent(P.tutorialPrevStep,ye.logger.tutorialIdSetting))}}},ge=function(){function t(e){o()(this,t),l()(this,"tutorialId",""),l()(this,"tutorialCategory",""),l()(this,"eventLogger",null),this.eventLogger=e,this.initTutorialMenu()}return r()(t,[{key:"initTutorialMenu",value:function(){var t=this;$("#db_tutorials").click((function(){t.loadTutorialDialog(),t.addTutorialDialogEventHandlers(),t.showTutorialDialog()}))}},{key:"loadTutorialDialog",value:function(){$("#tutorialModal .modal-header").text(MSG.tutorialMenu.header);$("#tutorialModal .modal-header").append('<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>'),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="tutorial_label">'+MSG.tutorialMenu.chooseCategory+"</div>"),$("#tutorialModal .modal-body .message").append('<div id="tutorialModal_categories_menu" class="tutorial_categories_wrapper"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_dwenguino_components" class="tutorial_categories_item card"></div>'),$("#tutorial_category_dwenguino_components").append('<div class="category_tag">'+MSG.tutorialMenu.catDwenguinoComponents+"</div>"),$("#tutorial_category_dwenguino_components").append('<div id="tutorial_categories_dwenguino_components_img" class="tutorial_categories_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_dwenguino_connector" class="tutorial_categories_item card"></div>'),$("#tutorial_category_dwenguino_connector").append('<div class="category_tag">'+MSG.tutorialMenu.catDwenguinoConnector+"</div>"),$("#tutorial_category_dwenguino_connector").append('<div id="tutorial_categories_dwenguino_connector_img" class="tutorial_categories_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_wegostem" class="tutorial_categories_item card"></div>'),$("#tutorial_category_wegostem").append('<div class="category_tag">'+MSG.tutorialMenu.catWeGoStem+"</div>"),$("#tutorial_category_wegostem").append('<div id="tutorial_categories_wegostem_img" class="tutorial_categories_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_dwenguino" class="tutorial_categories_item card"></div>'),$("#tutorial_category_dwenguino").append('<div class="category_tag">'+MSG.tutorialMenu.catDwenguino+"</div>"),$("#tutorial_category_dwenguino").append('<div id="tutorial_categories_dwenguino_img" class="tutorial_categories_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_riding_robot" class="tutorial_categories_item card"></div>'),$("#tutorial_category_riding_robot").append('<div class="category_tag">'+MSG.tutorialMenu.catRidingRobot+"</div>"),$("#tutorial_category_riding_robot").append('<div id="tutorial_categories_riding_robot_img" class="tutorial_categories_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_social_robot" class="tutorial_categories_item card"></div>'),$("#tutorial_category_social_robot").append('<div class="category_tag">'+MSG.tutorialMenu.catSocialRobot+"</div>"),$("#tutorial_category_social_robot").append('<div id="tutorial_categories_social_robot_img" class="tutorial_categories_img"></div>'),$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>")}},{key:"addTutorialDialogEventHandlers",value:function(){var t=this;$("#tutorial_category_dwenguino_components").click((function(){t.loadComponentsOverview()})),$("#tutorial_category_dwenguino_connector").click((function(){t.loadConnectorOverview()})),$("#tutorial_category_wegostem").click((function(){t.loadTutorialsMenu("wegostem")})),$("#tutorial_category_dwenguino").click((function(){t.loadTutorialsMenu("dwenguino")})),$("#tutorial_category_riding_robot").click((function(){t.loadTutorialsMenu("ridingrobot")})),$("#tutorial_category_social_robot").click((function(){t.loadTutorialsMenu("socialrobot")})),$(".close").click((function(){t.hideTutorialDialog()}))}},{key:"showTutorialDialog",value:function(){$("#tutorialModal").modal("show")}},{key:"hideTutorialDialog",value:function(){$("#tutorialModal").modal("hide")}},{key:"loadTutorialsMenu",value:function(t){var e=this;$("#tutorialModal .modal-header").text(MSG.tutorialMenu.header),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="tutorial_label">'+MSG.tutorialMenu.chooseTutorial+"</div>"),$("#tutorialModal .modal-body .message").append('<div id="tutorialModal_tutorials_menu"></div>'),$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="previous_tutorial_dialog" type="button" class="btn btn-default">'+MSG.tutorialMenu.previous+"</button>"),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>"),$("#previous_tutorial_dialog").click((function(){e.loadTutorialDialog(),e.addTutorialDialogEventHandlers()}));var n={category:t},i=this,o={type:"GET",url:c.getServerUrl()+"/tutorials/completedTutorials",data:n,retryLimit:1};function a(e){$.each(he,(function(n,o){if(o.category==t){var a=!1;$.each(e,(function(t,e){o.id==e.tutorial_id&&(a=!0)})),i.addTutorial(o,a)}}))}$.ajax(o).done(a).fail((function t(e,n){o.retryLimit>0&&(this.retryLimit--,$.ajax({type:"POST",url:c.getServerUrl()+"/renewToken"}).done((function(e){$.ajax(o).done(a).fail(t)})).fail((function(t,e){console.log(e),console.warn("Failed to log in:",t)})))}))}},{key:"loadComponentsOverview",value:function(){var t=this;$("#tutorialModal .modal-header").text(MSG.tutorialMenu.dwenguinoComponents),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="container"></div>'),$("#tutorialModal .modal-body .message .container").append('<div id="row1" class="row"></div>'),$("#row1").append("<h2>"+MSG.tutorialMenu.sensors+"</h2>"),$("#tutorialModal .modal-body .message .container").append('<ul id="tutorialModal_sensors_menu" class=" row components_overview_cards"></ul>');for(var e=[ae,Zt,K,ee,se],n=0;n<e.length;n++){var i=e[n].getType();$("#tutorialModal_sensors_menu").append('<li id="tutorial_sensors_item_'+i+'" class="components_overview_cards_item"></li>'),$("#tutorial_sensors_item_"+i).append('<div id="tutorial_sensors_card_'+i+'" class="components_overview_card bg-c-4"></div>'),$("#tutorial_sensors_card_"+i).append('<div id="tutorial_sensors_'+i+'" class="components_overview_card_content"></div>'),$("#tutorial_sensors_"+i).append('<div class="components_overview_card_title">'+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[i])+"</div>"),$("#tutorial_sensors_"+i).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_sensors_"+i).append('<div class="components_overview_card_text">'+e[n].getDescription()+"</div>"),$("#tutorial_sensors_"+i).append('<div id="input_pins'+i+'" class="components_overview_card_label">in: </div>'),$("#tutorial_sensors_"+i).append('<div id="output_pins'+i+'" class="components_overview_card_label">out: </div>'),$("#tutorial_sensors_"+i).append('<div id="circuit_pins'+i+'" class="components_overview_card_label">circuit: </div>')}$("#tutorialModal .modal-body .message .container").append('<div id="row2" class="row"></div>'),$("#row2").append("<h2>"+MSG.tutorialMenu.actuators+"</h2>"),$("#tutorialModal .modal-body .message .container").append('<div id="row3" class="row"></div>'),$("#row3").append("<h3>"+MSG.tutorialMenu.movement+"</h3>"),$("#tutorialModal .modal-body .message .container").append('<ul id="tutorialModal_movement_menu" class=" row components_overview_cards"></ul>');for(var o=[ie,de],a=0;a<o.length;a++){var r=o[a].getType();$("#tutorialModal_movement_menu").append('<li id="tutorial_movement_item_'+r+'" class="components_overview_cards_item"></li>'),$("#tutorial_movement_item_"+r).append('<div id="tutorial_movement_card_'+r+'" class="components_overview_card bg-c-11"></div>'),$("#tutorial_movement_card_"+r).append('<div id="tutorial_movement_'+r+'" class="components_overview_card_content"></div>'),$("#tutorial_movement_"+r).append('<div class="components_overview_card_title">'+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[r])+"</div>"),$("#tutorial_movement_"+r).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_movement_"+r).append('<div class="components_overview_card_text">'+o[a].getDescription()+"</div>"),$("#tutorial_movement_"+r).append('<div id="input_pins'+r+'" class="components_overview_card_label">in: </div>'),$("#tutorial_movement_"+r).append('<div id="output_pins'+r+'" class="components_overview_card_label">out: </div>'),$("#tutorial_movement_"+r).append('<div id="circuit_pins'+r+'" class="components_overview_card_label">circuit: </div>')}$("#tutorialModal .modal-body .message .container").append('<div id="row4" class="row"></div>'),$("#row4").append("<h3>"+MSG.tutorialMenu.display+"</h3>"),$("#tutorialModal .modal-body .message .container").append('<ul id="tutorialModal_display_menu" class=" row components_overview_cards"></ul>');for(var s=[zt,Qt,ce],l=0;l<s.length;l++){var c=s[l].getType();$("#tutorialModal_display_menu").append('<li id="tutorial_display_item_'+c+'" class="components_overview_cards_item"></li>'),$("#tutorial_display_item_"+c).append('<div id="tutorial_display_card_'+c+'" class="components_overview_card bg-c-6"></div>'),$("#tutorial_display_card_"+c).append('<div id="tutorial_display_'+c+'" class="components_overview_card_content"></div>'),$("#tutorial_display_"+c).append('<div class="components_overview_card_title">'+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[c])+"</div>"),$("#tutorial_display_"+c).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_display_"+c).append('<div class="components_overview_card_text">'+s[l].getDescription()+"</div>"),$("#tutorial_display_"+c).append('<div id="input_pins'+c+'" class="components_overview_card_label">in: </div>'),$("#tutorial_display_"+c).append('<div id="output_pins'+c+'" class="components_overview_card_label">out: </div>'),$("#tutorial_display_"+c).append('<div id="circuit_pins'+c+'" class="components_overview_card_label">circuit: </div>')}$("#tutorialModal .modal-body .message .container").append('<div id="row5" class="row"></div>'),$("#row5").append("<h3>"+MSG.tutorialMenu.audio+"</h3>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_audio_menu" class="components_overview row"></div>');for(var u=[Yt],d=0;d<u.length;d++){var p=u[d].getType();$("#tutorialModal_audio_menu").append('<li id="tutorial_audio_item_'+p+'" class="components_overview_cards_item"></li>'),$("#tutorial_audio_item_"+p).append('<div id="tutorial_audio_card_'+p+'" class="components_overview_card bg-c-3"></div>'),$("#tutorial_audio_card_"+p).append('<div id="tutorial_audio_'+p+'" class="components_overview_card_content"></div>'),$("#tutorial_audio_"+p).append('<div class="components_overview_card_title">'+DwenguinoBlocklyLanguageSettings.translateFrom("simulator",[p])+"</div>"),$("#tutorial_audio_"+p).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_audio_"+p).append('<div class="components_overview_card_text">'+u[d].getDescription()+"</div>"),$("#tutorial_audio_"+p).append('<div id="input_pins'+p+'" class="components_overview_card_label">in: </div>'),$("#tutorial_audio_"+p).append('<div id="output_pins'+p+'" class="components_overview_card_label">out: </div>'),$("#tutorial_audio_"+p).append('<div id="circuit_pins'+p+'" class="components_overview_card_label">circuit: </div>')}for(var h=e.concat(o).concat(s).concat(u),g=0;g<h.length;g++){for(var f=h[g].getInputPins(),m=0;m<f.length;m++)$("#input_pins"+h[g].getType()).append('<span class="badge badge-pill">'+f[m]+"</span> ");for(var v=h[g].getOutputPins(),_=0;_<v.length;_++)$("#output_pins"+h[g].getType()).append('<span class="badge badge-pill">'+v[_]+"</span> ");$("#circuit_pins"+h[g].getType()).append('<span class="badge badge-pill">5V</span> '),$("#circuit_pins"+h[g].getType()).append('<span class="badge badge-pill">GND</span> ')}$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="previous_tutorial_dialog" type="button" class="btn btn-default">'+MSG.tutorialMenu.previous+"</button>"),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>"),$("#previous_tutorial_dialog").click((function(){t.loadTutorialDialog(),t.addTutorialDialogEventHandlers()}))}},{key:"loadConnectorOverview",value:function(){var t=this;$("#tutorialModal .modal-header").text(MSG.tutorialMenu.catDwenguinoConnector),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="container"></div>'),$("#tutorialModal .modal-body .message .container").append('<div id="row1" class="row"></div>'),$("#tutorialModal .modal-body .message .container").append('<div id="row2" class="row"></div>'),$("#tutorialModal .modal-body .message .container").append('<div id="row3" class="row"></div>'),$("#row2").append('<div id="pin_mapping" class="col-lg-12 col-md-12 col-sm-12 col-xs-12"></div>'),$("#pin_mapping").append('<img src="DwenguinoIDE/img/tutorials/pin_mapping.svg" class="img-fluid">'),$("#row3").append('<div id="connector_overview" class="col-lg-10 col-md-10 col-sm-10 col-xs-10"></div>'),$("#connector_overview").append('<img src="DwenguinoIDE/img/tutorials/expansion_connector.svg" class="img-fluid">'),$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="previous_tutorial_dialog" type="button" class="btn btn-default">'+MSG.tutorialMenu.previous+"</button>"),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>"),$("#previous_tutorial_dialog").click((function(){t.loadTutorialDialog(),t.addTutorialDialogEventHandlers()}))}},{key:"addTutorial",value:function(t,e){var n=this,i=$("<div>").attr("class","tutorial_item row").attr("id",t.id).attr("role","presentation");$("#tutorialModal_tutorials_menu").append(i),i.click((function(){n.eventLogger.tutorialId=t.id,n.tutorialId=t.id,n.tutorialCategory=t.category,n.eventLogger.tutorialIdSetting=t.id,t.initSteps(),hopscotch.configure({showPrevButton:"true"}),n.hideTutorialDialog(),hopscotch.startTour(t),n.eventLogger.recordEvent(n.eventLogger.createEvent(P.startTutorial,t.id))})),e?($("#"+t.id).append('<div class="fas fa-check c-6 col-auto"></div>'),$("#"+t.id).append('<div class="col-auto">'+t.label+"</div>")):($("#"+t.id).append('<div class="fas fa-times c-1 col-auto"></div>'),$("#"+t.id).append('<div class="col-auto">'+t.label+"</div>"))}},{key:"endTutorial",value:function(){var t=this.tutorialCategory;this.saveCompleteTutorial(this.tutorialId,this.tutorialCategory),this.eventLogger.tutorialId="",this.eventLogger.tutorialIdSetting="",this.tutorialId="",this.tutorialCategory="",this.eventLogger.recordEvent(this.eventLogger.createEvent(P.endTutorial,"")),this.loadTutorialsMenu(t),this.showTutorialDialog()}},{key:"saveCompleteTutorial",value:function(t,e){var n={tutorialId:t,category:e},i={type:"POST",url:c.getServerUrl()+"/tutorials/completeTutorial",data:n,retryLimit:1};$.ajax(i).fail((function t(e,n){i.retryLimit>0&&(this.retryLimit--,$.ajax({type:"POST",url:c.getServerUrl()+"/renewToken"}).done((function(e){$.ajax(i).fail(t)})).fail((function(t,e){console.log(e),console.warn("Failed to log in:",t)})))}))}}]),t}(),fe=function(){function t(){o()(this,t)}return r()(t,[{key:"initCookiesInformation",value:function(){this.loadCookiesInformationDialog(),this.addCookiesInformationDialogEventHandlers(),this.showCookiesInformationDialog()}},{key:"loadCookiesInformationDialog",value:function(){$("#cookiesModal .modal-header").text(DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["whatAreCookiesTitle"]));var t='<button type="button" class="close" data-dismiss="modal" aria-label="'+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["close"])+'"><span aria-hidden="true">&times;</span></button>';$("#cookiesModal .modal-header").append(t),$("#cookiesModal .modal-body .message").empty(),$("#cookiesModal .modal-body .message").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["whatAreCookiesDescription1"])+"</p>"),$("#cookiesModal .modal-body .message").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["whatAreCookiesDescription2"])+"</p>"),$("#cookiesModal .modal-body .message").append("<h2>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["whatAreNecessaryCookiesTitle"])+"</h2>"),$("#cookiesModal .modal-body .message").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["whatAreNecessaryCookiesDescription"])+"</p>"),$("#cookiesModal .modal-body .message").append("<h2>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["whichCookiesTitle"])+"</h2>"),$("#cookiesModal .modal-body .message").append("<h3>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["dwengoCookieTitle"])+"</h3>"),$("#cookiesModal .modal-body .message").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["dwengoCookieDescription"])+"</p>"),$("#cookiesModal .modal-body .message").append("<h3>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["jenkinsCookieTitle"])+"</h3>"),$("#cookiesModal .modal-body .message").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["jenkinsCookieDescription"])+"</p>"),$("#cookiesModal .modal-footer").empty(),$("#cookiesModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+DwenguinoBlocklyLanguageSettings.translateFrom("cookieConsent",["close"])+"</button>")}},{key:"addCookiesInformationDialogEventHandlers",value:function(){var t=this;$(".close").click((function(){t.hideTutorialDialog()}))}},{key:"showCookiesInformationDialog",value:function(){$("#cookiesModal").modal("show")}},{key:"hideCookiesInformationDialog",value:function(){$("#cookiesModal").modal("hide")}}]),t}(),me=function(){function t(){o()(this,t)}return r()(t,[{key:"validateSchool",value:function(t){return""!==t?null:new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errSchool"]))}},{key:"validateId",value:function(t){for(var e=0;e<4;e++)if(null==t[e])return new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errId"]));return null}},{key:"validateFirstname",value:function(t){if(""==t)return new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errFirstname"]))}},{key:"validateSecretCode",value:function(t){if(""==t)return new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errSecretCode"]))}},{key:"validatePassword",value:function(t){if(""==t)return new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errPassword"]))}},{key:"validatePasswords",value:function(t,e){if(t!=e)return new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errPasswordNotIdentical"]))}},{key:"validateEmail",value:function(t){if(""==t)return new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errEmail"]))}},{key:"validateAgeGroup",value:function(t){return void 0!==t?null:new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errAgeGroup"]))}},{key:"validateGender",value:function(t){return void 0!==t?null:new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errGender"]))}},{key:"validateActivityId",value:function(t){return""!==t?null:new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errActivityId"]))}},{key:"validateAcceptConditions",value:function(t){return t[0].checked?void 0:new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errAcceptConditions"]))}},{key:"validateResearchConditions",value:function(t){return t[0].checked?void 0:new Error(DwenguinoBlocklyLanguageSettings.translateFrom("validator",["errAcceptResearch"]))}},{key:"hasErrors",value:function(t){for(var e=t.length,n=0;n<e;n++)if(null!=t[n])return!0;return!1}}]),t}(),ve=function(){function t(e){o()(this,t),l()(this,"currentlySelectedIcons",["0","0","0","0"]),l()(this,"SIZE",4),l()(this,"icons",[{id:1,name:MSG.logging.person,html:'<span class="glyphicon icon-user"></span>'},{id:2,name:MSG.logging.dog,html:'<span class="glyphicon icon-dog"></span>'},{id:3,name:MSG.logging.car,html:'<span class="glyphicon icon-car"></span>'},{id:4,name:MSG.logging.camera,html:'<span class="glyphicon icon-camera"></span>'},{id:5,name:MSG.logging.heart,html:'<span class="glyphicon icon-heart"></span>'},{id:6,name:MSG.logging.plane,html:'<span class="glyphicon icon-plane"></span>'},{id:7,name:MSG.logging.house,html:'<span class="glyphicon icon-house"></span>'},{id:8,name:MSG.logging.umbrella,html:'<span class="glyphicon icon-umbrella"></span>'},{id:9,name:MSG.logging.star,html:'<span class="glyphicon icon-star"></span>'},{id:10,name:MSG.logging.money,html:'<span class="glyphicon icon-money"></span>'},{id:11,name:MSG.logging.gift,html:'<span class="glyphicon icon-gift"></span>'},{id:12,name:MSG.logging.keys,html:'<span class="glyphicon icon-keys"></span>'},{id:13,name:MSG.logging.music,html:'<span class="glyphicon icon-music"></span>'},{id:14,name:MSG.logging.snowflake,html:'<span class="glyphicon icon-snowflake"></span>'},{id:15,name:MSG.logging.fire,html:'<span class="glyphicon icon-fire"></span>'},{id:16,name:MSG.logging.envelope,html:'<span class="glyphicon icon-envelope"></span>'}]),l()(this,"schools",null),l()(this,"validator",null),l()(this,"eventLogger",null),this.validator=new me,this.eventLogger=e}return r()(t,[{key:"createInitialMenu",value:function(){this.createLoggingModalDialogWithoutFooter(MSG.logging.login);$("#loggingModalBody").append('<div id="user_info"></div>'),$("#loggingModalBody").append('<div id="authentication_menu" class="tutorial_categories_wrapper"></div>'),this.addUserInfoPanel("user_info"),this.addAuthenticationPanel("authentication_menu"),this.showDialog()}},{key:"addUserInfoPanel",value:function(t){$.ajax({type:"GET",url:c.getServerUrl()+"/user"}).done((function(e){var n=e.firstname;$("#"+t).append("<p>Hello "+n+"</p>")})).fail((function(e,n){403==e.status?$.ajax({type:"POST",url:c.getServerUrl()+"/auth/renew"}).done((function(e){$.ajax({type:"GET",url:c.getServerUrl()+"/user"}).done((function(e){var n=e.firstname;$("#"+t).append("<p>Hello "+n+"</p>")})).fail((function(t,e){console.log(e,t)}))})).fail((function(t,e){console.log(e,t)})):401==e.status||console.log(n,e)}))}},{key:"addAuthenticationPanel",value:function(t){var e=this;$.ajax({type:"GET",url:c.getServerUrl()+"/user"}).done((function(n){$("#"+t).append('<div id="authentication_settings" class="tutorial_categories_item card"></div>'),$("#authentication_settings").append('<div class="category_tag">'+MSG.logging.settings+"</div>"),$("#authentication_settings").append('<div id="authentication_settings_img"></div>'),$("#authentication_settings").click((function(){e.showUserSettings()})),$("#"+t).append('<div id="authentication_logout" class="tutorial_categories_item card"></div>'),$("#authentication_logout").append('<div class="category_tag">'+MSG.logging.logout+"</div>"),$("#authentication_logout").append('<div id="logout_img"></div>'),$("#authentication_logout").click((function(){e.logout()}))})).fail((function(n,i){403==n.status?$.ajax({type:"POST",url:c.getServerUrl()+"/auth/renew"}).done((function(n){$.ajax({type:"GET",url:c.getServerUrl()+"/user"}).done((function(n){$("#"+t).append('<div id="authentication_settings" class="tutorial_categories_item card"></div>'),$("#authentication_settings").append('<div class="category_tag">'+MSG.logging.settings+"</div>"),$("#authentication_settings").append('<div id="authentication_settings_img"></div>'),$("#authentication_settings").click((function(){e.showUserSettings()})),$("#"+t).append('<div id="authentication_logout" class="tutorial_categories_item card"></div>'),$("#authentication_logout").append('<div class="category_tag">'+MSG.logging.logout+"</div>"),$("#authentication_logout").append('<div id="logout_img"></div>'),$("#authentication_logout").click((function(){e.logout()}))})).fail((function(n,i){$("#"+t).append('<div id="authentication_new_user" class="tutorial_categories_item card"></div>'),$("#authentication_new_user").append('<div class="category_tag">'+MSG.logging.newuser+"</div>"),$("#authentication_new_user").append('<div id="new_user_img"></div>'),$("#"+t).append('<div id="authentication_existing_user" class="tutorial_categories_item card"></div>'),$("#authentication_existing_user").append('<div class="category_tag">'+MSG.logging.login+"</div>"),$("#authentication_existing_user").append('<div id="school_user_img"></div>'),$("#authentication_new_user").click((function(){e.createUserMenu()})),$("#authentication_existing_user").click((function(){e.createLoginMenu()}))}))})).fail((function(n,i){$("#"+t).append('<div id="authentication_new_user" class="tutorial_categories_item card"></div>'),$("#authentication_new_user").append('<div class="category_tag">'+MSG.logging.newuser+"</div>"),$("#authentication_new_user").append('<div id="new_user_img"></div>'),$("#"+t).append('<div id="authentication_existing_user" class="tutorial_categories_item card"></div>'),$("#authentication_existing_user").append('<div class="category_tag">'+MSG.logging.login+"</div>"),$("#authentication_existing_user").append('<div id="school_user_img"></div>'),$("#authentication_new_user").click((function(){e.createUserMenu()})),$("#authentication_existing_user").click((function(){e.createLoginMenu()}))})):($("#"+t).append('<div id="authentication_new_user" class="tutorial_categories_item card"></div>'),$("#authentication_new_user").append('<div class="category_tag">'+MSG.logging.newuser+"</div>"),$("#authentication_new_user").append('<div id="new_user_img"></div>'),$("#"+t).append('<div id="authentication_existing_user" class="tutorial_categories_item card"></div>'),$("#authentication_existing_user").append('<div class="category_tag">'+MSG.logging.login+"</div>"),$("#authentication_existing_user").append('<div id="school_user_img"></div>'),$("#authentication_new_user").click((function(){e.createUserMenu()})),$("#authentication_existing_user").click((function(){e.createLoginMenu()})))}))}},{key:"createLoginMenu",value:function(){var t=this;this.createLoggingModalDialog(MSG.logging.login),$("#loggingModalBody").append('<form id="loginUser"></form>'),$("#loginUser").append('<div id="inputEmail" class="ui-widget row mb-4"></div>'),$("#inputEmail").append('<label for="emailTag" class="col-md-3">'+MSG.logging.email+"</label>"),$("#inputEmail").append('<input id="emailTag" name="emailTag" class="col-md-8" placeholder="'+MSG.logging.enterEmail+'">'),$("#loginUser").append('<div id="inputPassword" class="ui-widget row mb-4"></div>'),$("#inputPassword").append('<label for="passwordTag" class="col-md-3">'+MSG.logging.password+"</label>"),$("#inputPassword").append('<input id="passwordTag" name="passwordTag" type="password" class="col-md-8" placeholder="'+MSG.logging.enterPassword+'">'),$("#loggingModalBody").append('<button id="forgot_password_modal_dialog_button" type="button" class="btn btn-default mt-4">'+MSG.logging.forgotPassword+"</button>"),$("#loggingModalFooter").append('<button id="back_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.back+"</button>"),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),this.showDialog(),$("#forgot_password_modal_dialog_button").click((function(){t.forgotPassword()})),$("#back_modal_dialog_button").click((function(){t.createInitialMenu()})),$("#submit_modal_dialog_button").click((function(){var e=[],n=$("input[name=emailTag]").val(),i=$("input[name=passwordTag]").val();e.push(t.validator.validateEmail(n)),e.push(t.validator.validatePassword(i)),t.validator.hasErrors(e)?t.showErrors(e):t.login()}))}},{key:"forgotPassword",value:function(){var t=this;this.createLoggingModalDialog(MSG.logging.forgotPassword),$("#loggingModalBody").append('<form id="forgotPassword"></form>'),$("#forgotPassword").append('<div id="inputEmail" class="ui-widget row mb-4"></div>'),$("#inputEmail").append('<label for="emailTag" class="col-md-3">'+MSG.logging.email+"</label>"),$("#inputEmail").append('<input id="emailTag" name="emailTag" class="col-md-8" placeholder="'+MSG.logging.enterEmail+'">'),$("#loggingModalFooter").append('<button id="back_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.back+"</button>"),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),this.showDialog(),$("#back_modal_dialog_button").click((function(){t.createLoginMenu()})),$("#submit_modal_dialog_button").click((function(){var e=[],n=$("input[name=emailTag]").val();e.push(t.validator.validateEmail(n)),t.validator.hasErrors(e)?t.showErrors(e):t.sendPasswordResetCode()}))}},{key:"sendPasswordResetCode",value:function(){var t=this,e={email:$("input[name=emailTag]").val()};$.ajax({type:"POST",url:c.getServerUrl()+"/getPasswordResetCode",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)}).done((function(e){t.showResetPasswordScreen()})).fail((function(e,n){t.createLoggingModalDialog(MSG.logging.forgotPassword),$("#loggingModalBody").append("<p>"+MSG.logging.userDoesNotExist+"</p>"),$("#loggingModalFooter").append('<button id="back_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.back+"</button>"),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),$("#loggingModal").modal("show"),$("#back_modal_dialog_button").click((function(){t.sendPasswordResetCode()})),$("#submit_modal_dialog_button").click((function(){t.removeDialog()}))}))}},{key:"showResetPasswordScreen",value:function(){var t=this;this.createLoggingModalDialog(MSG.logging.resetPassword),$("#loggingModalBody").append('<form id="resetPassword"></form>'),$("#resetPassword").append('<div id="inputEmail" class="ui-widget row mb-4"></div>'),$("#inputEmail").append('<label for="emailTag" class="col-md-3">'+MSG.logging.email+"</label>"),$("#inputEmail").append('<input id="emailTag" name="emailTag" autocomplete="username" class="col-md-8" placeholder="'+MSG.logging.enterEmail+'">'),$("#resetPassword").append('<div id="inputSecretCode" class="ui-widget row mb-4"></div>'),$("#inputSecretCode").append('<label for="secretCodeTag" class="col-md-3">'+MSG.logging.secretCode+"</label>"),$("#inputSecretCode").append('<input id="secretCodeTag" name="secretCodeTag" class="col-md-8" placeholder="'+MSG.logging.enterSecretCode+'">'),$("#resetPassword").append('<div id="inputPassword1" class="ui-widget row mb-4"></div>'),$("#inputPassword1").append('<label for="passwordTag1" class="col-md-3">'+MSG.logging.password+"</label>"),$("#inputPassword1").append('<input id="passwordTag1" name="passwordTag1" type="password" autocomplete="new-password" class="col-md-8" placeholder="'+MSG.logging.enterPassword+'">'),$("#resetPassword").append('<div id="inputPassword2" class="ui-widget row mb-4"></div>'),$("#inputPassword2").append('<label for="passwordTag2" class="col-md-3">'+MSG.logging.password+"</label>"),$("#inputPassword2").append('<input id="passwordTag2" name="passwordTag2" type="password" autocomplete="new-password" class="col-md-8" placeholder="'+MSG.logging.enterPassword+'">'),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),this.showDialog(),$("#submit_modal_dialog_button").click((function(){var e=[],n=$("input[name=emailTag]").val(),i=$("input[name=secretCodeTag]").val(),o=$("input[name=passwordTag1]").val(),a=$("input[name=passwordTag2]").val();e.push(t.validator.validateEmail(n)),e.push(t.validator.validateSecretCode(i)),e.push(t.validator.validatePasswords(o,a)),e.push(t.validator.validatePassword(o)),e.push(t.validator.validatePassword(a)),t.validator.hasErrors(e)?t.showErrors(e):t.resetPassword()}))}},{key:"resetPassword",value:function(){var t=this,e={email:$("input[name=emailTag]").val(),secretCode:$("input[name=secretCodeTag]").val(),password:$("input[name=passwordTag1]").val(),password_repeated:$("input[name=passwordTag2]").val()};$.ajax({type:"POST",url:c.getServerUrl()+"/resetPassword",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)}).done((function(e){t.removeDialog()})).fail((function(t,e){console.log("Failed to register:",e),console.log(t)}))}},{key:"login",value:function(){var t=this,e={email:$("input[name=emailTag]").val(),password:$("input[name=passwordTag]").val()};$.ajax({type:"POST",url:c.getServerUrl()+"/login",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)}).done((function(e){console.log(e),t.resetSelectedIcons(),t.removeDialog()})).fail((function(n,i){console.warn("Failed to log in:",i),t.resetSelectedIcons();var o;o=n.responseJSON.error.map((function(t){return{message:'<a id="resendLink" href="#">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",[t])+"</a>"}})),t.showErrors(o),$("#resendLink").click((function(){$.ajax({type:"POST",url:c.getServerUrl()+"/resendActivationLink",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)}).done((function(e){t.showErrors([{message:"The activation link has been sent."}])})).fail((function(t,e){console.log(t)}))}))}))}},{key:"logout",value:function(){var t=this;$.ajax({type:"POST",url:c.getServerUrl()+"/logout"}).done((function(e){t.removeDialog()})).fail((function(e,n){t.removeDialog()}))}},{key:"showUserSettings",value:function(){var t=this;$.ajax({type:"GET",url:c.getServerUrl()+"/user"}).done((function(e){t.createLoggingModalDialog(MSG.logging.settings),$("#loggingModalBody").append('<form id="loginUser"></form>'),$("#loggingModalBody").append('<div id="nameRow" class="ui-widget row mb-4"></div>'),$("#nameRow").append('<div class="col-md-3"><p>'+MSG.logging.firstname+"</p></div>"),$("#nameRow").append('<div class="col-md-8"><p>'+e.firstname+"</p></div>"),$("#loggingModalBody").append('<div id="emailRow" class="ui-widget row mb-4"></div>'),$("#emailRow").append('<div class="col-md-3"><p>'+MSG.logging.email+"</p></div>"),$("#emailRow").append('<div class="col-md-8"><p>'+e.email+"</p></div>"),$("#loggingModalBody").append('<div id="roleRow" class="ui-widget row mb-4"></div>'),$("#roleRow").append('<div class="col-md-3"><p>'+MSG.logging.role+"</p></div>"),$("#roleRow").append('<div class="col-md-8"><p>'+e.role+"</p></div>"),$("#loggingModalFooter").append('<button id="back_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.back+"</button>"),$("#back_modal_dialog_button").click((function(){t.createInitialMenu()})),t.showDialog()})).fail((function(e,n){t.createLoggingModalDialog(MSG.logging.settings),$("#loggingModalFooter").append('<button id="back_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.back+"</button>"),$("#back_modal_dialog_button").click((function(){t.createInitialMenu()})),t.showDialog()}))}},{key:"createUserMenu",value:function(){var t=this;this.createLoggingModalDialog(MSG.logging.newuser),$("#loggingModalBody").append('<form id="registerUser"></form>'),$("#registerUser").append('<div id="registerUserConditions"></div>'),$("#registerUserConditions").append("<h3>"+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["conditions"])+"</h3>"),$("#registerUserConditions").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["conditions1"])+"</p>"),$("#registerUserConditions").append('<ul><li><a href="#">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["generalConditions"])+'</a></li><li><a href="#">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["privacyStatement"])+"</a></li></ul>"),$("#registerUserConditions").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["conditions2"])+"</p>"),$("#registerUserConditions").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["conditions3"])+"</p>"),$("#registerUserConditions").append("<p>"+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["conditions4"])+"</p>"),$("#registerUserConditions").append('<div id="acceptConditions" class="ui-widget row mb-4"></div>'),$("#acceptConditions").append('<input type="checkbox" name="acceptConditionsCheckbox" id="acceptConditionsCheckbox" class="col-md-1">'),$("#acceptConditions").append('<label id="acceptConditionsLabel" for="acceptConditionsCheckbox" class="col-md-11">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["acceptConditions"])+"</label>"),$("#registerUserConditions").append('<div id="acceptResearch" class="ui-widget row mb-4"></div>'),$("#acceptResearch").append('<input type="checkbox" name="acceptResearchCheckbox" id="acceptResearchCheckbox" class="col-md-1">'),$("#acceptResearch").append('<label id="acceptResearchLabel" for="acceptResearchCheckbox" class="col-md-11">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["acceptResearch"])+"</label>"),$("#loggingModalFooter").append('<button id="continue_logging_modal" type="button" class="btn btn-default">'+MSG.logging.continue+"</button>"),this.showDialog(),$("#continue_logging_modal").click((function(){var e=[],n=$("input[name=acceptConditionsCheckbox]"),i=$("input[name=acceptResearchCheckbox]");e.push(t.validator.validateAcceptConditions(n)),e.push(t.validator.validateResearchConditions(i)),t.validator.hasErrors(e)?t.showErrors(e):(t.showErrors([]),$("#registerUserConditions").hide(),$("#continue_logging_modal").remove(),t.showRegistrationForm())}))}},{key:"showRegistrationForm",value:function(){var t=this;$("#registerUser").append('<div id="inputFirstname" class="ui-widget row mb-4"></div>'),$("#inputFirstname").append('<label for="firstnameTag" class="col-md-4">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["firstname"])+"</label>"),$("#inputFirstname").append('<input id="firstnameTag" name="firstnameTag" class="col-md-7" placeholder="'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["enterFirstname"])+'">'),$("#registerUser").append('<div id="inputEmail" class="ui-widget row mb-4"></div>'),$("#inputEmail").append('<label for="emailTag" class="col-md-4">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["email"])+"</label>"),$("#inputEmail").append('<input id="emailTag" name="emailTag" autocomplete="username" class="col-md-7" placeholder="'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["enterEmail"])+'">'),$("#registerUser").append('<div id="inputPassword1" class="ui-widget row mb-4"></div>'),$("#inputPassword1").append('<label for="passwordTag1" class="col-md-4">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["password"])+"</label>"),$("#inputPassword1").append('<input id="passwordTag1" name="passwordTag1" type="password" autocomplete="new-password" class="col-md-7" placeholder="'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["enterPassword"])+'">'),$("#registerUser").append('<div id="inputPassword2" class="ui-widget row mb-4"></div>'),$("#inputPassword2").append('<label for="passwordTag2" class="col-md-4">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["repeatedPassword"])+"</label>"),$("#inputPassword2").append('<input id="passwordTag2" name="passwordTag2" type="password" autocomplete="new-password" class="col-md-7" placeholder="'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["enterRepeatedPassword"])+'">');var e={student:DwenguinoBlocklyLanguageSettings.translateFrom("logging",["student"]),teacher:DwenguinoBlocklyLanguageSettings.translateFrom("logging",["teacher"])};$("#registerUser").append('<div id="inputRole" class="ui-widget row mb-4">'),$("#inputRole").append('<label for="roleTag" class="col-md-4">'+DwenguinoBlocklyLanguageSettings.translateFrom("logging",["role"])+"</label>"),$("#inputRole").append('<select id="roleTag" name="roleTag" class="col-md-7"></select>'),$.each(e,(function(t,e){$("#roleTag").append($("<option></option>").val(t).html(e))})),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),$("#submit_modal_dialog_button").click((function(){var e=[],n=$("input[name=acceptConditionsCheckbox]"),i=$("input[name=acceptResearchCheckbox]"),o=$("input[name=firstnameTag]").val(),a=$("input[name=emailTag]").val(),r=$("input[name=passwordTag1]").val(),s=$("input[name=passwordTag2]").val();e.push(t.validator.validateAcceptConditions(n)),e.push(t.validator.validateResearchConditions(i)),e.push(t.validator.validateFirstname(o)),e.push(t.validator.validateEmail(a)),e.push(t.validator.validatePasswords(r,s)),e.push(t.validator.validatePassword(r)),e.push(t.validator.validatePassword(s)),t.validator.hasErrors(e)?t.showErrors(e):(t.showErrors([]),t.registerUser())}))}},{key:"registerUser",value:function(){var t=this,e=$("input[name=acceptConditionsCheckbox]")[0].checked,n=$("input[name=acceptResearchCheckbox]")[0].checked,i={firstname:$("input[name=firstnameTag]").val(),email:$("input[name=emailTag]").val(),password:$("input[name=passwordTag1]").val(),password_repeated:$("input[name=passwordTag2]").val(),role:$("select[name=roleTag]").val(),accept_conditions:e,accept_research:n};$.ajax({type:"POST",url:c.getServerUrl()+"/register",headers:{"Content-Type":"application/json"},data:JSON.stringify(i)}).done((function(e){t.removeDialog(),t.showVerificationScreen()})).fail((function(e,n){console.log("Failed to register:",n),401==e.status&&"userAlreadyExists"==e.responseJSON.error&&t.showErrors([{message:DwenguinoBlocklyLanguageSettings.translateFrom("logging",["userAlreadyExists"])}])}))}},{key:"showVerificationScreen",value:function(){this.createLoggingModalDialogWithoutFooter(MSG.logging.verification),$("#loggingModalBody").append('<p id="loggingModalBody1"></p>'),$("#loggingModalBody1").text(MSG.logging.verificationSentTo),this.showDialog()}},{key:"showSettingsMenu",value:function(){var t=this;$.ajax({type:"GET",url:c.getServerUrl()+"/schools/"}).done((function(e){t.schools=e,t.createLoggingModalDialog(MSG.logging.setup),$("#loggingModalBody").append('<div id="inputSchool" class="ui-widget row mb-4">'),$("#inputSchool").append('<label for="myschooltags" class="col-md-2">'+MSG.logging.school+"</label>"),$("#inputSchool").append('<input id="myschooltags" name="myschooltags" class="form-control col-md-8" placeholder="'+MSG.logging.selectSchool+'">'),$("#loggingModalBody").append('<div id="inputAge" class="ui-widget row mb-4"></div>'),$("#inputAge").append('<label for="birth" class="col-md-3">'+MSG.logging.birth+"</label>"),$("#inputAge").append('<input type="date" class="form-control col-md-7" id="birth">'),$("#loggingModalBody").append('<div id="inputGender" class="ui-widget row mb-4"></div>'),$("#inputGender").append('<label for="birth" class="col-md-3">'+MSG.logging.gender+"</label>"),$("#inputGender").append('<div id="genderOptions" class="col-md-7">'),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="f">'+MSG.logging.gender1+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="m">'+MSG.logging.gender2+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="x">'+MSG.logging.gender3+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="na">'+MSG.logging.gender4+"</label>");var n=new Date,i=("0"+n.getDate()).slice(-2),o=("0"+(n.getMonth()+1)).slice(-2),a=n.getFullYear()+"-"+o+"-"+i;$("#birth").val(a),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),$("#loggingModal").modal("show"),t.schoolsAutocomplete=new autoComplete({selector:'input[name="myschooltags"]',minChars:2,source:function(t,n){t=t.toLowerCase();for(var i=e,o=[],a=0;a<i.length;a++)~i[a].naam.toLowerCase().indexOf(t)&&o.push(i[a].naam+", "+i[a].gemeente);n(o)}}),$("#submit_modal_dialog_button").click((function(){var e=[],n=$("input[name=myschooltags]").val(),i=$("#birth").val(),o=$("input[name=genderRadio]:checked").val();if(e.push(t.validator.validateSchool(n)),e.push(t.validator.validateGender(o)),t.validator.hasErrors(e))t.showErrors(e);else{t.eventLogger.setSchool(n),t.eventLogger.setDateOfBirth(i),t.eventLogger.setGender(o);var a={school:n,dateOfBirth:i,gender:o};$.ajax({type:"POST",url:c.getServerUrl()+"/user/update",headers:{"Content-Type":"application/json"},data:JSON.stringify(a)}).done((function(e){t.removeDialog()})).fail((function(t,e){console.warn("Failed to log in:",e)}))}}))})).fail((function(t,e){console.warn("Failed to fetch schools:",e)}))}},{key:"showDialog",value:function(){$("#loggingModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#loggingModal"),$(".modal-backdrop").remove()}},{key:"createLoggingModalDialog",value:function(t){this.removeDialog(),$("#db_body").append('<div id="loggingModal" class="modal fade" role="dialog"></div>'),$("#loggingModal").append('<div id="loggingModalDialog" class="modal-dialog"></div>'),$("#loggingModalDialog").append('<div id="loggingModalContent" class="modal-content"></div>'),$("#loggingModalContent").append('<div id="loggingModalHeader" class="modal-header"></div>'),$("#loggingModalContent").append('<div id="loggingModalBody" class="modal-body"></div>'),$("#loggingModalContent").append('<div id="loggingModalFooter" class="modal-footer"></div>'),$("#loggingModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#loggingModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>')}},{key:"createLoggingModalDialogWithoutFooter",value:function(t){this.removeDialog(),$("#db_body").append('<div id="loggingModal" class="modal fade" role="dialog"></div>'),$("#loggingModal").append('<div id="loggingModalDialog" class="modal-dialog"></div>'),$("#loggingModalDialog").append('<div id="loggingModalContent" class="modal-content"></div>'),$("#loggingModalContent").append('<div id="loggingModalHeader" class="modal-header"></div>'),$("#loggingModalContent").append('<div id="loggingModalBody" class="modal-body"></div>'),$("#loggingModalHeader").append('<h4 class="modal-title">'+t+"</h4>"),$("#loggingModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>')}},{key:"showErrors",value:function(t){$("div").remove("#loggingModalErrors"),$("#loggingModalBody").append('<div id="loggingModalErrors" class="mt-4"></div>');for(var e=t.length,n=0;n<e;n++)null!=t[n]&&$("#loggingModalErrors").append("<p>"+t[n].message+"</p>")}},{key:"createIconModule",value:function(){$("#loggingModalBody").append('<div class="row"><div class="col-md-12 mt-4"><b>'+MSG.logging.choosePassword+"</b></div></div>"),$("#loggingModalBody").append('<div class="row"><div class="col-md-3 mt-4 mb-4">'+MSG.logging.currentlySelected+'</div><div class="col-md-8 mt-4 mb-4"><div id="currentlySelected" class="row"></div></div>'),$("#currentlySelected").append('<div id="currentlySelected0" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected1" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected2" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected3" class="col-2"></div>'),this.createIconGrid()}},{key:"makeIconsResponsive",value:function(){for(var t=this,e=function(e){for(var n=function(n){$("#r"+e+"c"+n).click((function(){t.addIconToId(e,n)}))},i=1;i<5;i++)n(i)},n=1;n<5;n++)e(n)}},{key:"createIconGrid",value:function(){$("#loggingModalBody").append('<div id="inputIcons"></div>'),$("#inputIcons").append('<div id="row1" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row2" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row3" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row4" class="ui-widget row ml-1"></div>');for(var t=1;t<5;t++)for(var e=1;e<5;e++){$("#row"+t).append('<div id="r'+t+"c"+e+'" class="col-md-2 authentication_item mr-1 mb-1"></div>');var n=4*(t-1)+e,i=this.icons[n-1];$("#r"+t+"c"+e).append('<div class="category_tag">'+i.name+"</div>"),$("#r"+t+"c"+e).append('<div id="school_user_img">'+i.html+"</div>")}}},{key:"resetSelectedIcons",value:function(){for(var t=0;t<4;t++)this.currentlySelectedIcons[t]="0",$("#currentlySelected"+t).html("")}},{key:"addIconToId",value:function(t,e){for(var n=0;n<4;n++)if("0"==this.currentlySelectedIcons[n]){var i=4*(t-1)+e,o=this.icons[i-1];this.currentlySelectedIcons[n]=JSON.stringify(o.id),$("#currentlySelected"+n).html(o.name+"<p>"+o.html+"</p>");break}}}]),t}(),_e={simButtonStateClicked:!1,workspace:null,recording:"",difficultyLevel:1,simulatorState:"off",xmlLoadedFromFile:"",xmlFromScenario:"",logger:null,simulationEnvironment:null,cookiesInformation:null,loginMenu:null,tutorialMenu:null,fileIOController:null,initDwenguinoBlockly:function(t){this.workspace=t,this.setWorkspaceBlockFromXml('<xml id="startBlocks" style="display: none">'+document.getElementById("startBlocks").innerHTML+"</xml>"),this.fileIOController=new It,this.logger=new u,this.logger.init();var e=this;this.cookiesInformation=new fe,_e.displayCookieConsent(),this.loginMenu=new ve(this.logger),this.tutorialMenu=new ge(this.logger),this.simulationEnvironment=new Vt(this.logger,this.workspace),_e.recording=window.sessionStorage.loadOnceRecording||"",delete window.sessionStorage.loadOnceRecording,$("#db_menu_item_dwengo_robot_teacher_image").click((function(){e.loginMenu.createInitialMenu()})),$("#db_menu_item_difficulty_slider").slider({value:0,min:0,max:2,step:1,slide:function(t,n){_e.setDifficultyLevel(n.value),console.log(n.value);var i=e.logger.createEvent(P.difficultyLevel,n.value);e.logger.recordEvent(i)}}),$("#db_menu_item_difficulty_slider_input").val("$"+$("#db_menu_item_difficulty_slider").slider("value")),$("#db_blockly").resizable({handles:"e"}),$("#db_blockly").resize((function(){_e.onresize(),Blockly.svgResize(_e.workspace)})),$("#db_menu_item_simulator").click((function(){_e.toggleSimulator()})),_e.toggleSimulator(),$("#db_menu_item_run").click((function(){Blockly.Arduino.emptySetup();var t=Blockly.Arduino.workspaceToCode(_e.workspace);_e.runEventHandler(t)})),$("#db_menu_item_upload").click((function(){if(window.File&&window.FileReader&&window.FileList&&window.Blob){console.log("yay, files supported"),$("#dropzoneModal .modal-header").empty(),$("#dropzoneModal .modal-header").append('<h4 class="modal-title">'+MSG.dropzone.dictUploadBlocks+"</h4>"),$("#dropzoneModal .modal-header").append('<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),$("#dropzoneModal .modal-body .message").empty(),$("#dropzoneModal .modal-body .message").append("<p>"+MSG.dropzone.dictSelectFile+"</p>"),$("#dropzoneModal .modal-body .message").append('<label for="fileInput" class="form-label">'+MSG.dropzone.dictChooseFile+'</label><input type="file" id="fileInput" class="form-control">'),$("#dropzoneModal .modal-body .message").append('<div id="filedrag">'+MSG.dropzone.dictDefaultMessage+"</div>"),$("#dropzoneModal .modal-body .message").append('<pre id="fileDisplayArea"></pre>'),$("#dropzoneModal .modal-footer").empty(),$("#dropzoneModal .modal-footer").append('<button id="submit_upload_modal_dialog_button" type="button" class="btn btn-default" data-dismiss="modal">Ok</button>'),$("#dropzoneModal").modal("show");var t=function(t){if(t.type.match(/text.*/)){var e=new FileReader;e.onload=function(i){n.innerText=t.name,_e.xmlLoadedFromFile=e.result},e.readAsText(t)}else n.innerText=MSG.dropzone.dictFileNotSupported},e=document.getElementById("fileInput"),n=document.getElementById("fileDisplayArea");console.log(e),e.addEventListener("change",(function(n){console.log("file input changed");var i=e.files[0];t(i)}));var i=function(t){t.stopPropagation(),t.preventDefault(),t.target.className="dragover"==t.type?"hover":""},o=document.getElementById("filedrag");o.addEventListener("dragover",i,!1),o.addEventListener("dragleave",i,!1),o.addEventListener("drop",(function(e){i(e);var n=(e.target.files||e.dataTransfer.files)[0];t(n)}),!1),o.style.display="block",$("#submit_upload_modal_dialog_button").click((function(){_e.restoreFromXml(Blockly.Xml.textToDom(_e.xmlLoadedFromFile))}))}else alert("The File APIs are not fully supported in this browser.")})),$("#db_menu_item_download").click((function(){var t=Blockly.Xml.workspaceToDom(_e.workspace),n=Blockly.Xml.domToText(t);console.debug(n),localStorage.workspaceXml=n,_e.download("blocks.xml",n);var i=e.logger.createEvent(P.downloadClicked,"");_e.logger.recordEvent(i)})),$("#db_menu_item_clear").click((function(){_e.simulationEnvironment.stop();_e.runEventHandler('#include <Wire.h>\n#include <Dwenguino.h>\n#include <LiquidCrystal.h>\n\nvoid setup(){\ninitDwenguino();\ndwenguinoLCD.setCursor(2,0);\ndwenguinoLCD.print(String("WeGoSTEM ;)"));\n}\n\nvoid loop(){}\n')})),$("#blocklyDiv").click((function(){_e.simulationEnvironment.stop()})),_e.workspace.addChangeListener((function(t){console.log("blockly event");var e="";if("create"==t.type){var n={xml:Blockly.Xml.domToText(t.xml),ids:t.ids};n=JSON.stringify(n),e=_e.logger.createEvent(P.blocklyBlockCreate,n),_e.logger.recordEvent(e)}else if("delete"==t.type){n={oldXml:Blockly.Xml.domToText(t.oldXml),ids:t.ids};n=JSON.stringify(n),e=_e.logger.createEvent(P.blocklyBlockDelete,n),_e.logger.recordEvent(e)}else if("move"==t.type){n={oldParentId:t.oldParentId,oldInputName:t.oldInputName,oldCoordinate:t.oldCoordinate,newParentId:t.newParentId,newInputName:t.newInputName,newCoordinate:t.newCoordinate};n=JSON.stringify(n),e=_e.logger.createEvent(P.blocklyBlockMove,n),_e.logger.recordEvent(e)}else if("createVar"==t.type){n={varType:t.varType,varName:t.varName,varId:t.varId};n=JSON.stringify(n),e=_e.logger.createEvent(P.blocklyVarCreate,n),_e.logger.recordEvent(e)}else if("deleteVar"==t.type){n={varType:t.varType,varName:t.varName,varId:t.varId};n=JSON.stringify(n),e=_e.logger.createEvent(P.blocklyVarDelete,n),_e.logger.recordEvent(e)}else if(t.type==Blockly.Events.VAR_RENAME){n={oldName:t.oldName,newName:t.newName,varId:t.varId};n=JSON.stringify(n),e=_e.logger.createEvent(P.blocklyVarRename,n),_e.logger.recordEvent(e)}else if(t.type==Blockly.Events.UI){n={element:t.element,oldValue:t.oldValue,newValue:t.newValue};n=JSON.stringify(n),e=_e.logger.createEvent(P.blocklyUI,n),_e.logger.recordEvent(e)}else if(t.type==Blockly.Events.CHANGE){n={element:t.element,name:t.name,oldValue:t.oldValue,newValue:t.newValue};n=JSON.stringify(n),e=_e.logger.createEvent(P.blocklyChange,n),_e.logger.recordEvent(e)}else if(t.type==Blockly.Events.UNDO){n={};e=_e.logger.createEvent(P.undo,n),_e.logger.recordEvent(e)}else console.debug("Type of event unkown ",t)}))},restoreFromXml:function(t){_e.workspace.clear(),Blockly.Xml.domToWorkspace(t,_e.workspace);_e.workspace.getAllBlocks().length;var e=_e.logger.createEvent(P.uploadClicked,t);_e.logger.recordEvent(e)},download:function(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},toggleSimulator:function(){var t=[];this.simButtonStateClicked?(t=["100%","off",!1],_e.simulationEnvironment.stop()):(t=["50%","on",!0],_e.simulationEnvironment.open()),$("#db_blockly").width(t[0]),this.simButtonStateClicked=t[2],_e.simulatorState=t[1];var e=_e.logger.createEvent(P.simButtonStateClicked,_e.simulatorState);_e.logger.recordEvent(e),_e.onresize(),Blockly.svgResize(_e.workspace)},runEventHandler:function(t){_e.disableRunButton(),$.ajax({url:c.getServerUrl()+"/utilities/run",dataType:"json",type:"post",contentType:"application/x-www-form-urlencoded",data:{code:t},success:function(t,e,n){console.log("succes"),console.log(t),"error"===t.status&&_e.showModalErrorDialog(t),_e.resetRunButton()},error:function(t,e,n){console.log(n),_e.resetRunButton()}}),console.log(t.replace(/\r?\n|\r/g,"\n"));var e=_e.logger.createEvent(P.runClicked,"");_e.logger.recordEvent(e)},showModalErrorDialog:function(t){$("#errorModal .modal-header").html(MSG.runError),"Upload failed"===t.info?$("#errorModal .modal-body .message").html(MSG.uploadError):"Compilation failed"===t.info?$("#errorModal .modal-body .message").html(MSG.compileError):"Clean failed"===t.info?$("#errorModal .modal-body .message").html(MSG.cleanError):$("#errorModal .modal-body .message").html(MSG.uploadError),$("#errorModal .modal-body .console").hide(),$("#errorModal .modal-body .error_details").off("click"),$("#errorModal .modal-body .error_details").click((function(){console.log("toggle console"),$("#errorModal .modal-body .console").toggle()})),"SIGTERM"===t.message.signal?$("#errorModal .modal-body .console").html("Operation timed out"):$("#errorModal .modal-body .console").html(t.trace),$("#errorModal").modal("show")},disableRunButton:function(){$("#db_menu_item_run").off("click"),$("#db_menu_item_clear").off("click"),$("#db_menu_item_dwengo_robot_teacher_image").attr("src","DwenguinoIDE/img/gear_animation.gif"),$("#db_menu_item_dwengo_robot_teacher_image").css({padding:"10px 25px",maxHeight:"100%",float:"right"}),$("#db_menu_item_run").css({color:"gray"}),$("#db_menu_item_clear").css({color:"gray"})},resetRunButton:function(){$("#db_menu_item_run").click((function(){Blockly.Arduino.emptySetup();var t=Blockly.Arduino.workspaceToCode(_e.workspace);_e.runEventHandler(t)})),$("#db_menu_item_clear").click((function(){_e.runEventHandler('#include <Wire.h>\n#include <Dwenguino.h>\n#include <LiquidCrystal.h>\n\nvoid setup(){\ninitDwenguino();\ndwenguinoLCD.setCursor(2,0);\ndwenguinoLCD.print(String("WeGoSTEM ;)"));\n}\n\nvoid loop(){}\n')})),$("#db_menu_item_run").css({color:"black"}),$("#db_menu_item_run").hover((function(){$(this).css({color:"#8bab42"})})),$("#db_menu_item_run").mouseleave((function(){$(this).css({color:"black"})})),$("#db_menu_item_clear").css({color:"black"}),$("#db_menu_item_clear").hover((function(){$(this).css({color:"#8bab42"})})),$("#db_menu_item_clear").mouseleave((function(){$(this).css({color:"black"})})),$("#db_menu_item_dwengo_robot_teacher_image").css({padding:"10px",maxHeight:"100%",float:"right"}),$("#db_menu_item_dwengo_robot_teacher_image").attr("src","DwenguinoIDE/img/dwengo_robot_plain.svg")},prevWorkspaceXml:"",takeSnapshotOfWorkspace:function(){console.log("taking snapshot");var t=Blockly.Xml.workspaceToDom(_e.workspace),e=Blockly.Xml.domToText(t);if(e!=_e.prevWorkspaceXml){var n={blocksXml:e,blocksJsCode:Blockly.JavaScript.workspaceToCode(_e.workspace)},i=JSON.stringify(n);_e.prevWorkspaceXml=e;var o=this.logger.createEvent(P.changedWorkspace,i);_e.logger.recordEvent(o)}},logCodeChange:function(t){_e.takeSnapshotOfWorkspace()},previouslyRenderedCode:null,renderCode:function(){_e.logCodeChange(),Blockly.Arduino.emptySetup();var t=Blockly.Arduino.workspaceToCode(_e.workspace);if(null===_e.previouslyRenderedCode)document.getElementById("db_arduino_code").innerHTML=prettyPrintOne(t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),"cpp",!1),_e.previouslyRenderedCode=t;else if(t!==_e.previouslyRenderedCode){var e=_e.highlightModifiedCode(t);document.getElementById("db_arduino_code").innerHTML=prettyPrintOne(e.join(""),"cpp",!1),_e.previouslyRenderedCode=t}},highlightModifiedCode:function(t){for(var e=JsDiff.diffWords(_e.previouslyRenderedCode,t),n=[],i=0;i<e.length;i++)if(!e[i].removed){var o=e[i].value.replace(/</g,"&lt;").replace(/>/g,"&gt;");e[i].added?n.push('<span class="code_highlight_new">'+o+"</span>"):n.push(o)}return n},setDifficultyLevel:function(t){_e.difficultyLevel=t,$("#toolbox").load("./DwenguinoIDE/levels/lvl"+t+".xml",(function(){_e.doTranslation(),_e.workspace.updateToolbox(document.getElementById("toolbox"))}))},fallbackCopyCodeToClipboard:function(t){var e=document.createElement("dummy-text-area");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy"),$("#notification-copy").show(),$("#notification-copy").text(MSG.arduinoCodeCopied),setTimeout((function(){$("#notification-copy").hide("blind",{},500)}),3e3)}catch(t){console.error("Unable to copy Arduino code: ",t)}document.body.removeChild(e)},copyCodeToClipboard:function(){var t=Blockly.Arduino.workspaceToCode(_e.workspace);navigator.clipboard?navigator.clipboard.writeText(t).then((function(){$("#notification-copy").show(),$("#notification-copy").text(MSG.arduinoCodeCopied),setTimeout((function(){$("#notification-copy").hide("blind",{},500)}),3e3)}),(function(t){console.error("Unable to copy Arduino code: ",t)})):fallbackCopyCodeToClipboard(t)},loadFileXmlIntoWorkspace:function(t){console.log("loading into workspace"),_e.setWorkspaceBlockFromXml(t)},onresize:function(){var t=document.getElementById("db_blockly"),e=document.getElementById("blocklyDiv"),n=t,i=0,o=0;do{i+=n.offsetLeft,o+=n.offsetTop,n=n.offsetParent}while(n);e.style.left=i+"px",e.style.top=o+"px",e.style.width=t.offsetWidth+"px",e.style.height=t.offsetHeight+"px"},injectBlockly:function(){document.getElementById("db_blockly");var t=document.getElementById("blocklyDiv"),e=Blockly.inject(t,{toolbox:document.getElementById("toolbox"),media:"DwenguinoIDE/img/",zoom:{controls:!0,wheel:!0},undo:!0});window.addEventListener("resize",_e.onresize,!1),_e.onresize(),Blockly.svgResize(e),e.addChangeListener(_e.renderCode);return e.registerButtonCallback("createVariableCallback",(function(t){console.log("Creating new variable")})),e.registerToolboxCategoryCallback("DWB_VARIABLES",(function(){var t=e.getAllVariables(),n=[];n.push('<block type="variables_declare_set_int"></block>'),n.push('<block type="variables_get_int"></block>'),n.push('<block type="variables_declare_set_string"></block>'),n.push('<block type="variables_get_string"></block>'),console.log(t);for(var i=0;i<t.length;i++){var o='<block type="variables_get'+("Number"==t[i].type?"_int":"String"==t[i].type?"_string":"")+'"><field name="VAR" id="';o=(o=(o=o+t[i].id_+'" variabletype="')+t[i].type+'">')+t[i].name+"</field></block>",console.log(o),n.push(o)}var a=[];for(i=0;i<n.length;i++)a.push(Blockly.Xml.textToDom(n[i]));return a})),e},changeLanguage:function(){if("undefined"!=typeof Blockly&&window.sessionStorage){var t=Blockly.Xml.workspaceToDom(_e.workspace),e=Blockly.Xml.domToText(t);window.sessionStorage.loadOnceBlocks=e,window.sessionStorage.loadOnceRecording=_e.recording,window.sessionStorage.loadOnceSessionId=_e.sessionId}var n=document.getElementById("db_menu_item_language_selection"),i=encodeURIComponent(n.options[n.selectedIndex].value),o=window.location.search;o=o.length<=1?"?lang="+i:o.match(/[?&]lang=[^&]*/)?o.replace(/([?&]lang=)[^&]*/,"$1"+i):o.replace(/\?/,"?lang="+i+"&");var a={lang:i};console.log(a),$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:c.getServerUrl()+"/lang",data:JSON.stringify(a)}).done((function(t){console.log(t)})).fail((function(t,e){console.log(e,t)})),window.location=window.location.protocol+"//"+window.location.host+window.location.pathname+o},LANG:DwenguinoBlocklyLanguageSettings.getLang(),isRtl:function(){return!1},initLanguage:function(){var t=_e.isRtl();document.dir=t?"rtl":"ltr",document.head.parentElement.setAttribute("lang",_e.LANG);var e={lang:_e.LANG};console.log(e),$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:c.getServerUrl()+"/lang",data:JSON.stringify(e)}).done((function(t){console.log(t)})).fail((function(t,e){console.log(e,t)}));var n=[];for(var i in DwenguinoBlocklyLanguageSettings.LANGUAGE_NAME)n.push([DwenguinoBlocklyLanguageSettings.LANGUAGE_NAME[i],i]);n.sort((function(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:0}));var o=document.getElementById("db_menu_item_language_selection");o.options.length=0;for(var a=0;a<n.length;a++){var r=n[a],s=(i=r[r.length-1],new Option(r[0],i));i===_e.LANG&&(s.selected=!0),o.options.add(s)}o.addEventListener("change",_e.changeLanguage,!0)},doTranslation:function(){document.title+=" "+DwenguinoBlocklyLanguageSettings.translate(["title"]),document.getElementById("db_menu_item_upload").title=DwenguinoBlocklyLanguageSettings.translate(["loadBlocksFileTooltip"]),document.getElementById("db_menu_item_download").title=MSG.saveBlocksFileTooltip,document.getElementById("db_menu_item_simulator").title=MSG.toggleSimulator;for(var t,e=["catLogic","catLoops","catMath","catText","catLists","catColour","catVariables","catFunctions","catBoardIO","catDwenguino","catSocialRobot","catArduino","catComments"],n=0;t=e[n];n++){var i=document.getElementById(t);i&&i.setAttribute("name",MSG[t])}var o,a=document.getElementsByClassName("textVar");for(n=0;o=a[n];n++)o.textContent=MSG.textVariable;var r,s=document.getElementsByClassName("listVar");for(n=0;r=s[n];n++)r.textContent=MSG.listVariable},loadBlocks:function(t){try{var e=window.sessionStorage.loadOnceBlocks}catch(t){e=null}if("BlocklyStorage"in window&&window.location.hash.length>1)BlocklyStorage.retrieveXml(window.location.hash.substring(1));else if(e){delete window.sessionStorage.loadOnceBlocks;var n=Blockly.Xml.textToDom(e);Blockly.Xml.domToWorkspace(n,_e.workspace)}else if(t){n=Blockly.Xml.textToDom(t);Blockly.Xml.domToWorkspace(n,_e.workspace),_e.recording=""}else"BlocklyStorage"in window&&window.setTimeout(BlocklyStorage.restoreBlocks,0)},setWorkspaceBlockFromXml:function(t){_e.workspace.clear();try{var e=Blockly.Xml.textToDom(t)}catch(t){return void console.log("invalid xml")}Blockly.Xml.domToWorkspace(e,_e.workspace)},setupEnvironment:function(){_e.initLanguage();var t=_e.injectBlockly();_e.initDwenguinoBlockly(t),_e.doTranslation(),_e.setDifficultyLevel(0),_e.takeSnapshotOfWorkspace(),$(window).resize((function(){_e.onresize(),Blockly.svgResize(_e.workspace)}));var e=document.querySelector('input[id="code_checkbox"]');e.addEventListener("change",(function(){e.checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible",_e.renderCode()):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("db_code_pane").style.visibility="hidden")})),$("#copy-code").click((function(){_e.copyCodeToClipboard()})),document.querySelector('input[id="hardware_checkbox"]').addEventListener("change",(function(){_e.renderCode()}))},tearDownEnvironment:function(){},displayCookieConsent:function(){var t=MSG.cookieConsent.cookieConsent+'<a id="cookie-info" href="#" class="ml-1">'+MSG.cookieConsent.cookieInfo+'</a><div class=" ml-2 d-flex align-items-center justify-content-center g-2"> <button id="allow-cookies" class="allow-button mr-1">'+MSG.cookieConsent.close+"</button></div>";$("#cookie-consent").html(t);var e=this;$("#cookie-info").click((function(){e.cookiesInformation.initCookiesInformation()})),$("#allow-cookies").click((function(){$("#cookie-consent").remove()}))}};$(document).ready((function(){_e.setupEnvironment()}));var ye=e.default=_e}]);