!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var i=n(12);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}},function(e,t,n){var i=n(13),o=n(4);e.exports=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?o(e):t}},function(e,t,n){var i=n(11);function o(t,n,r){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=o=Reflect.get:e.exports=o=function(e,t,n){var o=i(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},o(t,n,r||t)}e.exports=o},function(e,t,n){var i=n(14),o=n(15),r=n(16),a=n(18);e.exports=function(e,t){return i(e)||o(e,t)||r(e,t)||a()}},function(e,t,n){e.exports=n(20)},function(e,t){function n(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,o)}e.exports=function(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function s(e){n(a,o,r,s,l,"next",e)}function l(e){n(a,o,r,s,l,"throw",e)}s(void 0)}))}}},function(e,t,n){var i=n(3);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}},function(e,t){function n(t,i){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,i)}e.exports=n},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}}},function(e,t,n){var i=n(17);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=32)}([function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var i=n(6),o=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=d;var r=n(5);r.inherits=n(2);var a=n(23),s=n(14);r.inherits(d,a);for(var l=o(s.prototype),c=0;c<l.length;c++){var u=l[c];d.prototype[u]||(d.prototype[u]=s.prototype[u])}function d(e){if(!(this instanceof d))return new d(e);a.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",p)}function p(){this.allowHalfOpen||this._writableState.ended||i.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=n(38),o=n(39),r=n(40);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,n)}function c(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=p(e,t),e}(e,t,n,i):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(t,n),o=(e=s(e,i)).write(t,n);return o!==i&&(e=e.slice(0,o)),e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):p(e,t);if("Buffer"===t.type&&r(t.data))return p(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=s(e,t<0?0:0|h(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function h(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(i)return j(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function m(e,t,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:v(e,t,n,i,o);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,i,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,i,o){var r,a=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var u=-1;for(r=n;r<s;r++)if(c(e,r)===c(t,-1===u?0:r-u)){if(-1===u&&(u=r),r-u+1===l)return u*a}else-1!==u&&(r-=r-u),u=-1}else for(n+l>s&&(n=s-l),r=n;r>=0;r--){for(var d=!0,p=0;p<l;p++)if(c(e,r+p)!==c(t,p)){d=!1;break}if(d)return r}return-1}function _(e,t,n,i){n=Number(n)||0;var o=e.length-n;i?(i=Number(i))>o&&(i=o):i=o;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");i>r/2&&(i=r/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function y(e,t,n,i){return W(j(t,e.length-n),e,n,i)}function b(e,t,n,i){return W(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function k(e,t,n,i){return b(e,t,n,i)}function S(e,t,n,i){return W(H(t),e,n,i)}function w(e,t,n,i){return W(function(e,t){for(var n,i,o,r=[],a=0;a<e.length&&!((t-=2)<0);++a)i=(n=e.charCodeAt(a))>>8,o=n%256,r.push(o),r.push(i);return r}(t,e.length-n),e,n,i)}function E(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var i=[],o=t;o<n;){var r,a,s,l,c=e[o],u=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(r=e[o+1]))&&(l=(31&c)<<6|63&r)>127&&(u=l);break;case 3:r=e[o+1],a=e[o+2],128==(192&r)&&128==(192&a)&&(l=(15&c)<<12|(63&r)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:r=e[o+1],a=e[o+2],s=e[o+3],128==(192&r)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&r)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),o+=d}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=I));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return u(t),t<=0?s(e,t):void 0!==n?"string"==typeof i?s(e,t).fill(n,i):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,o=0,r=Math.min(n,i);o<r;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):function(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,o){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var r=(o>>>=0)-(i>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(r,a),c=this.slice(i,o),u=e.slice(t,n),d=0;d<s;++d)if(c[d]!==u[d]){r=c[d],a=u[d];break}return r<a?-1:a<r?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var r=!1;;)switch(i){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,n);default:if(r)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),r=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function T(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(127&e[o]);return i}function C(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(e[o]);return i}function M(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var o="",r=t;r<n;++r)o+=N(e[r]);return o}function P(e,t,n){for(var i=e.slice(t,n),o="",r=0;r<i.length;r+=2)o+=String.fromCharCode(i[r]+256*i[r+1]);return o}function A(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,n,i,o,r){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<r)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function R(e,t,n,i){t<0&&(t=65535+t+1);for(var o=0,r=Math.min(e.length-n,2);o<r;++o)e[n+o]=(t&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function B(e,t,n,i){t<0&&(t=4294967295+t+1);for(var o=0,r=Math.min(e.length-n,4);o<r;++o)e[n+o]=t>>>8*(i?o:3-o)&255}function $(e,t,n,i,o,r){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,i,r){return r||$(e,0,n,4),o.write(e,t,n,i,23,4),n+4}function L(e,t,n,i,r){return r||$(e,0,n,8),o.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var o=t-e;n=new l(o,void 0);for(var r=0;r<o;++r)n[r]=this[r+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e],o=1,r=0;++r<t&&(o*=256);)i+=this[e+r]*o;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e+--t],o=1;t>0&&(o*=256);)i+=this[e+--t]*o;return i},l.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=this[e],o=1,r=0;++r<t&&(o*=256);)i+=this[e+r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var i=t,o=1,r=this[e+--i];i>0&&(o*=256);)r+=this[e+--i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),o.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),o.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),o.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),o.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||O(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,r=0;for(this[t]=255&e;++r<n&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||O(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,r=1;for(this[t+o]=255&e;--o>=0&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):B(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):B(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);O(this,e,t,n,o-1,-o)}var r=0,a=1,s=0;for(this[t]=255&e;++r<n&&(a*=256);)e<0&&0===s&&0!==this[t+r-1]&&(s=1),this[t+r]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);O(this,e,t,n,o-1,-o)}var r=n-1,a=1,s=0;for(this[t+r]=255&e;--r>=0&&(a*=256);)e<0&&0===s&&0!==this[t+r+1]&&(s=1),this[t+r]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):B(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):B(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o,r=i-n;if(this===e&&n<t&&t<i)for(o=r-1;o>=0;--o)e[o+t]=this[o+n];else if(r<1e3||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<r;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+r),t);return r},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{var a=l.isBuffer(e)?e:j(new l(e,i).toString()),s=a.length;for(r=0;r<n-t;++r)this[r+t]=a[r%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var i=e.length,o=null,r=[],a=0;a<i;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&r.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&r.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&r.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;r.push(n)}else if(n<2048){if((t-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function H(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,n,i){for(var o=0;o<i&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(0))},function(e,t){var n,i,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,c=[],u=!1,d=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&h())}function h(){if(!u){var e=s(p);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(t){!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,i,o){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var r,a,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,i)}));case 4:return t.nextTick((function(){e.call(null,n,i,o)}));default:for(r=new Array(s-1),a=0;a<r.length;)r[a++]=arguments[a];return t.nextTick((function(){e.apply(null,r)}))}}}:e.exports=t}).call(this,n(4))},function(e,t,n){var i=n(3),o=i.Buffer;function r(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return o(e,t,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=i:(r(i,t),t.Buffer=a),r(o,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=o(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,n){var i=n(17)(Object,"create");e.exports=i},function(e,t,n){var i=n(31);e.exports=function(e,t){for(var n=e.length;n--;)if(i(e[n][0],t))return n;return-1}},function(e,t,n){var i=n(96);e.exports=function(e,t){var n=e.__data__;return i(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(35),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(0))},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function r(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,a,s,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(r(n=this._events[e]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),a=(c=n.slice()).length,l=0;l<a;l++)c[l].apply(this,s);return!0},n.prototype.addListener=function(e,t){var a;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(a=r(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(e,o),n||(n=!0,t.apply(this,arguments))}return o.listener=t,this.on(e,o),this},n.prototype.removeListener=function(e,t){var n,r,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(n=this._events[e]).length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){(t=e.exports=n(23)).Stream=t,t.Readable=t,t.Writable=n(14),t.Duplex=n(1),t.Transform=n(27),t.PassThrough=n(45)},function(e,t,n){"use strict";(function(t,i,o){var r=n(6);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var i=e.entry;for(e.entry=null;i;){var o=i.callback;t.pendingcb--,o(void 0),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=_;var s,l=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?i:r.nextTick;_.WritableState=v;var c=n(5);c.inherits=n(2);var u,d={deprecate:n(44)},p=n(24),h=n(7).Buffer,f=o.Uint8Array||function(){},g=n(25);function m(){}function v(e,t){s=s||n(1),e=e||{};var i=t instanceof s;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var o=e.highWaterMark,c=e.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:i&&(c||0===c)?c:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===e.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,o=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,o){--t.pendingcb,n?(r.nextTick(o,i),r.nextTick(E,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(o(i),e._writableState.errorEmitted=!0,e.emit("error",i),E(e,t))}(e,n,i,t,o);else{var a=S(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||k(e,n),i?l(b,e,n,a,o):b(e,n,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function _(e){if(s=s||n(1),!(u.call(_,this)||this instanceof s))return new _(e);this._writableState=new v(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),p.call(this)}function y(e,t,n,i,o,r,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,r,t.onwrite),t.sync=!1}function b(e,t,n,i){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),E(e,t)}function k(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,o=new Array(i),r=t.corkedRequestsFree;r.entry=n;for(var s=0,l=!0;n;)o[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;o.allBuffers=l,y(e,t,!0,t.length,o,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,d=n.callback;if(y(e,t,!1,t.objectMode?1:c.length,c,u,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function S(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),E(e,t)}))}function E(e,t){var n=S(t);return n&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,r.nextTick(w,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}c.inherits(_,p),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:d.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(_,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===_&&e&&e._writableState instanceof v}})):u=function(e){return e instanceof this},_.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},_.prototype.write=function(e,t,n){var i=this._writableState,o=!1,a=!i.objectMode&&function(e){return h.isBuffer(e)||e instanceof f}(e);return a&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=m),i.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),r.nextTick(t,n)}(this,n):(a||function(e,t,n,i){var o=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),r.nextTick(i,a),o=!1),o}(this,i,e,n))&&(i.pendingcb++,o=function(e,t,n,i,o,r){if(!n){var a=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,n)),t}(t,i,o);i!==a&&(n=!0,o="buffer",i=a)}var s=t.objectMode?1:i.length;t.length+=s;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:o,isBuf:n,callback:r,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,s,i,o,r);return l}(this,i,a,e,t,n)),o},_.prototype.cork=function(){this._writableState.corked++},_.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||k(this,e))},_.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),_.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},_.prototype._writev=null,_.prototype.end=function(e,t,n){var i=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,n){t.ending=!0,E(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,i,n)},Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),_.prototype.destroy=g.destroy,_.prototype._undestroy=g.undestroy,_.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(4),n(11).setImmediate,n(0))},function(e,t,n){(function(t,n,i){e.exports=function e(t,n,i){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof _dereq_&&_dereq_;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){return o(t[a][1][e]||e)}),u,u.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof _dereq_&&_dereq_,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,n){"use strict";t.exports=function(e){var t=e._SomePromiseArray;function n(e){var n=new t(e),i=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),i}e.any=function(e){return n(e)},e.prototype.any=function(){return n(this)}}},{}],2:[function(e,n,i){"use strict";var o;try{throw new Error}catch(e){o=e}var r=e("./schedule"),a=e("./queue"),s=e("./util");function l(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new a(16),this._normalQueue=new a(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=r}function c(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function u(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function d(e){this._normalQueue._pushOne(e),this._queueTick()}l.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},l.prototype.hasCustomScheduler=function(){return this._customScheduler},l.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},l.prototype.disableTrampolineIfNecessary=function(){s.hasDevTools&&(this._trampolineEnabled=!1)},l.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},l.prototype.fatalError=function(e,n){n?(t.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),t.exit(2)):this.throwLater(e)},l.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.hasDevTools?(l.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?c.call(this,e,t,n):this._schedule((function(){setTimeout((function(){e.call(t,n)}),100)}))},l.prototype.invoke=function(e,t,n){this._trampolineEnabled?u.call(this,e,t,n):this._schedule((function(){e.call(t,n)}))},l.prototype.settlePromises=function(e){this._trampolineEnabled?d.call(this,e):this._schedule((function(){e._settlePromises()}))}):(l.prototype.invokeLater=c,l.prototype.invoke=u,l.prototype.settlePromises=d),l.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),i=e.shift();t.call(n,i)}else t._settlePromises()}},l.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},l.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},l.prototype._reset=function(){this._isTickUsed=!1},n.exports=l,n.exports.firstLineError=o},{"./queue":26,"./schedule":29,"./util":36}],3:[function(e,t,n){"use strict";t.exports=function(e,t,n,i){var o=!1,r=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(r,r,null,this,e)},s=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},l=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(r){o||(o=!0,e.prototype._propagateFrom=i.propagateFromFunction(),e.prototype._boundValue=i.boundValueFunction());var c=n(r),u=new e(t);u._propagateFrom(this,1);var d=this._target();if(u._setBoundTo(c),c instanceof e){var p={promiseRejectionQueued:!1,promise:u,target:d,bindingPromise:c};d._then(t,a,void 0,u,p),c._then(s,l,void 0,u,p),u._setOnCancel(c)}else u._resolveCallback(d);return u},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}},{}],4:[function(e,t,n){"use strict";var i;"undefined"!=typeof Promise&&(i=Promise);var o=e("./promise")();o.noConflict=function(){try{Promise===o&&(Promise=i)}catch(e){}return o},t.exports=o},{"./promise":22}],5:[function(e,t,n){"use strict";var i=Object.create;if(i){var o=i(null),r=i(null);o[" size"]=r[" size"]=0}t.exports=function(t){var n=e("./util"),i=n.canEvaluate;function o(e){return function(e,i){var o;if(null!=e&&(o=e[i]),"function"!=typeof o){var r="Object "+n.classString(e)+" has no method '"+n.toString(i)+"'";throw new t.TypeError(r)}return o}(e,this.pop()).apply(e,this)}function r(e){return e[this]}function a(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}n.isIdentifier,t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(o,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=a;else if(i){var n=(void 0)(e);t=null!==n?n:r}else t=r;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./util"),a=r.tryCatch,s=r.errorObj,l=t._async;t.prototype.break=t.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(r.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var i=a(e).call(this._boundValue());i===s&&(this._attachExtraTrace(i.e),l.throwLater(i.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./util"),i=e("./es5").keys,o=n.tryCatch,r=n.errorObj;return function(e,a,s){return function(l){var c=s._boundValue();e:for(var u=0;u<e.length;++u){var d=e[u];if(d===Error||null!=d&&d.prototype instanceof Error){if(l instanceof d)return o(a).call(c,l)}else if("function"==typeof d){var p=o(d).call(c,l);if(p===r)return p;if(p)return o(a).call(c,l)}else if(n.isObject(l)){for(var h=i(d),f=0;f<h.length;++f){var g=h[f];if(d[g]!=l[g])continue e}return o(a).call(c,l)}}return t}}}},{"./es5":13,"./util":36}],8:[function(e,t,n){"use strict";t.exports=function(e){var t=!1,n=[];function i(){this._trace=new i.CapturedTrace(o())}function o(){var e=n.length-1;if(e>=0)return n[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},i.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},i.prototype._popContext=function(){if(void 0!==this._trace){var e=n.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},i.CapturedTrace=null,i.create=function(){if(t)return new i},i.deactivateLongStackTraces=function(){},i.activateLongStackTraces=function(){var n=e.prototype._pushContext,r=e.prototype._popContext,a=e._peekContext,s=e.prototype._peekContext,l=e.prototype._promiseCreated;i.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=r,e._peekContext=a,e.prototype._peekContext=s,e.prototype._promiseCreated=l,t=!1},t=!0,e.prototype._pushContext=i.prototype._pushContext,e.prototype._popContext=i.prototype._popContext,e._peekContext=e.prototype._peekContext=o,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},i}},{}],9:[function(e,n,i){"use strict";n.exports=function(n,i){var o,r,a,s=n._getDomain,l=n._async,c=e("./errors").Warning,u=e("./util"),d=u.canAttachTrace,p=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,h=/\((?:timers\.js):\d+:\d+\)/,f=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,g=null,m=null,v=!1,_=!(0==u.env("BLUEBIRD_DEBUG")),y=!(0==u.env("BLUEBIRD_WARNINGS")||!_&&!u.env("BLUEBIRD_WARNINGS")),b=!(0==u.env("BLUEBIRD_LONG_STACK_TRACES")||!_&&!u.env("BLUEBIRD_LONG_STACK_TRACES")),k=0!=u.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(y||!!u.env("BLUEBIRD_W_FORGOTTEN_RETURN"));n.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var e=this;setTimeout((function(){e._notifyUnhandledRejection()}),1)}},n.prototype._notifyUnhandledRejectionIsHandled=function(){G("rejectionHandled",o,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),G("unhandledRejection",r,e,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},n.prototype._warn=function(e,t,n){return N(e,t,n||this)},n.onPossiblyUnhandledRejection=function(e){var t=s();r="function"==typeof e?null===t?e:u.domainBind(t,e):void 0},n.onUnhandledRejectionHandled=function(e){var t=s();o="function"==typeof e?null===t?e:u.domainBind(t,e):void 0};var S=function(){};n.longStackTraces=function(){if(l.haveItemsQueued()&&!Q.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!Q.longStackTraces&&V()){var e=n.prototype._captureStackTrace,t=n.prototype._attachExtraTrace;Q.longStackTraces=!0,S=function(){if(l.haveItemsQueued()&&!Q.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=e,n.prototype._attachExtraTrace=t,i.deactivateLongStackTraces(),l.enableTrampoline(),Q.longStackTraces=!1},n.prototype._captureStackTrace=L,n.prototype._attachExtraTrace=F,i.activateLongStackTraces(),l.disableTrampolineIfNecessary()}},n.hasLongStackTraces=function(){return Q.longStackTraces&&V()};var w=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return u.global.dispatchEvent(e),function(e,t){var n=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!u.global.dispatchEvent(n)}}return"function"==typeof Event?(e=new Event("CustomEvent"),u.global.dispatchEvent(e),function(e,t){var n=new Event(e.toLowerCase(),{cancelable:!0});return n.detail=t,!u.global.dispatchEvent(n)}):((e=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),u.global.dispatchEvent(e),function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e.toLowerCase(),!1,!0,t),!u.global.dispatchEvent(n)})}catch(e){}return function(){return!1}}(),E=u.isNode?function(){return t.emit.apply(t,arguments)}:u.global?function(e){var t="on"+e.toLowerCase(),n=u.global[t];return!!n&&(n.apply(u.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function x(e,t){return{promise:t}}var I={promiseCreated:x,promiseFulfilled:x,promiseRejected:x,promiseResolved:x,promiseCancelled:x,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:x},T=function(e){var t=!1;try{t=E.apply(null,arguments)}catch(e){l.throwLater(e),t=!0}var n=!1;try{n=w(e,I[e].apply(null,arguments))}catch(e){l.throwLater(e),n=!0}return n||t};function C(){return!1}function M(e,t,n){var i=this;try{e(t,n,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+u.toString(e));i._attachCancellationCallback(e)}))}catch(e){return e}}function P(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?u.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function A(){return this._onCancelField}function O(e){this._onCancelField=e}function R(){this._cancellationParent=void 0,this._onCancelField=void 0}function B(e,t){if(0!=(1&t)){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}n.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?n.longStackTraces():!e.longStackTraces&&n.hasLongStackTraces()&&S()),"warnings"in e){var t=e.warnings;Q.warnings=!!t,k=Q.warnings,u.isObject(t)&&"wForgottenReturn"in t&&(k=!!t.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!Q.cancellation){if(l.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=R,n.prototype._propagateFrom=B,n.prototype._onCancel=A,n.prototype._setOnCancel=O,n.prototype._attachCancellationCallback=P,n.prototype._execute=M,$=B,Q.cancellation=!0}return"monitoring"in e&&(e.monitoring&&!Q.monitoring?(Q.monitoring=!0,n.prototype._fireEvent=T):!e.monitoring&&Q.monitoring&&(Q.monitoring=!1,n.prototype._fireEvent=C)),n},n.prototype._fireEvent=C,n.prototype._execute=function(e,t,n){try{e(t,n)}catch(e){return e}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(e){},n.prototype._attachCancellationCallback=function(e){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(e,t){};var $=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)};function D(){var e=this._boundTo;return void 0!==e&&e instanceof n?e.isFulfilled()?e.value():void 0:e}function L(){this._trace=new q(this._peekContext())}function F(e,t){if(d(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var i=H(e);u.notEnumerableProp(e,"stack",i.message+"\n"+i.stack.join("\n")),u.notEnumerableProp(e,"__stackCleaned__",!0)}}}function N(e,t,i){if(Q.warnings){var o,r=new c(e);if(t)i._attachExtraTrace(r);else if(Q.longStackTraces&&(o=n._peekContext()))o.attachExtraTrace(r);else{var a=H(r);r.stack=a.message+"\n"+a.stack.join("\n")}T("warning",r)||W(r,"",!0)}}function j(e){for(var t=[],n=0;n<e.length;++n){var i=e[n],o="    (No stack trace)"===i||g.test(i),r=o&&Y(i);o&&!r&&(v&&" "!==i.charAt(0)&&(i="    "+i),t.push(i))}return t}function H(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var i=t[n];if("    (No stack trace)"===i||g.test(i))break}return n>0&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:j(t)}}function W(e,t,n){if("undefined"!=typeof console){var i;if(u.isObject(e)){var o=e.stack;i=t+m(o,e)}else i=t+String(e);"function"==typeof a?a(i,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(i)}}function G(e,t,n,i){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(i):t(n,i))}catch(e){l.throwLater(e)}"unhandledRejection"===e?T(e,n,i)||o||W(n,"Unhandled rejection "):T(e,i)}function U(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():u.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+function(e){return e.length<41?e:e.substr(0,38)+"..."}(t)+">, no stack trace)"}function V(){return"function"==typeof z}var Y=function(){return!1},X=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function K(e){var t=e.match(X);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function q(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);z(this,q),t>32&&this.uncycle()}u.inherits(q,Error),i.CapturedTrace=q,q.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},i=0,o=this;void 0!==o;++i)t.push(o),o=o._parent;for(i=(e=this._length=i)-1;i>=0;--i){var r=t[i].stack;void 0===n[r]&&(n[r]=i)}for(i=0;i<e;++i){var a=n[t[i].stack];if(void 0!==a&&a!==i){a>0&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[i]._parent=void 0,t[i]._length=1;var s=i>0?t[i-1]:this;a<e-1?(s._parent=t[a+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var l=s._length+1,c=i-2;c>=0;--c)t[c]._length=l,l++;return}}}},q.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=H(e),n=t.message,i=[t.stack],o=this;void 0!==o;)i.push(j(o.stack.split("\n"))),o=o._parent;!function(e){for(var t=e[0],n=1;n<e.length;++n){for(var i=e[n],o=t.length-1,r=t[o],a=-1,s=i.length-1;s>=0;--s)if(i[s]===r){a=s;break}for(s=a;s>=0;--s){var l=i[s];if(t[o]!==l)break;t.pop(),o--}t=i}}(i),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(i),u.notEnumerableProp(e,"stack",function(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}(n,i)),u.notEnumerableProp(e,"__stackCleaned__",!0)}};var z=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():U(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,g=e,m=t;var n=Error.captureStackTrace;return Y=function(e){return p.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var i,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return g=/@/,m=t,v=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){i="stack"in e}return"stack"in o||!i||"number"!=typeof Error.stackTraceLimit?(m=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?U(t):t.toString()},null):(g=e,m=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(a=function(e){console.warn(e)},u.isNode&&t.stderr.isTTY?a=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:u.isNode||"string"!=typeof(new Error).stack||(a=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var Q={warnings:y,longStackTraces:!1,cancellation:!1,monitoring:!1};return b&&n.longStackTraces(),{longStackTraces:function(){return Q.longStackTraces},warnings:function(){return Q.warnings},cancellation:function(){return Q.cancellation},monitoring:function(){return Q.monitoring},propagateFromFunction:function(){return $},boundValueFunction:function(){return D},checkForgottenReturns:function(e,t,n,i,o){if(void 0===e&&null!==t&&k){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&i._bitField))return;n&&(n+=" ");var r="",a="";if(t._trace){for(var s=t._trace.stack.split("\n"),l=j(s),c=l.length-1;c>=0;--c){var u=l[c];if(!h.test(u)){var d=u.match(f);d&&(r="at "+d[1]+":"+d[2]+":"+d[3]+" ");break}}if(l.length>0){var p=l[0];for(c=0;c<s.length;++c)if(s[c]===p){c>0&&(a="\n"+s[c-1]);break}}}var g="a promise was created in a "+n+"handler "+r+"but was not returned from it, see http://goo.gl/rRqMUw"+a;i._warn(g,!0,t)}},setBounds:function(e,t){if(V()){for(var n,i,o=e.stack.split("\n"),r=t.stack.split("\n"),a=-1,s=-1,l=0;l<o.length;++l)if(c=K(o[l])){n=c.fileName,a=c.line;break}for(l=0;l<r.length;++l){var c;if(c=K(r[l])){i=c.fileName,s=c.line;break}}a<0||s<0||!n||!i||n!==i||a>=s||(Y=function(e){if(p.test(e))return!0;var t=K(e);return!!(t&&t.fileName===n&&a<=t.line&&t.line<=s)})}},warn:N,deprecated:function(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),N(n)},CapturedTrace:q,fireDomEvent:w,fireGlobalEvent:E}}},{"./errors":12,"./util":36}],10:[function(e,t,n){"use strict";t.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,(function(){throw t}))},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var i=arguments[1];return i instanceof e&&i.suppressUnhandledRejections(),this.caught(n,(function(){return i}))}}},{}],11:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.reduce,i=e.all;function o(){return i(this)}e.prototype.each=function(e){return n(this,e,t,0)._then(o,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return n(this,e,t,t)},e.each=function(e,i){return n(e,i,t,0)._then(o,void 0,void 0,e,void 0)},e.mapSeries=function(e,i){return n(e,i,t,t)}}},{}],12:[function(e,t,n){"use strict";var i,o,r=e("./es5"),a=r.freeze,s=e("./util"),l=s.inherits,c=s.notEnumerableProp;function u(e,t){function n(i){if(!(this instanceof n))return new n(i);c(this,"message","string"==typeof i?i:t),c(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return l(n,Error),n}var d=u("Warning","warning"),p=u("CancellationError","cancellation error"),h=u("TimeoutError","timeout error"),f=u("AggregateError","aggregate error");try{i=TypeError,o=RangeError}catch(e){i=u("TypeError","type error"),o=u("RangeError","range error")}for(var g="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<g.length;++m)"function"==typeof Array.prototype[g[m]]&&(f.prototype[g[m]]=Array.prototype[g[m]]);r.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var v=0;function _(e){if(!(this instanceof _))return new _(e);c(this,"name","OperationalError"),c(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(c(this,"message",e.message),c(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}f.prototype.toString=function(){var e=Array(4*v+1).join(" "),t="\n"+e+"AggregateError of:\n";v++,e=Array(4*v+1).join(" ");for(var n=0;n<this.length;++n){for(var i=this[n]===this?"[Circular AggregateError]":this[n]+"",o=i.split("\n"),r=0;r<o.length;++r)o[r]=e+o[r];t+=(i=o.join("\n"))+"\n"}return v--,t},l(_,Error);var y=Error.__BluebirdErrorTypes__;y||(y=a({CancellationError:p,TimeoutError:h,OperationalError:_,RejectionError:_,AggregateError:f}),r.defineProperty(Error,"__BluebirdErrorTypes__",{value:y,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:i,RangeError:o,CancellationError:y.CancellationError,OperationalError:y.OperationalError,TimeoutError:y.TimeoutError,AggregateError:y.AggregateError,Warning:d}},{"./es5":13,"./util":36}],13:[function(e,t,n){var i=function(){"use strict";return void 0===this}();if(i)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,r={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t};t.exports={isArray:function(e){try{return"[object Array]"===r.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,t,n){return e[t]=n.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return a}},isES5:i,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,i){return n(this,e,i,t)},e.filter=function(e,i,o){return n(e,i,o,t)}}},{}],15:[function(e,t,n){"use strict";t.exports=function(t,n,i){var o=e("./util"),r=t.CancellationError,a=o.errorObj,s=e("./catch_filter")(i);function l(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function c(e){this.finallyHandler=e}function u(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function d(){return h.call(this,this.promise._target()._settledValue())}function p(e){if(!u(this,e))return a.e=e,a}function h(e){var o=this.promise,s=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?s.call(o._boundValue()):s.call(o._boundValue(),e);if(l===i)return l;if(void 0!==l){o._setReturnedNonUndefined();var h=n(l,o);if(h instanceof t){if(null!=this.cancelPromise){if(h._isCancelled()){var f=new r("late cancellation observer");return o._attachExtraTrace(f),a.e=f,a}h.isPending()&&h._attachCancellationCallback(new c(this))}return h._then(d,p,void 0,this,void 0)}}}return o.isRejected()?(u(this),a.e=e,a):(u(this),e)}return l.prototype.isFinallyHandler=function(){return 0===this.type},c.prototype._resultCancelled=function(){u(this.finallyHandler)},t.prototype._passThrough=function(e,t,n,i){return"function"!=typeof e?this.then():this._then(n,i,void 0,new l(this,t,e),void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThrough(e,0,h,h)},t.prototype.tap=function(e){return this._passThrough(e,1,h)},t.prototype.tapCatch=function(e){var n=arguments.length;if(1===n)return this._passThrough(e,1,void 0,h);var i,r=new Array(n-1),a=0;for(i=0;i<n-1;++i){var l=arguments[i];if(!o.isObject(l))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+o.classString(l)));r[a++]=l}r.length=a;var c=arguments[i];return this._passThrough(s(r,c,this),1,void 0,h)},l}},{"./catch_filter":7,"./util":36}],16:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r,a){var s=e("./errors").TypeError,l=e("./util"),c=l.errorObj,u=l.tryCatch,d=[];function p(e,n,o,r){if(a.cancellation()){var s=new t(i),l=this._finallyPromise=new t(i);this._promise=s.lastly((function(){return l})),s._captureStackTrace(),s._setOnCancel(this)}else(this._promise=new t(i))._captureStackTrace();this._stack=r,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(d):d,this._yieldedPromise=null,this._cancellationPhase=!1}l.inherits(p,r),p.prototype._isResolved=function(){return null===this._promise},p.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},p.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if(void 0!==this._generator.return)this._promise._pushContext(),e=u(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),e=u(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},p.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=u(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},p.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=u(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},p.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},p.prototype.promise=function(){return this._promise},p.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},p.prototype._continue=function(e){var n=this._promise;if(e===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(e.e,!1);var i=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(i);var r=o(i,this._promise);if(r instanceof t||null!==(r=function(e,n,i){for(var r=0;r<n.length;++r){i._pushContext();var a=u(n[r])(e);if(i._popContext(),a===c){i._pushContext();var s=t.reject(c.e);return i._popContext(),s}var l=o(a,i);if(l instanceof t)return l}return null}(r,this._yieldHandlers,this._promise))){var a=(r=r._target())._bitField;0==(50397184&a)?(this._yieldedPromise=r,r._proxy(this,null)):0!=(33554432&a)?t._async.invoke(this._promiseFulfilled,this,r._value()):0!=(16777216&a)?t._async.invoke(this._promiseRejected,this,r._reason()):this._promiseCancelled()}else this._promiseRejected(new s("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(i))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},t.coroutine=function(e,t){if("function"!=typeof e)throw new s("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,i=p,o=(new Error).stack;return function(){var t=e.apply(this,arguments),r=new i(void 0,void 0,n,o),a=r.promise();return r._generator=t,r._promiseFulfilled(void 0),a}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new s("expecting a function but got "+l.classString(e));d.push(e)},t.spawn=function(e){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=new p(e,this),o=i.promise();return i._run(t.spawn),o}}},{"./errors":12,"./util":36}],17:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r,a){var s=e("./util");s.canEvaluate,s.tryCatch,s.errorObj,t.join=function(){var e,t=arguments.length-1;t>0&&"function"==typeof arguments[t]&&(e=arguments[t]);var i=[].slice.call(arguments);e&&i.pop();var o=new n(i).promise();return void 0!==e?o.spread(e):o}}},{"./util":36}],18:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r,a){var s=t._getDomain,l=e("./util"),c=l.tryCatch,u=l.errorObj,d=t._async;function p(e,t,n,i){this.constructor$(e),this._promise._captureStackTrace();var o=s();this._callback=null===o?t:l.domainBind(o,t),this._preservedValues=i===r?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}function h(e,n,o,r){if("function"!=typeof n)return i("expecting a function but got "+l.classString(n));var a=0;if(void 0!==o){if("object"!=typeof o||null===o)return t.reject(new TypeError("options argument must be an object but it is "+l.classString(o)));if("number"!=typeof o.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+l.classString(o.concurrency)));a=o.concurrency}return new p(e,n,a="number"==typeof a&&isFinite(a)&&a>=1?a:0,r).promise()}l.inherits(p,n),p.prototype._asyncInit=function(){this._init$(void 0,-2)},p.prototype._init=function(){},p.prototype._promiseFulfilled=function(e,n){var i=this._values,r=this.length(),s=this._preservedValues,l=this._limit;if(n<0){if(i[n=-1*n-1]=e,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return i[n]=e,this._queue.push(n),!1;null!==s&&(s[n]=e);var d=this._promise,p=this._callback,h=d._boundValue();d._pushContext();var f=c(p).call(h,e,n,r),g=d._popContext();if(a.checkForgottenReturns(f,g,null!==s?"Promise.filter":"Promise.map",d),f===u)return this._reject(f.e),!0;var m=o(f,this._promise);if(m instanceof t){var v=(m=m._target())._bitField;if(0==(50397184&v))return l>=1&&this._inFlight++,i[n]=m,m._proxy(this,-1*(n+1)),!1;if(0==(33554432&v))return 0!=(16777216&v)?(this._reject(m._reason()),!0):(this._cancel(),!0);f=m._value()}i[n]=f}return++this._totalResolved>=r&&(null!==s?this._filter(i,s):this._resolve(i),!0)},p.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var i=e.pop();this._promiseFulfilled(n[i],i)}},p.prototype._filter=function(e,t){for(var n=t.length,i=new Array(n),o=0,r=0;r<n;++r)e[r]&&(i[o++]=t[r]);i.length=o,this._resolve(i)},p.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return h(this,e,t,null)},t.map=function(e,t,n,i){return h(e,t,n,i)}}},{"./util":36}],19:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r){var a=e("./util"),s=a.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+a.classString(e));return function(){var i=new t(n);i._captureStackTrace(),i._pushContext();var o=s(e).apply(this,arguments),a=i._popContext();return r.checkForgottenReturns(o,a,"Promise.method",i),i._resolveFromSyncValue(o),i}},t.attempt=t.try=function(e){if("function"!=typeof e)return o("expecting a function but got "+a.classString(e));var i,l=new t(n);if(l._captureStackTrace(),l._pushContext(),arguments.length>1){r.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],u=arguments[2];i=a.isArray(c)?s(e).apply(u,c):s(e).call(u,c)}else i=s(e)();var d=l._popContext();return r.checkForgottenReturns(i,d,"Promise.try",l),l._resolveFromSyncValue(i),l},t.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,n){"use strict";var i=e("./util"),o=i.maybeWrapAsError,r=e("./errors").OperationalError,a=e("./es5"),s=/^(?:name|message|stack|cause)$/;function l(e){var t;if(function(e){return e instanceof Error&&a.getPrototypeOf(e)===Error.prototype}(e)){(t=new r(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var n=a.keys(e),o=0;o<n.length;++o){var l=n[o];s.test(l)||(t[l]=e[l])}return t}return i.markAsOriginatingFromRejection(e),e}t.exports=function(e,t){return function(n,i){if(null!==e){if(n){var r=l(o(n));e._attachExtraTrace(r),e._reject(r)}else if(t){var a=[].slice.call(arguments,1);e._fulfill(a)}else e._fulfill(i);e=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./util"),i=t._async,o=n.tryCatch,r=n.errorObj;function a(e,t){if(!n.isArray(e))return s.call(this,e,t);var a=o(t).apply(this._boundValue(),[null].concat(e));a===r&&i.throwLater(a.e)}function s(e,t){var n=this._boundValue(),a=void 0===e?o(t).call(n,null):o(t).call(n,null,e);a===r&&i.throwLater(a.e)}function l(e,t){if(!e){var n=new Error(e+"");n.cause=e,e=n}var a=o(t).call(this._boundValue(),e);a===r&&i.throwLater(a.e)}t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var n=s;void 0!==t&&Object(t).spread&&(n=a),this._then(n,l,void 0,this,e)}return this}}},{"./util":36}],22:[function(e,n,i){"use strict";n.exports=function(){var i=function(){return new f("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},o=function(){return new M.PromiseInspection(this._target())},r=function(e){return M.reject(new f(e))};function a(){}var s,l={},c=e("./util");s=c.isNode?function(){var e=t.domain;return void 0===e&&(e=null),e}:function(){return null},c.notEnumerableProp(M,"_getDomain",s);var u=e("./es5"),d=e("./async"),p=new d;u.defineProperty(M,"_async",{value:p});var h=e("./errors"),f=M.TypeError=h.TypeError;M.RangeError=h.RangeError;var g=M.CancellationError=h.CancellationError;M.TimeoutError=h.TimeoutError,M.OperationalError=h.OperationalError,M.RejectionError=h.OperationalError,M.AggregateError=h.AggregateError;var m=function(){},v={},_={},y=e("./thenables")(M,m),b=e("./promise_array")(M,m,y,r,a),k=e("./context")(M),S=k.create,w=e("./debuggability")(M,k),E=(w.CapturedTrace,e("./finally")(M,y,_)),x=e("./catch_filter")(_),I=e("./nodeback"),T=c.errorObj,C=c.tryCatch;function M(e){e!==m&&function(e,t){if(null==e||e.constructor!==M)throw new f("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new f("expecting a function but got "+c.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function P(e){this.promise._resolveCallback(e)}function A(e){this.promise._rejectCallback(e,!1)}function O(e){var t=new M(m);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return M.prototype.toString=function(){return"[object Promise]"},M.prototype.caught=M.prototype.catch=function(e){var t=arguments.length;if(t>1){var n,i=new Array(t-1),o=0;for(n=0;n<t-1;++n){var a=arguments[n];if(!c.isObject(a))return r("Catch statement predicate: expecting an object but got "+c.classString(a));i[o++]=a}return i.length=o,e=arguments[n],this.then(void 0,x(i,e,this))}return this.then(void 0,e)},M.prototype.reflect=function(){return this._then(o,o,void 0,this,void 0)},M.prototype.then=function(e,t){if(w.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+c.classString(e);arguments.length>1&&(n+=", "+c.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},M.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},M.prototype.spread=function(e){return"function"!=typeof e?r("expecting a function but got "+c.classString(e)):this.all()._then(e,void 0,void 0,v,void 0)},M.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},M.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new b(this).promise()},M.prototype.error=function(e){return this.caught(c.originatesFromRejection,e)},M.getNewLibraryCopy=n.exports,M.is=function(e){return e instanceof M},M.fromNode=M.fromCallback=function(e){var t=new M(m);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=C(e)(I(t,n));return i===T&&t._rejectCallback(i.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},M.all=function(e){return new b(e).promise()},M.cast=function(e){var t=y(e);return t instanceof M||((t=new M(m))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},M.resolve=M.fulfilled=M.cast,M.reject=M.rejected=function(e){var t=new M(m);return t._captureStackTrace(),t._rejectCallback(e,!0),t},M.setScheduler=function(e){if("function"!=typeof e)throw new f("expecting a function but got "+c.classString(e));return p.setScheduler(e)},M.prototype._then=function(e,t,n,i,o){var r=void 0!==o,a=r?o:new M(m),l=this._target(),u=l._bitField;r||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===i&&0!=(2097152&this._bitField)&&(i=0!=(50397184&u)?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var d=s();if(0!=(50397184&u)){var h,f,v=l._settlePromiseCtx;0!=(33554432&u)?(f=l._rejectionHandler0,h=e):0!=(16777216&u)?(f=l._fulfillmentHandler0,h=t,l._unsetRejectionIsUnhandled()):(v=l._settlePromiseLateCancellationObserver,f=new g("late cancellation observer"),l._attachExtraTrace(f),h=t),p.invoke(v,l,{handler:null===d?h:"function"==typeof h&&c.domainBind(d,h),promise:a,receiver:i,value:f})}else l._addCallbacks(e,t,a,i,d);return a},M.prototype._length=function(){return 65535&this._bitField},M.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},M.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},M.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},M.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},M.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},M.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},M.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},M.prototype._isFinal=function(){return(4194304&this._bitField)>0},M.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},M.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},M.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},M.prototype._setAsyncGuaranteed=function(){p.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},M.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==l)return void 0===t&&this._isBound()?this._boundValue():t},M.prototype._promiseAt=function(e){return this[4*e-4+2]},M.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},M.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},M.prototype._boundValue=function(){},M.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,n=e._rejectionHandler0,i=e._promise0,o=e._receiverAt(0);void 0===o&&(o=l),this._addCallbacks(t,n,i,o,null)},M.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),i=e._rejectionHandlerAt(t),o=e._promiseAt(t),r=e._receiverAt(t);void 0===r&&(r=l),this._addCallbacks(n,i,o,r,null)},M.prototype._addCallbacks=function(e,t,n,i,o){var r=this._length();if(r>=65531&&(r=0,this._setLength(0)),0===r)this._promise0=n,this._receiver0=i,"function"==typeof e&&(this._fulfillmentHandler0=null===o?e:c.domainBind(o,e)),"function"==typeof t&&(this._rejectionHandler0=null===o?t:c.domainBind(o,t));else{var a=4*r-4;this[a+2]=n,this[a+3]=i,"function"==typeof e&&(this[a+0]=null===o?e:c.domainBind(o,e)),"function"==typeof t&&(this[a+1]=null===o?t:c.domainBind(o,t))}return this._setLength(r+1),r},M.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},M.prototype._resolveCallback=function(e,t){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(i(),!1);var n=y(e,this);if(!(n instanceof M))return this._fulfill(e);t&&this._propagateFrom(n,2);var o=n._target();if(o!==this){var r=o._bitField;if(0==(50397184&r)){var a=this._length();a>0&&o._migrateCallback0(this);for(var s=1;s<a;++s)o._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(o)}else if(0!=(33554432&r))this._fulfill(o._value());else if(0!=(16777216&r))this._reject(o._reason());else{var l=new g("late cancellation observer");o._attachExtraTrace(l),this._reject(l)}}else this._reject(i())}},M.prototype._rejectCallback=function(e,t,n){var i=c.ensureErrorObject(e),o=i===e;if(!o&&!n&&w.warnings()){var r="a promise was rejected with a non-error: "+c.classString(e);this._warn(r,!0)}this._attachExtraTrace(i,!!t&&o),this._reject(e)},M.prototype._resolveFromExecutor=function(e){if(e!==m){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,i=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,n)}));n=!1,this._popContext(),void 0!==i&&t._rejectCallback(i,!0)}},M.prototype._settlePromiseFromHandler=function(e,t,n,i){var o=i._bitField;if(0==(65536&o)){var r;i._pushContext(),t===v?n&&"number"==typeof n.length?r=C(e).apply(this._boundValue(),n):(r=T).e=new f("cannot .spread() a non-array: "+c.classString(n)):r=C(e).call(t,n);var a=i._popContext();0==(65536&(o=i._bitField))&&(r===_?i._reject(n):r===T?i._rejectCallback(r.e,!1):(w.checkForgottenReturns(r,a,"",i,this),i._resolveCallback(r)))}},M.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},M.prototype._followee=function(){return this._rejectionHandler0},M.prototype._setFollowee=function(e){this._rejectionHandler0=e},M.prototype._settlePromise=function(e,t,n,i){var r=e instanceof M,s=this._bitField,l=0!=(134217728&s);0!=(65536&s)?(r&&e._invokeInternalOnCancel(),n instanceof E&&n.isFinallyHandler()?(n.cancelPromise=e,C(t).call(n,i)===T&&e._reject(T.e)):t===o?e._fulfill(o.call(n)):n instanceof a?n._promiseCancelled(e):r||e instanceof b?e._cancel():n.cancel()):"function"==typeof t?r?(l&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,n,i,e)):t.call(n,i,e):n instanceof a?n._isResolved()||(0!=(33554432&s)?n._promiseFulfilled(i,e):n._promiseRejected(i,e)):r&&(l&&e._setAsyncGuaranteed(),0!=(33554432&s)?e._fulfill(i):e._reject(i))},M.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,i=e.receiver,o=e.value;"function"==typeof t?n instanceof M?this._settlePromiseFromHandler(t,i,o,n):t.call(i,o,n):n instanceof M&&n._reject(o)},M.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},M.prototype._settlePromise0=function(e,t,n){var i=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(i,e,o,t)},M.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},M.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var n=i();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!=(134217728&t)?this._settlePromises():p.settlePromises(this))}},M.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return p.fatalError(e,c.isNode);(65535&t)>0?p.settlePromises(this):this._ensurePossibleRejectionHandled()}},M.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var i=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),r=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,i,r,t)}},M.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var i=this._rejectionHandlerAt(n),o=this._promiseAt(n),r=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,i,r,t)}},M.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var i=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,i,e),this._fulfillPromises(t,i)}this._setLength(0)}this._clearCancellationData()},M.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},M.defer=M.pending=function(){return w.deprecated("Promise.defer","new Promise"),{promise:new M(m),resolve:P,reject:A}},c.notEnumerableProp(M,"_makeSelfResolutionError",i),e("./method")(M,m,y,r,w),e("./bind")(M,m,y,w),e("./cancel")(M,b,r,w),e("./direct_resolve")(M),e("./synchronous_inspection")(M),e("./join")(M,b,y,m,p,s),M.Promise=M,M.version="3.5.1",e("./map.js")(M,b,r,y,m,w),e("./call_get.js")(M),e("./using.js")(M,r,y,S,m,w),e("./timers.js")(M,m,w),e("./generators.js")(M,r,m,y,a,w),e("./nodeify.js")(M),e("./promisify.js")(M,m),e("./props.js")(M,b,y,r),e("./race.js")(M,m,y,r),e("./reduce.js")(M,b,r,y,m,w),e("./settle.js")(M,b,w),e("./some.js")(M,b,r),e("./filter.js")(M,m),e("./each.js")(M,m),e("./any.js")(M),c.toFastProperties(M),c.toFastProperties(M.prototype),O({a:1}),O({b:2}),O({c:3}),O(1),O((function(){})),O(void 0),O(!1),O(new M(m)),w.setBounds(d.firstLineError,c.lastLineError),M}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r){var a=e("./util");function s(e){var i=this._promise=new t(n);e instanceof t&&i._propagateFrom(e,3),i._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return a.isArray,a.inherits(s,r),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function e(n,r){var s=i(this._values,this._promise);if(s instanceof t){var l=(s=s._target())._bitField;if(this._values=s,0==(50397184&l))return this._promise._setAsyncGuaranteed(),s._then(e,this._reject,void 0,this,r);if(0==(33554432&l))return 0!=(16777216&l)?this._reject(s._reason()):this._cancel();s=s._value()}if(null!==(s=a.asArray(s)))0!==s.length?this._iterate(s):-5===r?this._resolveEmptyArray():this._resolve(function(e){switch(r){case-2:return[];case-3:return{};case-6:return new Map}}());else{var c=o("expecting an array or an iterable object but got "+a.classString(s)).reason();this._promise._rejectCallback(c,!1)}},s.prototype._iterate=function(e){var n=this.getActualLength(e.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,r=!1,a=null,s=0;s<n;++s){var l=i(e[s],o);a=l instanceof t?(l=l._target())._bitField:null,r?null!==a&&l.suppressUnhandledRejections():null!==a?0==(50397184&a)?(l._proxy(this,s),this._values[s]=l):r=0!=(33554432&a)?this._promiseFulfilled(l._value(),s):0!=(16777216&a)?this._promiseRejected(l._reason(),s):this._promiseCancelled(s):r=this._promiseFulfilled(l,s)}r||o._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var n=0;n<e.length;++n)e[n]instanceof t&&e[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}},{"./util":36}],24:[function(e,t,n){"use strict";t.exports=function(t,n){var i={},o=e("./util"),r=e("./nodeback"),a=o.withAppended,s=o.maybeWrapAsError,l=o.canEvaluate,c=e("./errors").TypeError,u={__isPromisified__:!0},d=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),p=function(e){return o.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function h(e){return!d.test(e)}function f(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function g(e,t,n){var i=o.getDataPropertyOrDefault(e,t+n,u);return!!i&&f(i)}function m(e,t,n,i){for(var r=o.inheritedDataKeys(e),a=[],s=0;s<r.length;++s){var l=r[s],u=e[l],d=i===p||p(l);"function"!=typeof u||f(u)||g(e,l,t)||!i(l,u,e,d)||a.push(l,u)}return function(e,t,n){for(var i=0;i<e.length;i+=2){var o=e[i];if(n.test(o))for(var r=o.replace(n,""),a=0;a<e.length;a+=2)if(e[a]===r)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}(a,t,n),a}var v=l?void 0:function(e,l,c,u,d,p){var h=function(){return this}(),f=e;function g(){var o=l;l===i&&(o=this);var c=new t(n);c._captureStackTrace();var u="string"==typeof f&&this!==h?this[f]:e,d=r(c,p);try{u.apply(o,a(arguments,d))}catch(e){c._rejectCallback(s(e),!0,!0)}return c._isFateSealed()||c._setAsyncGuaranteed(),c}return"string"==typeof f&&(e=u),o.notEnumerableProp(g,"__isPromisified__",!0),g};function _(e,t,n,r,a){for(var s=new RegExp(function(e){return e.replace(/([$])/,"\\$")}(t)+"$"),l=m(e,t,s,n),c=0,u=l.length;c<u;c+=2){var d=l[c],p=l[c+1],h=d+t;if(r===v)e[h]=v(d,i,d,p,t,a);else{var f=r(p,(function(){return v(d,i,d,p,t,a)}));o.notEnumerableProp(f,"__isPromisified__",!0),e[h]=f}}return o.toFastProperties(e),e}t.promisify=function(e,t){if("function"!=typeof e)throw new c("expecting a function but got "+o.classString(e));if(f(e))return e;var n=void 0===(t=Object(t)).context?i:t.context,r=!!t.multiArgs,a=function(e,t,n){return v(e,t,void 0,e,null,r)}(e,n);return o.copyDescriptors(e,a,h),a},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(t=Object(t)).multiArgs,i=t.suffix;"string"!=typeof i&&(i="Async");var r=t.filter;"function"!=typeof r&&(r=p);var a=t.promisifier;if("function"!=typeof a&&(a=v),!o.isIdentifier(i))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=o.inheritedDataKeys(e),l=0;l<s.length;++l){var u=e[s[l]];"constructor"!==s[l]&&o.isClass(u)&&(_(u.prototype,i,r,a,n),_(u,i,r,a,n))}return _(e,i,r,a,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r,a=e("./util"),s=a.isObject,l=e("./es5");"function"==typeof Map&&(r=Map);var c=function(){var e=0,t=0;function n(n,i){this[e]=n,this[e+t]=i,e++}return function(i){t=i.size,e=0;var o=new Array(2*i.size);return i.forEach(n,o),o}}();function u(e){var t,n=!1;if(void 0!==r&&e instanceof r)t=c(e),n=!0;else{var i=l.keys(e),o=i.length;t=new Array(2*o);for(var a=0;a<o;++a){var s=i[a];t[a]=e[s],t[a+o]=s}}this.constructor$(t),this._isMap=n,this._init$(void 0,n?-6:-3)}function d(e){var n,r=i(e);return s(r)?(n=r instanceof t?r._then(t.props,void 0,void 0,void 0,void 0):new u(r).promise(),r instanceof t&&n._propagateFrom(r,2),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}a.inherits(u,n),u.prototype._init=function(){},u.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(e){for(var t=new r,n=e.length/2|0,i=0;i<n;++i){var o=e[n+i],a=e[i];t.set(o,a)}return t}(this._values);else{n={};for(var i=this.length(),o=0,a=this.length();o<a;++o)n[this._values[o+i]]=this._values[o]}return this._resolve(n),!0}return!1},u.prototype.shouldCopyValues=function(){return!1},u.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return d(this)},t.props=function(e){return d(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,n){"use strict";function i(e){this._capacity=e,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(e){return this._capacity<e},i.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},i.prototype.push=function(e,t,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var o=this._front+i-3;this._checkCapacity(i);var r=this._capacity-1;this[o+0&r]=e,this[o+1&r]=t,this[o+2&r]=n,this._length=i},i.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,n,i,o){for(var r=0;r<o;++r)n[r+i]=e[r+0],e[r+0]=void 0}(this,0,this,t,this._front+this._length&t-1)},t.exports=i},{}],27:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./util"),a=function(e){return e.then((function(t){return s(t,e)}))};function s(e,s){var l=i(e);if(l instanceof t)return a(l);if(null===(e=r.asArray(e)))return o("expecting an array or an iterable object but got "+r.classString(e));var c=new t(n);void 0!==s&&c._propagateFrom(s,3);for(var u=c._fulfill,d=c._reject,p=0,h=e.length;p<h;++p){var f=e[p];(void 0!==f||p in e)&&t.cast(f)._then(u,d,void 0,c,null)}return c}t.race=function(e){return s(e,void 0)},t.prototype.race=function(){return s(this,void 0)}}},{"./util":36}],28:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r,a){var s=t._getDomain,l=e("./util"),c=l.tryCatch;function u(e,n,i,o){this.constructor$(e);var a=s();this._fn=null===a?n:l.domainBind(a,n),void 0!==i&&(i=t.resolve(i))._attachCancellationCallback(this),this._initialValue=i,this._currentCancellable=null,this._eachValues=o===r?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function d(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function p(e,t,n,o){return"function"!=typeof t?i("expecting a function but got "+l.classString(t)):new u(e,t,n,o).promise()}function h(e){this.accum=e,this.array._gotAccum(e);var n=o(this.value,this.array._promise);return n instanceof t?(this.array._currentCancellable=n,n._then(f,void 0,void 0,this,void 0)):f.call(this,n)}function f(e){var n,i=this.array,o=i._promise,r=c(i._fn);o._pushContext(),(n=void 0!==i._eachValues?r.call(o._boundValue(),e,this.index,this.length):r.call(o._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(i._currentCancellable=n);var s=o._popContext();return a.checkForgottenReturns(n,s,void 0!==i._eachValues?"Promise.each":"Promise.reduce",o),n}l.inherits(u,n),u.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==r&&this._eachValues.push(e)},u.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},u.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},u.prototype._iterate=function(e){var n,i;this._values=e;var o=e.length;if(void 0!==this._initialValue?(n=this._initialValue,i=0):(n=t.resolve(e[0]),i=1),this._currentCancellable=n,!n.isRejected())for(;i<o;++i){var r={accum:null,value:e[i],index:i,length:o,array:this};n=n._then(h,void 0,void 0,r,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(d,d,void 0,n,this)},t.prototype.reduce=function(e,t){return p(this,e,t,null)},t.reduce=function(e,t,n,i){return p(e,t,n,i)}}},{"./util":36}],29:[function(e,o,r){"use strict";var a,s=e("./util"),l=s.getNativePromise();if(s.isNode&&"undefined"==typeof MutationObserver){var c=n.setImmediate,u=t.nextTick;a=s.isRecentNode?function(e){c.call(n,e)}:function(e){u.call(t,e)}}else if("function"==typeof l&&"function"==typeof l.resolve){var d=l.resolve();a=function(e){d.then(e)}}else a="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?void 0!==i?function(e){i(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var e=document.createElement("div"),t={attributes:!0},n=!1,i=document.createElement("div");return new MutationObserver((function(){e.classList.toggle("foo"),n=!1})).observe(i,t),function(o){var r=new MutationObserver((function(){r.disconnect(),o()}));r.observe(e,t),n||(n=!0,i.classList.toggle("foo"))}}();o.exports=a},{"./util":36}],30:[function(e,t,n){"use strict";t.exports=function(t,n,i){var o=t.PromiseInspection;function r(e){this.constructor$(e)}e("./util").inherits(r,n),r.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},r.prototype._promiseFulfilled=function(e,t){var n=new o;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},r.prototype._promiseRejected=function(e,t){var n=new o;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},t.settle=function(e){return i.deprecated(".settle()",".reflect()"),new r(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,n){"use strict";t.exports=function(t,n,i){var o=e("./util"),r=e("./errors").RangeError,a=e("./errors").AggregateError,s=o.isArray,l={};function c(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function u(e,t){if((0|t)!==t||t<0)return i("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new c(e),o=n.promise();return n.setHowMany(t),n.init(),o}o.inherits(c,n),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=s(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(e){this._howMany=e},c.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new a,t=this.length();t<this._values.length;++t)this._values[t]!==l&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(e){this._values.push(e)},c.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new r(t)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return u(e,t)},t.prototype.some=function(e){return u(this,e)},t._SomePromiseArray=c}},{"./errors":12,"./util":36}],32:[function(e,t,n){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},r=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return r.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),i.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,n){"use strict";t.exports=function(t,n){var i=e("./util"),o=i.errorObj,r=i.isObject,a={}.hasOwnProperty;return function(e,s){if(r(e)){if(e instanceof t)return e;var l=function(e){try{return function(e){return e.then}(e)}catch(e){return o.e=e,o}}(e);if(l===o){s&&s._pushContext();var c=t.reject(l.e);return s&&s._popContext(),c}if("function"==typeof l)return function(e){try{return a.call(e,"_promise0")}catch(e){return!1}}(e)?(c=new t(n),e._then(c._fulfill,c._reject,void 0,c,null),c):function(e,r,a){var s=new t(n),l=s;a&&a._pushContext(),s._captureStackTrace(),a&&a._popContext();var c=!0,u=i.tryCatch(r).call(e,(function(e){s&&(s._resolveCallback(e),s=null)}),(function(e){s&&(s._rejectCallback(e,c,!0),s=null)}));return c=!1,s&&u===o&&(s._rejectCallback(u.e,!0,!0),s=null),l}(e,l,s)}return e}}},{"./util":36}],34:[function(e,t,n){"use strict";t.exports=function(t,n,i){var o=e("./util"),r=t.TimeoutError;function a(e){this.handle=e}a.prototype._resultCancelled=function(){clearTimeout(this.handle)};var s=function(e){return l(+this).thenReturn(e)},l=t.delay=function(e,o){var r,l;return void 0!==o?(r=t.resolve(o)._then(s,null,null,e,void 0),i.cancellation()&&o instanceof t&&r._setOnCancel(o)):(r=new t(n),l=setTimeout((function(){r._fulfill()}),+e),i.cancellation()&&r._setOnCancel(new a(l)),r._captureStackTrace()),r._setAsyncGuaranteed(),r};function c(e){return clearTimeout(this.handle),e}function u(e){throw clearTimeout(this.handle),e}t.prototype.delay=function(e){return l(e,this)},t.prototype.timeout=function(e,t){var n,s;e=+e;var l=new a(setTimeout((function(){n.isPending()&&function(e,t,n){var i;i="string"!=typeof t?t instanceof Error?t:new r("operation timed out"):new r(t),o.markAsOriginatingFromRejection(i),e._attachExtraTrace(i),e._reject(i),null!=n&&n.cancel()}(n,t,s)}),e));return i.cancellation()?(s=this.then(),(n=s._then(c,u,void 0,l,void 0))._setOnCancel(l)):n=this._then(c,u,void 0,l,void 0),n}}},{"./util":36}],35:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r,a){var s=e("./util"),l=e("./errors").TypeError,c=e("./util").inherits,u=s.errorObj,d=s.tryCatch,p={};function h(e){setTimeout((function(){throw e}),0)}function f(e,n){var o=0,a=e.length,s=new t(r);return function r(){if(o>=a)return s._fulfill();var l=function(e){var t=i(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(e[o++]);if(l instanceof t&&l._isDisposable()){try{l=i(l._getDisposer().tryDispose(n),e.promise)}catch(e){return h(e)}if(l instanceof t)return l._then(r,h,null,null,null)}r()}(),s}function g(e,t,n){this._data=e,this._promise=t,this._context=n}function m(e,t,n){this.constructor$(e,t,n)}function v(e){return g.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function _(e){this.length=e,this.promise=null,this[e-1]=null}g.prototype.data=function(){return this._data},g.prototype.promise=function(){return this._promise},g.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():p},g.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var i=t!==p?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,i},g.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},c(m,g),m.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},_.prototype._resultCancelled=function(){for(var e=this.length,n=0;n<e;++n){var i=this[n];i instanceof t&&i.cancel()}},t.using=function(){var e=arguments.length;if(e<2)return n("you must pass at least 2 arguments to Promise.using");var o,r=arguments[e-1];if("function"!=typeof r)return n("expecting a function but got "+s.classString(r));var l=!0;2===e&&Array.isArray(arguments[0])?(e=(o=arguments[0]).length,l=!1):(o=arguments,e--);for(var c=new _(e),p=0;p<e;++p){var h=o[p];if(g.isDisposer(h)){var m=h;(h=h.promise())._setDisposable(m)}else{var y=i(h);y instanceof t&&(h=y._then(v,null,null,{resources:c,index:p},void 0))}c[p]=h}var b=new Array(c.length);for(p=0;p<b.length;++p)b[p]=t.resolve(c[p]).reflect();var k=t.all(b).then((function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return u.e=n.error(),u;if(!n.isFulfilled())return void k.cancel();e[t]=n.value()}S._pushContext(),r=d(r);var i=l?r.apply(void 0,e):r(e),o=S._popContext();return a.checkForgottenReturns(i,o,"Promise.using",S),i})),S=k.lastly((function(){var e=new t.PromiseInspection(k);return f(c,e)}));return c.promise=S,S._setOnCancel(c),S},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new m(e,this,o());throw new l}}},{"./errors":12,"./util":36}],36:[function(e,i,o){"use strict";var r,a=e("./es5"),s="undefined"==typeof navigator,l={e:{}},c="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:void 0!==this?this:null;function u(){try{var e=r;return r=null,e.apply(this,arguments)}catch(e){return l.e=e,l}}function d(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function p(e,t,n){if(d(e))return e;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return a.defineProperty(e,t,i),e}var h=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(a.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var i=[],o=Object.create(null);null!=e&&!t(e);){var r;try{r=n(e)}catch(e){return i}for(var s=0;s<r.length;++s){var l=r[s];if(!o[l]){o[l]=!0;var c=Object.getOwnPropertyDescriptor(e,l);null!=c&&null==c.get&&null==c.set&&i.push(l)}}e=a.getPrototypeOf(e)}return i}}var i={}.hasOwnProperty;return function(n){if(t(n))return[];var o=[];e:for(var r in n)if(i.call(n,r))o.push(r);else{for(var a=0;a<e.length;++a)if(i.call(e[a],r))continue e;o.push(r)}return o}}(),f=/this\s*\.\s*\S+\s*=/,g=/^[a-z$_][a-z$_0-9]*$/i;function m(e){try{return e+""}catch(e){return"[no string representation]"}}function v(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function _(e){return v(e)&&a.propertyIsWritable(e,"stack")}var y="stack"in new Error?function(e){return _(e)?e:new Error(m(e))}:function(e){if(_(e))return e;try{throw new Error(m(e))}catch(e){return e}};function b(e){return{}.toString.call(e)}var k=function(e){return a.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var S="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],i=e[Symbol.iterator]();!(t=i.next()).done;)n.push(t.value);return n};k=function(e){return a.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?S(e):null}}var w=void 0!==t&&"[object process]"===b(t).toLowerCase(),E=void 0!==t&&void 0!==t.env,x={isClass:function(e){try{if("function"==typeof e){var t=a.names(e.prototype),n=a.isES5&&t.length>1,i=t.length>0&&!(1===t.length&&"constructor"===t[0]),o=f.test(e+"")&&a.names(e).length>0;if(n||i||o)return!0}return!1}catch(e){return!1}},isIdentifier:function(e){return g.test(e)},inheritedDataKeys:h,getDataPropertyOrDefault:function(e,t,n){if(!a.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var i=Object.getOwnPropertyDescriptor(e,t);return null!=i?null==i.get&&null==i.set?i.value:n:void 0},thrower:function(e){throw e},isArray:a.isArray,asArray:k,notEnumerableProp:p,isPrimitive:d,isObject:function(e){return"function"==typeof e||"object"==typeof e&&null!==e},isError:v,canEvaluate:s,errorObj:l,tryCatch:function(e){return r=e,u},inherits:function(e,t){var n={}.hasOwnProperty;function i(){for(var i in this.constructor=e,this.constructor$=t,t.prototype)n.call(t.prototype,i)&&"$"!==i.charAt(i.length-1)&&(this[i+"$"]=t.prototype[i])}return i.prototype=t.prototype,e.prototype=new i,e.prototype},withAppended:function(e,t){var n,i=e.length,o=new Array(i+1);for(n=0;n<i;++n)o[n]=e[n];return o[n]=t,o},maybeWrapAsError:function(e){return d(e)?new Error(m(e)):e},toFastProperties:function(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e},filledRange:function(e,t,n){for(var i=new Array(e),o=0;o<e;++o)i[o]=t+o+n;return i},toString:m,canAttachTrace:_,ensureErrorObject:y,originatesFromRejection:function(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)},markAsOriginatingFromRejection:function(e){try{p(e,"isOperational",!0)}catch(e){}},classString:b,copyDescriptors:function(e,t,n){for(var i=a.names(e),o=0;o<i.length;++o){var r=i[o];if(n(r))try{a.defineProperty(t,r,a.getDescriptor(e,r))}catch(e){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:w,hasEnvVariables:E,env:function(e){return E?t.env[e]:void 0},global:c,getNativePromise:function(){if("function"==typeof Promise)try{var e=new Promise((function(){}));if("[object Promise]"==={}.toString.call(e))return Promise}catch(e){}},domainBind:function(e,t){return e.bind(t)}};x.isRecentNode=x.isNode&&function(){var e=t.versions.node.split(".").map(Number);return 0===e[0]&&e[1]>10||e[0]>0}(),x.isNode&&x.toFastProperties(t);try{throw new Error}catch(e){x.lastLineError=e}i.exports=x},{"./es5":13}]},{},[4])(4),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,n(4),n(0),n(11).setImmediate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t.eol&&e)for(var n=0,i=e.length;n<i;n++)if("\r"===e[n]){if("\n"===e[n+1]){t.eol="\r\n";break}if(e[n+1]){t.eol="\r";break}}else if("\n"===e[n]){t.eol="\n";break}return t.eol||"\n"}},function(e,t,n){var i=n(65),o=n(73);e.exports=function(e,t){var n=o(e,t);return i(n)?n:void 0}},function(e,t,n){var i=n(19).Symbol;e.exports=i},function(e,t,n){var i=n(67),o="object"==typeof self&&self&&self.Object===Object&&self,r=i||o||Function("return this")();e.exports=r},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var i=n(30),o=n(76);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==i(e)}},function(e,t,n){"use strict";(function(t,i){var o=n(6);e.exports=y;var r,a=n(37);y.ReadableState=_,n(12).EventEmitter;var s=function(e,t){return e.listeners(t).length},l=n(24),c=n(7).Buffer,u=t.Uint8Array||function(){},d=n(5);d.inherits=n(2);var p=n(41),h=void 0;h=p&&p.debuglog?p.debuglog("stream"):function(){};var f,g=n(42),m=n(25);d.inherits(y,l);var v=["error","close","destroy","pause","resume"];function _(e,t){e=e||{};var i=t instanceof(r=r||n(1));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var o=e.highWaterMark,a=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:i&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(f||(f=n(26).StringDecoder),this.decoder=new f(e.encoding),this.encoding=e.encoding)}function y(e){if(r=r||n(1),!(this instanceof y))return new y(e);this._readableState=new _(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),l.call(this)}function b(e,t,n,i,o){var r,a=e._readableState;return null===t?(a.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,E(e)}}(e,a)):(o||(r=function(e,t){var n;return function(e){return c.isBuffer(e)||e instanceof u}(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(a,t)),r?e.emit("error",r):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),i?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):k(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?k(e,a,t,!1):I(e,a)):k(e,a,t,!1))):i||(a.reading=!1)),function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function k(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&E(e)),I(e,t)}Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(e,t){this.push(null),t(e)},y.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=c.from(e,t),t=""),n=!0),b(this,e,t,!1,n)},y.prototype.unshift=function(e){return b(this,e,null,!0,!1)},y.prototype.isPaused=function(){return!1===this._readableState.flowing},y.prototype.setEncoding=function(e){return f||(f=n(26).StringDecoder),this._readableState.decoder=new f(e),this._readableState.encoding=e,this};var S=8388608;function w(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=S?e=S:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function E(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?o.nextTick(x,e):x(e))}function x(e){h("emit readable"),e.emit("readable"),P(e)}function I(e,t){t.readingMore||(t.readingMore=!0,o.nextTick(T,e,t))}function T(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(h("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function C(e){h("readable nexttick read 0"),e.read(0)}function M(e,t){t.reading||(h("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),P(e),t.flowing&&!t.reading&&e.read(0)}function P(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function A(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var i;return e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,i=1,o=n.data;for(e-=o.length;n=n.next;){var r=n.data,a=e>r.length?r.length:e;if(a===r.length?o+=r:o+=r.slice(0,e),0==(e-=a)){a===r.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=r.slice(a));break}++i}return t.length-=i,o}(e,t):function(e,t){var n=c.allocUnsafe(e),i=t.head,o=1;for(i.data.copy(n),e-=i.data.length;i=i.next;){var r=i.data,a=e>r.length?r.length:e;if(r.copy(n,n.length-e,0,a),0==(e-=a)){a===r.length?(++o,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=r.slice(a));break}++o}return t.length-=o,n}(e,t),i}(e,t.buffer,t.decoder),n);var n}function O(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,o.nextTick(R,t,e))}function R(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function B(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}y.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?O(this):E(this),null;if(0===(e=w(e,t))&&t.ended)return 0===t.length&&O(this),null;var i,o=t.needReadable;return h("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",o=!0),t.ended||t.reading?h("reading or ended",o=!1):o&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=w(n,t))),null===(i=e>0?A(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&O(this)),null!==i&&this.emit("data",i),i},y.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},y.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,h("pipe count=%d opts=%j",r.pipesCount,t);var l=t&&!1===t.end||e===i.stdout||e===i.stderr?_:c;function c(){h("onend"),e.end()}r.endEmitted?o.nextTick(l):n.once("end",l),e.on("unpipe",(function t(i,o){h("onunpipe"),i===n&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,h("cleanup"),e.removeListener("close",m),e.removeListener("finish",v),e.removeListener("drain",u),e.removeListener("error",g),e.removeListener("unpipe",t),n.removeListener("end",c),n.removeListener("end",_),n.removeListener("data",f),d=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||u())}));var u=function(e){return function(){var t=e._readableState;h("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,P(e))}}(n);e.on("drain",u);var d=!1,p=!1;function f(t){h("ondata"),p=!1,!1!==e.write(t)||p||((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==B(r.pipes,e))&&!d&&(h("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(t){h("onerror",t),_(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",v),_()}function v(){h("onfinish"),e.removeListener("close",m),_()}function _(){h("unpipe"),n.unpipe(e)}return n.on("data",f),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",g),e.once("close",m),e.once("finish",v),e.emit("pipe",n),r.flowing||(h("pipe resume"),n.resume()),e},y.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var i=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var r=0;r<o;r++)i[r].emit("unpipe",this,n);return this}var a=B(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},y.prototype.on=function(e,t){var n=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&E(this):o.nextTick(C,this))}return n},y.prototype.addListener=y.prototype.on,y.prototype.resume=function(){var e=this._readableState;return e.flowing||(h("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,o.nextTick(M,e,t))}(this,e)),this},y.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},y.prototype.wrap=function(e){var t=this,n=this._readableState,i=!1;for(var o in e.on("end",(function(){if(h("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(o){h("wrapped data"),n.decoder&&(o=n.decoder.write(o)),(!n.objectMode||null!=o)&&(n.objectMode||o&&o.length)&&(t.push(o)||(i=!0,e.pause()))})),e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));for(var r=0;r<v.length;r++)e.on(v[r],this.emit.bind(this,v[r]));return this._read=function(t){h("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),y._fromList=A}).call(this,n(0),n(4))},function(e,t,n){e.exports=n(12).EventEmitter},function(e,t,n){"use strict";var i=n(6);function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return r||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||i.nextTick(o,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(i.nextTick(o,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";var i=n(7).Buffer,o=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===o||!o(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=u,this.end=d,t=3;break;default:return this.write=p,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function u(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}t.StringDecoder=r,r.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},r.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var o=a(t[i]);return o>=0?(o>0&&(e.lastNeed=o-1),o):--i<n||-2===o?0:(o=a(t[i]))>=0?(o>0&&(e.lastNeed=o-2),o):--i<n||-2===o?0:(o=a(t[i]))>=0?(o>0&&(2===o?o=0:e.lastNeed=o-3),o):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";e.exports=r;var i=n(1),o=n(5);function r(e){if(!(this instanceof r))return new r(e);i.call(this,e),this._transformState={afterTransform:function(e,t){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),i(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){s(e,t,n)})):s(this,null,null)}function s(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}o.inherits=n(2),o.inherits(r,i),r.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},r.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},r.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var o=this._readableState;(i.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},r.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},r.prototype._destroy=function(e,t){var n=this;i.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.bufFromString=function(t){var n=e.byteLength(t),i=e.allocUnsafe?e.allocUnsafe(n):new e(n);return i.write(t),i},t.emptyBuffer=function(){return e.allocUnsafe?e.allocUnsafe(0):new e(0)},t.filterArray=function(e,t){for(var n=[],i=0;i<e.length;i++)t.indexOf(i)>-1&&n.push(e[i]);return n},t.trimLeft=String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.replace(/^\s+/,"")},t.trimRight=String.prototype.trimRight?function(e){return e.trimRight()}:function(e){return e.replace(/\s+$/,"")}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,i){var o=e.call(this,"Error: "+t+". JSON Line number: "+n+(i?" near: "+i:""))||this;return o.err=t,o.line=n,o.extra=i,o.name="CSV Parse Error",o}return i(t,e),t.column_mismatched=function(e,n){return new t("column_mismatched",e,n)},t.unclosed_quote=function(e,n){return new t("unclosed_quote",e,n)},t.fromJSON=function(e){return new t(e.err,e.line,e.extra)},t.prototype.toJSON=function(){return{err:this.err,line:this.line,extra:this.extra}},t}(Error);t.default=o},function(e,t,n){var i=n(18),o=n(68),r=n(69),a=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):r(e)}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){e.exports=n(33)},function(e,t,n){"use strict";var i=n(34),o=function(e,t){return new i.Converter(e,t)};o.csv=o,o.Converter=i.Converter,e.exports=o},function(e,t,n){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),a=n(50),s=n(51),l=o(n(15)),c=n(52),u=n(105),d=function(t){function o(n,i){void 0===i&&(i={});var o=t.call(this,i)||this;return o.options=i,o.params=a.mergeParams(n),o.runtime=s.initParseRuntime(o),o.result=new u.Result(o),o.processor=new c.ProcessorLocal(o),o.once("error",(function(t){e((function(){o.result.processError(t),o.emit("done",t)}))})),o.once("done",(function(){o.processor.destroy()})),o}return i(o,t),o.prototype.preRawData=function(e){return this.runtime.preRawDataHook=e,this},o.prototype.preFileLine=function(e){return this.runtime.preFileLineHook=e,this},o.prototype.subscribe=function(e,t,n){return this.parseRuntime.subscribe={onNext:e,onError:t,onCompleted:n},this},o.prototype.fromFile=function(e,t){var i=this,o=n(!function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}());return o.exists(e,(function(n){n?o.createReadStream(e,t).pipe(i):i.emit("error",new Error("File does not exist. Check to make sure the file path to your csv is correct."))})),this},o.prototype.fromStream=function(e){return e.pipe(this),this},o.prototype.fromString=function(e){e.toString();var t=new r.Readable,n=0;return t._read=function(t){if(n>=e.length)this.push(null);else{var i=e.substr(n,t);this.push(i),n+=t}},this.fromStream(t)},o.prototype.then=function(e,t){var n=this;return new l.default((function(i,o){n.parseRuntime.then={onfulfilled:function(t){i(e?e(t):t)},onrejected:function(e){t?i(t(e)):o(e)}}}))},Object.defineProperty(o.prototype,"parseParam",{get:function(){return this.params},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"parseRuntime",{get:function(){return this.runtime},enumerable:!0,configurable:!0}),o.prototype._transform=function(e,t,n){var i=this;this.processor.process(e).then((function(e){if(e.length>0)return i.runtime.started=!0,i.result.processResult(e)})).then((function(){i.emit("drained"),n()}),(function(e){i.runtime.hasError=!0,i.runtime.error=e,i.emit("error",e),n()}))},o.prototype._flush=function(e){var t=this;this.processor.flush().then((function(e){if(e.length>0)return t.result.processResult(e)})).then((function(){t.processEnd(e)}),(function(n){t.emit("error",n),e()}))},o.prototype.processEnd=function(e){this.result.endProcess(),this.emit("done"),e()},Object.defineProperty(o.prototype,"parsedLineNumber",{get:function(){return this.runtime.parsedLineNumber},enumerable:!0,configurable:!0}),o}(r.Transform);t.Converter=d}).call(this,n(11).setImmediate)},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,o=1,r={},a=!1,s=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){u(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&u(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),i=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){u(e.data)},i=function(t){e.port2.postMessage(t)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var e=s.documentElement;i=function(t){var n=s.createElement("script");n.onreadystatechange=function(){u(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():i=function(e){setTimeout(u,0,e)},l.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var a={callback:e,args:t};return r[o]=a,i(o),o++},l.clearImmediate=c}function c(e){delete r[e]}function u(e){if(a)setTimeout(u,0,e);else{var t=r[e];if(t){a=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{c(e),a=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(0),n(4))},function(e,t,n){e.exports=o;var i=n(12).EventEmitter;function o(){i.call(this)}n(2)(o,i),o.Readable=n(13),o.Writable=n(46),o.Duplex=n(47),o.Transform=n(48),o.PassThrough=n(49),o.Stream=o,o.prototype.pipe=function(e,t){var n=this;function o(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function r(){n.readable&&n.resume&&n.resume()}n.on("data",o),e.on("drain",r),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",l));var a=!1;function s(){a||(a=!0,e.end())}function l(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(u(),0===i.listenerCount(this,"error"))throw e}function u(){n.removeListener("data",o),e.removeListener("drain",r),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",u),n.removeListener("close",u),e.removeListener("close",u)}return n.on("error",c),e.on("error",c),n.on("end",u),n.on("close",u),e.on("close",u),e.emit("pipe",n),e}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){for(var t,n=c(e),i=n[0],a=n[1],s=new r(3*(i+a)/4-a),l=0,u=a>0?i-4:i,d=0;d<u;d+=4)t=o[e.charCodeAt(d)]<<18|o[e.charCodeAt(d+1)]<<12|o[e.charCodeAt(d+2)]<<6|o[e.charCodeAt(d+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;return 2===a&&(t=o[e.charCodeAt(d)]<<2|o[e.charCodeAt(d+1)]>>4,s[l++]=255&t),1===a&&(t=o[e.charCodeAt(d)]<<10|o[e.charCodeAt(d+1)]<<4|o[e.charCodeAt(d+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t),s},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,r=[],a=0,s=n-o;a<s;a+=16383)r.push(d(e,a,a+16383>s?s:a+16383));return 1===o?(t=e[n-1],r.push(i[t>>2]+i[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],r.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),r.join("")};for(var i=[],o=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)i[s]=a[s],o[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function d(e,t,n){for(var i,o=[],r=t;r<n;r+=3)i=(e[r]<<16&16711680)+(e[r+1]<<8&65280)+(255&e[r+2]),o.push(u(i));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,o){var r,a,s=8*o-i-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?o-1:0,p=n?-1:1,h=e[t+d];for(d+=p,r=h&(1<<-u)-1,h>>=-u,u+=s;u>0;r=256*r+e[t+d],d+=p,u-=8);for(a=r&(1<<-u)-1,r>>=-u,u+=i;u>0;a=256*a+e[t+d],d+=p,u-=8);if(0===r)r=1-c;else{if(r===l)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,i),r-=c}return(h?-1:1)*a*Math.pow(2,r-i)},t.write=function(e,t,n,i,o,r){var a,s,l,c=8*r-o-1,u=(1<<c)-1,d=u>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=i?0:r-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[n+h]=255&s,h+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+h]=255&a,h+=f,a/=256,c-=8);e[n+h-f]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){},function(e,t,n){"use strict";var i=n(7).Buffer,o=n(43);function r(e,t,n){e.copy(t,n)}e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t=i.allocUnsafe(e>>>0),n=this.head,o=0;n;)r(n.data,t,o),o+=n.data.length,n=n.next;return t},e}(),o&&o.inspect&&o.inspect.custom&&(e.exports.prototype[o.inspect.custom]=function(){var e=o.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,n(0))},function(e,t,n){"use strict";e.exports=r;var i=n(27),o=n(5);function r(e){if(!(this instanceof r))return new r(e);i.call(this,e)}o.inherits=n(2),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(14)},function(e,t,n){e.exports=n(1)},function(e,t,n){e.exports=n(13).Transform},function(e,t,n){e.exports=n(13).PassThrough},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeParams=function(e){var t={delimiter:",",ignoreColumns:void 0,includeColumns:void 0,quote:'"',trim:!0,checkType:!1,ignoreEmpty:!1,noheader:!1,headers:void 0,flatKeys:!1,maxRowLength:0,checkColumn:!1,escape:'"',colParser:{},eol:void 0,alwaysSplitAtEOL:!1,output:"json",nullObject:!1,downstreamFormat:"line",needEmitAll:!0};for(var n in e||(e={}),e)e.hasOwnProperty(n)&&(Array.isArray(e[n])?t[n]=[].concat(e[n]):t[n]=e[n]);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initParseRuntime=function(e){var t=e.parseParam,n={needProcessIgnoreColumn:!1,needProcessIncludeColumn:!1,selectedColumns:void 0,ended:!1,hasError:!1,error:void 0,delimiter:e.parseParam.delimiter,eol:e.parseParam.eol,columnConv:[],headerType:[],headerTitle:[],headerFlag:[],headers:void 0,started:!1,parsedLineNumber:0,columnValueSetter:[]};return t.ignoreColumns&&(n.needProcessIgnoreColumn=!0),t.includeColumns&&(n.needProcessIncludeColumn=!0),n}},function(e,t,n){"use strict";(function(e){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),a=o(n(15)),s=n(54),l=o(n(16)),c=n(57),u=n(28),d=n(58),p=o(n(59)),h=o(n(29)),f=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.rowSplit=new d.RowSplit(e.converter),e.eolEmitted=!1,e._needEmitEol=void 0,e.headEmitted=!1,e._needEmitHead=void 0,e}return i(n,t),n.prototype.flush=function(){var e=this;if(this.runtime.csvLineBuffer&&this.runtime.csvLineBuffer.length>0){var t=this.runtime.csvLineBuffer;return this.runtime.csvLineBuffer=void 0,this.process(t,!0).then((function(t){return e.runtime.csvLineBuffer&&e.runtime.csvLineBuffer.length>0?a.default.reject(h.default.unclosed_quote(e.runtime.parsedLineNumber,e.runtime.csvLineBuffer.toString())):a.default.resolve(t)}))}return a.default.resolve([])},n.prototype.destroy=function(){return a.default.resolve()},Object.defineProperty(n.prototype,"needEmitEol",{get:function(){return void 0===this._needEmitEol&&(this._needEmitEol=this.converter.listeners("eol").length>0),this._needEmitEol},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"needEmitHead",{get:function(){return void 0===this._needEmitHead&&(this._needEmitHead=this.converter.listeners("header").length>0),this._needEmitHead},enumerable:!0,configurable:!0}),n.prototype.process=function(e,t){var n,i=this;return void 0===t&&(t=!1),n=t?e.toString():s.prepareData(e,this.converter.parseRuntime),a.default.resolve().then((function(){return i.runtime.preRawDataHook?i.runtime.preRawDataHook(n):n})).then((function(e){return e&&e.length>0?i.processCSV(e,t):a.default.resolve([])}))},n.prototype.processCSV=function(e,t){var n=this,i=this.params,o=this.runtime;o.eol||l.default(e,o),this.needEmitEol&&!this.eolEmitted&&o.eol&&(this.converter.emit("eol",o.eol),this.eolEmitted=!0),i.ignoreEmpty&&!o.started&&(e=u.trimLeft(e));var r=c.stringToLines(e,o);return t?(r.lines.push(r.partial),r.partial=""):this.prependLeftBuf(u.bufFromString(r.partial)),r.lines.length>0?(o.preFileLineHook?this.runPreLineHook(r.lines):a.default.resolve(r.lines)).then((function(e){return o.started||n.runtime.headers?n.processCSVBody(e):n.processDataWithHead(e)})):a.default.resolve([])},n.prototype.processDataWithHead=function(e){if(this.params.noheader)this.params.headers?this.runtime.headers=this.params.headers:this.runtime.headers=[];else{for(var t="",n=[];e.length;){var i=t+e.shift(),o=this.rowSplit.parse(i);if(o.closed){n=o.cells,t="";break}t=i+l.default(i,this.runtime)}if(this.prependLeftBuf(u.bufFromString(t)),0===n.length)return[];this.params.headers?this.runtime.headers=this.params.headers:this.runtime.headers=n}return(this.runtime.needProcessIgnoreColumn||this.runtime.needProcessIncludeColumn)&&this.filterHeader(),this.needEmitHead&&!this.headEmitted&&(this.converter.emit("header",this.runtime.headers),this.headEmitted=!0),this.processCSVBody(e)},n.prototype.filterHeader=function(){if(this.runtime.selectedColumns=[],this.runtime.headers){for(var e=this.runtime.headers,t=0;t<e.length;t++)if(this.params.ignoreColumns)if(this.params.ignoreColumns.test(e[t])){if(!this.params.includeColumns||!this.params.includeColumns.test(e[t]))continue;this.runtime.selectedColumns.push(t)}else this.runtime.selectedColumns.push(t);else this.params.includeColumns?this.params.includeColumns.test(e[t])&&this.runtime.selectedColumns.push(t):this.runtime.selectedColumns.push(t);this.runtime.headers=u.filterArray(this.runtime.headers,this.runtime.selectedColumns)}},n.prototype.processCSVBody=function(e){if("line"===this.params.output)return e;var t=this.rowSplit.parseMultiLines(e);return this.prependLeftBuf(u.bufFromString(t.partial)),"csv"===this.params.output?t.rowsCells:p.default(t.rowsCells,this.converter)},n.prototype.prependLeftBuf=function(t){t&&(this.runtime.csvLineBuffer?this.runtime.csvLineBuffer=e.concat([t,this.runtime.csvLineBuffer]):this.runtime.csvLineBuffer=t)},n.prototype.runPreLineHook=function(e){var t=this;return new a.default((function(n,i){!function e(t,n,i,o){if(i>=t.length)o();else if(n.preFileLineHook){var r=t[i],a=n.preFileLineHook(r,n.parsedLineNumber+i);if(i++,a&&a.then)a.then((function(r){t[i-1]=r,e(t,n,i,o)}));else{for(t[i-1]=a;i<t.length;)t[i]=n.preFileLineHook(t[i],n.parsedLineNumber+i),i++;o()}}else o()}(e,t.runtime,0,(function(t){t?i(t):n(e)}))}))},n}(r.Processor);t.ProcessorLocal=f}).call(this,n(3).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Processor=function(e){this.converter=e,this.params=e.parseParam,this.runtime=e.parseRuntime}},function(e,t,n){"use strict";(function(e){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(55));t.prepareData=function(t,n){var i=function(t,n){return n.csvLineBuffer&&n.csvLineBuffer.length>0?e.concat([n.csvLineBuffer,t]):t}(t,n);n.csvLineBuffer=void 0;var r=function(e,t){var n=e.length-1;if(0!=(128&e[n])){for(;128==(192&e[n]);)n--;n--}return n!=e.length-1?(t.csvLineBuffer=e.slice(n+1),e.slice(0,n+1)):e}(i,n).toString("utf8");return!1===n.started?o.default(r):r}}).call(this,n(3).Buffer)},function(e,t,n){"use strict";(function(t){var i=n(56);e.exports=function(e){return"string"==typeof e&&65279===e.charCodeAt(0)?e.slice(1):t.isBuffer(e)&&i(e)&&239===e[0]&&187===e[1]&&191===e[2]?e.slice(3):e}}).call(this,n(3).Buffer)},function(e,t){e.exports=function(e){for(var t=0;t<e.length;)if(9==e[t]||10==e[t]||13==e[t]||32<=e[t]&&e[t]<=126)t+=1;else if(194<=e[t]&&e[t]<=223&&128<=e[t+1]&&e[t+1]<=191)t+=2;else if(224==e[t]&&160<=e[t+1]&&e[t+1]<=191&&128<=e[t+2]&&e[t+2]<=191||(225<=e[t]&&e[t]<=236||238==e[t]||239==e[t])&&128<=e[t+1]&&e[t+1]<=191&&128<=e[t+2]&&e[t+2]<=191||237==e[t]&&128<=e[t+1]&&e[t+1]<=159&&128<=e[t+2]&&e[t+2]<=191)t+=3;else{if(!(240==e[t]&&144<=e[t+1]&&e[t+1]<=191&&128<=e[t+2]&&e[t+2]<=191&&128<=e[t+3]&&e[t+3]<=191||241<=e[t]&&e[t]<=243&&128<=e[t+1]&&e[t+1]<=191&&128<=e[t+2]&&e[t+2]<=191&&128<=e[t+3]&&e[t+3]<=191||244==e[t]&&128<=e[t+1]&&e[t+1]<=143&&128<=e[t+2]&&e[t+2]<=191&&128<=e[t+3]&&e[t+3]<=191))return!1;t+=4}return!0}},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(16));t.stringToLines=function(e,t){var n=o.default(e,t),i=e.split(n);return{lines:i,partial:i.pop()||""}}},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(16)),r=n(28),a=[",","|","\t",";",":"],s=function(){function e(e){this.conv=e,this.cachedRegExp={},this.delimiterEmitted=!1,this._needEmitDelimiter=void 0,this.quote=e.parseParam.quote,this.trim=e.parseParam.trim,this.escape=e.parseParam.escape}return Object.defineProperty(e.prototype,"needEmitDelimiter",{get:function(){return void 0===this._needEmitDelimiter&&(this._needEmitDelimiter=this.conv.listeners("delimiter").length>0),this._needEmitDelimiter},enumerable:!0,configurable:!0}),e.prototype.parse=function(e){if(0===e.length||this.conv.parseParam.ignoreEmpty&&0===e.trim().length)return{cells:[],closed:!0};var t=this.quote,n=this.trim;this.escape,(this.conv.parseRuntime.delimiter instanceof Array||"auto"===this.conv.parseRuntime.delimiter.toLowerCase())&&(this.conv.parseRuntime.delimiter=this.getDelimiter(e)),this.needEmitDelimiter&&!this.delimiterEmitted&&(this.conv.emit("delimiter",this.conv.parseRuntime.delimiter),this.delimiterEmitted=!0);var i=this.conv.parseRuntime.delimiter,o=e.split(i);if("off"===t){if(n)for(var r=0;r<o.length;r++)o[r]=o[r].trim();return{cells:o,closed:!0}}return this.toCSVRow(o,n,t,i)},e.prototype.toCSVRow=function(e,t,n,i){for(var o=[],a=!1,s="",l=0,c=e.length;l<c;l++){var u=e[l];!a&&t&&(u=r.trimLeft(u));var d=u.length;if(a)this.isQuoteClose(u)?(a=!1,s+=i+(u=u.substr(0,d-1)),s=this.escapeQuote(s),t&&(s=r.trimRight(s)),o.push(s),s=""):s+=i+u;else{if(2===d&&u===this.quote+this.quote){o.push("");continue}if(this.isQuoteOpen(u)){if(u=u.substr(1),this.isQuoteClose(u)){u=u.substring(0,u.lastIndexOf(n)),u=this.escapeQuote(u),o.push(u);continue}if(-1!==u.indexOf(n)){for(var p=0,h="",f=0,g=u;f<g.length;f++){var m=g[f];m===n&&h!==this.escape?(p++,h=""):h=m}if(p%2==1){t&&(u=r.trimRight(u)),o.push(n+u);continue}a=!0,s+=u;continue}a=!0,s+=u;continue}t&&(u=r.trimRight(u)),o.push(u)}}return{cells:o,closed:!a}},e.prototype.getDelimiter=function(e){var t;if("auto"===this.conv.parseParam.delimiter)t=a;else{if(!(this.conv.parseParam.delimiter instanceof Array))return this.conv.parseParam.delimiter;t=this.conv.parseParam.delimiter}var n=0,i=",";return t.forEach((function(t){var o=e.split(t).length;o>n&&(i=t,n=o)})),i},e.prototype.isQuoteOpen=function(e){var t=this.quote,n=this.escape;return e[0]===t&&(e[1]!==t||e[1]===n&&(e[2]===t||2===e.length))},e.prototype.isQuoteClose=function(e){var t=this.quote,n=this.escape;this.conv.parseParam.trim&&(e=r.trimRight(e));for(var i=0,o=e.length-1;e[o]===t||e[o]===n;)o--,i++;return i%2!=0},e.prototype.escapeQuote=function(e){var t="es|"+this.quote+"|"+this.escape;void 0===this.cachedRegExp[t]&&(this.cachedRegExp[t]=new RegExp("\\"+this.escape+"\\"+this.quote,"g"));var n=this.cachedRegExp[t];return e.replace(n,this.quote)},e.prototype.parseMultiLines=function(e){for(var t=[],n="";e.length;){var i=n+e.shift(),a=this.parse(i);0===a.cells.length&&this.conv.parseParam.ignoreEmpty||(a.closed||this.conv.parseParam.alwaysSplitAtEOL?(this.conv.parseRuntime.selectedColumns?t.push(r.filterArray(a.cells,this.conv.parseRuntime.selectedColumns)):t.push(a.cells),n=""):n=i+(o.default(i,this.conv.parseRuntime)||"\n"))}return{rowsCells:t,partial:n}},e}();t.RowSplit=s},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(29)),r=i(n(60)),a=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/;function s(e,t,n){if(t.parseParam.checkColumn&&t.parseRuntime.headers&&e.length!==t.parseRuntime.headers.length)throw o.default.column_mismatched(t.parseRuntime.parsedLineNumber+n);return function(e,t,n){for(var i=!1,o={},r=0,a=e.length;r<a;r++){var s=e[r];if(!n.parseParam.ignoreEmpty||""!==s){i=!0;var l=t[r];l&&""!==l||(l=t[r]="field"+(r+1));var d=c(l,r,n);if(d){var p=d(s,l,o,e,r);void 0!==p&&u(o,l,p,n,r)}else n.parseParam.checkType&&(s=h(s,l,r,n)(s)),void 0!==s&&u(o,l,s,n,r)}}return i?o:null}(e,t.parseRuntime.headers||[],t)||null}t.default=function(e,t){for(var n=[],i=0,o=e.length;i<o;i++){var r=s(e[i],t,i);r&&n.push(r)}return n};var l={string:g,number:f,omit:function(){}};function c(e,t,n){if(void 0!==n.parseRuntime.columnConv[t])return n.parseRuntime.columnConv[t];var i=n.parseParam.colParser[e];if(void 0===i)return n.parseRuntime.columnConv[t]=null;if("object"==typeof i&&(i=i.cellParser||"string"),"string"==typeof i){i=i.trim().toLowerCase();var o=l[i];return n.parseRuntime.columnConv[t]=o||null}return n.parseRuntime.columnConv[t]="function"==typeof i?i:null}function u(e,t,n,i,o){if(!i.parseRuntime.columnValueSetter[o])if(i.parseParam.flatKeys)i.parseRuntime.columnValueSetter[o]=d;else if(t.indexOf(".")>-1){for(var r=t.split("."),a=!0;r.length>0;)if(0===r.shift().length){a=!1;break}!a||i.parseParam.colParser[t]&&i.parseParam.colParser[t].flat?i.parseRuntime.columnValueSetter[o]=d:i.parseRuntime.columnValueSetter[o]=p}else i.parseRuntime.columnValueSetter[o]=d;!0===i.parseParam.nullObject&&"null"===n&&(n=null),i.parseRuntime.columnValueSetter[o](e,t,n)}function d(e,t,n){e[t]=n}function p(e,t,n){r.default(e,t,n)}function h(e,t,n,i){return i.parseRuntime.headerType[n]?i.parseRuntime.headerType[n]:t.indexOf("number#!")>-1?i.parseRuntime.headerType[n]=f:t.indexOf("string#!")>-1?i.parseRuntime.headerType[n]=g:i.parseParam.checkType?i.parseRuntime.headerType[n]=m:i.parseRuntime.headerType[n]=g}function f(e){var t=parseFloat(e);return isNaN(t)?e:t}function g(e){return e.toString()}function m(e){var t=e.trim();return""===t?g(e):a.test(t)?f(e):5===t.length&&"false"===t.toLowerCase()||4===t.length&&"true"===t.toLowerCase()?function(e){var t=e.trim();return 5!==t.length||"false"!==t.toLowerCase()}(e):"{"===t[0]&&"}"===t[t.length-1]||"["===t[0]&&"]"===t[t.length-1]?function(e){try{return JSON.parse(e)}catch(t){return e}}(e):g(e)}},function(e,t,n){var i=n(61);e.exports=function(e,t,n){return null==e?e:i(e,t,n)}},function(e,t,n){var i=n(62),o=n(74),r=n(103),a=n(20),s=n(104);e.exports=function(e,t,n,l){if(!a(e))return e;for(var c=-1,u=(t=o(t,e)).length,d=u-1,p=e;null!=p&&++c<u;){var h=s(t[c]),f=n;if(c!=d){var g=p[h];void 0===(f=l?l(g,h,p):void 0)&&(f=a(g)?g:r(t[c+1])?[]:{})}i(p,h,f),p=p[h]}return e}},function(e,t,n){var i=n(63),o=n(31),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var a=e[t];r.call(e,t)&&o(a,n)&&(void 0!==n||t in e)||i(e,t,n)}},function(e,t,n){var i=n(64);e.exports=function(e,t,n){"__proto__"==t&&i?i(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var i=n(17),o=function(){try{var e=i(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var i=n(66),o=n(70),r=n(20),a=n(72),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,p=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!r(e)||o(e))&&(i(e)?p:s).test(a(e))}},function(e,t,n){var i=n(30),o=n(20);e.exports=function(e){if(!o(e))return!1;var t=i(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(0))},function(e,t,n){var i=n(18),o=Object.prototype,r=o.hasOwnProperty,a=o.toString,s=i?i.toStringTag:void 0;e.exports=function(e){var t=r.call(e,s),n=e[s];try{e[s]=void 0;var i=!0}catch(e){}var o=a.call(e);return i&&(t?e[s]=n:delete e[s]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var i=n(71),o=function(){var e=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},function(e,t,n){var i=n(19)["__core-js_shared__"];e.exports=i},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var i=n(21),o=n(75),r=n(77),a=n(100);e.exports=function(e,t){return i(e)?e:o(e,t)?[e]:r(a(e))}},function(e,t,n){var i=n(21),o=n(22),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(i(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||a.test(e)||!r.test(e)||null!=t&&e in Object(t)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,r=n(78)((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,i,r){t.push(i?r.replace(o,"$1"):n||e)})),t}));e.exports=r},function(e,t,n){var i=n(79);e.exports=function(e){var t=i(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var i=n(80);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var i=arguments,o=t?t.apply(this,i):i[0],r=n.cache;if(r.has(o))return r.get(o);var a=e.apply(this,i);return n.cache=r.set(o,a)||r,a};return n.cache=new(o.Cache||i),n}o.Cache=i,e.exports=o},function(e,t,n){var i=n(81),o=n(95),r=n(97),a=n(98),s=n(99);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},function(e,t,n){var i=n(82),o=n(88),r=n(94);e.exports=function(){this.size=0,this.__data__={hash:new i,map:new(r||o),string:new i}}},function(e,t,n){var i=n(83),o=n(84),r=n(85),a=n(86),s=n(87);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},function(e,t,n){var i=n(8);e.exports=function(){this.__data__=i?i(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var i=n(8),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(i){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},function(e,t,n){var i=n(8),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return i?void 0!==t[e]:o.call(t,e)}},function(e,t,n){var i=n(8);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=i&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var i=n(89),o=n(90),r=n(91),a=n(92),s=n(93);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var i=n(9),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=i(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},function(e,t,n){var i=n(9);e.exports=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var i=n(9);e.exports=function(e){return i(this.__data__,e)>-1}},function(e,t,n){var i=n(9);e.exports=function(e,t){var n=this.__data__,o=i(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},function(e,t,n){var i=n(17)(n(19),"Map");e.exports=i},function(e,t,n){var i=n(10);e.exports=function(e){var t=i(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var i=n(10);e.exports=function(e){return i(this,e).get(e)}},function(e,t,n){var i=n(10);e.exports=function(e){return i(this,e).has(e)}},function(e,t,n){var i=n(10);e.exports=function(e,t){var n=i(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},function(e,t,n){var i=n(101);e.exports=function(e){return null==e?"":i(e)}},function(e,t,n){var i=n(18),o=n(102),r=n(21),a=n(22),s=i?i.prototype:void 0,l=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(r(t))return o(t,e)+"";if(a(t))return l?l.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t){e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length,o=Array(i);++n<i;)o[n]=t(e[n],n,e);return o}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var i=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var i=n(22);e.exports=function(e){if("string"==typeof e||i(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(15)),r=n(106),a=function(){function e(e){this.converter=e,this.finalResult=[]}return Object.defineProperty(e.prototype,"needEmitLine",{get:function(){return!!this.converter.parseRuntime.subscribe&&!!this.converter.parseRuntime.subscribe.onNext||this.needPushDownstream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"needPushDownstream",{get:function(){return void 0===this._needPushDownstream&&(this._needPushDownstream=this.converter.listeners("data").length>0||this.converter.listeners("readable").length>0),this._needPushDownstream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"needEmitAll",{get:function(){return!!this.converter.parseRuntime.then&&this.converter.parseParam.needEmitAll},enumerable:!0,configurable:!0}),e.prototype.processResult=function(e){var t=this,n=this.converter.parseRuntime.parsedLineNumber;return this.needPushDownstream&&"array"===this.converter.parseParam.downstreamFormat&&0===n&&s(this.converter,"["+r.EOL),new o.default((function(n,i){t.needEmitLine?function e(t,n,i,o,r){if(i>=t.length)r();else if(n.parseRuntime.subscribe&&n.parseRuntime.subscribe.onNext){var a=n.parseRuntime.subscribe.onNext,l=t[i],c=a(l,n.parseRuntime.parsedLineNumber+i);if(i++,c&&c.then)c.then((function(){!function(t,n,i,o,r,a,l){r&&s(i,l),e(t,i,o,r,a)}(t,0,n,i,o,r,l)}),r);else{for(o&&s(n,l);i<t.length;){var u=t[i];a(u,n.parseRuntime.parsedLineNumber+i),i++,o&&s(n,u)}r()}}else{if(o)for(;i<t.length;)u=t[i++],s(n,u);r()}}(e,t.converter,0,t.needPushDownstream,(function(o){o?i(o):(t.appendFinalResult(e),n())})):(t.appendFinalResult(e),n())}))},e.prototype.appendFinalResult=function(e){this.needEmitAll&&(this.finalResult=this.finalResult.concat(e)),this.converter.parseRuntime.parsedLineNumber+=e.length},e.prototype.processError=function(e){this.converter.parseRuntime.subscribe&&this.converter.parseRuntime.subscribe.onError&&this.converter.parseRuntime.subscribe.onError(e),this.converter.parseRuntime.then&&this.converter.parseRuntime.then.onrejected&&this.converter.parseRuntime.then.onrejected(e)},e.prototype.endProcess=function(){this.converter.parseRuntime.then&&this.converter.parseRuntime.then.onfulfilled&&(this.needEmitAll?this.converter.parseRuntime.then.onfulfilled(this.finalResult):this.converter.parseRuntime.then.onfulfilled([])),this.converter.parseRuntime.subscribe&&this.converter.parseRuntime.subscribe.onCompleted&&this.converter.parseRuntime.subscribe.onCompleted(),this.needPushDownstream&&"array"===this.converter.parseParam.downstreamFormat&&s(this.converter,"]"+r.EOL)},e}();function s(e,t){if("object"!=typeof t||e.options.objectMode)e.push(t);else{var n=JSON.stringify(t);e.push(n+("array"===e.parseParam.downstreamFormat?","+r.EOL:r.EOL),"utf8")}}t.Result=a},function(e,t){t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!=typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n",t.homedir=function(){return"/"}}])},function(e,t,n){var i=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function s(e,t,n,i){var o=t&&t.prototype instanceof u?t:u,r=Object.create(o.prototype),a=new S(i||[]);return r._invoke=function(e,t,n){var i="suspendedStart";return function(o,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw r;return E()}for(n.method=o,n.arg=r;;){var a=n.delegate;if(a){var s=y(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(e,t,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(e,n,a),r}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var c={};function u(){}function d(){}function p(){}var h={};h[o]=function(){return this};var f=Object.getPrototypeOf,g=f&&f(f(w([])));g&&g!==t&&n.call(g,o)&&(h=g);var m=p.prototype=u.prototype=Object.create(h);function v(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function _(e,t){var i;this._invoke=function(o,r){function a(){return new t((function(i,a){!function i(o,r,a,s){var c=l(e[o],e,r);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return i("throw",e,a,s)}))}s(c.arg)}(o,r,i,a)}))}return i=i?i.then(a,a):a()}}function y(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,y(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var i=l(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,c;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function w(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,r=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:E}}function E(){return{value:void 0,done:!0}}return d.prototype=m.constructor=p,p.constructor=d,p[a]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},v(_.prototype),_.prototype[r]=function(){return this},e.AsyncIterator=_,e.async=function(t,n,i,o,r){void 0===r&&(r=Promise);var a=new _(s(t,n,i,o),r);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(m),m[a]="Generator",m[o]=function(){return this},m.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=w,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var s=n.call(r,"catchLoc"),l=n.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,c):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=i}catch(e){Function("r","regeneratorRuntime = r")(i)}},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n.n(o),a=n(2),s=n.n(a),l=n(0),c=n.n(l),u=function(){function e(){r()(this,e)}return s()(e,[{key:"validateSchool",value:function(e){return""!==e?null:new Error(MSG.validator.errSchool)}},{key:"validateId",value:function(e){for(var t=0;t<4;t++)if(null==e[t])return new Error(MSG.validator.errId);return null}},{key:"validateAgeGroup",value:function(e){return void 0!==e?null:new Error(MSG.validator.errAgeGroup)}},{key:"validateGender",value:function(e){return void 0!==e?null:new Error(MSG.validator.errGender)}},{key:"validateActivityId",value:function(e){return""!==e?null:new Error(MSG.validator.errActivityId)}},{key:"hasErrors",value:function(e){for(var t=e.length,n=0;n<t;n++)if(null!=e[n])return!0;return!1}}]),e}(),d=function(){function e(){r()(this,e)}return s()(e,null,[{key:"getServerUrl",value:function(){return"http://localhost:12032"}}]),e}(),p=function(){function e(t){r()(this,e),c()(this,"username",null),c()(this,"password",null),c()(this,"currentlySelectedIcons",[null,null,null,null]),c()(this,"SIZE",4),c()(this,"icons",[{id:1,name:MSG.logging.person,html:'<span class="glyphicon icon-user"></span>'},{id:2,name:MSG.logging.dog,html:'<span class="glyphicon icon-dog"></span>'},{id:3,name:MSG.logging.car,html:'<span class="glyphicon icon-car"></span>'},{id:4,name:MSG.logging.camera,html:'<span class="glyphicon icon-camera"></span>'},{id:5,name:MSG.logging.heart,html:'<span class="glyphicon icon-heart"></span>'},{id:6,name:MSG.logging.plane,html:'<span class="glyphicon icon-plane"></span>'},{id:7,name:MSG.logging.house,html:'<span class="glyphicon icon-house"></span>'},{id:8,name:MSG.logging.umbrella,html:'<span class="glyphicon icon-umbrella"></span>'},{id:9,name:MSG.logging.star,html:'<span class="glyphicon icon-star"></span>'},{id:10,name:MSG.logging.money,html:'<span class="glyphicon icon-money"></span>'},{id:11,name:MSG.logging.gift,html:'<span class="glyphicon icon-gift"></span>'},{id:12,name:MSG.logging.keys,html:'<span class="glyphicon icon-keys"></span>'},{id:13,name:MSG.logging.music,html:'<span class="glyphicon icon-music"></span>'},{id:14,name:MSG.logging.snowflake,html:'<span class="glyphicon icon-snowflake"></span>'},{id:15,name:MSG.logging.fire,html:'<span class="glyphicon icon-fire"></span>'},{id:16,name:MSG.logging.envelope,html:'<span class="glyphicon icon-envelope"></span>'}]),c()(this,"schools",null),c()(this,"validator",null),c()(this,"eventLogger",null),this.validator=new u,this.eventLogger=t}return s()(e,[{key:"createInitialMenu",value:function(){this.createLoggingModalDialogWithoutFooter(MSG.logging.login),$("#loggingModalBody").append('<p id="loggingModalBody1"></p>'),$("#loggingModalBody").append('<div id="authentication_menu" class="tutorial_categories_wrapper"></div>'),$("#authentication_menu").append('<div id="authentication_new_user" class="tutorial_categories_item card"></div>'),$("#authentication_new_user").append('<div class="category_tag">'+MSG.logging.newuser+"</div>"),$("#authentication_new_user").append('<div id="new_user_img"></div>'),$("#authentication_menu").append('<div id="authentication_existing_user" class="tutorial_categories_item card"></div>'),$("#authentication_existing_user").append('<div class="category_tag">'+MSG.logging.login+"</div>"),$("#authentication_existing_user").append('<div id="school_user_img"></div>'),this.showDialog();var e=this;$("#authentication_new_user").click((function(){e.createUserMenu()})),$("#authentication_existing_user").click((function(){e.createLoginMenu()}))}},{key:"createLoginMenu",value:function(){var e=this;this.createLoggingModalDialog(MSG.logging.login),$("#loggingModalBody").append('<div id="inputUsername" class="ui-widget row mb-4">'),$("#inputUsername").append('<label for="myusernametag" class="col-md-3">'+MSG.logging.username+"</label>"),$("#inputUsername").append('<input id="myusernametag" name="myusernametag" class="col-md-8" placeholder="Enter username">'),e.createIconModule(),$("#loggingModalBody").append('<button id="reset_modal_dialog_button" type="button" class="btn btn-default mt-4">'+MSG.logging.reset+"</button>"),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),this.showDialog(),e.makeIconsResponsive(),$("#reset_modal_dialog_button").click((function(){e.resetSelectedIcons()})),$("#submit_modal_dialog_button").click((function(){e.login()}))}},{key:"login",value:function(){var e=this,t=[];if(User.username=$("input[name=myusernametag]").val(),User.password=JSON.stringify(e.currentlySelectedIcons),t.push(e.validator.validateId(e.currentlySelectedIcons)),e.validator.hasErrors(t))e.showErrors(t);else{var n={userId:User.username,password:JSON.stringify(e.currentlySelectedIcons)};$.ajax({type:"POST",url:d.getServerUrl()+"/authentication/authenticate",data:n}).done((function(t){e.eventLogger.setUserId(t.id),e.resetSelectedIcons(),e.removeDialog()})).fail((function(e,t){console.warn("Failed to log in:",t),console.log(e)}))}}},{key:"createUserMenu",value:function(){var e=this;e.createLoggingModalDialog(MSG.logging.newuser),$("#loggingModalBody").append('<div id="inputUsername" class="ui-widget row mb-4">'),$("#inputUsername").append('<label for="myusernametag" class="col-md-3">'+MSG.logging.username+"</label>"),$("#inputUsername").append('<input id="myusernametag" name="myusernametag" class="col-md-8" placeholder="'+MSG.logging.chooseUsername+'">'),e.createIconModule(),$("#loggingModalBody").append('<button id="reset_modal_dialog_button" type="button" class="btn btn-default mt-4">'+MSG.logging.reset+"</button>"),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),e.showDialog(),e.makeIconsResponsive(),$("#reset_modal_dialog_button").click((function(){e.resetSelectedIcons()})),$("#submit_modal_dialog_button").click((function(){e.registerUser()}))}},{key:"registerUser",value:function(){var e=this,t=[];if(User.username=$("input[name=myusernametag]").val(),User.password=JSON.stringify(e.currentlySelectedIcons),t.push(e.validator.validateId(e.currentlySelectedIcons)),e.validator.hasErrors(t))e.showErrors(t);else{var n={userId:User.username,password:JSON.stringify(e.currentlySelectedIcons)};$.ajax({type:"POST",url:d.getServerUrl()+"/authentication/new",data:n}).done((function(t){e.eventLogger.setUserId(e.username),e.resetSelectedIcons(),e.removeDialog(),e.showSettingsMenu()})).fail((function(e,t){console.log("Failed to register:",t)}))}}},{key:"showSettingsMenu",value:function(){var e=this;$.ajax({type:"GET",url:d.getServerUrl()+"/schools/"}).done((function(t){e.schools=t,e.createLoggingModalDialog(MSG.logging.setup),$("#loggingModalBody").append('<div id="inputSchool" class="ui-widget row mb-4">'),$("#inputSchool").append('<label for="myschooltags" class="col-md-2">'+MSG.logging.school+"</label>"),$("#inputSchool").append('<input id="myschooltags" name="myschooltags" class="form-control col-md-8" placeholder="'+MSG.logging.selectSchool+'">'),$("#loggingModalBody").append('<div id="inputAge" class="ui-widget row mb-4"></div>'),$("#inputAge").append('<label for="birth" class="col-md-3">'+MSG.logging.birth+"</label>"),$("#inputAge").append('<input type="date" class="form-control col-md-7" id="birth">'),$("#loggingModalBody").append('<div id="inputGender" class="ui-widget row mb-4"></div>'),$("#inputGender").append('<label for="birth" class="col-md-3">'+MSG.logging.gender+"</label>"),$("#inputGender").append('<div id="genderOptions" class="col-md-7">'),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="f">'+MSG.logging.gender1+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="m">'+MSG.logging.gender2+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="x">'+MSG.logging.gender3+"</label>"),$("#genderOptions").append('<label class="radio-inline"><input type="radio" name="genderRadio" value="na">'+MSG.logging.gender4+"</label>");var n=new Date,o=("0"+n.getDate()).slice(-2),r=("0"+(n.getMonth()+1)).slice(-2),a=n.getFullYear()+"-"+r+"-"+o;$("#birth").val(a),$("#loggingModalFooter").append('<button id="submit_modal_dialog_button" type="button" class="btn btn-default">'+MSG.logging.ok+"</button>"),$("#loggingModal").modal("show"),e.schoolsAutocomplete=new autoComplete({selector:'input[name="myschooltags"]',minChars:2,source:function(e,n){e=e.toLowerCase();var o=t,r=[];for(i=0;i<o.length;i++)~o[i].naam.toLowerCase().indexOf(e)&&r.push(o[i].naam+", "+o[i].gemeente);n(r)}}),$("#submit_modal_dialog_button").click((function(){var t=[],n=$("input[name=myschooltags]").val(),i=$("#birth").val(),o=$("input[name=genderRadio]:checked").val();if(t.push(e.validator.validateSchool(n)),t.push(e.validator.validateGender(o)),e.validator.hasErrors(t))e.showErrors(t);else{e.eventLogger.setSchool(n),e.eventLogger.setDateOfBirth(i),e.eventLogger.setGender(o);var r={userId:User.username,password:User.password,school:n,dateOfBirth:i,gender:o};$.ajax({type:"POST",url:d.getServerUrl()+"/authentication/updateUser",data:r}).done((function(t){e.removeDialog(),console.log("[act;"+(e.eventLogger.dateOfBirth||"")+";"+(e.eventLogger.userId||"")+";"+(e.eventLogger.school||"")+"]")})).fail((function(e,t){console.warn("Failed to log in:",t)}))}}))})).fail((function(e,t){console.warn("Failed to fetch schools:",t)}))}},{key:"showDialog",value:function(){$("#loggingModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#loggingModal"),$(".modal-backdrop").remove()}},{key:"createLoggingModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="loggingModal" class="modal fade" role="dialog"></div>'),$("#loggingModal").append('<div id="loggingModalDialog" class="modal-dialog"></div>'),$("#loggingModalDialog").append('<div id="loggingModalContent" class="modal-content"></div>'),$("#loggingModalContent").append('<div id="loggingModalHeader" class="modal-header"></div>'),$("#loggingModalContent").append('<div id="loggingModalBody" class="modal-body"></div>'),$("#loggingModalContent").append('<div id="loggingModalFooter" class="modal-footer"></div>'),$("#loggingModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#loggingModalHeader").append('<h4 class="modal-title">'+e+"</h4>")}},{key:"createLoggingModalDialogWithoutFooter",value:function(e){this.removeDialog(),$("#db_body").append('<div id="loggingModal" class="modal fade" role="dialog"></div>'),$("#loggingModal").append('<div id="loggingModalDialog" class="modal-dialog"></div>'),$("#loggingModalDialog").append('<div id="loggingModalContent" class="modal-content"></div>'),$("#loggingModalContent").append('<div id="loggingModalHeader" class="modal-header"></div>'),$("#loggingModalContent").append('<div id="loggingModalBody" class="modal-body"></div>'),$("#loggingModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#loggingModalHeader").append('<h4 class="modal-title">'+e+"</h4>")}},{key:"showErrors",value:function(e){$("div").remove("#loggingModalErrors"),$("#loggingModalBody").append('<div id="loggingModalErrors" class="mt-4"></div>');for(var t=e.length,n=0;n<t;n++)null!=e[n]&&$("#loggingModalErrors").append("<p>"+e[n].message+"</p>")}},{key:"createIconModule",value:function(){$("#loggingModalBody").append('<div class="row"><div class="col-md-12 mt-4"><b>'+MSG.logging.choosePassword+"</b></div></div>"),$("#loggingModalBody").append('<div class="row"><div class="col-md-3 mt-4 mb-4">'+MSG.logging.currentlySelected+'</div><div class="col-md-8 mt-4 mb-4"><div id="currentlySelected" class="row"></div></div>'),$("#currentlySelected").append('<div id="currentlySelected0" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected1" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected2" class="col-2"></div>'),$("#currentlySelected").append('<div id="currentlySelected3" class="col-2"></div>'),this.createIconGrid()}},{key:"makeIconsResponsive",value:function(){for(var e=this,t=function(t){for(var n=function(n){$("#r"+t+"c"+n).click((function(){e.addIconToId(t,n)}))},i=1;i<5;i++)n(i)},n=1;n<5;n++)t(n)}},{key:"createIconGrid",value:function(){$("#loggingModalBody").append('<div id="inputIcons"></div>'),$("#inputIcons").append('<div id="row1" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row2" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row3" class="ui-widget row ml-1"></div>'),$("#inputIcons").append('<div id="row4" class="ui-widget row ml-1"></div>');for(var e=1;e<5;e++)for(var t=1;t<5;t++){$("#row"+e).append('<div id="r'+e+"c"+t+'" class="col-md-2 authentication_item mr-1 mb-1"></div>');var n=4*(e-1)+t,i=this.icons[n-1];$("#r"+e+"c"+t).append('<div class="category_tag">'+i.name+"</div>"),$("#r"+e+"c"+t).append('<div id="school_user_img">'+i.html+"</div>")}}},{key:"resetSelectedIcons",value:function(){for(var e=0;e<4;e++)this.currentlySelectedIcons[e]=null,$("#currentlySelected"+e).html("")}},{key:"addIconToId",value:function(e,t){for(var n=0;n<4;n++)if(null==this.currentlySelectedIcons[n]){var i=4*(e-1)+t,o=this.icons[i-1];this.currentlySelectedIcons[n]=o.id,$("#currentlySelected"+n).html(o.name+"<p>"+o.html+"</p>");break}}}]),e}(),h=function(){function e(){r()(this,e),c()(this,"sessionId",null),c()(this,"tutorialId",null),c()(this,"school",null),c()(this,"userId",null),c()(this,"dataOfBirth",""),c()(this,"genderSetting",""),c()(this,"tutialIdSetting",""),c()(this,"computerId","-1"),c()(this,"workshopId","-1"),c()(this,"loggingModal",null),this.loggingModal=new p(this)}return s()(e,[{key:"init",value:function(){var e=this,t={};$(document).keydown((function(n){t[n.which]=!0,t[69]&&t[83]&&t[84]&&e.loggingModal.createInitialMenu()})),$(document).keyup((function(e){delete t[e.which]})),this.sessionId=window.sessionStorage.loadOnceSessionId,delete window.sessionStorage.loadOnceSessionId,this.sessionId||$.ajax({type:"GET",url:d.getServerUrl()+"/logging/id"}).done((function(t){e.sessionId=t})).fail((function(e,t){console.warn("Failed to fetch sessionId:",t)}))}},{key:"createEvent",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r={timestamp:$.now(),name:t,simulatorState:o,selectedDifficulty:i,activeTutorial:e.tutorialIdSetting,groupId:e.activityIdSetting,computerId:e.computerId,workshopId:e.workshopId,data:n};return r}},{key:"recordEvent",value:function(t){var n={timestamp:$.now(),userId:e.userId,school:e.school,sessionId:e.sessionId,dateOfBirth:e.agegroupSetting,gender:e.genderSetting,event:t};console.log(t),void 0!==this.sessionId&&$.ajax({type:"POST",url:d.getServerUrl()+"/logging/event",data:n}).done((function(e){console.debug("Recording submitted",e)})).fail((function(e,t){console.warn("Failed to submit recording:",t)}))}},{key:"setUserId",value:function(e){this.userId=e}},{key:"setSchool",value:function(e){this.school=e}},{key:"setDateOfBirth",value:function(e){this.dateOfBirth=e}},{key:"setGender",value:function(e){this.genderSetting=e}}]),e}(),f=n(4),g=n.n(f),m=n(7),v=n.n(m),_=n(5),y=n.n(_),b=n(6),k=n.n(b),S=n(3),w=n.n(S),E=function(){function e(){r()(this,e)}return s()(e,null,[{key:"mapButtonIdToIndex",value:function(t){return e.map[t]}},{key:"mapIndexToButtonId",value:function(t){for(var n in e.map)if(e.map[n]===t)return n}},{key:"mapButtonPinNameToIndex",value:function(t){return e.pinMap[t]}},{key:"mapIndexToButtonPinName",value:function(t){for(var n in e.pinMap)if(e.pinMap[n]===t)return n}}]),e}();c()(E,"map",{sim_button_N:0,sim_button_W:1,sim_button_C:2,sim_button_E:3,sim_button_S:4}),c()(E,"pinMap",{SW_N:0,SW_W:1,SW_C:2,SW_E:3,SW_S:4});var x=E,I=function(){function e(){r()(this,e),c()(this,"pins",new Array(44)),c()(this,"pinMapping",{}),c()(this,"lcdContent",new Array(2));for(var t=0;t<24;++t)this.pinMapping[t+""]=t;for(var n=0;n<8;++n)this.pinMapping["A"+n]=24+n;this.pinMapping.SW_N=16,this.pinMapping.SW_E=17,this.pinMapping.SW_S=18,this.pinMapping.SW_W=19,this.pinMapping.SW_C=32,this.pinMapping.BUZZER=33,this.pinMapping.LCD_BACKLIGHT=20,this.pinMapping.DC_MOTOR_1=34,this.pinMapping.DC_MOTOR_2=35,this.pinMapping.SERVO_MOTOR_1=36,this.pinMapping.SERVO_MOTOR_2=37;for(var i=0;i<8;++i)this.pinMapping["LED"+i]=38+i;for(var o=33;o<45;o++)this.pinMapping[o+""]=o;this.pinMapping.LED13=13,this.lcdContent[0]=" ".repeat(16),this.lcdContent[1]=" ".repeat(16),this.resetBoard()}return s()(e,[{key:"resetBoard",value:function(){this.lcdContent=new Array(2),this.lcdContent[0]=" ".repeat(16),this.lcdContent[1]=" ".repeat(16);for(var e=0;e<24;++e)this.pins[this.pinMapping[e+""]]=0;for(var t=0;t<8;++t)this.pins[this.pinMapping["A"+t]]=0;this.pins[this.pinMapping.LCD_BACKLIGHT]=0,this.pins[this.pinMapping.BUZZER]=0,this.pins[this.pinMapping.DC_MOTOR_1]=0,this.pins[this.pinMapping.DC_MOTOR_2]=0,this.pins[this.pinMapping.SERVO_MOTOR_1]=0,this.pins[this.pinMapping.SERVO_MOTOR_2]=0;for(var n=0;n<8;++n)this.pins[this.pinMapping.LED0+n]=0;this.pins[this.pinMapping.LED13]=0,this.pins[this.pinMapping.SW_N]=1,this.pins[this.pinMapping.SW_E]=1,this.pins[this.pinMapping.SW_S]=1,this.pins[this.pinMapping.SW_W]=1,this.pins[this.pinMapping.SW_C]=1}},{key:"setTonePlaying",value:function(e){this.setTonePlayingOnPin(e,"BUZZER")}},{key:"getTonePlaying",value:function(){return this.getTonePlayingOnPin("BUZZER")}},{key:"setTonePlayingOnPin",value:function(e,t){this.pins[this.pinMapping[t]]=e}},{key:"getTonePlayingOnPin",value:function(e){return this.pins[this.pinMapping[e]]}},{key:"setLcdContent",value:function(e,t){var n=t;e<0||e>1||(t.length>16&&(n=t.substr(0,16)),this.lcdContent[e]=n)}},{key:"getLcdContent",value:function(e){if(e<0||e>1)throw new Error("This is not a valid line number");return this.lcdContent[e]}},{key:"setBacklight",value:function(e){if(1!=e&&0!=e)throw new Error("Invalid status");this.pins[this.pinMapping.LCD_BACKLIGHT]=e}},{key:"getBackLightStatus",value:function(){return this.pins[this.pinMapping.LCD_BACKLIGHT]}},{key:"setServoAngle",value:function(e,t){this.pins[this.pinMapping["SERVO_MOTOR_"+e]]=t,console.log("setServoAngle",this.pins[this.pinMapping["SERVO_MOTOR_"+e]])}},{key:"getServoAngle",value:function(e){return this.pins[this.pinMapping["SERVO_MOTOR_"+e]]}},{key:"setMotorSpeed",value:function(e,t){if(e>2||e<1)throw Error("No motor with this number");t>255&&(motorspeed=255),this.pins[this.pinMapping["DC_MOTOR_"+e]]=t}},{key:"getMotorSpeed",value:function(e){if(e>2||e<1)throw Error("No motor with this number");return this.pins[this.pinMapping["DC_MOTOR_"+e]]}},{key:"setLedState",value:function(e,t){8==e?this.pins[this.pinMapping.LED13]=t:this.pins[this.pinMapping["LED"+e]]=t}},{key:"getLedState",value:function(e){return 8==e?this.pins[this.pinMapping.LED13]:this.pins[this.pinMapping["LED"+e]]}},{key:"setButtonState",value:function(e,t){var n=x.mapIndexToButtonPinName(e);this.pins[this.pinMapping[n]]=t}},{key:"getButtonState",value:function(e){var t=x.mapIndexToButtonPinName(e);return this.pins[this.pinMapping[t]]}},{key:"setSonarDistance",value:function(e,t,n){this.setIoPinState(e,n),this.setIoPinState(t,n)}},{key:"getSonarDistance",value:function(e,t){return this.getIoPinState(t)}},{key:"setIoPinState",value:function(e,t){var n=e+"";this.pins[this.pinMapping[n]]=t}},{key:"getIoPinState",value:function(e){var t=e+"";return this.pins[this.pinMapping[t]]}},{key:"setAnalogIoPinState",value:function(e,t){if(!e.startsWith("A"))throw new Error("Not a valid analog pin name!");this.setIoPinState(e,t)}},{key:"getAnalogIoPinState",value:function(e){if(!e.startsWith("A"))throw new Error("Not a valid analog pin name!");return this.getIoPinState(e)}}]),e}(),T={motorRadius:10,motorDistance:380,nrOfSteps:200},C=function(){function e(t){r()(this,e),c()(this,"boardState",null),c()(this,"currentScenario",null),c()(this,"stepmotorQueue",[]),c()(this,"servoAngleQueue",[]),c()(this,"colorQueue",[]),c()(this,"stepperPins",[33,34]),c()(this,"penPositionPins",[36,37]),c()(this,"colorPin",35),c()(this,"stylusPosPin",38),c()(this,"drawingActive",!1),this.boardState=t}return s()(e,[{key:"setCurrentScenario",value:function(e){this.currentScenario=e}},{key:"clearLcd",value:function(){for(var e=0;e<2;e++)this.writeLcd(" ".repeat(16),e,0)}},{key:"writeLcd",value:function(e,t,n){this.boardState.setBacklight(1);var i=this.boardState.getLcdContent(t).substr(0,n),o=0;i.length<n&&(o=n-i.length),e=i+" ".repeat(o)+e.substring(0,16-n),this.boardState.getLcdContent(t).substr(e.length+n,16),this.boardState.setLcdContent(t,e)}},{key:"digitalWrite",value:function(e,t){var n=Number(e);n>=32&&n<=39||13===n?(n>=32&&n<=39&&(n-=32),"HIGH"===t||1==t?13===n?this.boardState.setLedState(8,1):this.boardState.setLedState(n,1):13===n?this.boardState.setLedState(8,0):this.boardState.setLedState(n,0)):this.boardState.setIoPinState(n,t)}},{key:"analogWrite",value:function(e,t){this.boardState.setAnalogIoPinState(e,t)}},{key:"digitalRead",value:function(e){if(e.startsWith("SW_")){var t=x.mapButtonPinNameToIndex(e);return this.boardState.getButtonState(t)}return(e=Number(e))>=32&&e<=39||13===e?(e>=32&&e<=39&&(e-=32),this.boardState.getButtonState(e)):1}},{key:"analogRead",value:function(e){return this.boardState.getAnalogIoPinState(e)}},{key:"setLeds",value:function(e){e=e.toString(2);for(var t=0;t<8;t++)this.digitalWrite(32+t,0);var n=8-e.length;n<0&&(n=0);for(t=0;t<Math.min(e.length,8);t++)this.digitalWrite(39-(n+t),e[t])}},{key:"tone",value:function(e,t){"BUZZER"===e&&this.boardState.setTonePlaying(t)}},{key:"noTone",value:function(e){"BUZZER"===e&&this.boardState.setTonePlaying(0)}},{key:"servo",value:function(e,t){t>180&&(t=180),t<0&&(t=0);var n=e+35;t!==this.boardState.getServoAngle(e)&&(this.boardState.setServoAngle(e,t),this.boardState.setIoPinState(n,t))}},{key:"servoWithPin",value:function(e,t){t!==this.boardState.getIoPinState(e)&&this.boardState.setIoPinState(e,t)}},{key:"startDcMotor",value:function(e,t){t>255&&(t=255),t<-255&&(t=-255),t!==this.boardState.getMotorSpeed(e)&&this.boardState.setMotorSpeed(e,t)}},{key:"sonar",value:function(e,t){return Math.round(this.boardState.getSonarDistance(e,t))}},{key:"pir",value:function(e){return this.boardState.getIoPinState(e)}},{key:"rgbLed",value:function(e,t){console.log(e,"pins"),console.log(t,"rgbColor"),this.analogWrite(e[0],t[0]),this.analogWrite(e[1],t[1]),this.analogWrite(e[2],t[2])}},{key:"sleep",value:function(e){}},{key:"stepperMotorStep",value:function(e,t){var n=t>0?1:-1;this.boardState.setIoPinState(e,this.boardState.getIoPinState(e)+n)}},{key:"stepMotorSteps",value:function(e,t){for(var n=0;n<Math.abs(t);++n)this.stepperMotorStep(e,t)}},{key:"stepMotorsTo",value:function(e){for(var t=[0,0],n=0;n<t.length;++n)t[n]=this.boardState.getIoPinState(this.penPositionPins[n])+e[n];for(var i=this.coordinatesToSteps(t),o=0;o<i.length;++o)this.boardState.setIoPinState(this.stepperPins[o],i[o])}},{key:"coordinatesToSteps",value:function(e){var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),n=Math.sqrt(Math.pow(e[1],2)+Math.pow(T.motorDistance-e[0],2)),i=2*Math.PI*T.motorRadius/T.nrOfSteps;return[t/=i,n/=i]}},{key:"drawRobotCheckPosition",value:function(e){var t=DwenguinoSimulation.currentScenario;(e[0]<t.paper.position.x||e[0]>t.paper.position.x+t.paper.width||e[1]<t.paper.position.y||e[1]>t.paper.position.y+t.paper.height)&&(window.stepMotorError||(alert(MSG.bounds),DwenguinoSimulation.handleSimulationStop(),window.stepMotorError=!0))}},{key:"drawRobotLine",value:function(e,t,n){n&&(e+=20,t+=40);for(var i=[0,0],o=0;o<i.length;++o)i[o]=this.boardState.getIoPinState(this.penPositionPins[o]);var r=i,a=Math.atan((t-r[1])/(e-r[0])),s=Math.sqrt(Math.pow(r[0]-e,2)+Math.pow(r[1]-t,2)),l=Math.cos(a),c=Math.sin(a);this.update(s,l,c),this.drawingActive=!0}},{key:"update",value:function(e,t,n){var i=this;e>0?(this.stepMotorsTo([t,n]),this.currentScenario.updateScenario(this.boardState),setTimeout((function(){i.update(e-1,t,n)}),30)):this.drawingActive=!1}},{key:"drawRobotLowerStylus",value:function(){this.boardState.setIoPinState(this.stylusPosPin,0)}},{key:"drawRobotLiftStylus",value:function(){this.boardState.setIoPinState(this.stylusPosPin,90)}},{key:"changeColor",value:function(e){this.boardState.setIoPinState(this.colorPin,e)}}]),e}();function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var P,A=function(e){y()(n,e);var t=M(n);function n(e,i){var o;return r()(this,n),o=t.call(this),c()(g()(o),"logger",null),c()(g()(o),"workspace",null),c()(g()(o),"simulationViewContainerId","db_simulator_panes"),o.logger=e,o.workspace=i,o}return s()(n,[{key:"resetDwenguino",value:function(){v()(w()(n.prototype),"resetDwenguino",this).call(this),-1!==this.debugger.blocks.lastColours[0]&&this.debugger.blocks.lastBlocks[0].setColour(this.debugger.blocks.lastColours[0]),this.debugger.blocks.lastColours=[-1,-1],this.debugger.blocks.lastBlocks=[null,null]}},{key:"initScenario",value:function(){this.currentScenario.initSimulationState(this.board),this.currentScenario.initSimulationDisplay(this.simulationViewContainerId),this.currentScenario.updateScenario(this.board)}},{key:"initDebugger",value:function(){var e=Blockly.JavaScript.workspaceToCode(this.workspace);v()(w()(n.prototype),"initDebugger",this).call(this,e),this.mapBlocksToCode(),this.updateBlocklyColour()}},{key:"step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];v()(w()(n.prototype),"step",this).call(this,e),!this.isSimulationPaused&&this.isSimulationRunning&&this.updateBlocklyColour()}},{key:"mapBlocksToCode",value:function(){for(var e=this,t=this.workspace.getAllBlocks()[0],n=0,i=this.debugger.code.split("\n"),o=[],r=function(){if(i[n].trim()===Blockly.JavaScript.blockToCode(a).split("\n")[0]&&(i[n].trim().startsWith("for")||i[n].trim().startsWith("while")||i[n].trim().startsWith("if"))?(o.push(a),e.debugger.blocks.blockMapping[n]=a,a=a.getInputTargetBlock("DO")||a.getInputTargetBlock("DO0")):i[n].trim()===Blockly.JavaScript.blockToCode(a).split("\n")[0]&&(e.debugger.blocks.blockMapping[n]=a,a=a.getNextBlock()),null===a&&o.length>0){var t=o.pop();a=t.getNextBlock(),n++}n++},a=t.getInputTargetBlock("SETUP");null!==a&&n<i.length;)r();for(;o.length>0;)o.pop(),n++;for(;n<i.length&&"while (true) {"!==i[n];)n++;for(n<i.length&&(this.debugger.blocks.blockMapping[n]=t,n++),a=t.getInputTargetBlock("LOOP");null!==a&&n<i.length;)r()}},{key:"updateBlocklyColour",value:function(){var e=this.debugger.debuggerjs.machine.getCurrentLoc().start.line-1;""!==this.debugger.code&&void 0!==this.debugger.blocks.blockMapping[e]&&(null!==this.debugger.blocks.lastBlocks[0]&&this.debugger.blocks.lastBlocks[0].setColour(this.debugger.blocks.lastColours[0]),this.debugger.blocks.lastBlocks[0]=this.debugger.blocks.lastBlocks[1],this.debugger.blocks.lastColours[0]=this.debugger.blocks.lastColours[1],this.debugger.blocks.lastBlocks[1]=this.debugger.blocks.blockMapping[e],this.debugger.blocks.lastColours[1]=this.debugger.blocks.blockMapping[e].getColour(),null!==this.debugger.blocks.lastBlocks[0]&&this.debugger.blocks.lastBlocks[0].setColour(210))}}]),n}(function(){function e(){r()(this,e),c()(this,"board",null),c()(this,"debugger",null),c()(this,"simulationSandbox",null),c()(this,"currentScenario",null),c()(this,"speedDelay",16),c()(this,"baseSpeedDelay",16),c()(this,"isSimulationRunning",!1),c()(this,"isSimulationPaused",!1),this.board=new I,this.simulationSandbox=new C(this.board),this.initDebuggerState()}return s()(e,[{key:"initDebuggerState",value:function(){this.debugger={debuggerjs:null,code:"",blocks:{lastBlocks:[null,null],lastColours:[-1,-1],blockMapping:{}}}}},{key:"setCurrentScenario",value:function(e){this.currentScenario=e,this.simulationSandbox.setCurrentScenario(this.currentScenario),this.resetDwenguino()}},{key:"initScenario",value:function(){this.currentScenario.initSimulationState(this.board),this.currentScenario.initSimulationDisplay(""),this.currentScenario.updateScenario(this.board)}},{key:"resetDwenguino",value:function(){this.debugger.debuggerjs=null,this.debugger.code="",this.debugger.blocks.blockMapping={},this.board.resetBoard(),this.initScenario()}},{key:"createDebugger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return debugjs.createDebugger(e)}},{key:"initDebugger",value:function(e){this.resetDwenguino(),this.debugger.code=e,this.debugger.debuggerjs=this.createDebugger({iframeParentElement:document.getElementById("debug"),sandbox:{DwenguinoSimulation:this.simulationSandbox}}),this.debugger.debuggerjs.machine.on("error",(function(e){console.log(e),console.error(e.message)}));this.debugger.debuggerjs.load(this.debugger.code,"DwenguinoSimulation"),this.debugger.debuggerjs.machine.step()}},{key:"step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isSimulationPaused&&this.isSimulationRunning){var t=this.debugger.debuggerjs.machine.getCurrentLoc().start.line-1;this.debugger.debuggerjs.machine.step();var n=void 0===this.debugger.code.split("\n")[t]?"":this.debugger.code.split("\n")[t];if(this.currentScenario.updateScenario(this.board),n.trim().startsWith("DwenguinoSimulation.sleep")){var i=Number(this.debugger.code.split("\n")[t].replace(/\D+/g,""));this.delayStepsTaken=0,this.delayStepsToTake=Math.floor(i/this.baseSpeedDelay),this.delayRemainingAfterSteps=i%this.baseSpeedDelay,this.performDelayLoop(e)}else e?this.setIsSimulationPaused(!0):setTimeout(this.step.bind(this),this.speedDelay);this.checkForEnd()}}},{key:"performDelayLoop",value:function(e){var t=this;this.delayStepsTaken<this.delayStepsToTake?(this.currentScenario.updateScenario(this.board),this.delayStepsTaken++,setTimeout((function(){t.performDelayLoop(e)}),this.speedDelay)):e?this.setIsSimulationPaused(!0):setTimeout((function(){t.step()}),this.delayRemainingAfterSteps)}},{key:"handleScope",value:function(){var e=this.debugger.debuggerjs.machine.getCurrentStackFrame().scope;for(var t in e){var n=e[t];this.debugger.debuggerjs.machine.$runner.gen.stackFrame.evalInScope(n.name)}}},{key:"checkForEnd",value:function(){(this.isSimulationRunning||this.isSimulationPaused)&&this.debugger.debuggerjs.machine.halted&&(this.setIsSimulationRunning(!1),this.setIsSimulationPaused(!1))}},{key:"setIsSimulationRunning",value:function(e){this.isSimulationRunning=e,this.currentScenario.setIsSimulationRunning(this.isSimulationRunning)}},{key:"setIsSimulationPaused",value:function(e){this.isSimulationPaused=e}}]),e}()),O=Object.freeze((P={downloadClicked:"downloadClicked",blockyBlockCreate:"blocklyBlockCreate",blocklyBlockDelete:"blocklyBlockDelete",blocklyBlockMove:"blocklyBlockMove",blocklyVarCreate:"blocklyVarCreate",blocklyVarDelete:"blocklyVarDelete",blocklyVarRename:"blocklyVarRename",blocklyUI:"blocklyUI",blocklyChange:"blocklyChange",undo:"undo",uploadClicked:"uploadClicked",simButtonStateClicked:"simButtonStateClicked",runClicked:"runClicked",changedWorkspace:"changedWorkspace",downloadScenarioClicked:"downloadScenarioClicked",moveRobotComponent:"moveRobotComponent",addRobotComponent:"addRobotComponent",removeRobotComponent:"removeRobotComponent"},c()(P,"addRobotComponent","addRobotComponent"),c()(P,"changedScenario","changedScenario"),c()(P,"simStart","simStart"),c()(P,"simResume","simResume"),c()(P,"simPause","simPause"),c()(P,"simStopButtonClicked","simStopButtonClicked"),c()(P,"simStep","simStep"),c()(P,"simStop","simStop"),c()(P,"setSpeed","setSpeed"),c()(P,"startTutorial","startTutorial"),c()(P,"endTutorial","endTutorial"),c()(P,"tutorialNextStep","tutorialNextStep"),c()(P,"tutorialPrevStep","tutorialPrevStep"),P)),R=function(){function e(t,n,i){r()(this,e),c()(this,"simulationRunner",null),c()(this,"scenarioView","spyrograph"),c()(this,"scenarios",null),c()(this,"logger",null),this.logger=t,this.scenarios=i,this.simulationRunner=new A(this.logger,n),this.simulationRunner.setCurrentScenario(this.scenarios[this.scenarioView]),this.initSimulationControlsUI(i)}return s()(e,[{key:"initSimulationControlsUI",value:function(e){var t=this;$("#db_simulator_menu").empty(),$("#db_infopane").prepend('<div id="db_simulator_menu"></div>'),$("#db_simulator_menu").append('<div id="sim_menu"></div>'),$("#sim_menu").append('<div id="sim_start" class="sim_item"></div>'),$("#sim_menu").append('<div id="sim_pause" class="sim_item_disabled"></div>'),$("#sim_menu").append('<div id="sim_stop" class="sim_item_disabled"></div>'),$("#sim_menu").append('<div id="sim_step" class="sim_item"></div>'),$("#sim_menu").append('<div id="sim_scenarioTag" ></div>'),$("#sim_menu").append('<div id="sim_scenarios" class="btn-group btn-group-toggle" data-toggle="buttons"></div>'),$.each(Object.keys(this.scenarios),(function(e,n){var i='<label id="scenario_label_'+n+'" class="btn sim_scenario_btn"></label>',o='<input id="sim_scenario_'+n+'"type="radio" name="scenario_type" class="sim_scenario_radio" value="'+n+'" autocomplete="off"><img src="DwenguinoIDE/img/scenarios/scenario_'+n+'.png" class="scenario_image">';$("#sim_scenarios").append(i),$("#scenario_label_"+n).append(o),n==t.scenarioView&&($("#sim_scenario_"+n).attr("checked","checked"),$("#scenario_label_"+n).attr("class","btn sim_scenario_btn active"))})),this.translateSimulatorInterface(),$("#sim_speed").on("change",(function(){t.setSpeed()}));var n=this;$("input[name=scenario_type]:radio").change((function(){console.log($(this).val()),n.scenarioView=$(this).val(),n.translateSimulatorInterface(),n.handleSimulationStop(),n.simulationRunner.setCurrentScenario(n.scenarios[n.scenarioView]),n.logger.recordEvent(n.logger.createEvent(O.changedScenario,this.scenarioView))})),$("#sim_start").click((function(){t.setButtonsStart(),t.simulationRunner.isSimulationRunning||t.simulationRunner.isSimulationPaused?t.simulationRunner.isSimulationRunning||(t.logger.recordEvent(t.logger.createEvent(O.simResume,"")),t.simulationRunner.setIsSimulationPaused(!1),t.simulationRunner.setIsSimulationRunning(!0),t.resumeSimulation()):(t.simulationRunner.setIsSimulationRunning(!0),t.startSimulation(),t.logger.recordEvent(t.logger.createEvent(O.simStart,"")))})),$("#sim_pause").click((function(){t.logger.recordEvent(t.logger.createEvent(O.simPause,"")),t.simulationRunner.setIsSimulationRunning(!1),t.simulationRunner.setIsSimulationPaused(!0),t.setButtonsPause()})),$("#sim_stop").click((function(){t.logger.recordEvent(t.logger.createEvent(O.simStopButtonClicked,"")),t.handleSimulationStop()})),$("#sim_step").click((function(){t.setButtonsStep(),t.logger.recordEvent(t.logger.createEvent(O.simStep,"")),t.simulationRunner.isSimulationPaused||t.simulationRunner.isSimulationRunning?t.simulationRunner.isSimulationRunning||(t.simulationRunner.setIsSimulationPaused(!1),t.simulationRunner.step(!0),t.setIsSimulationPaused(!0)):(t.startStepSimulation(),t.simulationRunner.setIsSimulationPaused(!0))}));var i=function(e,t,n){$.each(t,(function(e,t){var n=$(t.attr("href"));t.removeClass("active"),n.hide()})),$(e).addClass("active"),$(e.hash).show(),n.preventDefault()};$("a[href$='#db_code_pane']").click((function(e){i(this,[$("a[href$='#db_robot_pane']")],e)})),$("a[href$='#db_robot_pane']").click((function(e){i(this,[$("a[href$='#db_code_pane']")],e)})),$("a[href$='#db_robot_pane']").trigger("click")}},{key:"translateSimulatorInterface",value:function(){document.getElementById("sim_start").innerHTML="<span class='glyphicon glyphicon-play' alt='"+MSG.simulator.start+"'></span>",document.getElementById("sim_stop").innerHTML="<span class='glyphicon glyphicon-stop' alt='"+MSG.simulator.stop+"'></span>",document.getElementById("sim_pause").innerHTML="<span class='glyphicon glyphicon-pause' alt='"+MSG.simulator.pause+"'></span>",document.getElementById("sim_step").innerHTML="<span class='glyphicon glyphicon-step-forward' alt='"+MSG.simulator.step+"'></span>",document.getElementById("sim_scenarioTag").textContent=MSG.simulator.scenario+":"}},{key:"startSimulation",value:function(){this.startDebuggingView(),this.simulationRunner.initDebugger(),this.simulationRunner.step()}},{key:"startStepSimulation",value:function(){this.startDebuggingView(),this.simulationRunner.initDebugger(),this.simulationRunner.step(!0)}},{key:"stopSimulation",value:function(){this.stopDebuggingView(),this.simulationRunner.resetDwenguino()}},{key:"resumeSimulation",value:function(){this.simulationRunner.step()}},{key:"handleSimulationStop",value:function(){this.logger.recordEvent(this.logger.createEvent(O.simStop,"")),this.simulationRunner.setIsSimulationRunning(!1),this.simulationRunner.setIsSimulationPaused(!1),this.setButtonsStop(),this.stopSimulation()}},{key:"setButtonsStart",value:function(){document.getElementById("sim_pause").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_start").className="sim_item_disabled",document.getElementById("sim_step").className="sim_item_disabled"}},{key:"setButtonsPause",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"setButtonsStop",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item_disabled",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"setButtonsStep",value:function(){document.getElementById("sim_start").className="sim_item",document.getElementById("sim_step").className="sim_item",document.getElementById("sim_stop").className="sim_item",document.getElementById("sim_pause").className="sim_item_disabled"}},{key:"startDebuggingView",value:function(){0!==document.getElementsByClassName("alertDebug").length&&document.getElementsByClassName("alertDebug")[0].remove();var e='<div class ="alertDebug">'+MSG.simulator.alertDebug+"</div>";$("#db_body").append(e),document.getElementsByClassName("alertDebug")[0].style.width=document.getElementById("blocklyDiv").style.width,document.querySelector('input[id="code_checkbox"]').checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible"):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("blocklyDiv").style.opacity="0.5",document.getElementById("db_code_pane").style.visibility="hidden"),document.getElementById("db_code_pane").style.opacity="0.5",document.getElementById("blocklyDiv").style.opacity="0.5"}},{key:"stopDebuggingView",value:function(){document.querySelector('input[id="code_checkbox"]').checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible"):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("db_code_pane").style.visibility="hidden"),document.getElementById("db_code_pane").style.opacity="1",document.getElementById("blocklyDiv").style.opacity="1",document.getElementById("blocklyDiv").style.pointerEvents="auto",0!==document.getElementsByClassName("alertDebug").length&&document.getElementsByClassName("alertDebug")[0].remove()}},{key:"setSpeed",value:function(){var e=document.getElementById("sim_speed"),t=e.options[e.selectedIndex].value;switch(this.logger.recordEvent(this.logger.createEvent(O.setSpeed,t)),t){case"veryslow":this.simulationRunner.speedDelay=600;break;case"slow":this.simulationRunner.speedDelay=300;break;case"medium":this.simulationRunner.speedDelay=150;break;case"fast":this.simulationRunner.speedDelay=75;break;case"veryfast":this.simulationRunner.speedDelay=32;break;case"realtime":this.simulationRunner.speedDelay=16}}}]),e}(),B=n(8),D=n.n(B),L=(n(19),function(){function e(){r()(this,e)}return s()(e,[{key:"render",value:function(e){this.clearCanvases(),this.drawLcd(e),this.drawLeds(e),this.drawRgbLeds(e),this.drawServos(e),this.drawPirs(e),this.drawSonars(e),this.drawSoundSensors(e),this.drawLightSensors(e)}},{key:"drawLcd",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==de.LCD){for(var n=0;n<2;++n)$("#sim_lcd_row"+n).text(e[t].getState()[n]),null!==document.getElementById("sim_lcd_row"+n)&&(document.getElementById("sim_lcd_row"+n).innerHTML=document.getElementById("sim_lcd_row"+n).innerHTML.replace(/ /g,"&nbsp;"));var i=document.getElementById("sim_lcds");null!==i&&(i.style.display="none",i.offsetHeight,i.style.display="block")}}},{key:"initializeCanvas",value:function(e,t){var n=t.getCanvasId(),i=document.getElementById(n);null!==i&&(this.configureCanvasDimensions(i),this.render(e))}},{key:"clearCanvases",value:function(){for(var e=document.getElementsByClassName("sim_canvas"),t=0;t<e.length;t++){if(e.item(t).getContext)e.item(t).getContext("2d").clearRect(0,0,e.item(t).width,e.item(t).height)}}},{key:"clearCanvas",value:function(e){var t=document.getElementById(e);t.getContext&&t.getContext("2d").clearRect(0,0,t.width,t.height)}},{key:"drawLeds",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==de.LED){var n=document.getElementById(e[t].getCanvasId());this.drawLed(e[t],n)}}},{key:"drawLed",value:function(e,t){if(t.getContext){var n=t.getContext("2d");n.beginPath(),n.arc(t.width/2,t.height/2,e.getRadius(),0,2*Math.PI),1===e.getState()?n.fillStyle=e.getOnColor():n.fillStyle=e.getOffColor(),n.fill(),n.fillStyle=e.getBorderColor(),n.stroke()}else console.log(t,"This canvas has no context")}},{key:"drawRgbLeds",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==de.RGBLED){var n=document.getElementById(e[t].getCanvasId());this.drawRgbLed(e[t],n)}}},{key:"drawRgbLed",value:function(e,t){if(t.getContext){var n=this;e.getLedBackground().onload=function(){var i=t.getContext("2d"),o=e.getLedBackground();i.drawImage(o,0,0,40,30),i.beginPath(),i.arc(25,15,e.getRadius(),0,2*Math.PI);var r=e.getState();if(0==r[0]&&0==r[1]&&0==r[2])i.fillStyle="#CCCCCC";else{var a=n.rgbToHex(r);i.fillStyle=a}i.fill(),i.translate(16,6);var s=e.getLedSvg();i.drawImage(s,0,0,18,18),i.translate(-16,-6)};var i=t.getContext("2d"),o=e.getLedBackground();i.drawImage(o,0,0,40,30),i.beginPath(),i.arc(25,15,e.getRadius(),0,2*Math.PI);var r=e.getState();if(0==r[0]&&0==r[1]&&0==r[2])i.fillStyle="#CCCCCC";else{var a=n.rgbToHex(r);i.fillStyle=a}i.fill(),i.translate(16,6);var s=e.getLedSvg();i.drawImage(s,0,0,18,18),i.translate(-16,-6)}else console.log(t,"This canvas has no context")}},{key:"rgbToHex",value:function(e){return"#"+this.componentToHex(e[0])+this.componentToHex(e[1])+this.componentToHex(e[2])}},{key:"componentToHex",value:function(e){var t=e.toString(16);return 1==t.length?"0"+t:t}},{key:"drawServos",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==de.SERVO){var n=document.getElementById(e[t].getCanvasId());this.clearCanvas(e[t].getCanvasId()),this.drawServo(e[t],n)}}},{key:"drawServo",value:function(e,t){if(t.getContext){var n=this;e.getServoBackground().onload=function(){var i=t.getContext("2d");switch(e.getCostume()){case"plain":n.drawServoBackground(i,e),n.drawRotatedServohead(i,e)}},e.getImage(0).onload=function(){var i=t.getContext("2d");switch(i.fillStyle=e.getBackgroundColor(),e.getCostume()){case"plain":n.drawRotatedServohead(i,e);break;case"eye":n.drawEye(i,e,t);break;case"righthand":i.fillRect(e.getX()+100,e.getY()+30,e.getWidth()-100,e.getHeight()-60),n.drawRightHand(i,e);break;case"lefthand":i.fillRect(e.getX()+10,e.getY()+30,e.getWidth()-28,e.getHeight()-60),n.drawLeftHand(i,e)}};var i=t.getContext("2d");switch(i.fillStyle=e.getBackgroundColor(),e.getCostume()){case"plain":n.drawServoBackground(i,e),n.drawRotatedServohead(i,e);break;case"eye":n.drawEye(i,e,t);break;case"righthand":i.fillRect(e.getX()+100,e.getY()+30,e.getWidth()-100,e.getHeight()-60),n.drawRightHand(i,e);break;case"lefthand":i.fillRect(e.getX()+10,e.getY()+30,e.getWidth()-28,e.getHeight()-60),n.drawLeftHand(i,e)}}else console.log(t,"This canvas has no context")}},{key:"drawPirs",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==de.PIR){var n=document.getElementById(e[t].getCanvasId());this.drawPir(e[t],n)}}},{key:"drawPir",value:function(e,t){if(t.getContext){e.getImage().onload=function(){t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())},t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())}else console.log(t,"This canvas has no context")}},{key:"drawSonars",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==de.SONAR){var n=document.getElementById(e[t].getCanvasId());this.drawSonar(e[t],n)}}},{key:"drawSonar",value:function(e,t){if(t.getContext){e.getImage().onload=function(){t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())},t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())}else console.log(t,"This canvas has no context")}},{key:"drawServoBackground",value:function(e,t){e.translate(0,t.getY()),e.drawImage(t.getServoBackground(),0,0,t.getWidth(),t.getHeight()),e.translate(0,-t.getY())}},{key:"drawRotatedServohead",value:function(e,t){var n=this.getDirection(t.getPrevAngle(),t.getAngle()),i=t.getAngle()-t.getPrevAngle();if(0!=i)if(i>5||i<-5){var o=t.getPrevAngle()+5*n;t.setPrevAngle(o),e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(t.getPrevAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(-t.getPrevAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}else{var r=t.getPrevAngle()+i;t.setPrevAngle(r),e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(-t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}else e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(-t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}},{key:"drawEye",value:function(e,t,n){this.renderEyeBall(e,t,n),this.renderIris(e,t,n)}},{key:"renderEyeBall",value:function(e,t,n){var i=t.getImage(0);e.drawImage(i,0,0,100,100)}},{key:"renderIris",value:function(e,t,n){var i=t.getImage(1);i.src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";var o=this.getDirection(t.getPrevAngle(),t.getAngle()),r=t.getAngle()-t.getPrevAngle();if(0!=r){var a=t.getPrevAngle()/120*(n.width-60)+5;if(r>5||r<-5){var s=t.getPrevAngle()+5*o;t.setPrevAngle(s),t.getPrevAngle()>=0&t.getPrevAngle()<=120?e.drawImage(i,a,n.height/2-30,60,60):t.getPrevAngle()<=130&&(a=n.width-60+5,e.drawImage(i,a,n.height/2-30,60,60))}else{var l=t.getPrevAngle()+r;t.setPrevAngle(l),t.getPrevAngle()>=0&t.getPrevAngle()<=120?e.drawImage(i,a,n.height/2-30,60,60):t.getPrevAngle()<=130&&(a=n.width-60+5,e.drawImage(i,a,n.height/2-30,60,60))}}else{a=t.getAngle()/120*(n.width-60)+5;t.getAngle()>=0&t.getAngle()<=120?e.drawImage(i,a,n.height/2-30,60,60):t.getAngle()<=130&&(a=n.width-60+5,e.drawImage(i,a,n.height/2-30,60,60))}}},{key:"drawRightHand",value:function(e,t){var n=t.getAngle()-t.getPrevAngle();n>0?this.drawDown(e,t):n<0?this.drawUp(e,t):(e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2))}},{key:"drawDown",value:function(e,t){var n=t.getAngle()-t.getPrevAngle();if(n>=5){var i=t.getPrevAngle()+5;t.setPrevAngle(i),e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getPrevAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getPrevAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2)}else{var o=t.getPrevAngle()+n;t.setPrevAngle(o),e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2)}}},{key:"drawUp",value:function(e,t){var n=t.getPrevAngle()-t.getAngle();if(n>=5){var i=t.getPrevAngle()-5;t.setPrevAngle(i),e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getPrevAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getPrevAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2)}else{var o=t.getPrevAngle()-n;t.setPrevAngle(o),e.translate(t.getX()+t.getWidth()/2+50,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2-50,-t.getY()-t.getHeight()/2)}}},{key:"drawLeftHand",value:function(e,t){var n=this.getDirection(t.getPrevAngle(),t.getAngle()),i=t.getAngle()-t.getPrevAngle();if(0!=i)if(i>5||i<-5){var o=t.getPrevAngle()+5*n;t.setPrevAngle(o),e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(-t.getPrevAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getPrevAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}else{var r=t.getPrevAngle()+i;t.setPrevAngle(r),e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}else e.translate(t.getX()+t.getWidth()/2,t.getY()+t.getHeight()/2),e.rotate(-t.getAngle()*Math.PI/180),e.drawImage(t.getImage(0),-t.getWidth()/2,-t.getHeight()/2,t.getWidth(),t.getHeight()),e.rotate(t.getAngle()*Math.PI/180),e.translate(-t.getX()-t.getWidth()/2,-t.getY()-t.getHeight()/2)}},{key:"drawSoundSensors",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==de.SOUND){var n=document.getElementById(e[t].getCanvasId());this.drawSoundSensor(e[t],n)}}},{key:"drawSoundSensor",value:function(e,t){if(t.getContext){e.getImage().onload=function(){t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())},t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())}else console.log(t,"This canvas has no context")}},{key:"drawLightSensors",value:function(e){for(var t=0;t<e.length;t++)if(e[t].getType()==de.LIGHT){var n=document.getElementById(e[t].getCanvasId());this.drawLightSensor(e[t],n)}}},{key:"drawLightSensor",value:function(e,t){if(t.getContext){e.getImage().onload=function(){t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())},t.getContext("2d").drawImage(e.getImage(),0,0,e.getWidth(),e.getHeight())}else console.log(t,"This canvas has no context")}},{key:"configureCanvasDimensions",value:function(e){var t=window.devicePixelRatio||1,n=e.getBoundingClientRect();(e.width=n.width*t,e.height=n.height*t,e.getContext)&&e.getContext("2d").scale(t,t)}},{key:"getDirection",value:function(e,t){return t-e>0?1:-1}}]),e}()),F=function(){function e(t,n){if(r()(this,e),this._eventBus=t,this._htmlClasses=n,void 0===this.toString)throw new Error("You have to implement the method toString");if(void 0===this.toggleVisibility)throw new Error("You have to implement the method toggleVisibility");if(void 0===this.reset)throw new Error("You have to implement the method reset");if(void 0===this.insertHtml)throw new Error("You have to implement the method insertHtml to add the component to the simulation container");if(void 0===this.removeHtml)throw new Error("You have to implement the method removeHtml to remove the component from the simulation container");if(void 0===this.toXml)throw new Error("You have to implement the method toXml to save the robot component to an XML file")}return s()(e,[{key:"setHtmlClasses",value:function(e){this._htmlClasses=e}},{key:"getHtmlClasses",value:function(){return this._htmlClasses}}]),e}(),N={SAVE:"save",INITIALIZECANVAS:"initializecanvas",CLEARCANVAS:"clearcanvas"};Object.freeze(N);var j=function(){function e(t){r()(this,e),this.name=t,this.callbacks=[]}return s()(e,[{key:"registerCallback",value:function(e){this.callbacks.push(e)}}]),e}();function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var W={PLAIN:"plain",EYE:"eye",MOUTH:"mouth",RIGHTHAND:"righthand",LEFTHAND:"lefthand"};Object.freeze(W);var G=function(e){y()(n,e);var t=H(n);function n(e,i,o,a,s,l,c,u,d,p,h,f,g){var m;switch(r()(this,n),(m=t.call(this,e,g))._id=i,m._type=de.SERVO,m._width=d,m._height=p,m._x=c,m._y=u,m._offset={left:h,top:f},m._angle=s,m._prevAngle=0,m._image=[new Image,new Image],m._backgroundImage=new Image,m._backgroundImageRotated=new Image,m._backgroundImage.src="./DwenguinoIDE/img/socialrobot/servo_background.png",m._backgroundImageRotated.src="./DwenguinoIDE/img/socialrobot/servo_background_rotated.png",a){case W.PLAIN:m._image[0].src="./DwenguinoIDE/img/socialrobot/servo_head.png";break;case W.EYE:m._image[0].src="./DwenguinoIDE/img/socialrobot/eye1_background.svg",m._image[1].src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";break;case W.RIGHTHAND:m._image[0].src="./DwenguinoIDE/img/socialrobot/righthand.png";break;case W.LEFTHAND:m._image[0].src="./DwenguinoIDE/img/socialrobot/lefthand.png"}return m._backgroundColor="#206499",m._pin=o,m._costume=a,m._canvasId="sim_servo_canvas"+m._id,m.insertHtml(),m.toggleVisibility(l),m}return s()(n,[{key:"toString",value:function(){var e="";return e=(e=(e=(e=(e=(e=e.concat(this.getType()," ")).concat(this.getId()," ")).concat("Angle ",this.getAngle()," ")).concat("Costume ",this.getCostume()," ")).concat("Pin ",this.getPin()," ")).concat("CanvasId ",this.getCanvasId()," ")}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.servoOptions),e.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toggleVisibility",value:function(e){e?$("#sim_servo"+this.getId()).css("visibility","visible"):$("#sim_servo"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Angle='",this.getAngle(),"'")).concat(" PrevAngle='",this.getPrevAngle(),"'")).concat(" Pin='",parseInt(this.getPin()),"'")).concat(" Costume='",this.getCostume(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(30),this.setAngle(0),this.setPrevAngle(0)}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog(),this.createCostumeOptionsDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossibleServoPins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i);1==this.getId()?($(".pinButton").prop("disabled",!0),$(".pinButton").addClass("option_button_disabled"),$("#pin36.pinButton").prop("disabled",!1),$("#pin36.pinButton").removeClass("option_button_disabled"),$("#pin36.pinButton").addClass("option_button_selected")):2==this.getId()?($(".pinButton").prop("disabled",!0),$(".pinButton").addClass("option_button_disabled"),$("#pin37.pinButton").prop("disabled",!1),$("#pin37.pinButton").removeClass("option_button_disabled"),$("#pin37.pinButton").addClass("option_button_selected")):($(".pinButton").removeClass("option_button_disabled"),$("#pin36.pinButton").prop("disabled",!0),$("#pin37.pinButton").prop("disabled",!0),$("#pin36.pinButton").addClass("option_button_disabled"),$("#pin37.pinButton").addClass("option_button_disabled"))}},{key:"getAllPossibleServoPins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,36,37]}},{key:"createCostumeOptionsDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsCostume" class="ui-widget row mb-4">'),$("#componentOptionsCostume").append('<div class="col-md-2">'+MSG.servoCostume+"</div>"),$("#componentOptionsCostume").append('<div id="costume" class="col-md-10"></div>');for(var t={plain:"./DwenguinoIDE/img/socialrobot/servo.png",eye:"./DwenguinoIDE/img/socialrobot/eye.png",mouth:"./DwenguinoIDE/img/socialrobot/mouth.png",righthand:"./DwenguinoIDE/img/socialrobot/righthand_icon.png",lefthand:"./DwenguinoIDE/img/socialrobot/lefthand_icon.png"},n=function(){var n=D()(o[i],2),r=(n[0],n[1]);console.log(r),$("#costume").append('<div id="costume_inner" class="row"></div>'),$("#costume_inner").append("<div id=costume"+r+" name="+r+' class="col-lg-3 col-md-2 col-sm-3 col-xs-4 ml-2 mb-2 costumeButton"></div>'),$("#costume"+r).append('<img src="'+t[r]+'" class="img-responsive">');var a=document.getElementById("costume"+r);a.addEventListener("click",(function(){e._eventBus.dispatchEvent(N.CLEARCANVAS,e.getCanvasId());var t=a.getAttribute("name");switch(t){case W.PLAIN:e.setHtmlClasses("sim_canvas servo_canvas"),e.setCostume(t),e.setWidth(100),e.setHeight(50);break;case W.EYE:e.setHtmlClasses("servo_canvas"),e.setCostume(t),e.setWidth(35),e.setHeight(35);break;case W.RIGHTHAND:case W.LEFTHAND:e.setHtmlClasses("servo_canvas hand_canvas"),e.setCostume(t),e.setWidth(64),e.setHeight(149)}document.getElementById(e.getCanvasId()).className="",document.getElementById(e.getCanvasId()).className=e.getHtmlClasses(),e._eventBus.dispatchEvent(N.INITIALIZECANVAS,e),e._eventBus.dispatchEvent(N.SAVE)}))},i=0,o=Object.entries(W);i<o.length;i++)n()}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(e){return this._height}},{key:"setX",value:function(e){this._x=e}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(e){this._y=e}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setAngle",value:function(e){this._angle=e}},{key:"getAngle",value:function(){return this._angle}},{key:"setPrevAngle",value:function(e){this._prevAngle=e}},{key:"getPrevAngle",value:function(){return this._prevAngle}},{key:"setImage",value:function(e,t){this._image[e].src=t}},{key:"getImage",value:function(e){return this._image[e]}},{key:"setBackgroundColor",value:function(e){this._backgroundColor=e}},{key:"getBackgroundColor",value:function(){return this._backgroundColor}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setCostume",value:function(e){switch(this._costume=e,e){case W.PLAIN:this._image[0].src="./DwenguinoIDE/img/socialrobot/servo_head.png";break;case W.EYE:this._image[0].src="./DwenguinoIDE/img/socialrobot/eye1_background.svg",this._image[1].src="./DwenguinoIDE/img/socialrobot/eye1_forground.svg";break;case W.RIGHTHAND:this._image[0].src="./DwenguinoIDE/img/socialrobot/righthand.png";break;case W.LEFTHAND:this._image[0].src="./DwenguinoIDE/img/socialrobot/lefthand.png"}}},{key:"getServoBackground",value:function(){return this._backgroundImage}},{key:"getServoBackgroundRotated",value:function(){return this._backgroundImageRotated}},{key:"getCostume",value:function(){return this._costume}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(F);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var V={red:"red",yellow:"yellow",blue:"blue",green:"#72f542"};Object.freeze(V);var Y=function(e){y()(n,e);var t=U(n);function n(e,i,o,a,s,l,c,u,d,p,h,f,g,m){var v;return r()(this,n),(v=t.call(this,e,m))._id=i,v._type=de.LED,v._radius=l,v._x=c,v._y=u,v._offset={left:d,top:p},v._onColor=h,v._offColor=f,v._borderColor=g,v._pin=o,v._state=a,v._canvasId="sim_led_canvas"+v._id,v.insertHtml(),v.toggleVisibility(s),v}return s()(n,[{key:"toString",value:function(){return"led"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.ledOptions),e.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Radius='",this.getRadius(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" OnColor='",this.getOnColor(),"'")).concat(" OffColor='",this.getOffColor(),"'")).concat(" BorderColor='",this.getBorderColor(),"'")).concat(" Pin='",this.getPin(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(0),this.setState(0)}},{key:"toggleVisibility",value:function(e){e?$("#sim_led"+this.getId()).css("visibility","visible"):$("#sim_led"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog(),this.createColorOptionsDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"createColorOptionsDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsColor" class="ui-widget row mb-4">'),$("#componentOptionsColor").append('<div class="col-md-2">Color</div>'),$("#componentOptionsColor").append('<div id="color" class="col-md-10"></div>');for(var t=function(){var t=D()(i[n],2),o=t[0],r=t[1];$("#color").append('<button type="button" id=color'+r+" name="+o+' class="col-md-1 ml-2 mb-2 colorButton"></buttons>');var a=document.getElementById("color"+r);a.classList.add(o),e.getOnColor()==o&&a.classList.add("colorButton_selected"),a.addEventListener("click",(function(){e._eventBus.dispatchEvent(N.CLEARCANVAS,e.getCanvasId());var t=a.getAttribute("name");e.setOnColor(t),$(".colorButton").removeClass("colorButton_selected"),a.classList.add("colorButton_selected"),e._eventBus.dispatchEvent(N.INITIALIZECANVAS,e),e._eventBus.dispatchEvent(N.SAVE)}))},n=0,i=Object.entries(V);n<i.length;n++)t()}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setRadius",value:function(e){this._radius=e}},{key:"getRadius",value:function(){return this._radius}},{key:"setX",value:function(e){this._x=e}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(e){this._y=e}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setOnColor",value:function(e){this._onColor=e}},{key:"getOnColor",value:function(){return this._onColor}},{key:"setOffColor",value:function(e){this._offColor=e}},{key:"getOffColor",value:function(){return this._offColor}},{key:"setBorderColor",value:function(e){this._borderColor=e}},{key:"getBorderColor",value:function(){return this._borderColor}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"getCanvasId",value:function(){return this._canvasId}}]),n}(F);function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var K=function(e){y()(n,e);var t=X(n);function n(e,i){var o,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return r()(this,n),(o=t.call(this,e,c))._id=i,o._type=de.LCD,o._offset={left:s,top:l},o._state=new Array(2),o.insertHtml(),o.toggleVisibility(a),o}return s()(n,[{key:"toString",value:function(){return"lcd"}},{key:"insertHtml",value:function(){$("#sim_container").append("<div id='sim_lcd"+this.getId()+"' class='sim_element sim_element_lcd draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_lcd"+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_lcd"+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_lcd"+this.getId()).append("<div id='sim_element_lcd_img'></div>"),$("#sim_element_lcd_img").append('<div class="lcd" id="sim_lcd_row0"></div>'),$("#sim_element_lcd_img").append('<div class="lcd" id="sim_lcd_row1"></div>')}},{key:"removeHtml",value:function(){$("#sim_lcd"+this.getId()).remove()}},{key:"toXml",value:function(){var e="";e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){}},{key:"toggleVisibility",value:function(e){e?$("#sim_lcd"+this.getId()).css("visibility","visible"):$("#sim_lcd"+this.getId()).css("visibility","hidden")}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setState",value:function(e,t){this._state[0]=e,this._state[1]=t}},{key:"getState",value:function(){return this._state}}]),n}(F),q=function(){function e(t,n,i,o,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"";r()(this,e),this._id=t,this._parentId=n,this._minValue=i,this._maxValue=o,this._initialValue=a,this._label=s,this._valuePrefix=l,this._valueSuffix=c,this._sliderId="slider_"+this._id,this._sliderLabelId="slider_"+this._id+"_label",this._sliderValueId="slider_"+this._id+"_value",this._sliderRangeId="slider_"+this._id+"_range",this._classes=u,this.insert()}return s()(e,[{key:"toString",value:function(){return"sonar"}},{key:"insert",value:function(){document.getElementById(this.getSliderRangeId())?console.log("already exists"):(""!=this.getLabel()&&this.insertLabel(),$("#"+this.getParentId()).append('<div id="'+this.getSliderValueId()+'" class="">'+this.getValuePrefix()+this.getInitialValue()+this.getValueSuffix()+"</div>"),$("#"+this.getParentId()).append('<div id="'+this.getSliderId()+'" class="slidecontainer '+this.getClasses()+'"></div>'),$("#"+this.getSliderId()).append('<input id="'+this.getSliderRangeId()+'" type="range" min="'+this.getMinValue()+'" max="'+this.getMaxValue()+'" value="'+this.getInitialValue()+'" class="slider"></input>'))}},{key:"insertLabel",value:function(){var e='<div id="'+this.getSliderLabelId()+'" class="slider_label">'+this.getLabel()+"</div>";$("#"+this.getParentId()).append(e)}},{key:"updateValueLabel",value:function(e){document.getElementById(this.getSliderValueId()).innerHTML=this.getValuePrefix()+e+this.getValueSuffix()}},{key:"remove",value:function(){$("#"+this.getSliderLabelId()).remove(),$("#"+this.getSliderValueId()).remove(),$("#"+this.getSliderId()).remove()}},{key:"getParentId",value:function(){return this._parentId}},{key:"getSliderElement",value:function(){return document.getElementById(this.getSliderRangeId())}},{key:"getInitialValue",value:function(){return this._initialValue}},{key:"getMinValue",value:function(){return this._minValue}},{key:"getMaxValue",value:function(){return this._maxValue}},{key:"getLabel",value:function(){return this._label}},{key:"getValuePrefix",value:function(){return this._valuePrefix}},{key:"getValueSuffix",value:function(){return this._valueSuffix}},{key:"getSliderId",value:function(){return this._sliderId}},{key:"getSliderLabelId",value:function(){return this._sliderLabelId}},{key:"getSliderValueId",value:function(){return this._sliderValueId}},{key:"getSliderRangeId",value:function(){return this._sliderRangeId}},{key:"getClasses",value:function(){return this._classes}}]),e}();function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Q=function(e){y()(n,e);var t=z(n);function n(e,i){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:58,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"sim_canvas sonar_canvas";return r()(this,n),(o=t.call(this,e,f))._id=i,o._type=de.SONAR,o._width=u,o._height=d,o._offset={left:p,top:h},o._image=new Image,o._image.src="./DwenguinoIDE/img/board/sonar.png",o._echoPin=a,o._triggerPin=s,o._state=l,o._stateUpdated=!1,o._slider=null,o._canvasId="sim_sonar_canvas"+o._id,o.insertHtml(),o.toggleVisibility(c),o}return s()(n,[{key:"toString",value:function(){return"sonar"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var t=MSG.sonarSliderLabel+" "+this.getId(),n=""+this.getType()+this.getId();this._slider=new q(n,"sensor_options",0,200,0,t,""," cm","sonar_slider");var i=this;this._slider.getSliderElement().oninput=function(){var e=i.getId();i.changeSonarDistance(this.value,e),i._slider.updateValueLabel(this.value)},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.sonarOptions),e.showDialog()}))}},{key:"changeSonarDistance",value:function(e){this.setState(e),this._stateUpdated=!0,this._eventBus.dispatchEvent(N.SAVE)}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove(),this.getSlider().remove()}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" EchoPin='",this.getEchoPin(),"'")).concat(" TriggerPin='",this.getTriggerPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){}},{key:"toggleVisibility",value:function(e){e?$("#sim_sonar"+this.getId()).css("visibility","visible"):$("#sim_sonar"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsTriggerPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsTriggerPin").append('<div class="col-md-2">Trigger pin</div>'),$("#componentOptionsTriggerPin").append('<div id="triggerPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsEchoPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsEchoPin").append('<div class="col-md-2">Echo pin</div>'),$("#componentOptionsEchoPin").append('<div id="echoPin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=0;n<t.length;n++)$("#triggerPin").append('<button type="button" id=triggerPin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 triggerPinButton pinButton option_button_enabled">'+t[n]+"</button>"),$("#echoPin").append('<button type="button" id=echoPin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 echoPinButton pinButton option_button_enabled">'+t[n]+"</button>");for(var i=function(n){e.getTriggerPin()==t[n]&&($("#triggerPin"+t[n]).addClass("option_button_selected"),$("#echoPin"+t[n]).addClass("option_button_disabled"),$("#echoPin"+t[n]).prop("disabled",!0)),e.getEchoPin()==t[n]&&($("#echoPin"+t[n]).addClass("option_button_selected"),$("#triggerPin"+t[n]).addClass("option_button_disabled"),$("#triggerPin"+t[n]).prop("disabled",!0));var i=document.getElementById("triggerPin"+t[n]),o=document.getElementById("echoPin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setTriggerPin(t),$(".triggerPinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE),$(".echoPinButton").removeClass("option_button_disabled"),$(".echoPinButton").prop("disabled",!1),$("#echoPin"+t).addClass("option_button_disabled"),$("#echoPin"+t).prop("disabled",!0)})),o.addEventListener("click",(function(){var t=o.name;e.setEchoPin(t),$(".echoPinButton").removeClass("option_button_selected"),o.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE),$(".triggerPinButton").removeClass("option_button_disabled"),$(".triggerPinButton").prop("disabled",!1),$("#triggerPin"+t).addClass("option_button_disabled"),$("#triggerPin"+t).prop("disabled",!0)}))},o=0;o<t.length;o++)i(o)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(e){this._image.src=e}},{key:"getImage",value:function(){return this._image}},{key:"setEchoPin",value:function(e){this._echoPin=e}},{key:"getEchoPin",value:function(){return this._echoPin}},{key:"setTriggerPin",value:function(e){this._triggerPin=e}},{key:"getTriggerPin",value:function(){return this._triggerPin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getSlider",value:function(){return this._slider}}]),n}(F),Z={SERVO:"servo",LED:"led",PIR:"pir",SONAR:"sonar",LCD:"lcd",SOUND:"sound",LIGHT:"light",BUZZER:"buzzer"};Object.freeze(Z);var J=function e(){if(r()(this,e),void 0===this.toString)throw new Error("You have to implement the method toString");if(void 0===this.getType)throw new Error("You have to implement the method getType")};function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var te=function(e){y()(n,e);var t=ee(n);function n(){return r()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"sound"}}],[{key:"getType",value:function(){return Z.SOUND}},{key:"getDescription",value:function(){return""}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(J),ne=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";r()(this,e),this._id=t,this._parentId=n,this._label=i,this._buttonLabelId="button_"+this._id+"_label",this._buttonId="button_"+this._id+"_button",this._labelClasses=o,this._activeClasses="dwenguino_button dwenguino_button_pushed",this._inactiveClasses="dwenguino_button",this.insert()}return s()(e,[{key:"toString",value:function(){return"sonar"}},{key:"insert",value:function(){document.getElementById(this.getButtonId())?console.log("A button with id ",this.getButtonId()," already exists."):(""!=this.getLabel()&&$("#"+this.getParentId()).append('<div id="'+this.getButtonLabelId()+'" class="'+this.getLabelClasses()+'">'+this.getLabel()+"</div>"),$("#"+this.getParentId()).append('<div id="'+this.getButtonId()+'" class="'+this.getInactiveClasses()+'"></div>'))}},{key:"update",value:function(){this.isInactive()?this.getButtonElement().className=this.getActiveClasses():this.getButtonElement().className=this.getInactiveClasses()}},{key:"remove",value:function(){$("#"+this.getButtonLabelId()).remove(),$("#"+this.getButtonId()).remove()}},{key:"getParentId",value:function(){return this._parentId}},{key:"getButtonElement",value:function(){return document.getElementById(this.getButtonId())}},{key:"getLabel",value:function(){return this._label}},{key:"getButtonLabelId",value:function(){return this._buttonLabelId}},{key:"getButtonId",value:function(){return this._buttonId}},{key:"getLabelClasses",value:function(){return this._labelClasses}},{key:"getInactiveClasses",value:function(){return this._inactiveClasses}},{key:"getActiveClasses",value:function(){return this._activeClasses}},{key:"isInactive",value:function(){return this.getButtonElement().className===this.getInactiveClasses()}},{key:"isActive",value:function(){return this.getButtonElement().className===this.getActiveClasses()}}]),e}();function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var oe=function(e){y()(n,e);var t=ie(n);function n(e,i,o,a,s,l,c,u,d,p){var h;return r()(this,n),(h=t.call(this,e,p))._id=i,h._type=de.PIR,h._width=l,h._height=c,h._offset={left:u,top:d},h._image=new Image,h._image.src="./DwenguinoIDE/img/socialrobot/pir_off.png",h._pin=o,h._state=a,h._stateUpdated=!1,h._canvasId="sim_pir_canvas"+h._id,h._button=null,h.insertHtml(),h.toggleVisibility(s),h}return s()(n,[{key:"toString",value:function(){return"pir"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var t=MSG.pirButtonLabel+" "+this.getId(),n=""+this.getType()+this.getId();this._button=new ne(n,"sensor_options",t);var i=this;this._button.getButtonElement().onclick=function(){i._button.update(),i._button.isActive()?(i.setImage("./DwenguinoIDE/img/socialrobot/pir_on.png"),i.setState(1),i._stateUpdated=!0,i._eventBus.dispatchEvent(N.SAVE)):(i.setImage("./DwenguinoIDE/img/socialrobot/pir_off.png"),i.setState(0),i._stateUpdated=!0,i._eventBus.dispatchEvent(N.SAVE))},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.pirOptions),e.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove(),this.getButton().remove()}},{key:"toggleVisibility",value:function(e){e?$("#sim_pir"+this.getId()).css("visibility","visible"):$("#sim_pir"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(e){this._image.src=e}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getButton",value:function(){return this._button}}]),n}(F);function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var ae=function(e){y()(n,e);var t=re(n);function n(e,i,o,a,s,l,c,u,d,p){var h;return r()(this,n),(h=t.call(this,e,p))._id=i,h._type=de.SOUND,h._width=l,h._height=c,h._offset={left:u,top:d},h._image=new Image,h._image.src="./DwenguinoIDE/img/socialrobot/sound_sensor.png",h._pin=o,h._state=a,h._stateUpdated=!1,h._canvasId="sim_sound_canvas"+h._id,h._button=null,h.insertHtml(),h.toggleVisibility(s),h}return s()(n,[{key:"toString",value:function(){return"sound sensor"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var t=MSG.soundButtonLabel+" "+this.getId(),n=""+this.getType()+this.getId();this._button=new ne(n,"sensor_options",t);var i=this;this._button.getButtonElement().onclick=function(){i._button.update(),i._button.isActive()?(i.setImage("./DwenguinoIDE/img/socialrobot/sound_sensor.png"),i.setState(1),i._stateUpdated=!0,i._eventBus.dispatchEvent(N.SAVE)):(i.setImage("./DwenguinoIDE/img/socialrobot/sound_sensor.png"),i.setState(0),i._stateUpdated=!0,i._eventBus.dispatchEvent(N.SAVE))},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.soundOptions),e.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove(),this.getButton().remove()}},{key:"toggleVisibility",value:function(e){e?$("#sim_sound"+this.getId()).css("visibility","visible"):$("#sim_sound"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(e){this._image.src=e}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getButton",value:function(){return this._button}}]),n}(F);function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var le=function(e){y()(n,e);var t=se(n);function n(e,i,o,a,s,l,c,u,d,p){var h;return r()(this,n),(h=t.call(this,e,p))._id=i,h._type=de.LIGHT,h._width=l,h._height=c,h._offset={left:u,top:d},h._image=new Image,h._image.src="./DwenguinoIDE/img/socialrobot/light_sensor.png",h._pin=o,h._state=a,h._stateUpdated=!1,h._canvasId="sim_light_canvas"+h._id,h._slider=null,h.insertHtml(),h.toggleVisibility(s),h}return s()(n,[{key:"toString",value:function(){return"light sensor"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>");var t=MSG.lightSensorSliderLabel+" "+this.getId(),n=""+this.getType()+this.getId();this._slider=new q(n,"sensor_options",0,4095,0,t,"","","light_sensor_slider");var i=this;this._slider.getSliderElement().oninput=function(){var e=i.getId();i.changeLightSensorValue(this.value,e),i._slider.updateValueLabel(this.value)},document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.lightOptions),e.showDialog()}))}},{key:"changeLightSensorValue",value:function(e){this.setState(e),this._stateUpdated=!0,this._eventBus.dispatchEvent(N.SAVE)}},{key:"removeHtml",value:function(){$("#sim_light"+this.getId()).remove(),this.getSlider().remove()}},{key:"toggleVisibility",value:function(e){e?$("#sim_light"+this.getId()).css("visibility","visible"):$("#sim_light"+this.getId()).css("visibility","hidden")}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Width='",this.getWidth(),"'")).concat(" Height='",this.getHeight(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" Pin='",this.getPin(),"'")).concat(" State='",this.getState(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setState(0),this._stateUpdated=!1}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsPin" class="ui-widget row mb-4">'),$("#componentOptionsPin").append('<div class="col-md-2">Pin</div>'),$("#componentOptionsPin").append('<div id="pin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=function(n){$("#pin").append('<button type="button" id=pin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 pinButton option_button_enabled">'+t[n]+"</button>"),e.getPin()==t[n]&&$("#pin"+t[n]).addClass("option_button_selected");var i=document.getElementById("pin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setPin(t),$(".pinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE)}))},i=0;i<t.length;i++)n(i)}},{key:"getAllPossiblePins",value:function(){return["A0","A1","A2","A3","A4","A5"]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setWidth",value:function(e){this._width=e}},{key:"getWidth",value:function(){return this._width}},{key:"setHeight",value:function(e){this._height=e}},{key:"getHeight",value:function(){return this._height}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setImage",value:function(e){this._image.src=e}},{key:"getImage",value:function(){return this._image}},{key:"setPin",value:function(e){this._pin=e}},{key:"getPin",value:function(){return this._pin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"isStateUpdated",value:function(){return this._stateUpdated}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getSlider",value:function(){return this._slider}}]),n}(F);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var ue=function(e){y()(n,e);var t=ce(n);function n(e,i,o,a,s,l,c,u,d,p,h,f,g){var m;return r()(this,n),(m=t.call(this,e,g))._id=i,m._type=de.RGBLED,m._radius=u,m._x=d,m._y=p,m._offset={left:h,top:f},m._offColor="gray",m._redPin=o,m._greenPin=a,m._bluePin=s,m._state=l,m._canvasId="sim_rgbled_canvas"+m._id,m._ledSvg=new Image,m._ledSvg.src="./DwenguinoIDE/img/socialrobot/rgb_led_top.svg",m._ledBackground=new Image,m._ledBackground.src="./DwenguinoIDE/img/socialrobot/rgb_led_background.svg",m.insertHtml(),m.toggleVisibility(c),m}return s()(n,[{key:"toString",value:function(){return"RGB LED"}},{key:"insertHtml",value:function(){var e=this;$("#sim_container").append("<div id='sim_"+this.getType()+this.getId()+"' class='sim_element sim_element_"+this.getType()+" draggable'><div><span class='grippy'></span>"+MSG.simulator[this.getType()]+" "+this.getId()+"</div></div>"),$("#sim_"+this.getType()+this.getId()).css("top",this.getOffset().top+"px"),$("#sim_"+this.getType()+this.getId()).css("left",this.getOffset().left+"px"),$("#sim_"+this.getType()+this.getId()).append("<canvas id='"+this.getCanvasId()+"' class='"+this.getHtmlClasses()+"'></canvas>"),document.getElementById("sim_"+this.getType()+this.getId()).addEventListener("dblclick",(function(){e.createComponentOptionsModalDialog(MSG.rgbLedOptions),e.showDialog()}))}},{key:"removeHtml",value:function(){$("#sim_"+this.getType()+this.getId()).remove()}},{key:"toXml",value:function(){var e="";e=(e=(e=(e=e.concat("<Item ")).concat(" Type='",this.getType(),"'")).concat(" Id='",this.getId(),"'")).concat(" Radius='",this.getRadius(),"'");var t="#sim_"+this.getType()+this.getId();return e=$(t).attr("data-x")?e.concat(" OffsetLeft='",parseFloat(this.getOffset().left)+parseFloat($(t).attr("data-x")),"'"):e.concat(" OffsetLeft='",parseFloat(this.getOffset().left),"'"),e=(e=(e=(e=(e=(e=$(t).attr("data-y")?e.concat(" OffsetTop='",parseFloat(this.getOffset().top)+parseFloat($(t).attr("data-y")),"'"):e.concat(" OffsetTop='",parseFloat(this.getOffset().top),"'")).concat(" RedPin='",this.getRedPin(),"'")).concat(" GreenPin='",this.getGreenPin(),"'")).concat(" BluePin='",this.getBluePin(),"'")).concat(" Classes='",this.getHtmlClasses(),"'")).concat("></Item>")}},{key:"reset",value:function(){this.setX(0),this.setY(0),this.setState([0,0,0])}},{key:"toggleVisibility",value:function(e){e?$("#sim_led"+this.getId()).css("visibility","visible"):$("#sim_led"+this.getId()).css("visibility","hidden")}},{key:"showDialog",value:function(){$("#componentOptionsModal").modal("show")}},{key:"removeDialog",value:function(){$("div").remove("#componentOptionsModal"),$(".modal-backdrop").remove()}},{key:"createComponentOptionsModalDialog",value:function(e){this.removeDialog(),$("#db_body").append('<div id="componentOptionsModal" class="modal fade" role="dialog"></div>'),$("#componentOptionsModal").append('<div id="componentOptionsModalDialog" class="modal-dialog"></div>'),$("#componentOptionsModalDialog").append('<div id="componentOptionsModalContent" class="modal-content"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalHeader" class="modal-header"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalBody" class="modal-body container"></div>'),$("#componentOptionsModalContent").append('<div id="componentOptionsModalFooter" class="modal-footer"></div>'),$("#componentOptionsModalHeader").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),$("#componentOptionsModalHeader").append('<h4 class="modal-title">'+e+"</h4>"),this.createPinOptionsInModalDialog()}},{key:"createPinOptionsInModalDialog",value:function(){var e=this;$("#componentOptionsModalBody").append('<div id="componentOptionsRedPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsRedPin").append('<div class="col-md-2">Red pin</div>'),$("#componentOptionsRedPin").append('<div id="redPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsGreenPin" class="ui-widget row mb-4"></div>'),$("#componentOptionsGreenPin").append('<div class="col-md-2">Green pin</div>'),$("#componentOptionsGreenPin").append('<div id="greenPin" class="col-md-10"></div>'),$("#componentOptionsModalBody").append('<div id="componentOptionsBluePin" class="ui-widget row mb-4"></div>'),$("#componentOptionsBluePin").append('<div class="col-md-2">Blue pin</div>'),$("#componentOptionsBluePin").append('<div id="bluePin" class="col-md-10"></div>');for(var t=this.getAllPossiblePins(),n=0;n<t.length;n++)$("#redPin").append('<button type="button" id=redPin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 redPinButton pinButton option_button_enabled">'+t[n]+"</button>"),$("#greenPin").append('<button type="button" id=greenPin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 greenPinButton pinButton option_button_enabled">'+t[n]+"</button>"),$("#bluePin").append('<button type="button" id=bluePin'+t[n]+" name="+t[n]+' class="col-md-1 ml-2 mb-2 bluePinButton pinButton option_button_enabled">'+t[n]+"</button>");for(var i=function(n){e.getRedPin()==t[n]&&($("#redPin"+t[n]).addClass("option_button_selected"),$("#greenPin"+t[n]).addClass("option_button_disabled"),$("#greenPin"+t[n]).prop("disabled",!0),$("#bluePin"+t[n]).addClass("option_button_disabled"),$("#bluePin"+t[n]).prop("disabled",!0)),e.getGreenPin()==t[n]&&($("#greenPin"+t[n]).addClass("option_button_selected"),$("#redPin"+t[n]).addClass("option_button_disabled"),$("#redPin"+t[n]).prop("disabled",!0),$("#bluePin"+t[n]).addClass("option_button_disabled"),$("#bluePin"+t[n]).prop("disabled",!0)),e.getBluePin()==t[n]&&($("#bluePin"+t[n]).addClass("option_button_selected"),$("#redPin"+t[n]).addClass("option_button_disabled"),$("#redPin"+t[n]).prop("disabled",!0),$("#greenPin"+t[n]).addClass("option_button_disabled"),$("#greenPin"+t[n]).prop("disabled",!0));var i=document.getElementById("redPin"+t[n]),o=document.getElementById("greenPin"+t[n]),r=document.getElementById("bluePin"+t[n]);i.addEventListener("click",(function(){var t=i.name;e.setRedPin(t),$(".redPinButton").removeClass("option_button_selected"),i.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE),$(".greenPinButton").removeClass("option_button_disabled"),$(".greenPinButton").prop("disabled",!1),$("#greenPin"+t).addClass("option_button_disabled"),$("#greenPin"+t).prop("disabled",!0),$(".bluePinButton").removeClass("option_button_disabled"),$(".bluePinButton").prop("disabled",!1),$("#bluePin"+t).addClass("option_button_disabled"),$("#bluePin"+t).prop("disabled",!0)})),o.addEventListener("click",(function(){var t=o.name;e.setGreenPin(t),$(".greenPinButton").removeClass("option_button_selected"),o.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE),$(".redPinButton").removeClass("option_button_disabled"),$(".redPinButton").prop("disabled",!1),$("#redPin"+t).addClass("option_button_disabled"),$("#redPin"+t).prop("disabled",!0),$(".bluePinButton").removeClass("option_button_disabled"),$(".bluePinButton").prop("disabled",!1),$("#bluePin"+t).addClass("option_button_disabled"),$("#bluePin"+t).prop("disabled",!0)})),r.addEventListener("click",(function(){var t=i.name;e.setBluePin(t),$(".bluePinButton").removeClass("option_button_selected"),r.classList.add("option_button_selected"),e._eventBus.dispatchEvent(N.SAVE),$(".redPinButton").removeClass("option_button_disabled"),$(".redPinButton").prop("disabled",!1),$("#redPin"+t).addClass("option_button_disabled"),$("#redPin"+t).prop("disabled",!0),$(".greenPinButton").removeClass("option_button_disabled"),$(".greenPinButton").prop("disabled",!1),$("#greenPin"+t).addClass("option_button_disabled"),$("#greenPin"+t).prop("disabled",!0)}))},o=0;o<t.length;o++)i(o)}},{key:"getAllPossiblePins",value:function(){return["A0","A1","A2","A3","A4","A5"]}},{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"setRadius",value:function(e){this._radius=e}},{key:"getRadius",value:function(){return this._radius}},{key:"setX",value:function(e){this._x=e}},{key:"getX",value:function(){return this._x}},{key:"setY",value:function(e){this._y=e}},{key:"getY",value:function(){return this._y}},{key:"setOffset",value:function(e){this._offset=e}},{key:"getOffset",value:function(){return this._offset}},{key:"setRedPin",value:function(e){this._redPin=e}},{key:"getRedPin",value:function(){return this._redPin}},{key:"setGreenPin",value:function(e){this._greenPin=e}},{key:"getGreenPin",value:function(){return this._greenPin}},{key:"setBluePin",value:function(e){this._bluePin=e}},{key:"getBluePin",value:function(){return this._bluePin}},{key:"setState",value:function(e){this._state=e}},{key:"getState",value:function(){return this._state}},{key:"getCanvasId",value:function(){return this._canvasId}},{key:"getLedSvg",value:function(){return this._ledSvg}},{key:"getLedBackground",value:function(){return this._ledBackground}}]),n}(F),de={SERVO:"servo",LED:"led",RGBLED:"rgbled",PIR:"pir",SONAR:"sonar",LCD:"lcd",SOUND:"sound",LIGHT:"light"};Object.freeze(de);var pe=function(){function e(t,n,i){r()(this,e),c()(this,"logger",null),c()(this,"inputState",{pir:0,buttons:[1,1,1,1,1],sonarDistance:-1}),this.logger=n,this._eventBus=i,this._robot=[],this._numberOfComponentsOfType={},this.scenarioUtils=t,this.renderer=new L;for(var o=0,a=Object.entries(de);o<a.length;o++){var s=D()(a[o],2),l=(s[0],s[1]);this._numberOfComponentsOfType[l]=0}}return s()(e,[{key:"getRobot",value:function(){return this._robot}},{key:"resetSocialRobot",value:function(){for(var e=0;e<this._robot.length;e++)this._robot[e].reset()}},{key:"removeAllSocialRobotComponents",value:function(){for(var e=0;e<this._robot.length;e++)this.removeRobotComponent(this._robot[e])}},{key:"updateScenarioState",value:function(e){for(var t=0;t<this._robot.length;t++){var n=0;switch(this._robot[t].getType()){case de.SERVO:36===(n=this._robot[t].getPin())?this._robot[t].getAngle()!=e.getServoAngle(1)&&(this._robot[t].setPrevAngle(this._robot[t].getAngle()),this._robot[t].setAngle(e.getServoAngle(1))):37===n?this._robot[t].getAngle()!=e.getServoAngle(2)&&(this._robot[t].setPrevAngle(this._robot[t].getAngle()),this._robot[t].setAngle(e.getServoAngle(2))):this._robot[t].getAngle()!=e.getIoPinState(n)&&(this._robot[t].setPrevAngle(this._robot[t].getAngle()),this._robot[t].setAngle(e.getIoPinState(n)));break;case de.LED:n=this._robot[t].getPin(),this._robot[t].setState(e.getIoPinState(n));break;case de.RGBLED:var i=this._robot[t].getRedPin(),o=this._robot[t].getGreenPin(),r=this._robot[t].getBluePin(),a=[e.getIoPinState(i),e.getIoPinState(o),e.getIoPinState(r)];this._robot[t].setState(a);break;case de.PIR:n=this._robot[t].getPin(),this._robot[t].isStateUpdated()&&(e.setIoPinState(n,this._robot[t].getState()),this._robot[t]._stateUpdated=!1);break;case de.SONAR:var s=this._robot[t].getEchoPin(),l=this._robot[t].getTriggerPin();this._robot[t].isStateUpdated()&&(e.setIoPinState(s,this._robot[t].getState()),e.setIoPinState(l,this._robot[t].getState()),this._robot[t]._stateUpdated=!1);break;case de.LCD:this._robot[t].setState(e.getLcdContent(0),e.getLcdContent(1));break;case de.SOUND:n=this._robot[t].getPin(),console.log(n),this._robot[t].isStateUpdated()&&(e.setIoPinState(n,this._robot[t].getState()),this._robot[t]._stateUpdated=!1,console.log(this._robot[t].getState()));break;case de.LIGHT:n=this._robot[t].getPin(),this._robot[t].isStateUpdated()&&(e.setIoPinState(n,this._robot[t].getState()),this._robot[t]._stateUpdated=!1)}}}},{key:"getRobotComponentWithTypeAndId",value:function(e,t){for(var n=0;n<this._robot.length;n++)if(this._robot[n].getType()==e&&this._robot[n].getId()==t)return this._robot[n]}},{key:"removeRobotComponentWithTypeAndId",value:function(e,t){this.getRobotComponentWithTypeAndId(e,t).removeHtml();for(var n=0;n<this._robot.length;n++)this._robot[n].getType()==e&&this._robot[n].getId()==t&&(this._robot.splice(n,1),this.decrementNumberOf(e))}},{key:"addRobotComponent",value:function(e){switch(e){case de.SERVO:this.addServo();break;case de.LED:this.addLed();break;case de.RGBLED:this.addRgbLed();break;case de.PIR:this.addPir();break;case de.SONAR:this.addSonar();break;case de.LCD:this.addLcd();break;case de.SOUND:this.addSoundSensor();break;case de.LIGHT:this.addLightSensor()}}},{key:"removeRobotComponent",value:function(e){switch(e){case de.SERVO:this.removeServo();break;case de.LED:this.removeLed();break;case de.RGBLED:this.removeRgbLed();break;case de.PIR:this.removePir();break;case de.SONAR:this.removeSonar();break;case de.LCD:this.removeLcd();break;case de.SOUND:this.removeSoundSensor();break;case de.LIGHT:this.removeLightSensor()}}},{key:"addRobotComponentFromXml",value:function(e){switch(e.getAttribute("Type")){case de.SERVO:var t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),r=parseInt(e.getAttribute("Angle")),a=parseInt(e.getAttribute("Pin")),s=e.getAttribute("Costume"),l=e.getAttribute("Classes");this.addServo(a,s,r,!0,0,0,t,n,i,o,l);break;case de.LED:var c=parseFloat(e.getAttribute("Radius")),u=(i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),e.getAttribute("OnColor")),d=e.getAttribute("OffColor"),p=e.getAttribute("BorderColor");a=parseInt(e.getAttribute("Pin")),l=e.getAttribute("Classes");this.addLed(a,0,!0,c,0,0,i,o,u,d,p,l);break;case de.RGBLED:c=parseFloat(e.getAttribute("Radius")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop"));var h=e.getAttribute("RedPin"),f=e.getAttribute("GreenPin"),g=e.getAttribute("BluePin");l=e.getAttribute("Classes");this.addRgbLed(h,f,g,[0,0,0],!0,c,0,0,i,o,l);break;case de.PIR:t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),a=parseInt(e.getAttribute("Pin"));var m=parseInt(e.getAttribute("State"));l=e.getAttribute("Classes");console.log("addPir from xml"),this.addPir(a,m,!0,t,n,i,o,l);break;case de.SONAR:t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop"));var v=parseInt(e.getAttribute("EchoPin")),_=parseInt(e.getAttribute("TriggerPin"));m=parseInt(e.getAttribute("State")),l=e.getAttribute("Classes");this.addSonar(v,_,m,!0,t,n,i,o,l);break;case de.LCD:i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),l=e.getAttribute("Classes");this.addLcd(!0,i,o,l);break;case de.SOUND:t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),a=parseInt(e.getAttribute("Pin")),m=parseInt(e.getAttribute("State")),l=e.getAttribute("Classes");this.addSoundSensor(a,m,!0,t,n,i,o,l);break;case de.LIGHT:t=parseFloat(e.getAttribute("Width")),n=parseFloat(e.getAttribute("Height")),i=parseFloat(e.getAttribute("OffsetLeft")),o=parseFloat(e.getAttribute("OffsetTop")),a=parseInt(e.getAttribute("Pin")),m=parseInt(e.getAttribute("State")),l=e.getAttribute("Classes");this.addLightSensor(a,m,!0,t,n,i,o,l)}}},{key:"addServo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.PLAIN,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:50,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"sim_canvas servo_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,de.SERVO)),this.incrementNumberOf(de.SERVO);var d=this._numberOfComponentsOfType[de.SERVO];1==d?e=36:2==d&&(e=37);var p=new G(this._eventBus,d,e,t,n,i,o,r,a,s,l,c,u);this._robot.push(p),this.renderer.initializeCanvas(this._robot,p)}},{key:"removeServo",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,de.SERVO));var e=this._numberOfComponentsOfType[de.SERVO];this.removeRobotComponentWithTypeAndId(de.SERVO,e)}},{key:"addLed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"yellow",c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"gray",u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"black",d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"sim_canvas led_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,de.LED)),this.incrementNumberOf(de.LED);var p=this._numberOfComponentsOfType[de.LED],h=new Y(this._eventBus,p,e,t,n,i,o,r,a,s,l,c,u,d);this._robot.push(h),this.renderer.initializeCanvas(this._robot,h)}},{key:"removeLed",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,de.LED));var e=this._numberOfComponentsOfType[de.LED];this.removeRobotComponentWithTypeAndId(de.LED,e)}},{key:"addRgbLed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"A0",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"A1",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"A2",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"sim_canvas rgbled_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,de.RGBLED)),this.incrementNumberOf(de.RGBLED);var d=this._numberOfComponentsOfType[de.RGBLED],p=new ue(this._eventBus,d,e,t,n,i,o,r,a,s,l,c,u);this._robot.push(p),this.renderer.initializeCanvas(this._robot,p)}},{key:"removeRgbLed",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,de.RGBLED));var e=this._numberOfComponentsOfType[de.RGBLED];this.removeRobotComponentWithTypeAndId(de.RGBLED,e)}},{key:"addPir",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:75,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:75,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas pir_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,de.PIR)),this.incrementNumberOf(de.PIR);var l=this._numberOfComponentsOfType[de.PIR],c=new oe(this._eventBus,l,e,t,n,i,o,r,a,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removePir",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,de.PIR));var e=this._numberOfComponentsOfType[de.PIR];this.removeRobotComponentWithTypeAndId(de.PIR,e)}},{key:"addSonar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:58,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:5,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"sim_canvas sonar_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,de.SONAR)),this.incrementNumberOf(de.SONAR);var c=this._numberOfComponentsOfType[de.SONAR],u=new Q(this._eventBus,c,e,t,n,i,o,r,a,s,l);this._robot.push(u),this.renderer.initializeCanvas(this._robot,u)}},{key:"removeSonar",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,de.SONAR));var e=this._numberOfComponentsOfType[de.SONAR];this.removeRobotComponentWithTypeAndId(de.SONAR,e)}},{key:"addLcd",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,de.LCD)),this.incrementNumberOf(de.LCD);var o=this._numberOfComponentsOfType[de.LCD],r=new K(this._eventBus,o,e,t,n,i);this._robot.push(r)}},{key:"removeLcd",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,de.Lcd));var e=this._numberOfComponentsOfType[de.LCD];this.removeRobotComponentWithTypeAndId(de.LCD,e)}},{key:"addSoundSensor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:42,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas sound_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,de.SOUND)),this.incrementNumberOf(de.SOUND);var l=this._numberOfComponentsOfType[de.SOUND],c=new ae(this._eventBus,l,e,t,n,i,o,r,a,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removeSoundSensor",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,de.SOUND));var e=this._numberOfComponentsOfType[de.SOUND];this.removeRobotComponentWithTypeAndId(de.SOUND,e)}},{key:"addLightSensor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:45,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"sim_canvas light_canvas";this.logger.recordEvent(this.logger.createEvent(O.addRobotComponent,de.LIGHT)),this.incrementNumberOf(de.LIGHT);var l=this._numberOfComponentsOfType[de.LIGHT],c=new le(this._eventBus,l,e,t,n,i,o,r,a,s);this._robot.push(c),this.renderer.initializeCanvas(this._robot,c)}},{key:"removeLightSensor",value:function(){this.logger.recordEvent(this.logger.createEvent(O.removeRobotComponent,de.LIGHT));var e=this._numberOfComponentsOfType[de.LIGHT];this.removeRobotComponentWithTypeAndId(de.LIGHT,e)}},{key:"incrementNumberOf",value:function(e){this._numberOfComponentsOfType[e]+=1}},{key:"decrementNumberOf",value:function(e){this._numberOfComponentsOfType[e]-=1}}]),e}(),he=function(){function e(){r()(this,e),this.events={}}return s()(e,[{key:"registerEvent",value:function(e){var t=new j(e);this.events[e]=t}},{key:"dispatchEvent",value:function(e,t){this.events[e].callbacks.forEach((function(e){e(t)}))}},{key:"addEventListener",value:function(e,t){this.events[e].registerCallback(t)}}]),e}(),fe=function(){function e(t){r()(this,e),c()(this,"socialRobotScenario",{}),this._eventBus=t,this._components=[{type:de.SERVO,maximumAmount:5},{type:de.LED,maximumAmount:3},{type:de.RGBLED,maximumAmount:1},{type:de.PIR,maximumAmount:2},{type:de.SONAR,maximumAmount:1},{type:de.LCD,maximumAmount:1},{type:de.SOUND,maximumAmount:2},{type:de.LIGHT,maximumAmount:2},{type:de.DECORATION,maximumAmount:10}]}return s()(e,[{key:"setupEnvironment",value:function(e){this.socialRobotScenario=e,console.log("setupEnvironment"),this.initMenu(),this.translateRobotComponents()}},{key:"initMenu",value:function(){$("#db_simulator_top_pane").append('<div id="robot_components_menu" class="scrolling-wrapper-flexbox"></div>'),$("#robot_components_menu").append('<div id="rc_servo" class="robot_components_item bg-c-4 card"></div>'),$("#rc_servo").append('<div id="rc_servo_tag" class="rc_tag"></div>'),$("#rc_servo").append('<div id="rc_servo_img"></div>'),$("#rc_servo").append('<div id="rc_servo_options"></div>'),$("#robot_components_menu").append('<div id="rc_led" class="robot_components_item bg-c-4 card"></div>'),$("#rc_led").append('<div id="rc_led_tag" class="rc_tag"></div>'),$("#rc_led").append('<div id="rc_led_img"></div>'),$("#rc_led").append('<div id="rc_led_options"></div>'),$("#robot_components_menu").append('<div id="rc_rgbled" class="robot_components_item bg-c-4 card"></div>'),$("#rc_rgbled").append('<div id="rc_rgbled_tag" class="rc_tag"></div>'),$("#rc_rgbled").append('<div id="rc_rgbled_img"></div>'),$("#rc_rgbled").append('<div id="rc_rgbled_options"></div>'),$("#robot_components_menu").append('<div id="rc_pir" class="robot_components_item bg-c-4 card"></div>'),$("#rc_pir").append('<div id="rc_pir_tag" class="rc_tag"></div>'),$("#rc_pir").append('<div id="rc_pir_img"></div>'),$("#rc_pir").append('<div id="rc_pir_value"></div>'),$("#rc_pir").append('<div id="rc_pir_options"></div>'),$("#robot_components_menu").append('<div id="rc_sonar" class="robot_components_item bg-c-4 card"></div>'),$("#rc_sonar").append('<div id="rc_sonar_tag" class="rc_tag"></div>'),$("#rc_sonar").append('<div id="rc_sonar_img"></div>'),$("#rc_sonar").append('<div id="rc_sonar_value"></div>'),$("#rc_sonar").append('<div id="rc_sonar_options"></div>'),$("#robot_components_menu").append('<div id="rc_lcd" class="robot_components_item bg-c-4 card"></div>'),$("#rc_lcd").append('<div id="rc_lcd_tag" class="rc_tag"></div>'),$("#rc_lcd").append('<div id="rc_lcd_img"></div>'),$("#rc_lcd").append('<div id="rc_lcd_options"></div>'),$("#robot_components_menu").append('<div id="rc_sound" class="robot_components_item bg-c-4 card"></div>'),$("#rc_sound").append('<div id="rc_sound_tag" class="rc_tag"></div>'),$("#rc_sound").append('<div id="rc_sound_img"></div>'),$("#rc_sound").append('<div id="rc_sound_options"></div>'),$("#robot_components_menu").append('<div id="rc_light" class="robot_components_item bg-c-4 card"></div>'),$("#rc_light").append('<div id="rc_light_tag" class="rc_tag"></div>'),$("#rc_light").append('<div id="rc_light_img"></div>'),$("#rc_light").append('<div id="rc_light_options"></div>'),$("#robot_components_menu").append('<div id="rc_decoration" class="robot_components_item bg-c-4 card"></div>'),$("#rc_decoration").append('<div id="rc_decoration_tag" class="rc_tag"></div>'),$("#rc_decoration").append('<div id="rc_decoration_img"></div>'),$("#rc_decoration").append('<div id="rc_decoration_options"></div>'),this.initButtons()}},{key:"initButtons",value:function(){var e=this.generateButtonTemplate(de.SERVO);$("#rc_servo_options").append(e);var t=this.generateButtonTemplate(de.LED);$("#rc_led_options").append(t);var n=this.generateButtonTemplate(de.RGBLED);$("#rc_rgbled_options").append(n);var i=this.generateButtonTemplate(de.PIR);$("#rc_pir_options").append(i);var o=this.generateButtonTemplate(de.SONAR);$("#rc_sonar_options").append(o);var r=this.generateButtonTemplate(de.LCD);$("#rc_lcd_options").append(r);var a=this.generateButtonTemplate(de.SOUND);$("#rc_sound_options").append(a);var s=this.generateButtonTemplate(de.LIGHT);$("#rc_light_options").append(s);var l=this;$(".btn-number").click((function(e){e.preventDefault();var t=$(this).attr("data-field"),n=$(this).attr("data-type"),i=$("input[name='"+t+"']"),o=parseInt(i.val());isNaN(o)?i.val(0):"minus"==n?(o>i.attr("min")&&(i.val(o-1).change(),l.removeRobotComponent(e.target.id)),parseInt(i.val())==i.attr("min")&&$(this).attr("disabled",!0)):"plus"==n&&(o<i.attr("max")&&(i.val(o+1).change(),l.addRobotComponent(e.target.id)),parseInt(i.val())==i.attr("max")&&$(this).attr("disabled",!0))})),$(".input-number").focusin((function(){$(this).data("oldValue",$(this).val())})),$(".input-number").change((function(){var e=parseInt($(this).attr("min")),t=parseInt($(this).attr("max")),n=parseInt($(this).val()),i=$(this).attr("name");n>=e?$(".component_item_input[data-type='minus'][data-field='"+i+"']").removeAttr("disabled"):$(this).val($(this).data("oldValue")),n<=t?$(".component_item_input[data-type='plus'][data-field='"+i+"']").removeAttr("disabled"):$(this).val($(this).data("oldValue"))})),$(".input-number").keydown((function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,190])||65==e.keyCode&&!0===e.ctrlKey||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}))}},{key:"resetButtons",value:function(){for(var e=0,t=Object.entries(de);e<t.length;e++){var n=D()(t[e],2),i=(n[0],n[1]);$("input[name='"+i+"']").val(0).change()}}},{key:"changeValue",value:function(e,t){var n=$("input[name='"+e+"']"),i=parseInt(n.val());n.val(i+t).change()}},{key:"translateRobotComponents",value:function(){for(var e=0,t=Object.entries(de);e<t.length;e++){var n=D()(t[e],2),i=(n[0],n[1]);document.getElementById("rc_"+i+"_tag").textContent=MSG.simulator[i]}}},{key:"generateButtonTemplate",value:function(e){var t="";return this._components.forEach((function(n){n.type==e&&(t='<fieldset><button type="button" id="rc_'+e+'_minus_button" class="component_item_input btn-number" disabled="disabled" data-type="minus" data-field="'+e+'"><span class="glyphicon glyphicon-minus" id="rc_'+e+'_minus_button"></span></button><input type="text" name="'+e+'" class="component_item_input input-number" size="2" value="0" min="0" max="'+n.maximumAmount+'"><button type="button" id="rc_'+e+'_plus_button" class="component_item_input btn-number" data-type="plus" data-field="'+e+'"><span class="glyphicon glyphicon-plus" id="rc_'+e+'_plus_button"></span></button></fieldset>')})),t}},{key:"addRobotComponent",value:function(e){switch(e){case"rc_servo_plus_button":this.socialRobotScenario.addRobotComponent(de.SERVO);break;case"rc_led_plus_button":this.socialRobotScenario.addRobotComponent(de.LED);break;case"rc_rgbled_plus_button":this.socialRobotScenario.addRobotComponent(de.RGBLED);break;case"rc_pir_plus_button":this.socialRobotScenario.addRobotComponent(de.PIR);break;case"rc_sonar_plus_button":this.socialRobotScenario.addRobotComponent(de.SONAR);break;case"rc_decoration_plus_button":this.socialRobotScenario.addRobotComponent(de.DECORATION);break;case"rc_lcd_plus_button":this.socialRobotScenario.addRobotComponent(de.LCD);break;case"rc_sound_plus_button":this.socialRobotScenario.addRobotComponent(de.SOUND);break;case"rc_light_plus_button":this.socialRobotScenario.addRobotComponent(de.LIGHT)}this._eventBus.dispatchEvent(N.SAVE)}},{key:"removeRobotComponent",value:function(e){switch(e){case"rc_servo_minus_button":this.socialRobotScenario.removeRobotComponent(de.SERVO);break;case"rc_led_minus_button":this.socialRobotScenario.removeRobotComponent(de.LED);break;case"rc_rgbled_minus_button":this.socialRobotScenario.removeRobotComponent(de.RGBLED);break;case"rc_pir_minus_button":this.socialRobotScenario.removeRobotComponent(de.PIR);break;case"rc_sonar_minus_button":this.socialRobotScenario.removeRobotComponent(de.SONAR);break;case"rc_decoration_minus_button":this.socialRobotScenario.removeRobotComponent(de.DECORATION);break;case"rc_lcd_minus_button":this.socialRobotScenario.removeRobotComponent(de.LCD);break;case"rc_sound_minus_button":this.socialRobotScenario.removeRobotComponent(de.SOUND);break;case"rc_light_minus_button":this.socialRobotScenario.removeRobotComponent(de.LIGHT)}this._eventBus.dispatchEvent(N.SAVE)}}]),e}(),ge=function(){function e(t){r()(this,e),c()(this,"isSimulationRunning",!1),c()(this,"logger",null),this.logger=t}return s()(e,[{key:"initSimulationState",value:function(e){console.log("initSimulationState")}},{key:"initSimulationDisplay",value:function(e){$("#".concat(e)).empty()}},{key:"updateScenario",value:function(e){}},{key:"updateScenarioState",value:function(e){}},{key:"updateScenarioDisplay",value:function(e){}},{key:"setIsSimulationRunning",value:function(e){this.isSimulationRunning=e}},{key:"getIsSimulationRunning",value:function(){return this.isSimulationRunning}}]),e}(),me=function(){function e(t,n){r()(this,e),c()(this,"socialRobotScenario",null),this.socialRobotScenario=t,this._eventBus=n,this.setupInteract(),window.dragMoveListener=this.dragMoveListener}return s()(e,[{key:"setupInteract",value:function(){var e=this;interact(".draggable").draggable({inertia:!0,modifiers:[interact.modifiers.restrictRect({restriction:"parent",endOnly:!0})],autoScroll:!0,onmove:this.dragMoveListener,onend:function(t){var n=t.target.querySelector("p");n&&(n.textContent="moved a distance of "+Math.sqrt(Math.pow(t.pageX-t.x0,2)+Math.pow(t.pageY-t.y0,2)|0).toFixed(2)+"px"),e._eventBus.dispatchEvent(N.SAVE),e.socialRobotScenario.logger.recordEvent(e.socialRobotScenario.logger.createEvent(O.moveRobotComponent,t.target.id))}})}},{key:"dragMoveListener",value:function(e){var t=e.target,n=(parseFloat(t.getAttribute("data-x"))||0)+e.dx,i=(parseFloat(t.getAttribute("data-y"))||0)+e.dy;t.style.webkitTransform=t.style.transform="translate("+n+"px, "+i+"px)",t.setAttribute("data-x",n),t.setAttribute("data-y",i)}},{key:"fireCustomEvent",value:function(e,t,n){var i;n=n||{},document.createEvent?(i=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(i=document.createEventObject()).eventType=e,i.eventName=e,i=$.extend(i,n),document.createEvent?t.dispatchEvent(i):t.fireEvent("on"+i.eventType,i)}}]),e}(),ve=n(9),_e=n.n(ve),ye=n(10),be=n.n(ye),ke=function(){function e(){r()(this,e)}return s()(e,[{key:"download",value:function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"uploadXml",value:function(){return new Promise((function(e,t){var n="";if(window.File&&window.FileReader&&window.FileList&&window.Blob){console.log("yay, files supported"),$("div").remove("#dropzoneModal"),$("#blocklyDiv").append('<div id="dropzoneModal" class="modal fade" role="dialog"></div>'),$("#dropzoneModal").append('<div id="modalDialog" class="modal-dialog"></div>'),$("#modalDialog").append('<div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Upload</h4></div>'),$("#modalDialog").append('<div class="modal-body">'+MSG.dropzone.dictSelectFile+'<input type="file" id="fileInput"><div id="filedrag">'+MSG.dropzone.dictDefaultMessage+'</div><pre id="fileDisplayArea"><pre></div>'),$("#modalDialog").append('<div class="modal-footer"><button id="submit_upload_modal_dialog_button" type="button" class="btn btn-default" data-dismiss="modal">Ok</button></div>'),$("#dropzoneModal").modal("show");var i=function(e){if(e.type.match(/text.*/)){var t=new FileReader;t.onload=function(i){r.innerText=e.name,n=t.result},t.readAsText(e)}else r.innerText="File not supported!"},o=document.getElementById("fileInput"),r=document.getElementById("fileDisplayArea");o.addEventListener("change",(function(e){var t=o.files[0];i(t)}));var a=function(e){e.stopPropagation(),e.preventDefault(),e.target.className="dragover"==e.type?"hover":""},s=document.getElementById("filedrag");s.addEventListener("dragover",a,!1),s.addEventListener("dragleave",a,!1),s.addEventListener("drop",(function(e){a(e);var t=(e.target.files||e.dataTransfer.files)[0];i(t)}),!1),s.style.display="block",$("#dropzoneModal").on("click",(function(e){var n=$(e.target);console.log(n),(n.is("button.close")||n.is("div#dropzoneModal.modal.fade"))&&(console.log("closed"),t("Dialog closed without result"))})),$("#submit_upload_modal_dialog_button").click((function(){e(n)}))}else t("File IO libraries not supported")}))}}]),e}(),Se=function(){function e(t,n){r()(this,e),c()(this,"ioController",null),this.scenario=t,this._eventBus=n,this.ioController=new ke}var t;return s()(e,[{key:"saveScenario",value:function(e){console.log("save scenario"),this.ioController.download("scenario.xml",e),this.scenario.logger.recordEvent(this.scenario.logger.createEvent(O.downloadScenarioClicked,""))}},{key:"loadScenario",value:(t=be()(_e.a.mark((function e(){var t;return _e.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.ioController.uploadXml();case 3:t=e.sent,this.scenario.xmlToRobot(t),this._eventBus.dispatchEvent(N.SAVE),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return t.apply(this,arguments)})},{key:"textToDom",value:function(e){var t=(new DOMParser).parseFromString(e,"text/xml");return t&&t.firstChild&&"xml"==t.firstChild.nodeName.toLowerCase()&&t.firstChild===t.lastChild||goog.asserts.fail("Blockly.Xml.textToDom did not obtain a valid XML tree."),t.firstChild}}]),e}();function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ee=function(e){y()(n,e);var t=we(n);function n(e){var i;return r()(this,n),i=t.call(this,e),c()(g()(i),"simulationComponentsMenu",null),c()(g()(i),"simulationRobotComponents",null),i._eventBus=new he,i._eventBus.registerEvent(N.SAVE),i._eventBus.addEventListener(N.SAVE,(function(){i.saveRobot()})),i.simulationRobotComponents=new me(g()(i),i._eventBus),i.simulationComponentsMenu=new fe(i._eventBus),i}return s()(n,[{key:"initSimulationState",value:function(e){var t=this;v()(w()(n.prototype),"initSimulationState",this).call(this,e),this.renderer=new L,this.scenarioUtils=new Se(this,this._eventBus),this.robotComponentsFactory=new pe(this.scenarioUtils,this.logger,this._eventBus),this._eventBus.registerEvent(N.CLEARCANVAS),this._eventBus.addEventListener(N.CLEARCANVAS,(function(e){t.renderer.clearCanvas(e)})),this._eventBus.registerEvent(N.INITIALIZECANVAS),this._eventBus.addEventListener(N.INITIALIZECANVAS,(function(e){t.renderer.initializeCanvas(t.robotComponentsFactory.getRobot(),e)}))}},{key:"initSimulationDisplay",value:function(e){v()(w()(n.prototype),"initSimulationDisplay",this).call(this);var t=$("#".concat(e));t.empty();var i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane");t.append(i).append(o),this.simulationComponentsMenu.setupEnvironment(this),this.initSimulation(e);var r=this;$("#sim_stop").click((function(){setTimeout((function(){r.resetSocialRobot(),r.renderer.render(r.robotComponentsFactory.getRobot())}),500)})),this.setBackground(),this.initScenarioOptions(),this.setSensorOptions(),this.loadRobot()}},{key:"initScenarioOptions",value:function(){var e=this,t=this,n=$("<div>").attr("id","scenario_options");$("#sim_container").append(n),n.append("<div id='load_scenario' class='glyphicon glyphicon-cloud-upload' alt='Load'></div>"),n.append("<div id='save_scenario' class='glyphicon glyphicon-cloud-download' alt='Save'></div>"),n.append("<div id='switch_background' class='glyphicon glyphicon-refresh'></div>"),$("#load_scenario").click((function(){t.removeSocialRobotComponents(),t.scenarioUtils.loadScenario()})),$("#save_scenario").click((function(){var e=t.loadToXml();t.scenarioUtils.saveScenario(e)})),document.getElementById("switch_background").addEventListener("click",(function(){e.switchBackground()}))}},{key:"initSimulation",value:function(e){console.log("init simulation display");var t=$("#".concat(e));$("#db_simulator_top_pane").css("height","25%"),$("#db_simulator_bottom_pane").css("height","75%");var n=$("<div>").attr("id","sim_container").attr("style","margin: auto"),i=this;new ResizeSensor(n,(function(){i.containerWidth=n.width(),i.containerHeight=n.height()})),t.append(n)}},{key:"updateScenario",value:function(e){v()(w()(n.prototype),"updateScenario",this).call(this,e),this.updateScenarioState(e),this.updateScenarioDisplay(e)}},{key:"updateScenarioState",value:function(e){v()(w()(n.prototype),"updateScenarioState",this).call(this,e),this.robotComponentsFactory.updateScenarioState(e)}},{key:"updateScenarioDisplay",value:function(e){v()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e),this.renderer.render(this.robotComponentsFactory.getRobot())}},{key:"setSensorOptions",value:function(){if(!document.getElementById("sensor_options")){var e=$("<div>").attr("id","sensor_options");$("#sim_container").append(e)}}},{key:"setBackground",value:function(){console.log("set background"),$("#sim_container").append("<div id='sim_background' class='sim_element row'></div>"),$("#sim_background").append("<div id='sim_background_img' class='background1'></div>"),this._background=1;var e=$("#sensor_options").width(),t=($("#sim_background").width()-e-$("#sim_background_img").width())/2;$("#sim_background_img").css("top","0px"),$("#sim_background_img").css("margin-left",t+"px")}},{key:"switchBackground",value:function(){this._background<3?this._background+=1:this._background=1,document.getElementById("sim_background_img").className="",document.getElementById("sim_background_img").className="background"+this._background,this._eventBus.dispatchEvent(N.SAVE)}},{key:"backgroundToXml",value:function(){var e="";return e=(e=(e=(e=(e=e.concat("<Item ")).concat(" Type='","background","'")).concat(" Class='",document.getElementById("sim_background_img").className,"'")).concat(" Id='",this._background,"'")).concat("></Item>")}},{key:"resetSocialRobot",value:function(e){this.robotComponentsFactory.resetSocialRobot()}},{key:"removeSocialRobotComponents",value:function(){this.robotComponentsFactory.removeAllSocialRobotComponents()}},{key:"addRobotComponent",value:function(e){this.robotComponentsFactory.addRobotComponent(e)}},{key:"removeRobotComponent",value:function(e){this.robotComponentsFactory.removeRobotComponent(e),this.renderer.render(this.robotComponentsFactory.getRobot())}},{key:"setLedColor",value:function(e,t){var n=this.robotComponentsFactory.getRobotComponentWithTypeAndId(de.LED,e);void 0!==n&&n.setOnColor(t)}},{key:"loadToXml",value:function(){if(window.localStorage&&window.localStorage.getItem("dwenguinoSocialRobot"))return this.robotToXml()}},{key:"robotToXml",value:function(){var e='<xml xmlns="http://www.w3.org/1999/xhtml">';e=e.concat(this.backgroundToXml());for(var t=this.robotComponentsFactory.getRobot(),n=0;n<t.length;n++)e=e.concat(t[n].toXml());return e=e.concat("</xml>")}},{key:"xmlToRobot",value:function(e){for(var t=this.scenarioUtils.textToDom(e),n=t.childNodes.length,i=0;i<n;i++){var o=t.childNodes[i],r=o.getAttribute("Type");"background"!==r?(this.robotComponentsFactory.addRobotComponentFromXml(o),this.simulationComponentsMenu.changeValue(r,1)):(this._background=parseInt(o.getAttribute("Id")),document.getElementById("sim_background_img").className=o.getAttribute("Class"))}}},{key:"saveRobot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e?"permanentDwenguinoSocialRobot"+t:"dwenguinoSocialRobot"+t;console.log("%c saving robot","color: green");var i=window.localStorage;if(i){var o=this.robotToXml();i.setItem(n,o)}}},{key:"loadRobot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e?"permanentDwenguinoSocialRobot"+t:"dwenguinoSocialRobot"+t;console.log("%c loading robot","color: green");var i=window.localStorage;if(i){var o=i.getItem(n);o&&this.xmlToRobot(o)}}},{key:"clearRobot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="dwenguinoSocialRobot"+e;console.log("%c clearing robot","color: green");var n=window.localStorage;n&&n.removeItem(t)}}]),n}(ge);function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ie=function(e){y()(n,e);var t=xe(n);function n(e){var i;return r()(this,n),i=t.call(this,e),c()(g()(i),"inputsState",null),c()(g()(i),"audiocontext",null),c()(g()(i),"osc",null),c()(g()(i),"audioStarted",!1),c()(g()(i),"muted",!0),c()(g()(i),"prevFreq",0),c()(g()(i),"boardDisplayWidth","80%"),c()(g()(i),"componentsTopOffset","0%"),c()(g()(i),"rightSimComponentsPosition","auto"),c()(g()(i),"sonarDistance",0),c()(g()(i),"sonarInputChanged",!1),c()(g()(i),"sonarFieldBeingEdited",!1),i.inputsState={buttons:[1,1,1,1,1],reset:1},i}return s()(n,[{key:"setBoardDisplayWidthWidth",value:function(e){this.boardDisplayWidth=e}},{key:"setComponentsTopOffset",value:function(e){this.componentsTopOffset=e}},{key:"setComponentsRightPosition",value:function(e){this.rightSimComponentsPosition=e}},{key:"initAudioContext",value:function(){try{this.audiocontext=new AudioContext}catch(e){console.log("Web Audio API is not supported in this browser")}}},{key:"initSimulationDisplay",value:function(e){var t=this;$("#".concat(e)).append('<div id="db_simulator_pane"></div>'),$("#db_simulator_pane").append('<div id="debug"></div>'),$("#db_simulator_pane").append('<div id="sim_components"></div>');var n=$("<div>").css({position:"absolute",display:"inline-block",width:this.boardDisplayWidth,"max-width":"30vw",right:0}),i=$("<div>").attr("id","dummy").css({"margin-top":"70%"}),o=$("<div>").attr("id","sim_board").css({position:"absolute",right:0,bottom:0,left:0});n.append(i),n.append(o),$("#db_simulator_pane").append(n),$("#db_simulator_pane").append('<span id="db_simulator_mute"></span>'),$("#db_simulator_mute").attr("class","glyphicon glyphicon-volume-off");var r=$('<div id="sim_sonar" class="sim_sonar"></div>'),a=$('<div id="sim_sonar_distance" class="sim_sonar_distance"></div>'),s=$('<div id="sim_sonar_input"></div>').text("Sonar "+MSG.simulator.distance+":"),l=$('<button id="set_sonar_value"></button>').text("OK");$("#sim_components").append(r),$("#sim_components").append(a),$("#sim_components").append(s),$("#sim_components").append(l),$("#sim_components").css({"margin-top":this.componentsTopOffset,right:this.rightSimComponentsPosition}),$("#sim_sonar_input").append('<input type="text" id="sonar_input" name="sim_sonar_input" onkeypress="return event.charCode >= 48 && event.charCode <= 57">&nbsp;cm'),$("#sonar_input").on("keyup",(function(e){if("Enter"===e.key||13===e.keyCode){t.sonarInputChanged=!0;var n=$("#sonar_input").val();console.log(parseInt(n.trim())),t.sonarDistance=parseInt(n.trim())}})),$("#sonar_input").change((function(e){t.sonarInputChanged=!0;var n=$("#sonar_input").val();console.log(parseInt(n.trim())),t.sonarDistance=parseInt(n.trim())})),$("#set_sonar_value").click((function(e){var n=$("#sonar_input").val();console.log(parseInt(n.trim())),t.sonarDistance=parseInt(n.trim())})),$("#sonar_input").focus((function(){console.log("focus gained"),t.sonarFieldBeingEdited=!0})),$("#sonar_input").focusout((function(){console.log("focus lost"),t.sonarFieldBeingEdited=!1})),$("#sim_board").append('<div class="sim_light sim_light_off" id ="sim_light_13"></div>'),$("#sim_board").append('<div id="sim_lcds"></div>'),$("#sim_board").append('<div id="sim_lights"></div>'),$("#sim_board").append('<div id="sim_buttons"></div>'),$("#sim_board").append('<div id="sim_button_reset" class="sim_button"></div>'),$("#sim_lcds").append('<div class="sim_lcd" id="sim_lcd_row0"></div>'),$("#sim_lcds").append('<div class="sim_lcd" id="sim_lcd_row1"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_7"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_6"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_5"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_4"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_3"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_2"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_1"></div>'),$("#sim_lights").append('<div class="sim_light sim_light_off" id ="sim_light_0"></div>'),$("#sim_buttons").append('<div id="sim_buttons_top"></div>'),$("#sim_buttons").append('<div id="sim_buttons_middle"></div>'),$("#sim_buttons").append('<div id="sim_buttons_bottom"></div>'),$("#sim_buttons_top").append('<div id="sim_button_N" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_W" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_C" class="sim_button"></div>'),$("#sim_buttons_middle").append('<div id="sim_button_E" class="sim_button"></div>'),$("#sim_buttons_bottom").append('<div id="sim_button_S" class="sim_button"></div>'),this.hideSonar();var c=this;$("#sim_button_N, #sim_button_E, #sim_button_C, #sim_button_S, #sim_button_W").on("mousedown",(function(){c.getIsSimulationRunning()&&(c.inputsState.buttons[x.mapButtonIdToIndex(this.id)]=0)})),$("#sim_button_N, #sim_button_E, #sim_button_C, #sim_button_S, #sim_button_W").on("mouseup",(function(){c.getIsSimulationRunning()&&(c.inputsState.buttons[x.mapButtonIdToIndex(this.id)]=1)})),$("#db_simulator_mute").on("click",(function(){null==t.audiocontext&&t.initAudioContext(),t.muted?(t.muted=!1,$("#db_simulator_mute").removeClass(),$("#db_simulator_mute").attr("class","glyphicon  glyphicon-volume-up")):(t.muted=!0,$("#db_simulator_mute").removeClass(),$("#db_simulator_mute").attr("class","glyphicon  glyphicon-volume-off"))}))}},{key:"showSonar",value:function(){$("#sim_sonar").show(),$("#sim_sonar_distance").show(),$("#sim_sonar_input").show()}},{key:"hideSonar",value:function(){$("#sim_sonar").hide(),$("#sim_sonar_distance").hide(),$("#sim_sonar_input").hide()}},{key:"updateScenarioState",value:function(e){for(var t=0;t<this.inputsState.buttons.length;++t)e.setButtonState(t,this.inputsState.buttons[t]);this.sonarInputChanged&&(e.setSonarDistance(11,12,this.sonarDistance),this.sonarInputChanged=!1),this.sonarDistance=e.getSonarDistance(11,12)}},{key:"updateScenario",value:function(e){this.updateScenarioState(e),this.updateScenarioDisplay(e)}},{key:"updateScenarioDisplay",value:function(e){var t=e.getSonarDistance(11,12);if(t<=-1)this.hideSonar();else{this.showSonar();var n=document.getElementById("sonar_input");void 0!==n&&null!=n?this.sonarFieldBeingEdited||(n.value=t):console.log("Sonar input element is undefined")}this.audiocontext&&(this.prevFreq!=e.getTonePlaying()&&0!=this.prevFreq&&0!=e.getTonePlaying&&(this.prevFreq=e.getTonePlaying(),this.osc.stop(this.audiocontext.currentTime),this.osc.disconnect(this.audiocontext.destination),this.osc=null,this.audioStarted=!1),0===e.getTonePlaying()||this.muted?this.audioStarted&&(console.log("stop"),this.audioStarted=!1,this.osc.stop(this.audiocontext.currentTime),this.osc.disconnect(this.audiocontext.destination),this.osc=null):0===e.getTonePlaying()||this.muted||this.audioStarted||(this.osc=this.audiocontext.createOscillator(),this.osc.frequency.value=e.getTonePlaying(),this.osc.start(this.audiocontext.currentTime),this.osc.connect(this.audiocontext.destination),console.log("start"),this.audioStarted=!0));for(var i=0;i<5;i++)0===e.getButtonState(i)?document.getElementById(x.mapIndexToButtonId(i)).className="sim_button sim_button_pushed":document.getElementById(x.mapIndexToButtonId(i)).className="sim_button";1==e.getBackLightStatus()?$("#sim_lcds").addClass("on"):$("#sim_lcds").removeClass("on");for(var o=0;o<2;++o)$("#sim_lcd_row"+o).text(e.getLcdContent(o)),null!==document.getElementById("sim_lcd_row"+o)&&(document.getElementById("sim_lcd_row"+o).innerHTML=document.getElementById("sim_lcd_row"+o).innerHTML.replace(/ /g,"&nbsp;"));var r=document.getElementById("sim_lcds");if(null!==r){r.style.display="none",r.offsetHeight,r.style.display="block";var a=$(".sim_lcd"),s=$("#sim_board").width()/16*1.25;a.css({"font-size":s})}for(var l=0;l<8;l++){var c="";c=0===e.getLedState(l)?"sim_light sim_light_off":"sim_light sim_light_on",document.getElementById("sim_light_"+l).className=c}0===e.getLedState(8)?document.getElementById("sim_light_13").className="sim_light sim_light_off":document.getElementById("sim_light_13").className="sim_light sim_light_on"}}]),n}(ge);function Te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ce=function(e){y()(n,e);var t=Te(n);function n(e){var i;return r()(this,n),i=t.call(this,e),c()(g()(i),"dwenguinoBoardSimulation",null),i.dwenguinoBoardSimulation=new Ie(e),i.initSimulationState(null),i}return s()(n,[{key:"initSimulationState",value:function(e){v()(w()(n.prototype),"initSimulationState",this).call(this,e),this.robot={image:{width:65,height:83},start:{x:100,y:100,angle:0},position:{x:100,y:100,angle:0},collision:[{type:"circle",radius:25}]},this.containerWidth=0,this.containerHeight=0}},{key:"initSimulationDisplay",value:function(e){v()(w()(n.prototype),"initSimulationDisplay",this).call(this,e);var t=$("#".concat(e)),i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane"),r=$("<div>").attr("id","db_simulator_tab_selection"),a=$("<ul>").attr("class","tabs");r.append(a),o.append(r);var s=$("<div>").attr("id","db_robot_pane"),l=$("<div>").attr("id","sim_container"),c=$("<div>").attr("id","sim_animation");l.append(c),s.append(l),o.append(s),t.append(i).append(o),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("db_simulator_top_pane");var u=$("#db_robot_pane"),d=this;new ResizeSensor(l,(function(){console.log("myelement has been resized"),d.containerWidth=l.width(),d.containerHeight=l.height()}));var p=$("<div>").attr("id","sim_animation");l.append(p),u.append(l),$("#db_simulator_bottom_pane").css("display","flex").css("flex-direction","column"),$("#db_simulator_tab_selection").css("height","30px"),$("#db_robot_pane").css("flex: 1"),$("#sim_container").css("position","relative").css("width","80%").css("height","80%").css("box-sizing","border-box"),$("#sim_animation").css("width",this.robot.image.width+"px").css("height",this.robot.image.height+"px").css("maring-left","-25px").css("maring-right","-20px").css("position","absolute").css("background-image","url('DwenguinoIDE/img/board/robot.png')").css("background-size","100%").css("top",this.robot.position.y+"px").css("left",this.robot.position.x+"px")}},{key:"updateScenario",value:function(e){v()(w()(n.prototype),"updateScenario",this).call(this,e),this.updateScenarioState(e),this.updateScenarioDisplay(e),this.dwenguinoBoardSimulation.updateScenario(e)}},{key:"updateScenarioState",value:function(e){v()(w()(n.prototype),"updateScenarioState",this).call(this,e),this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height();var t=e.getMotorSpeed(1),i=e.getMotorSpeed(2),o=this.robot.position.x,r=this.robot.position.y,a=this.robot.position.angle,s=(t+i)/100;t!==i&&(a+=(i-t)/30),o+=s*Math.cos(Math.PI/180*a),r+=s*Math.sin(Math.PI/180*a),o>this.containerWidth?o=0:o<0&&(o=this.containerWidth),r>this.containerHeight?r=0:r<0&&(r=this.containerHeight),this.robot.position={x:o,y:r,angle:a}}},{key:"updateScenarioDisplay",value:function(e){v()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e);this.robot;var t=$("#sim_animation");this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height(),t.css("top",this.robot.position.y+"px").css("left",this.robot.position.x+"px").css("transform","rotate("+this.robot.position.angle+"deg)")}},{key:"setIsSimulationRunning",value:function(e){this.isSimulationRunning=e,this.dwenguinoBoardSimulation.setIsSimulationRunning(e)}}]),n}(ge);function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Pe=function(e){y()(n,e);var t=Me(n);function n(e){var i;return r()(this,n),(i=t.call(this,e)).initSimulationState(null),i}return s()(n,[{key:"initSimulationState",value:function(e){v()(w()(n.prototype),"initSimulationState",this).call(this,e)}},{key:"initSimulationDisplay",value:function(e){v()(w()(n.prototype),"initSimulationDisplay",this).call(this,e),$("#sim_container").css("border","solid").css("border-width","3px").css("border-color","black").css("max-width","80%").css("max-height","80%"),this.containerWidth=$("#sim_container").width(),this.containerHeight=$("#sim_container").height()}},{key:"updateScenario",value:function(e){v()(w()(n.prototype),"updateScenario",this).call(this,e)}},{key:"updateScenarioState",value:function(e){v()(w()(n.prototype),"updateScenarioState",this).call(this,e);var t=e.getMotorSpeed(1),i=e.getMotorSpeed(2),o=this.robot.position.x,r=this.robot.position.y,a=this.robot.position.angle,s=(t+i)/100;t!==i&&(a+=(i-t)/30%360),o+=s*Math.cos(Math.PI/180*a),r+=s*Math.sin(Math.PI/180*a),o>this.containerWidth-this.robot.image.width?o=this.containerWidth-this.robot.image.width:o<0&&(o=0),r>this.containerHeight-this.robot.image.height?r=this.containerHeight-this.robot.image.height:r<0&&(r=0);var l=r;a=(a%360+360)%360;var c=o+this.robot.image.width/2*Math.cos(Math.PI/180*a),u=l+this.robot.image.width/2*Math.sin(Math.PI/180*a),d=[[this.containerWidth,this.containerHeight],[0,this.containerHeight],[0,0],[this.containerWidth,0]],p=[0,0],h=[0,0];if(90==a)p=h=[c,this.containerHeight];else if(270==a)p=h=[c,0];else if(180==a)p=h=[0,u];else if(0==a)p=h=[this.containerWidth,u];else{Math.tan(a);var f=d[Math.floor(a/90)%4];p=[f[0],Math.tan(a*Math.PI/180)*(f[0]-c)+u],h=[(f[1]-u)/Math.tan(a*Math.PI/180)+c,f[1]]}var g=Math.min(this.calcDistanceBetweenPoints(p,[c,u]),this.calcDistanceBetweenPoints(h,[c,u]));return e.setSonarDistance(11,12,Math.abs(g-25)),console.log(e.getSonarDistance(11,12)),this.robot.position={x:o,y:r,angle:a},e}},{key:"calcDistanceBetweenPoints",value:function(e,t){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}},{key:"updateScenarioDisplay",value:function(e){v()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e)}},{key:"setIsSimulationRunning",value:function(e){this.isSimulationRunning=e,this.dwenguinoBoardSimulation.setIsSimulationRunning(e)}}]),n}(Ce),Ae=function(){function e(t,n){r()(this,e),c()(this,"x",0),c()(this,"y",0),this.x=t,this.y=n}return s()(e,[{key:"getEuclideanDistanceTo",value:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e.beginPath(),e.arc(this.x,this.y,t,0,360),e.closePath(),e.stroke(),e.fill()}},{key:"getX",value:function(){return this.x}},{key:"setX",value:function(e){this.x=e}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(e){this.y=e}}]),e}(),Oe=function(){function e(t,n){r()(this,e),c()(this,"point1",null),c()(this,"point2",null),this.point1=t,this.point2=n}return s()(e,[{key:"getSlope",value:function(){return(this.point2.getY()-this.point1.getY())/(this.point2.getX()-this.point1.getX())}},{key:"getOffset",value:function(){return this.point1.getY()-this.getSlope()*this.point1.getX()}},{key:"getPointsPerpendicular",value:function(e,t){var n=1/this.getSlope()*-1;return this.getPointAtDistanceFromPointWithSlope(e,t,n)}},{key:"getPointAtDistanceFromPointWithSlope",value:function(e,t,n){var i=Math.atan(n),o=t*Math.cos(i),r=t*Math.sin(i);return[new Ae(e.getX()+o,e.getY()+r),new Ae(e.getX()-o,e.getY()-r)]}},{key:"getPointsOnLineAtSetDistanceFromOtherPointOnLine",value:function(e,t){return this.getPointAtDistanceFromPointWithSlope(e,t,this.getSlope())}}]),e}(),Re=function(){function e(){r()(this,e)}return s()(e,[{key:"drawRobotArm",value:function(e,t,n,i,o,r){this.drawConvexHull(e,t,n,o),this.drawArmHoles(e,t,n,i,r)}},{key:"drawArmHoles",value:function(e,t,n,i,o){var r=t.getEuclideanDistanceTo(n)/i,a=new Oe(t,n).getSlope(),s=Math.atan(a);t.getX()>n.getX()&&(s+=Math.PI);for(var l=t,c=0;c<i;++c){e.beginPath(),e.arc(l.getX(),l.getY(),o,0,360),e.closePath(),e.stroke();var u=r*Math.cos(s),d=r*Math.sin(s);l=new Ae(l.getX()+u,l.getY()+d)}}},{key:"drawConvexHull",value:function(e,t,n,i){var o=new Oe(t,n),r=o.getPointsPerpendicular(t,i/2),a=o.getPointsPerpendicular(n,i/2),s=o.getPointsOnLineAtSetDistanceFromOtherPointOnLine(t,i/2),l=o.getPointsOnLineAtSetDistanceFromOtherPointOnLine(n,i/2),c=[];c.push(r[0]),c.push(a[0]);var u=null;u=this.checkIfInnerPointOfLineBetweenPoints(t,n,l[0])?l[1]:l[0];var d=new Ae(u.getX()+(a[0].getX()-n.getX()),u.getY()+(a[0].getY()-n.getY()));c.push(d),c.push(u),d=new Ae(u.getX()+(a[1].getX()-n.getX()),u.getY()+(a[1].getY()-n.getY())),c.push(d),c.push(a[1]),c.push(r[1]),u=this.checkIfInnerPointOfLineBetweenPoints(t,n,s[0])?s[1]:s[0],d=new Ae(u.getX()+(r[1].getX()-t.getX()),u.getY()+(r[1].getY()-t.getY())),c.push(d),c.push(u),d=new Ae(u.getX()+(r[0].getX()-t.getX()),u.getY()+(r[0].getY()-t.getY())),c.push(d),e.beginPath(),e.moveTo(c[0].getX(),c[0].getY()),e.lineTo(c[1].getX(),c[1].getY()),e.quadraticCurveTo(c[2].getX(),c[2].getY(),c[3].getX(),c[3].getY()),e.quadraticCurveTo(c[4].getX(),c[4].getY(),c[5].getX(),c[5].getY()),e.lineTo(c[6].getX(),c[6].getY()),e.quadraticCurveTo(c[7].getX(),c[7].getY(),c[8].getX(),c[8].getY()),e.quadraticCurveTo(c[9].getX(),c[9].getY(),c[0].getX(),c[0].getY()),e.closePath(),e.stroke()}},{key:"drawBasePlate",value:function(e,t,n){this.drawConvexHull(e,t,n,80),e.fillStyle="#8bab42",e.font="40px Courier New",e.textAlign="center",e.textBaseline="middle",e.fillText("dwengo",t.getX()+(n.getX()-t.getX())/2,t.getY())}},{key:"checkIfInnerPointOfLineBetweenPoints",value:function(e,t,n){return n.getEuclideanDistanceTo(e)+n.getEuclideanDistanceTo(t)<=e.getEuclideanDistanceTo(t)+.1}}]),e}();function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var $e=function(e){y()(n,e);var t=Be(n);function n(e){var i;return r()(this,n),i=t.call(this,e),c()(g()(i),"startScale",400),c()(g()(i),"currentScale",400),c()(g()(i),"currentColor","#4a9234"),c()(g()(i),"representationScale",{motorAxes:[[30,30],[280,30]],motorAngles:[0,0],segmentLengths:[30,20,150,170,120,150,160,150,50],segmentCount:[3,2,15,17,12,15,14,16,5],segmentRanges:[[2,3],[2,3],[10,20],[10,20],[5,15],[5,15],[5,15],[5,15],[0,2]],segmentIncrement:10,armWidth:10,holeDiameter:2.5,hinges:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]}),c()(g()(i),"drawingScale",{motorAxes:[[0,0],[0,0]],segmentLengths:[0,0,0,0,0,0,0,0,0],hinges:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],armWidth:0,holeDiameter:10}),c()(g()(i),"canvases",[]),c()(g()(i),"contexts",[]),c()(g()(i),"canvasNames",{SPYROGRAPH_CANVAS:0,SPYROGRAPH_DRAWING_CANVAS:1}),c()(g()(i),"container",null),c()(g()(i),"imageData",null),c()(g()(i),"graphicsLib",null),c()(g()(i),"dwenguinoBoardSimulation",null),c()(g()(i),"scaleFactorForDisplay",.8),i.initSimulationState(null),i.graphicsLib=new Re,i.dwenguinoBoardSimulation=new Ie(e),i.dwenguinoBoardSimulation.setBoardDisplayWidthWidth("100%"),i}return s()(n,[{key:"initSimulationState",value:function(e){v()(w()(n.prototype),"initSimulationState",this).call(this,e),this.representationScale.motorAngles=[0,0]}},{key:"initSimulationDisplay",value:function(e){var t=this;v()(w()(n.prototype),"initSimulationDisplay",this).call(this,e),this.canvases=[],this.contexts=[],this.initDrawingEnvironment(e),this.loadPreviousImageIfExists(),this.createControlsMenu(),this.convertToDisplayAndRender(!1),this.container=$("#".concat(e));var i=$("<div>").attr("id","boardContainer").css({position:"absolute",width:"40%",right:"10px",top:"10px"});this.container.append(i),this.dwenguinoBoardSimulation.setBoardDisplayWidthWidth("100%"),this.dwenguinoBoardSimulation.setComponentsTopOffset("55%"),this.dwenguinoBoardSimulation.setComponentsRightPosition("55px"),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("boardContainer"),new ResizeObserver((function(){for(var e=0;e<t.canvases.length;++e)t.canvases[e].width=t.container.width(),t.canvases[e].height=t.container.height();t.loadPreviousImageIfExists(),t.convertToDisplayAndRender(!0)})).observe(document.querySelector("#".concat(e)))}},{key:"initDrawingEnvironment",value:function(e){this.container=$("#".concat(e)),this.container.css({position:"relative"});for(var t=0,n=["spyrograph_canvas","spyrograph_drawing_canvas"];t<n.length;t++){var i=n[t];this.setupCanvas(i,this.container)}}},{key:"loadPreviousImageIfExists",value:function(){null!=this.imageData&&this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].putImageData(this.imageData,0,0)}},{key:"setupCanvas",value:function(e,t){var n=$("<canvas>").attr("id",e).css({position:"absolute",left:"10px",top:0})[0],i=n.getContext("2d");n.width=t.width(),n.height=t.height(),this.canvases.push(n),this.contexts.push(i),this.container.append(n)}},{key:"createControlsMenu",value:function(){var e=this,t=$("<span>").css({position:"absolute",right:0,bottom:0,width:"15%","text-align":"center","margin-right":"20px","margin-bottom":"20px"}),n=$("<input>").attr("type","color").attr("value",this.currentColor),i=this;n.on("change",(function(e){console.log($(this).val()),i.currentColor=$(this).val()})),t.append(n);var o=$("<button>").attr("value","Clear").html(MSG.clear).css({width:"90%","margin-top":"5px"});o.on("click",(function(t){e.contexts[e.canvasNames.SPYROGRAPH_DRAWING_CANVAS].clearRect(0,0,e.canvases[e.canvasNames.SPYROGRAPH_DRAWING_CANVAS].width,e.canvases[e.canvasNames.SPYROGRAPH_DRAWING_CANVAS].height),e.imageData=null})),t.append(o);var r=$("<button>").attr("value","Save").html(MSG.save).css({width:"90%","margin-top":"5px"});r.on("click",(function(t){var n=e.canvases[e.canvasNames.SPYROGRAPH_DRAWING_CANVAS].toDataURL("image/png"),i=document.createElement("a");i.download="tekening.png",i.href=n,i.click()})),t.append(r),this.container.append(t)}},{key:"createSlidersForSegments",value:function(e){for(var t=this,n=function(n){var i=$("<span>"),o=$("<span>").html("l"+n),r=$("<input>").attr("type","range").attr("min",t.representationScale.segmentRanges[n][0]).attr("max",t.representationScale.segmentRanges[n][1]).attr("value",t.representationScale.segmentCount[n]);r.css({"border-radius":"5px"});var a=t;r.on("change",(function(e){var t=parseInt($(this).val());console.log(t),a.representationScale.segmentCount[n]=t,a.representationScale.segmentLengths[n]=a.representationScale.segmentIncrement*t,a.calculateHingePoints(),a.convertToDisplayAndRender(!1)})),i.append(o),i.append(r),e.append(i)},i=0;i<this.representationScale.segmentLengths.length-1;++i)n(i)}},{key:"updateScenario",value:function(e){v()(w()(n.prototype),"updateScenario",this).call(this,e),this.updateScenarioState(e),this.updateScenarioDisplay(e),this.dwenguinoBoardSimulation.updateScenario(e)}},{key:"updateScenarioState",value:function(e){v()(w()(n.prototype),"updateScenarioState",this).call(this,e),this.timestep++;for(var t=0;t<2;t++)this.representationScale.motorAngles[t]+=e.getMotorSpeed(t+1)/3825;this.calculateHingePoints()}},{key:"calculateHingePoints",value:function(){for(var e=0;e<2;e++)this.representationScale.hinges[e]=[this.representationScale.motorAxes[e][0]+this.representationScale.segmentLengths[e]*Math.cos(this.representationScale.motorAngles[e]),this.representationScale.motorAxes[e][1]+this.representationScale.segmentLengths[e]*Math.sin(this.representationScale.motorAngles[e])];this.calulateFirstHingePoint(),this.calculateCentralHingePoints(),this.calculateFinalHingePoint()}},{key:"calulateFirstHingePoint",value:function(){var e=this.representationScale.segmentLengths[2],t=this.representationScale.segmentLengths[3],n=this.representationScale.hinges[0][0],i=this.representationScale.hinges[0][1],o=this.representationScale.hinges[1][0],r=this.representationScale.hinges[1][1],a=this.calculateHingePoint(n,i,o,r,e,t);this.representationScale.hinges[2][0]=a[0],this.representationScale.hinges[2][1]=a[1]}},{key:"calculateCentralHingePoints",value:function(){var e=this.representationScale.segmentLengths[3],t=this.representationScale.segmentLengths[4],n=this.representationScale.hinges[1][0],i=this.representationScale.hinges[1][1],o=this.representationScale.hinges[2][0],r=this.representationScale.hinges[2][1];this.representationScale.hinges[3][0]=n+(e+t)*(o-n)/e,this.representationScale.hinges[3][1]=i+(e+t)*(r-i)/e,e=this.representationScale.segmentLengths[2],t=this.representationScale.segmentLengths[5],n=this.representationScale.hinges[0][0],i=this.representationScale.hinges[0][1],o=this.representationScale.hinges[2][0],r=this.representationScale.hinges[2][1],this.representationScale.hinges[4][0]=n+(e+t)*(o-n)/e,this.representationScale.hinges[4][1]=i+(e+t)*(r-i)/e}},{key:"calculateFinalHingePoint",value:function(){var e=this.representationScale.hinges[3][0],t=this.representationScale.hinges[3][1],n=this.representationScale.hinges[4][0],i=this.representationScale.hinges[4][1],o=this.representationScale.segmentLengths[6],r=this.representationScale.segmentLengths[7],a=this.calculateHingePoint(e,t,n,i,o,r);this.representationScale.hinges[5][0]=a[0],this.representationScale.hinges[5][1]=a[1]}},{key:"calculateHingePoint",value:function(e,t,n,i,o,r){var a=r*r-o*o-n*n+e*e-i*i+t*t,s=2*(e-n),l=4*(i-t)*(i-t)/(s*s)+1,c=4*(i-t)*(i-t)+s*s,u=s*s,d=4*a*(i-t)/(s*s)-4*e*(i-t)/s-2*t,p=a*a/(s*s)-2*e*a/s+e*e+t*t-o*o,h=(-1*d+Math.sqrt(d*d-4*l*p))*u/(2*c),f=(-1*d-Math.sqrt(d*d-4*l*p))*u/(2*c);return h>f?[(2*h*(i-t)+a)/s,h]:[(2*f*(i-t)+a)/s,f]}},{key:"updateScenarioDisplay",value:function(e){v()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e),this.convertToDisplayAndRender(!0)}},{key:"convertToDisplayAndRender",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scaleRepresentationToDrawing(this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].width),this.mirrorDisplayVertically(this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].height),window.requestAnimationFrame((function(){e.render(t)}))}},{key:"mirrorDisplayVertically",value:function(e){for(var t=0;t<this.drawingScale.motorAxes.length;++t)this.drawingScale.motorAxes[t][1]=-1*this.drawingScale.motorAxes[t][1]+e;for(var n=0;n<this.drawingScale.hinges.length;++n)this.drawingScale.hinges[n][1]=-1*this.drawingScale.hinges[n][1]+e}},{key:"scaleRepresentationToDrawing",value:function(e){this.scaleSegementLengths(e),this.scaleHingePoints(e),this.scaleArmProperties(e)}},{key:"scaleArmProperties",value:function(e){this.drawingScale.armWidth=this.representationScale.armWidth/this.startScale*e,this.drawingScale.holeDiameter=this.representationScale.holeDiameter/this.startScale*e}},{key:"scaleHingePoints",value:function(e){for(var t=e*this.scaleFactorForDisplay,n=0;n<this.representationScale.motorAxes.length;++n)for(var i=0;i<this.representationScale.motorAxes[n].length;++i)this.drawingScale.motorAxes[n][i]=this.representationScale.motorAxes[n][i]/this.startScale*t;for(var o=0;o<this.representationScale.hinges.length;++o)for(var r=0;r<this.representationScale.hinges[o].length;++r)this.drawingScale.hinges[o][r]=this.representationScale.hinges[o][r]/this.startScale*t}},{key:"scaleSegementLengths",value:function(e){for(var t=e*this.scaleFactorForDisplay,n=0;n<this.representationScale.motorAxes.length;n++)for(var i=0;i<this.representationScale.motorAxes[n].length;i++)this.drawingScale.motorAxes[n][i]=this.representationScale.motorAxes[n][i]/this.startScale*t;for(var o=0;o<this.representationScale.segmentLengths.length;o++)this.drawingScale.segmentLengths[o]=this.representationScale.segmentLengths[o]/this.startScale*t;this.currentScale=t}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:TextTrackCueList,t=this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].width,n=this.canvases[this.canvasNames.SPYROGRAPH_CANVAS].height;this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].clearRect(0,0,t,n),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fillStyle="#000000",this.graphicsLib.drawBasePlate(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ae(this.drawingScale.motorAxes[0][0],this.drawingScale.motorAxes[0][1]),new Ae(this.drawingScale.motorAxes[1][0],this.drawingScale.motorAxes[1][1])),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fillStyle="#FF0000";for(var i=this.drawingScale.hinges.concat(this.drawingScale.motorAxes),o=0;o<i.length;o++)this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].beginPath(),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].arc(i[o][0],i[o][1],3,0,360),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].closePath(),this.contexts[this.canvasNames.SPYROGRAPH_CANVAS].fill();this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ae(this.drawingScale.motorAxes[0][0],this.drawingScale.motorAxes[0][1]),new Ae(this.drawingScale.hinges[0][0],this.drawingScale.hinges[0][1]),this.representationScale.segmentCount[0],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ae(this.drawingScale.motorAxes[1][0],this.drawingScale.motorAxes[1][1]),new Ae(this.drawingScale.hinges[1][0],this.drawingScale.hinges[1][1]),this.representationScale.segmentCount[1],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ae(this.drawingScale.hinges[0][0],this.drawingScale.hinges[0][1]),new Ae(this.drawingScale.hinges[4][0],this.drawingScale.hinges[4][1]),this.representationScale.segmentCount[2]+this.representationScale.segmentCount[5],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ae(this.drawingScale.hinges[1][0],this.drawingScale.hinges[1][1]),new Ae(this.drawingScale.hinges[3][0],this.drawingScale.hinges[3][1]),this.representationScale.segmentCount[3]+this.representationScale.segmentCount[4],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ae(this.drawingScale.hinges[3][0],this.drawingScale.hinges[3][1]),new Ae(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1]),this.representationScale.segmentCount[6],this.drawingScale.armWidth,this.drawingScale.holeDiameter),this.graphicsLib.drawRobotArm(this.contexts[this.canvasNames.SPYROGRAPH_CANVAS],new Ae(this.drawingScale.hinges[4][0],this.drawingScale.hinges[4][1]),new Ae(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1]),this.representationScale.segmentCount[7],this.drawingScale.armWidth,this.drawingScale.holeDiameter),e&&(this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].fillStyle=this.currentColor,this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].beginPath(),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].arc(this.drawingScale.hinges[5][0],this.drawingScale.hinges[5][1],1,0,360),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].closePath(),this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].fill()),this.imageData=this.contexts[this.canvasNames.SPYROGRAPH_DRAWING_CANVAS].getImageData(0,0,this.container.width(),this.container.height())}},{key:"setIsSimulationRunning",value:function(e){this.isSimulationRunning=e,this.dwenguinoBoardSimulation.setIsSimulationRunning(e)}}]),n}(ge);function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Le=function(e){y()(n,e);var t=De(n);function n(e){var i;return r()(this,n),i=t.call(this,e),c()(g()(i),"stepperMotorPins",[33,34]),c()(g()(i),"penPositionPins",[36,37]),c()(g()(i),"colorPin",35),c()(g()(i),"dwenguinoBoardSimulation",null),c()(g()(i),"previousProgramColor","#000"),c()(g()(i),"motor",{image:{radius:T.motorRadius},position:{xL:20,xR:20+T.motorDistance,y:20},settings:{nrOfSteps:T.nrOfSteps,currentSteps:[0,0]}}),c()(g()(i),"wireLengths",[300,200]),c()(g()(i),"startWireLengths",i.wireLengths),c()(g()(i),"stylus",{image:{radius:5},position:{x:80,y:80},prevPosition:{x:0,y:0},drawing:{radius:2,drawingColor:"#000",selectedColor:"#000",boardColor:"#000",liftStylus:!1}}),c()(g()(i),"paper",{height:(i.motor.position.xR-i.motor.position.xL)/Math.sqrt(2),width:i.motor.position.xR-i.motor.position.xL,position:{x:i.motor.position.xL,y:40}}),c()(g()(i),"containerWidth",0),c()(g()(i),"containerHeight",0),i.dwenguinoBoardSimulation=new Ie(e),i}return s()(n,[{key:"initSimulationState",value:function(e){v()(w()(n.prototype),"initSimulationState",this).call(this,e),this.caclulateStylusPoint(),e&&(e.setIoPinState(this.stepperMotorPins[0],this.wireLengths[0]/(2*Math.PI*T.motorRadius/T.nrOfSteps)),e.setIoPinState(this.stepperMotorPins[1],this.wireLengths[1]/(2*Math.PI*T.motorRadius/T.nrOfSteps)),e.setIoPinState(this.penPositionPins[0],this.stylus.position.x-this.motor.position.xL),e.setIoPinState(this.penPositionPins[1],this.stylus.position.y-this.motor.position.y))}},{key:"initSimulationDisplay",value:function(e){v()(w()(n.prototype),"initSimulationDisplay",this).call(this,e),this.initSimulationState(null);var t=$("#".concat(e)),i=$("<div>").attr("id","db_simulator_top_pane"),o=$("<div>").attr("id","db_simulator_bottom_pane");t.append(i).append(o),this.dwenguinoBoardSimulation.initSimulationState(null),this.dwenguinoBoardSimulation.initSimulationDisplay("db_simulator_top_pane"),o.append($("<canvas>").attr("id","sim_canvas").attr("class","canvas")),o.append($("<canvas>").attr("id","sim_canvas_drawing").attr("class","canvas")),o.append($("<canvas>").attr("id","sim_canvas_grid").attr("class","canvas")),o.append($("<div>").attr("id","sim_grid"));var r=$("<ul>").attr("id","sim_settings"),a=$("<li>").attr("class","sim_setting");$("<input />",{type:"checkbox",id:"cb_grid",value:"grid"}).prop("checked",!0).appendTo(a),$("<label />",{for:"cb_grid",id:"txt_grid",text:MSG.drawingrobotgrid}).appendTo(a),r.append(a);a=$("<li>").attr("class","sim_setting");$("#colorpicker");var s=$("<input />",{type:"color",id:"colorpicker",name:"colorpicker",value:this.stylus.drawing.drawingColor});s.appendTo(a),$("<label />",{for:"colorpicker",id:"txt_colorpicker",text:MSG.colorpicker}).appendTo(a),r.append(a);a=$("<li>").attr("class","sim_setting");$("<button />",{type:"button",id:"btn_saveImage",text:MSG.drawingrobotSaveImage}).appendTo(a),r.append(a),o.append(r);var l=this;s.on("change",(function(e){console.log($(this).val()),l.updateColor($(this).val())}));var c=$("#sim_canvas")[0],u=$("#sim_canvas_drawing")[0],d=$("#sim_canvas_grid")[0];$(".canvas").css("position","absolute").css("top","O").css("left","O"),$("#sim_settings").css("position","absolute").css("right","20px").css("top","0px").css("list-style","none"),$("#sim_grid").css("position","absolute").css("left",this.paper.position.x).css("top",this.paper.position.y).css("width",this.paper.width).css("height",this.paper.height),$(".sim_setting").css("vertical-align","middle"),this.containerWidth=o.width(),this.containerHeight=o.height(),c.width=this.containerWidth,c.height=this.containerHeight,u.width=this.containerWidth,u.height=this.containerHeight,d.width=this.containerWidth,d.height=this.containerHeight,this.drawGrid(),$("#cb_grid").click((function(){$("#svg_grid").toggle(this.checked),$("#sim_canvas_grid").toggle(this.checked)})),$("#btn_saveImage").click((function(){var e="image/png",t=$("#sim_canvas_drawing")[0].toDataURL(e),n=document.createElement("a");n.download=MSG.drawingrobotDrawing,n.href=t,n.dataset.downloadurl=[e,n.download,n.href].join(":"),document.body.appendChild(n),n.click(),document.body.removeChild(n)})),this.redraw()}},{key:"updateScenario",value:function(e){v()(w()(n.prototype),"updateScenarioState",this).call(this,e);this.updateScenarioState(e);this.updateScenarioDisplay(e)}},{key:"updateScenarioState",value:function(e){v()(w()(n.prototype),"updateScenarioState",this).call(this,e),this.updateServoAngle(e.getIoPinState(38)),this.previousProgramColor!=e.getIoPinState(this.colorPin)&&this.updateColor(e.getIoPinState(this.colorPin));var t=e.getIoPinState(this.stepperMotorPins[0]),i=e.getIoPinState(this.stepperMotorPins[1]);this.updateLengths([t,i]),this.caclulateStylusPoint(),e.setIoPinState(this.penPositionPins[0],this.stylus.position.x-this.motor.position.xL),e.setIoPinState(this.penPositionPins[1],this.stylus.position.y-this.motor.position.y)}},{key:"updateLengths",value:function(e){var t=this,n=e.map((function(e,n){var i=e*(2*Math.PI*t.motor.image.radius/t.motor.settings.nrOfSteps);return i>=0?i:0}));this.wireLengths=n}},{key:"calculateWireLengths",value:function(e){}},{key:"caclulateStylusPoint",value:function(){var e=this.wireLengths[0],t=this.wireLengths[1],n=this.motor.position.xR-this.motor.position.xL,i=(Math.pow(e,2)-Math.pow(t,2)+Math.pow(n,2))/(2*n);e+t>=n&&(this.stylus.position.x=this.motor.position.xL+i,this.stylus.position.y=this.motor.position.y+Math.sqrt(Math.pow(e,2)-Math.pow(i,2)))}},{key:"updateScenarioDisplay",value:function(e){v()(w()(n.prototype),"updateScenarioDisplay",this).call(this,e),this.redraw()}},{key:"redraw",value:function(){var e=$("#sim_canvas")[0],t=e.getContext("2d"),n=$("#sim_canvas_drawing")[0].getContext("2d");t.clearRect(0,0,e.width,e.height),t.beginPath(),t.strokeStyle="#848484",t.moveTo(this.motor.position.xL,this.motor.position.y),t.lineTo(this.stylus.position.x,this.stylus.position.y),t.moveTo(this.motor.position.xR,this.motor.position.y),t.lineTo(this.stylus.position.x,this.stylus.position.y),t.stroke(),t.beginPath(),t.globalAlpha=.5,t.fillStyle=this.stylus.drawing.drawingColor,t.arc(this.stylus.position.x,this.stylus.position.y,this.stylus.image.radius,0,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="#848484",t.arc(this.motor.position.xL,this.motor.position.y,this.motor.image.radius,0,2*Math.PI),t.fill(),t.beginPath(),t.fillStyle="#848484",t.arc(this.motor.position.xR,this.motor.position.y,this.motor.image.radius,0,2*Math.PI),t.fill(),this.stylus.drawing.liftStylus||(n.beginPath(),n.fillStyle=this.stylus.drawing.drawingColor,n.arc(this.stylus.position.x,this.stylus.position.y,this.stylus.drawing.radius,0,2*Math.PI),n.fill())}},{key:"drawGrid",value:function(){var e=this.paper.position.x,t=this.paper.position.y,n=$("#sim_canvas_grid")[0].getContext("2d");n.font="10px Arial",n.fillText("0",e,t),n.fillText("100",e+100,t),n.fillText("200",e+200,t),n.fillText("300",e+300,t),n.fillText("300",e-15,t+100),n.fillText("200",e-15,t+200),n.fillText("100",e-15,t+300);$("#sim_grid").append('        <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" id="svg_grid">          <defs>            <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">            <path d="M 10 0 L 0 0 0 10" fill="none" stroke="gray" stroke-width="0.5"/>            </pattern>            <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">              <rect width="100" height="100" fill="url(#smallGrid)"/>              <path d="M 100 0 L 0 0 0 100" fill="none" stroke="gray" stroke-width="1"/>            </pattern>          </defs>          <rect width="100%" height="100%" fill="url(#grid)" />        </svg>')}},{key:"updateServoAngle",value:function(e){90===e&&(this.stylus.drawing.liftStylus=!0),0===e&&(this.stylus.drawing.liftStylus=!1)}},{key:"checkServoAngle",value:function(e,t){return(90!==e||!t.stylus.drawing.liftStylus)&&!(0===e&&!t.stylus.drawing.liftStylus)}},{key:"updateColor",value:function(e){0!=e&&(this.stylus.drawing.drawingColor=e)}},{key:"setIsSimulationRunning",value:function(e){this.isSimulationRunning=e,this.dwenguinoBoardSimulation.setIsSimulationRunning(e)}}]),n}(ge),Fe=function(){function e(t,n){r()(this,e),c()(this,"logger",null),c()(this,"workspace",null),c()(this,"scenarios",null),this.scenarios={spyrograph:new $e(t),moving:new Ce(t),wall:new Pe(t),socialrobot:new Ee(t),plotter:new Le(t)},this.logger=t,this.workspace=n,this.simControlsController=new R(this.logger,this.workspace,this.scenarios)}return s()(e,[{key:"open",value:function(){}},{key:"stop",value:function(){this.simControlsController.handleSimulationStop()}}]),e}();function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var je=function(e){y()(n,e);var t=Ne(n);function n(){return r()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"buzzer"}}],[{key:"getType",value:function(){return Z.BUZZER}},{key:"getDescription",value:function(){return MSG.simulator.buzzerDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return["frequency"]}}]),n}(J);function He(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var We=function(e){y()(n,e);var t=He(n);function n(){return r()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"lcd"}}],[{key:"getType",value:function(){return Z.LCD}},{key:"getDescription",value:function(){return MSG.simulator.lcdDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(J);function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ue=function(e){y()(n,e);var t=Ge(n);function n(){return r()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"led"}}],[{key:"getType",value:function(){return Z.LED}},{key:"getDescription",value:function(){return MSG.simulator.ledDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(J);function Ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ye=function(e){y()(n,e);var t=Ve(n);function n(){return r()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"light sensor"}}],[{key:"getType",value:function(){return Z.LIGHT}},{key:"getDescription",value:function(){return""}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(J);function Xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ke=function(e){y()(n,e);var t=Xe(n);function n(){return r()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"PIR sensor"}}],[{key:"getType",value:function(){return Z.PIR}},{key:"getDescription",value:function(){return MSG.simulator.pirDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return[]}}]),n}(J);function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var ze=function(e){y()(n,e);var t=qe(n);function n(){return r()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"Servo"}}],[{key:"getType",value:function(){return Z.SERVO}},{key:"getDescription",value:function(){return MSG.simulator.servoDescription}},{key:"getInputPins",value:function(){return[]}},{key:"getOutputPins",value:function(){return["angle"]}}]),n}(J);function Qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k()(this,n)}}var Ze=function(e){y()(n,e);var t=Qe(n);function n(){return r()(this,n),t.call(this)}return s()(n,[{key:"toString",value:function(){return"Sonar"}}],[{key:"getType",value:function(){return Z.SONAR}},{key:"getDescription",value:function(){return""}},{key:"getInputPins",value:function(){return["trigger"]}},{key:"getOutputPins",value:function(){return["echo"]}}]),n}(J),Je={dwenguino:"db_menu_item_dwengo_robot_teacher_image",workspaceArea:"blocklyDiv",toolboxArea:"db_blocklyToolboxDiv",toolbox:"blocklyToolboxDiv",languageMenu:"db_menu_item_language",difficultyMenu:"db_menu_item_difficulty",dwengoBooksMenu:"db_tutorials",playButton:"db_menu_item_run",uploadButton:"db_menu_item_upload",openButton:"db_menu_item_upload",saveButton:"db_menu_item_download",simulatorButton:"db_menu_item_simulator",codeArea:"db_code_pane",simulatorArea:"db_simulator_pane",simulatorStartButton:"sim_start",simulatorStopButton:"sim_stop",simulatorScenarioTag:"sim_scenarioTag",simulatorBottomPane:"db_simulator_bottom_pane",simulatorScenarioSocialRobot:"sim_scenario",robotComponentsMenuLedPlusButton:"rc_led_plus_button",robotComponentsMenuLedMinusButton:"rc_led_minus_button",robotcomponentsMenuLedOptions:"rc_led_options",robotComponentsMenuLcdPlusbutton:"rc_lcd_plus_button",robotComponensMenu:"robot_components_menu"},et={introduction:{category:"dwenguino",targets:[Je.dwenguino,Je.workspaceArea,"db_blocklyToolboxDiv","db_menu_item_language","db_menu_item_difficulty","books_dropdown","db_menu_item_run","db_menu_item_upload","db_menu_item_download","db_menu_item_simulator"],placements:["left","right","right","left","left","left","left","left","left","left"],nrOfSteps:10,xOffsets:[0,"center",0,0,0,0,0,0,0,0],yOffsets:[0,"center",0,0,0,0,0,0,0,0],steps:[],id:"tutsIntroduction",label:MSG.tutsIntroduction,initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.introduction.stepTitles[e],content:MSG.tutorials.introduction.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-88" y="-382"></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()}},avoidWall:{category:"ridingrobot",id:"tutsAvoidWall",label:MSG.tutsAvoidWall,targets:[Je.simulatorButton,Je.simulatorScenarioTab,Je.simulatorScenarioSelection,Je.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,-20,0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.avoidWall.stepTitles[e],content:MSG.tutorials.avoidWall.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-152" y="43"><statement name="LOOP"><block type="controls_if" id="@5_v({:-p!8Gi,2CfS*2"><mutation else="1"></mutation><value name="IF0"><block type="logic_compare" id="pO3`z[KM7dM91a$uJnV="><field name="OP">GTE</field><value name="A"><block type="char_type" id="r)z[m@Nos2|cpm^(MovD"><field name="BITMASK">30</field></block></value><value name="B"><block type="sonar_sensor" id="%Ha2KSwLpWq]5!^?mUn?"><value name="trig"><block type="char_type" id="t3zJd~XLa:~hNsD11;$("><field name="BITMASK">11</field></block></value><value name="echo"><block type="char_type" id="Ohz-(RX2RI34`HQmDv,s"><field name="BITMASK">12</field></block></value></block></value></block></value><statement name="DO0"><block type="dc_motor" id="7S)A(0|1NJY$trtQzX,3"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="mvt87=#!=N4y.]LDT2Tm"><value name="channel"><block type="math_number" id="H0_b%l*{mJ45Li+J+87l"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="Zt+djA7XMOi9Zp/%]??C"><field name="NUM">-100</field></block></value></block></next></block></statement><statement name="ELSE"><block type="dc_motor" id="{|*6o9^%o+R~*cTn_CfU"><value name="channel"><block type="math_number" id="P#QoZo*y11wAim[,gWvA"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="nB/xoT!1$Slx0jAKrT;n"><field name="NUM">255</field></block></value><next><block type="dc_motor" id="IENQp`U=)/.K^:61n`3K"><value name="channel"><block type="math_number" id="K[n0u(V:ugdW?t1.p!le"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="YDYgsSjexNArI#`f:@#V"><field name="NUM">255</field></block></value></block></next></block></statement><next><block type="dwenguino_delay" id="Ve-hN}})E6#/rWFaP`be"><value name="DELAY_TIME"><block type="char_type" id="W^^#Oxga@%ncB=Vi:coG"><field name="BITMASK">50</field></block></value></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()}},driveForward:{category:"ridingrobot",targets:[Je.simulatorButton,Je.simulatorScenarioTab,Je.simulatorStartButton,Je.dwenguino],placements:["left","left","left"],nrOfSteps:3,xOffsets:[0,0,0],yOffsets:[0,-20,0],steps:[],id:"tutsDriveForward",label:MSG.tutsDriveForward,initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.driveForward.stepTitles[e],content:MSG.tutorials.driveForward.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-88" y="-382"><statement name="LOOP"><block type="dc_motor" id="}m$#-.GS5+AKD-gI}OY,"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="cgSFVxrXN$Sgeiy15T;?"><value name="channel"><block type="math_number" id="oA@j2Jdo#=lH`r:+![%K"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="a[y,hG3rY^+Pk+cjv=8m"><field name="NUM">-100</field></block></value><next><block type="dwenguino_delay" id="to!Bxm`]gQzEi;K`Bx%s"><value name="DELAY_TIME"><block type="char_type" id="FsFIj~`KNGMlcHhp^^gj"><field name="BITMASK">100</field></block></value></block></next></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()}},rideInSquare:{category:"ridingrobot",id:"tutsRideInSquare",label:MSG.tutsRideInSquare,targets:[Je.simulatorButton,Je.simulatorScenarioTab,Je.simulatorStartButton,Je.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,0,0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.rideInSquare.stepTitles[e],content:MSG.tutorials.rideInSquare.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-187" y="-164"><statement name="LOOP"><block type="dc_motor" id="2~!yv!MW{1Hr7=a=q^aT"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="k|$W/{v:t)Ri*1iI2c]E"><value name="channel"><block type="math_number" id="wne%a{,$k%a@w,sKH?a]"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="{6ghh[Yn?Jc$jNeC)?wv"><field name="NUM">100</field></block></value><next><block type="dwenguino_delay" id="Un-0xX*gj~d[dzM2VPW{"><value name="DELAY_TIME"><block type="char_type" id="O8V/|K]MghjNUo^;u*Z7"><field name="BITMASK">1500</field></block></value><next><block type="dc_motor" id="#b8ipVpP2%f@GX{1*cEh"><value name="channel"><block type="math_number" id="1Bv@--r|;e:;{Tcs[0sp"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="W9onZYpkG)?oZXg+D.mP"><field name="NUM">-100</field></block></value><next><block type="dc_motor" id="br1l/`ornE`|7lUs0e!v"><value name="channel"><block type="math_number" id="spfET~H),:iUz7wM%7_}"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id=":v_5D%Zxo$8F9#*mn{T["><field name="NUM">172</field></block></value><next><block type="dwenguino_delay" id="fUAytMwz;AODn(w;=(]i"><value name="DELAY_TIME"><block type="char_type" id="N@OUe?*wdU4M64`^4oVM"><field name="BITMASK">100</field></block></value><next><block type="dc_motor" id="hqOS]]B(sc98`z/$0}ll"><value name="channel"><block type="math_number" id="5I?rQjd]q(-CC6U.,cBM"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="HA_k5I*sC`55]E:Y).[["><field name="NUM">100</field></block></value><next><block type="dc_motor" id="`D{WegX*xn@F]K5=@EvF"><value name="channel"><block type="math_number" id="oV,/.U@niXOwlvvM]WpC"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="9^4I@Scrp(K2+.J7^p0;"><field name="NUM">100</field></block></value><next><block type="dwenguino_delay" id="J2$2d,OC8RV:+T!Re6X0"><value name="DELAY_TIME"><block type="char_type" id="ZM@t|GIBj##i(0vS8r:k"><field name="BITMASK">1500</field></block></value><next><block type="dc_motor" id=";u/@8A47:TKzi6F#%CGb"><value name="channel"><block type="math_number" id="]X@nX0adD06-`$RZ{},G"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="I[_cmLEv4];|ZSX59LdP"><field name="NUM">-100</field></block></value><next><block type="dc_motor" id="|:Sz^|w6bvv%3`ReTx8|"><value name="channel"><block type="math_number" id="ay6tlwL/NUW^@z3Y`,1e"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id=")}wry~D^GS~nx+nJ4299"><field name="NUM">172</field></block></value><next><block type="dwenguino_delay" id="}]TPc%CK(bh,WY?va56["><value name="DELAY_TIME"><block type="char_type" id="XV0xogxOQ/+HvYzr}o5k"><field name="BITMASK">200</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()}},rideToWall:{category:"ridingrobot",id:"tutsRideToWall",label:MSG.tutsRideToWall,targets:[Je.simulatorButton,Je.simulatorScenarioTab,Je.simulatorScenarioSelection,Je.simulatorStartButton],placements:["left","left","left","left"],nrOfSteps:4,xOffsets:[0,0,0,0],yOffsets:[0,-20,-20,0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.rideToWall.stepTitles[e],content:MSG.tutorials.rideToWall.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="yMwUfZQ@p0kW8udJ1vEa" x="-48" y="-12"><statement name="LOOP"><block type="controls_if" id="@5_v({:-p!8Gi,2CfS*2"><mutation else="1"></mutation><value name="IF0"><block type="logic_compare" id="pO3`z[KM7dM91a$uJnV="><field name="OP">GTE</field><value name="A"><block type="char_type" id="`pUCfCWqQ-!Y8Hc4DFul"><field name="BITMASK">175</field></block></value><value name="B"><block type="sonar_sensor" id="%Ha2KSwLpWq]5!^?mUn?"><value name="trig"><block type="char_type" id="72"><field name="BITMASK">11</field></block></value><value name="echo"><block type="char_type" id="77"><field name="BITMASK">12</field></block></value></block></value></block></value><statement name="DO0"><block type="dc_motor" id="P4X+*n{_@l|O~^r3M$+P"><value name="channel"><block type="math_number" id="32"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="37"><field name="NUM">100</field></block></value><next><block type="dc_motor" id="b]=`Pdj9m@E^lqhSf+j7"><value name="channel"><block type="math_number" id="-w/)R/{#UU20.gVTQ:n)"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="KWy~7`w*vC_K}G@ma:$H"><field name="NUM">100</field></block></value></block></next></block></statement><statement name="ELSE"><block type="dc_motor" id="WF@SV9}kgwe`Dx1KEdfO"><value name="channel"><block type="math_number" id="p|~*dbxFy-j|.oB!i5$g"><field name="NUM">1</field></block></value><value name="speed"><block type="math_number" id="*Nynrtc$eF,g^0)az}^R"><field name="NUM">0</field></block></value><next><block type="dc_motor" id="oz9a#j`Kv,ZVyL35B{J6"><value name="channel"><block type="math_number" id="okt3fpvN^;FR?TW?wly|"><field name="NUM">2</field></block></value><value name="speed"><block type="math_number" id="vf/?P:IP6mI%GD-!biz~"><field name="NUM">0</field></block></value></block></next></block></statement><next><block type="dwenguino_delay" id="Ve-hN}})E6#/rWFaP`be"><value name="DELAY_TIME"><block type="char_type" id="r)z[m@Nos2|cpm^(MovD"><field name="BITMASK">100</field></block></value></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()}},introduceYourself:{category:"wegostem",targets:[Je.simulatorButton,Je.workspaceArea,Je.simulatorStartButton,Je.simulatorStopButton,Je.workspaceArea,Je.workspaceArea,Je.simulatorStartButton,Je.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.introduceYourself.stepTitles[e],content:MSG.tutorials.introduceYourself.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsIntroduceYourselfWeGoSTEM",label:MSG.tutsIntroduceYourselfWeGoSTEM,onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="0" y="0"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Hallo ik ben</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_lcd" id=",9zhGR,lzKr175:cPC*_"><value name="text"><block type="text" id="w8Id%a/kU}P]3_TQV1V^"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="VruQbfPoZ[O~4VG#:`[v"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="-7M*Tw!{?A}JvmAw(0_X"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="$W3lceEvUBsyDFFMM-Rf"><value name="DELAY_TIME"><block type="char_type" id="F-`0yf?Z6xT^qV5x(YV@"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a5X=ZhxL5lziaL[@+1q6"><next><block type="dwenguino_lcd" id="l`pv.^G_BTi%EpsWCp3d"><value name="text"><block type="text" id="L+/nc=~kAE0A)8hYW^b|"><field name="TEXT">en ik ben</field></block></value><value name="line_number"><block type="char_type" id=",9#]]M|vVX:X`i2FLYk9"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="IgSB;tv7Q63a*I/8c9xO"><field name="BITMASK">0</field></block></value><next><block type="clear_lcd" id="bV|!1IpEB|pF6zyTGedz"><next><block type="dwenguino_lcd" id="V_ap+n0Ve.h;yqUOiap]"><value name="text"><block type="text" id="FW[UnvsP|RyxEeB)*sw?"><field name="TEXT">27 jaar oud.</field></block></value><value name="line_number"><block type="char_type" id="?0+(u3VHL7RwnU6roe8o"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="g7)%Ze+Q`)7(XB?2H1g/"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="t*AwHh}[O0Oa:iWRf=Bi"><value name="DELAY_TIME"><block type="char_type" id="MT%/M(V*Sh@Lq?2s~|@C"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="B*^u3w%Jw`6F^5V~RI?!"></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()},onNext:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting))},onPrev:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting))}},lampOnOffWeGoSTEM:{category:"wegostem",targets:[Je.simulatorButton,Je.workspaceArea,Je.simulatorStartButton,Je.simulatorStopButton,Je.workspaceArea,Je.workspaceArea,Je.simulatorStartButton,Je.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.lampOnOffWeGoSTEM.stepTitles[e],content:MSG.tutorials.lampOnOffWeGoSTEM.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsLampOnOffWeGoSTEM",label:MSG.tutsLampOnOffWeGoSTEM,onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-312" y="822"><statement name="SETUP"><block type="dwenguino_set_led" id="JRP=z*2cxmd77C1]%2_j"><value name="LED"><block type="dwenguino_led_pins" id="`6(1#3#Z#$M@Xbq?1Xfd"><field name="LED_NUMBER">3</field></block></value><value name="LED_STATE"><block type="dwenguino_on_off" id="@5tkt/z/jAQ:%,nb:Bb-"><field name="LED_ON_OFF">ON</field></block></value><next><block type="dwenguino_delay" id="UY`BuwYMQ$Q@W/RBx4W6"><value name="DELAY_TIME"><block type="char_type" id="mj5fa8/DHdN^R`GxC1?-"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_set_led" id=";^M:Bzu.h.,8-bH|((6J"><value name="LED"><block type="dwenguino_led_pins" id="4fPa^^](u@WY76EvFzq3"><field name="LED_NUMBER">3</field></block></value><value name="LED_STATE"><block type="dwenguino_on_off" id="Vb]-SSu`gi!r(Jcf[GAP"><field name="LED_ON_OFF">OFF</field></block></value><next><block type="dwenguino_delay" id="b{y].+kK+[2Im*dxbNbG"><value name="DELAY_TIME"><block type="char_type" id="30LY_FvNethd98Kevj|b"><field name="BITMASK">500</field></block></value></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()},onNext:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting))},onPrev:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting))}},nameOnLcd:{category:"wegostem",targets:[Je.simulatorButton,Je.workspaceArea,Je.simulatorStartButton,Je.simulatorStopButton,Je.workspaceArea,Je.workspaceArea,Je.simulatorStartButton,Je.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:7,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.nameOnLcdWeGoSTEM.stepTitles[e],content:MSG.tutorials.nameOnLcdWeGoSTEM.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsNameOnLcdWeGoSTEM",label:MSG.tutsNameOnLcdWeGoSTEM,onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="V9/6@;rsE|D#Da%TQ1aq" x="-79" y="184"><statement name="SETUP"><block type="dwenguino_lcd" id="4[oLkNw/z5;Ou4dn-zdD"><value name="text"><block type="text" id="48"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()},onNext:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting))},onPrev:function(){it.recordEvent(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting))}},poem1:{category:"wegostem",targets:[Je.simulatorButton,Je.workspaceArea,Je.simulatorStartButton,Je.simulatorStopButton,Je.workspaceArea,Je.workspaceArea,Je.simulatorStartButton,Je.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.poem1.stepTitles[e],content:MSG.tutorials.poem1.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsPoem1",label:MSG.tutsPoem1,onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Ik fiets</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_delay" id="]ou@Z_|5^GvXMS68m4Y#"><value name="DELAY_TIME"><block type="char_type" id="LNrn.uWc!l{k)lWdw9xu"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="U37Ix-]Ulb(y%rp+HmMK"><value name="text"><block type="text" id="62=RnV.lI.d94k41Y|Wg"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="XPa1w4n/89hzWxAri?_Z"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Mj.b?|/ktlgxW9^Lv+GB"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="qA+kIka6dC`XK2Zat.^e"><value name="DELAY_TIME"><block type="char_type" id="WxmGodyzXxbbWo)/zP0j"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m5J96Dy^pC:gh?H)nGT#"><next><block type="dwenguino_delay" id="%?k#,bPe1-.s6Z7_S8qn"><value name="DELAY_TIME"><block type="char_type" id="!(gLCQ_G4;$(a`n7`O[="><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="TMkN#X]!w%McWa+(x=`9"><value name="text"><block type="text" id="IZ|[v`1EEX*`RQf+b5qF"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="iu*fPG%V5+ylVMoYt^jx"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="xL-yEduk#tQd$~t|1xBe"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="}KCE%K7;EC#vmey7^_Jo"><value name="DELAY_TIME"><block type="char_type" id="{Qw5:{GSy/lpM]ZiaD]!"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="FS#9!f68];h@Hgj8D`EH"><next><block type="dwenguino_delay" id="d,ppwLH6:]IWf8u,D}~S"><value name="DELAY_TIME"><block type="char_type" id="ve7y8sxdW$N[k3Lpj4K2"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="0j6gbZ`fQp^lzmur:H(i"><value name="text"><block type="text" id="-f]hE(|MCiW#54W#}kLK"><field name="TEXT">en fiets</field></block></value><value name="line_number"><block type="char_type" id="K)vYa`Z)#deQ!1}q{H.Q"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="LrH3gTKol.2*[p4jH4D0"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="C0:#WaEgbVZ[r~G@q|8b"><value name="DELAY_TIME"><block type="char_type" id="gZQ`(0$Bx-3=@BNWMrxO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="%[VVkF7@588nv1he[fA+"><next><block type="dwenguino_delay" id="u-M}Ap5N:_2+,:-`@4?E"><value name="DELAY_TIME"><block type="char_type" id="+V7?6g(f`(Da3.R+Ok2-"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id="4;?GCk$#1]UKqc*JpCtJ"><value name="text"><block type="text" id=".p6;|WP*pK!5P)^Ibi,-"><field name="TEXT">tegen de wind.</field></block></value><value name="line_number"><block type="char_type" id="yWI%[,$r2zZ.PH0((f:i"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="t_H?BNzNHvT2@CNp%@#7"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="19c_V.(8_w+v6);fCwfb"><value name="DELAY_TIME"><block type="char_type" id="6WH|Q$Q])3;UFw!KD!T?"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_delay" id="TXE6?Wg@/oIBY$p[Ga`z"><value name="DELAY_TIME"><block type="char_type" id="%cORf5sbBjB-.(-iG@AH"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id=";DtXuybn,xF/FOwjCF:4"><value name="text"><block type="text" id="t^{u]hkT)4L^+p!F[G2["><field name="TEXT">Trappen</field></block></value><value name="line_number"><block type="char_type" id="0p`XD[NDyMNta|%A7t/3"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="X;|n1^p*Chsc^vz,C@eT"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="wJt.NHYCT?xxFT0a|l-S"><value name="DELAY_TIME"><block type="char_type" id="mo?t2aHT*Uo*nC.GuTk}"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m2JGGH-h$jb)lM9CXYe0"><next><block type="dwenguino_delay" id="j?55rb3}E;+|Co*S`hM="><value name="DELAY_TIME"><block type="char_type" id="1BqO7(NNgg),p%MZHjA,"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id=":(tHu6%DX8iR?metFeL4"><value name="text"><block type="text" id="OYCuh1oaO@[PhnMV)b[J"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="mXr+iQF]OYanHl6]k-vM"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="eqvW,Y~do5;yeOS16mZ!"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="jNUVPY(fkulqIW406a;S"><value name="DELAY_TIME"><block type="char_type" id="?T{RaN{N^O?S^,m2uL[F"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MyQf_q(vqm-4Kx_ho/$u"><next><block type="dwenguino_delay" id="VD_W^T{~dxNxg+ZJRrXi"><value name="DELAY_TIME"><block type="char_type" id="+{%R9Y^?n4lmJ)~5/cuF"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="/9?@iKh%N%b029DX4a/y"><value name="text"><block type="text" id="wfjtaN2m3P6y}W+m[1/e"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="INY`bm#sWx3kX0IL?kXK"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="I.bF136;-%aT?*HI$X+2"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="OB@:R;FWiU0/DWh~BdPW"><value name="DELAY_TIME"><block type="char_type" id="kZ[ges6!FQi[V[*cMA12"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="|O~qL_TJ__o~oivI7foI"><next><block type="dwenguino_delay" id="Qoi4Q0WT!4n-a04+G4%V"><value name="DELAY_TIME"><block type="char_type" id=";bjjtx40w|%CvcF`r~:j"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="@4@sN;=}m^8TF;t(nAer"><value name="text"><block type="text" id="ikdC`Zv[xMl0{]pR)fX#"><field name="TEXT">en trappen</field></block></value><value name="line_number"><block type="char_type" id="lSH?~`gnf%JviI:2}XJa"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="CVE!tF8@md9U@rJgE4Dp"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="T%l(=V4s=SMhd}1vUxhO"><value name="DELAY_TIME"><block type="char_type" id="kvZqY}2@Wx=.oK}MQE*`"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="drLvsnCiFEO=F@]r#v4Q"><next><block type="dwenguino_delay" id="%MnMga`gWN]%+32u!RgU"><value name="DELAY_TIME"><block type="char_type" id="5kN0m5!C?@CWtjguYWE?"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="6s|0$NVe+8umnbfq{NMT"><value name="text"><block type="text" id="~L+6,{(?3yAP6xK,efvE"><field name="TEXT">tot ik de</field></block></value><value name="line_number"><block type="char_type" id="qKk!A~k$:Mfer04ru%qy"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="}4;f_3pfEL]+mV|2ERvU"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="5y|#JTSHq_7OSw}[$Xs2"><value name="DELAY_TIME"><block type="char_type" id="GK;j0.zlVIIBGr=*4/}D"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{peMF%hI`]z?9xGfcz:-"><next><block type="dwenguino_delay" id="h~OBWExeL3ARveT/(HrJ"><value name="DELAY_TIME"><block type="char_type" id="i4cO:Zk3g@8H.c~CE+p!"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="Tt-^0U-/AlU[zNYL*2i~"><value name="text"><block type="text" id="eU6fM4.r;iyJT%0QtE%X"><field name="TEXT">terugweg</field></block></value><value name="line_number"><block type="char_type" id=";A@Mjgew#J6ly=Rrne^J"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Zwb0f$9HU@EA`Csj`9X;"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="2,dHZC$8Bapou6cguPPq"><value name="DELAY_TIME"><block type="char_type" id=";$}G/:ENCQU,IZC7Ugeu"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a$8|j|+r8;K2l:531Ks8"><next><block type="dwenguino_delay" id="lYLnC,T[q.O{L{bGiaWj"><value name="DELAY_TIME"><block type="char_type" id="4=dUiv1|T{_Ka`gdQe3."><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="r;3ncPFmQh!eK_WX9#_A"><value name="text"><block type="text" id="wdH=[^XHUAYF,gw26L!P"><field name="TEXT">vind</field></block></value><value name="line_number"><block type="char_type" id="_3{h1-PT^:FLw[KYSgiR"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="8J87Y.-o)HM[~u{ma$p-"><field name="BITMASK">0</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()},onNext:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting))},onPrev:function(){it.logger.recordEvent(it.logger.createEvent(EVENT_NAMEStutorialPrevStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting))}},poem2:{category:"wegostem",targets:[Je.simulatorButton,Je.workspaceArea,Je.simulatorStartButton,Je.simulatorStopButton,Je.workspaceArea,Je.workspaceArea,Je.simulatorStartButton,Je.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.poem2.stepTitles[e],content:MSG.tutorials.poem2.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsPoem2",label:MSG.tutsPoem2,onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="LOOP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Luie</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"><next><block type="dwenguino_delay" id="]ou@Z_|5^GvXMS68m4Y#"><value name="DELAY_TIME"><block type="char_type" id="LNrn.uWc!l{k)lWdw9xu"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="U37Ix-]Ulb(y%rp+HmMK"><value name="text"><block type="text" id="62=RnV.lI.d94k41Y|Wg"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="XPa1w4n/89hzWxAri?_Z"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Mj.b?|/ktlgxW9^Lv+GB"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="qA+kIka6dC`XK2Zat.^e"><value name="DELAY_TIME"><block type="char_type" id="WxmGodyzXxbbWo)/zP0j"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m5J96Dy^pC:gh?H)nGT#"><next><block type="dwenguino_delay" id="%?k#,bPe1-.s6Z7_S8qn"><value name="DELAY_TIME"><block type="char_type" id="!(gLCQ_G4;$(a`n7`O[="><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="TMkN#X]!w%McWa+(x=`9"><value name="text"><block type="text" id="IZ|[v`1EEX*`RQf+b5qF"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="iu*fPG%V5+ylVMoYt^jx"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="xL-yEduk#tQd$~t|1xBe"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="}KCE%K7;EC#vmey7^_Jo"><value name="DELAY_TIME"><block type="char_type" id="{Qw5:{GSy/lpM]ZiaD]!"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="FS#9!f68];h@Hgj8D`EH"><next><block type="dwenguino_delay" id="d,ppwLH6:]IWf8u,D}~S"><value name="DELAY_TIME"><block type="char_type" id="ve7y8sxdW$N[k3Lpj4K2"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="0j6gbZ`fQp^lzmur:H(i"><value name="text"><block type="text" id="-f]hE(|MCiW#54W#}kLK"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="K)vYa`Z)#deQ!1}q{H.Q"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="LrH3gTKol.2*[p4jH4D0"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="C0:#WaEgbVZ[r~G@q|8b"><value name="DELAY_TIME"><block type="char_type" id="gZQ`(0$Bx-3=@BNWMrxO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="%[VVkF7@588nv1he[fA+"><next><block type="dwenguino_delay" id="u-M}Ap5N:_2+,:-`@4?E"><value name="DELAY_TIME"><block type="char_type" id="+V7?6g(f`(Da3.R+Ok2-"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id="4;?GCk$#1]UKqc*JpCtJ"><value name="text"><block type="text" id=".p6;|WP*pK!5P)^Ibi,-"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="yWI%[,$r2zZ.PH0((f:i"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="t_H?BNzNHvT2@CNp%@#7"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="19c_V.(8_w+v6);fCwfb"><value name="DELAY_TIME"><block type="char_type" id="6WH|Q$Q])3;UFw!KD!T?"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="Ycv@=wOlPFRmBR2e0=O/"><next><block type="dwenguino_delay" id="TXE6?Wg@/oIBY$p[Ga`z"><value name="DELAY_TIME"><block type="char_type" id="%cORf5sbBjB-.(-iG@AH"><field name="BITMASK">1000</field></block></value><next><block type="dwenguino_lcd" id=";DtXuybn,xF/FOwjCF:4"><value name="text"><block type="text" id="t^{u]hkT)4L^+p!F[G2["><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="0p`XD[NDyMNta|%A7t/3"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="X;|n1^p*Chsc^vz,C@eT"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="wJt.NHYCT?xxFT0a|l-S"><value name="DELAY_TIME"><block type="char_type" id="mo?t2aHT*Uo*nC.GuTk}"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="m2JGGH-h$jb)lM9CXYe0"><next><block type="dwenguino_delay" id="j?55rb3}E;+|Co*S`hM="><value name="DELAY_TIME"><block type="char_type" id="1BqO7(NNgg),p%MZHjA,"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id=":(tHu6%DX8iR?metFeL4"><value name="text"><block type="text" id="OYCuh1oaO@[PhnMV)b[J"><field name="TEXT">luie</field></block></value><value name="line_number"><block type="char_type" id="mXr+iQF]OYanHl6]k-vM"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="eqvW,Y~do5;yeOS16mZ!"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="jNUVPY(fkulqIW406a;S"><value name="DELAY_TIME"><block type="char_type" id="?T{RaN{N^O?S^,m2uL[F"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MyQf_q(vqm-4Kx_ho/$u"><next><block type="dwenguino_delay" id="VD_W^T{~dxNxg+ZJRrXi"><value name="DELAY_TIME"><block type="char_type" id="+{%R9Y^?n4lmJ)~5/cuF"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="z2G$,+(O8MXqsG@%H11H"><value name="text"><block type="text" id="]`3zL$n)c4Iq*xzBgH.T"><field name="TEXT">Trui</field></block></value><value name="line_number"><block type="char_type" id="pS%A*`i=OI[^JkNaC7BV"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="r/BGRl]k^1B9);lmYZA+"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id=")lfqScQ#!=TX.Ue)taec"><value name="DELAY_TIME"><block type="char_type" id="iiD^.IY_C*84m;faJ,`o"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="cH7Pj9[Ip;DY!r7!v?dc"><next><block type="dwenguino_delay" id="#U+By.Ih$=e?BFb,FO7l"><value name="DELAY_TIME"><block type="char_type" id="p%akSl+Egf)|/q!XnJ(i"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="/9?@iKh%N%b029DX4a/y"><value name="text"><block type="text" id="wfjtaN2m3P6y}W+m[1/e"><field name="TEXT">ze wil</field></block></value><value name="line_number"><block type="char_type" id="INY`bm#sWx3kX0IL?kXK"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="I.bF136;-%aT?*HI$X+2"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="OB@:R;FWiU0/DWh~BdPW"><value name="DELAY_TIME"><block type="char_type" id="kZ[ges6!FQi[V[*cMA12"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="|O~qL_TJ__o~oivI7foI"><next><block type="dwenguino_delay" id="Qoi4Q0WT!4n-a04+G4%V"><value name="DELAY_TIME"><block type="char_type" id=";bjjtx40w|%CvcF`r~:j"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="@4@sN;=}m^8TF;t(nAer"><value name="text"><block type="text" id="ikdC`Zv[xMl0{]pR)fX#"><field name="TEXT">een beetje</field></block></value><value name="line_number"><block type="char_type" id="lSH?~`gnf%JviI:2}XJa"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="CVE!tF8@md9U@rJgE4Dp"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="T%l(=V4s=SMhd}1vUxhO"><value name="DELAY_TIME"><block type="char_type" id="kvZqY}2@Wx=.oK}MQE*`"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="drLvsnCiFEO=F@]r#v4Q"><next><block type="dwenguino_delay" id="%MnMga`gWN]%+32u!RgU"><value name="DELAY_TIME"><block type="char_type" id="5kN0m5!C?@CWtjguYWE?"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="6s|0$NVe+8umnbfq{NMT"><value name="text"><block type="text" id="~L+6,{(?3yAP6xK,efvE"><field name="TEXT">water</field></block></value><value name="line_number"><block type="char_type" id="qKk!A~k$:Mfer04ru%qy"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="}4;f_3pfEL]+mV|2ERvU"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="5y|#JTSHq_7OSw}[$Xs2"><value name="DELAY_TIME"><block type="char_type" id="GK;j0.zlVIIBGr=*4/}D"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{peMF%hI`]z?9xGfcz:-"><next><block type="dwenguino_delay" id="h~OBWExeL3ARveT/(HrJ"><value name="DELAY_TIME"><block type="char_type" id="i4cO:Zk3g@8H.c~CE+p!"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="Tt-^0U-/AlU[zNYL*2i~"><value name="text"><block type="text" id="eU6fM4.r;iyJT%0QtE%X"><field name="TEXT">dus wacht ze</field></block></value><value name="line_number"><block type="char_type" id=";A@Mjgew#J6ly=Rrne^J"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="Zwb0f$9HU@EA`Csj`9X;"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="2,dHZC$8Bapou6cguPPq"><value name="DELAY_TIME"><block type="char_type" id=";$}G/:ENCQU,IZC7Ugeu"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="a$8|j|+r8;K2l:531Ks8"><next><block type="dwenguino_delay" id="lYLnC,T[q.O{L{bGiaWj"><value name="DELAY_TIME"><block type="char_type" id="4=dUiv1|T{_Ka`gdQe3."><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="w1KB0pSAA!d(biO9]JkD"><value name="text"><block type="text" id="a=y!$ACL_i[bntAB)aJu"><field name="TEXT">en</field></block></value><value name="line_number"><block type="char_type" id="QzOY1(6flDF2U:wxct=a"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="c]_+qZCDBN^6RLN!y!1C"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="9(?sJuxj6j@;x@7Asi|c"><value name="DELAY_TIME"><block type="char_type" id="BxwWPv_K3%X$BG3e|_Oc"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="{f]kzKN1KgQ04-`ne1;7"><next><block type="dwenguino_delay" id="cuokpl:?{2A@~M@7`OJP"><value name="DELAY_TIME"><block type="char_type" id="ko.6d~(W|RHjt!.[oc+3"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="d(2/Uxt1k-Am7ShkBH:_"><value name="text"><block type="text" id="uQWlQI8MXKv]upN92?^4"><field name="TEXT">wacht ze</field></block></value><value name="line_number"><block type="char_type" id="gA1O7dtGAkwnDPod-qkJ"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="0T3suk9E8^[zKtWs$1u{"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="!#wStl5v`X#o+LT2yZ)l"><value name="DELAY_TIME"><block type="char_type" id="^OUEa:xd}n%%%I5XhxM:"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="rhu,trF%un+^egaUO:^4"><next><block type="dwenguino_delay" id="gv~6C5Lw@BAwk_,Y`cHx"><value name="DELAY_TIME"><block type="char_type" id="(E2[@~[ye`E^:b/%Cc6Y"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="r;3ncPFmQh!eK_WX9#_A"><value name="text"><block type="text" id="wdH=[^XHUAYF,gw26L!P"><field name="TEXT">en</field></block></value><value name="line_number"><block type="char_type" id="_3{h1-PT^:FLw[KYSgiR"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="8J87Y.-o)HM[~u{ma$p-"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="y0GhV=5]ABe?=zbLvf7v"><value name="DELAY_TIME"><block type="char_type" id=":}QFXZ7`nnXwB`(V_ad:"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="?K(I5BVBS^ur(9~DAn8Q"><next><block type="dwenguino_delay" id="5F(mmk#|BZA{FYK9FA5P"><value name="DELAY_TIME"><block type="char_type" id="_B*H^I#x3LH,lvRige]$"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="fI_KQvo@Jc?tO(O(oG]Z"><value name="text"><block type="text" id="m%o7bigf~!hj.k^Nba?p"><field name="TEXT">wacht ze</field></block></value><value name="line_number"><block type="char_type" id="+4$/h26osEjf,+J@?aGm"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="1)uzWjEHVqs!UVQm{Z^o"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="EH(/x2ezA[g-/$RE4X2q"><value name="DELAY_TIME"><block type="char_type" id="jvuTJE+;=/uEEAr@)/yO"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="MZWY%~bbn2ZRrpOv3vE!"><next><block type="dwenguino_delay" id="c{6-WNdwSti%V+Pwq9c0"><value name="DELAY_TIME"><block type="char_type" id="nl3)@R}ab?$2DCPhHyDx"><field name="BITMASK">500</field></block></value><next><block type="dwenguino_lcd" id="u15(rgZKNp)p,^*nLK0X"><value name="text"><block type="text" id="}Dbqsn@^U.iCAi9j(hKK"><field name="TEXT">op een bui.</field></block></value><value name="line_number"><block type="char_type" id="8Hzg*-d1C7l@rJvfCHq@"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="lBM0=O*pNp!41R{!k/My"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="Kg*!@evlzIz/1~B3%,-7"><value name="DELAY_TIME"><block type="char_type" id="Xp-Oiku[1GMpeTsaBWbK"><field name="BITMASK">1000</field></block></value><next><block type="clear_lcd" id="o!TOAVQ.XXt%|lX4EF;-"><next><block type="dwenguino_delay" id="-E@C,!R2MbOs5Psn9nNK"><value name="DELAY_TIME"><block type="char_type" id="pN@k9d(?_Lq:20,9tVW]"><field name="BITMASK">2000</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()},onNext:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting))},onPrev:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting))}},showNameAndDisappear:{category:"wegostem",targets:[Je.simulatorButton,Je.workspaceArea,Je.simulatorStartButton,Je.simulatorStopButton,Je.workspaceArea,Je.workspaceArea,Je.simulatorStartButton,Je.dwenguino],placements:["left","top","left","left","top","top","left","left"],nrOfSteps:6,xOffsets:[0,"center",0,0,"center","center",0],yOffsets:[0,"top",0,0,"top","top",0],steps:[],initSteps:function(){var e;for(e=0;e<this.nrOfSteps;e++)this.steps.push({title:MSG.tutorials.showNameAndDisappear.stepTitles[e],content:MSG.tutorials.showNameAndDisappear.stepContents[e],target:this.targets[e],placement:this.placements[e],showCloseButton:"true",width:400,xOffset:this.xOffsets[e],yOffset:this.yOffsets[e]})},id:"tutsShowNameAndDisappearWeGoSTEM",label:MSG.tutsShowNameAndDisappearWeGoSTEM,onStart:function(){it.loadFileXmlIntoWorkspace('<xml xmlns="http://www.w3.org/1999/xhtml"><block type="setup_loop_structure" id="ndSZof?3RjcH}j2Lp/XZ" x="-20" y="56"><statement name="SETUP"><block type="dwenguino_lcd" id="P~z0QTD+UA%Wvi-1|pJi"><value name="text"><block type="text" id="48"><field name="TEXT">Tom</field></block></value><value name="line_number"><block type="char_type" id="53"><field name="BITMASK">0</field></block></value><value name="character_number"><block type="char_type" id="58"><field name="BITMASK">0</field></block></value><next><block type="dwenguino_delay" id="8^{{=Y9|}Yjf}J~*A}Ug"><value name="DELAY_TIME"><block type="char_type" id="TO?6iQPh}HsK1u6/()KQ"><field name="BITMASK">7000</field></block></value><next><block type="clear_lcd" id="mZ@64g4j].F$R?6I2;|e"></block></next></block></next></block></statement></block></xml>')},onEnd:function(){it.tutorialMenu.endTutorial()},onNext:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialNextStep,it.logger.tutorialIdSetting))},onPrev:function(){it.logger.recordEvent(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting)),console.log(it.logger.createEvent(O.tutorialPrevStep,it.logger.tutorialIdSetting))}}},tt=function(){function e(t){r()(this,e),c()(this,"tutorialCategory",""),c()(this,"eventLogger",null),this.eventLogger=t,this.initTutorialMenu()}return s()(e,[{key:"initTutorialMenu",value:function(){var e=this;$("#db_tutorials").click((function(){e.loadTutorialDialog(),e.addTutorialDialogEventHandlers(),e.showTutorialDialog()}))}},{key:"loadTutorialDialog",value:function(){$("#tutorialModal .modal-header").text(MSG.tutorialMenu.header),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="tutorial_label">'+MSG.tutorialMenu.chooseCategory+"</div>"),$("#tutorialModal .modal-body .message").append('<div id="tutorialModal_categories_menu" class="tutorial_categories_wrapper"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_dwenguino_components" class="tutorial_categories_item card"></div>'),$("#tutorial_category_dwenguino_components").append('<div class="category_tag">'+MSG.tutorialMenu.catDwenguinoComponents+"</div>"),$("#tutorial_category_dwenguino_compoentns").append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_wegostem" class="tutorial_categories_item card"></div>'),$("#tutorial_category_wegostem").append('<div class="category_tag">'+MSG.tutorialMenu.catWeGoStem+"</div>"),$("#tutorial_category_wegostem").append('<div id="tutorial_categories_wegostem_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_dwenguino" class="tutorial_categories_item card"></div>'),$("#tutorial_category_dwenguino").append('<div class="category_tag">'+MSG.tutorialMenu.catDwenguino+"</div>"),$("#tutorial_category_dwenguino").append('<div id="tutorial_categories_dwenguino_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_riding_robot" class="tutorial_categories_item card"></div>'),$("#tutorial_category_riding_robot").append('<div class="category_tag">'+MSG.tutorialMenu.catRidingRobot+"</div>"),$("#tutorial_category_riding_robot").append('<div id="tutorial_categories_riding_robot_img"></div>'),$("#tutorialModal_categories_menu").append('<div id="tutorial_category_social_robot" class="tutorial_categories_item card"></div>'),$("#tutorial_category_social_robot").append('<div class="category_tag">'+MSG.tutorialMenu.catSocialRobot+"</div>"),$("#tutorial_category_social_robot").append('<div id="tutorial_categories_social_robot_img"></div>'),$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>")}},{key:"addTutorialDialogEventHandlers",value:function(){var e=this;$("#tutorial_category_dwenguino_components").click((function(){e.loadComponentsOverview()})),$("#tutorial_category_wegostem").click((function(){e.loadTutorialsMenu("wegostem")})),$("#tutorial_category_dwenguino").click((function(){e.loadTutorialsMenu("dwenguino")})),$("#tutorial_category_riding_robot").click((function(){e.loadTutorialsMenu("ridingrobot")})),$("#tutorial_category_social_robot").click((function(){e.loadTutorialsMenu("socialrobot")})),$(".close").click((function(){e.hideTutorialDialog()}))}},{key:"showTutorialDialog",value:function(){$("#tutorialModal").modal("show")}},{key:"hideTutorialDialog",value:function(){$("#tutorialModal").modal("hide")}},{key:"loadTutorialsMenu",value:function(e){var t=this;$("#tutorialModal .modal-header").text(MSG.tutorialMenu.header),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="tutorial_label">'+MSG.tutorialMenu.chooseTutorial+"</div>"),$("#tutorialModal .modal-body .message").append('<div id="tutorialModal_tutorials_menu"></div>'),$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="previous_tutorial_dialog" type="button" class="btn btn-default">'+MSG.tutorialMenu.previous+"</button>"),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>"),$("#previous_tutorial_dialog").click((function(){t.loadTutorialDialog(),t.addTutorialDialogEventHandlers()}));var n={username:User.username,password:User.password,category:e},i=this;$.ajax({type:"POST",url:d.getServerUrl()+"/tutorials/completedTutorials",data:n}).done((function(t){$.each(et,(function(n,o){if(o.category==e){var r=!1;$.each(t,(function(e,t){o.id==t.tutorial_id&&(r=!0)})),i.addTutorial(o,r)}}))})).fail((function(t,n){console.warn("Failed to get completed tutorials:",n),$.each(et,(function(t,n){if(n.category==e){i.addTutorial(n,!1)}}))}))}},{key:"loadComponentsOverview",value:function(){var e=this;$("#tutorialModal .modal-header").text(MSG.tutorialMenu.dwenguinoComponents),$("#tutorialModal .modal-body .message").empty(),$("#tutorialModal .modal-body .message").append('<div class="container"></div>'),$("#tutorialModal .modal-body .message .container").append('<div id="row1" class="row"></div>'),$("#row1").append("<h2>Sensors</h2>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_sensors_menu" class="components_overview row"></div>');for(var t=[Ze,Ye,te,Ke],n=0;n<t.length;n++)$("#tutorialModal_sensors_menu").append('<div id="tutorial_sensors_'+t[n].getType()+'" class="col-3 bg-c-4 card"></div>'),$("#tutorial_sensors_"+t[n].getType()).append('<div class="category_tag">'+MSG.simulator[t[n].getType()]+"</div>"),$("#tutorial_sensors_"+t[n].getType()).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_sensors_"+t[n].getType()).append("<div>"+t[n].getDescription()+"</div>"),$("#tutorial_sensors_"+t[n].getType()).append('<div id="input_pins'+t[n].getType()+'">IN: </div>'),$("#tutorial_sensors_"+t[n].getType()).append('<div id="output_pins'+t[n].getType()+'">OUT: </div>'),$("#tutorial_sensors_"+t[n].getType()).append('<div id="circuit_pins'+t[n].getType()+'">CIRCUIT: </div>');$("#tutorialModal .modal-body .message .container").append('<div id="row2" class="row"></div>'),$("#row2").append("<h2>Actuators</h2>"),$("#tutorialModal .modal-body .message .container").append('<div id="row3" class="row"></div>'),$("#row3").append("<h3>Movement</h3>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_movement_menu" class="components_overview row"></div>');for(var i=[ze],o=0;o<i.length;o++)$("#tutorialModal_movement_menu").append('<div id="tutorial_movement_'+i[o].getType()+'" class="col-3 bg-c-11 card"></div>'),$("#tutorial_movement_"+i[o].getType()).append('<div class="category_tag">'+MSG.simulator[i[o].getType()]+"</div>"),$("#tutorial_movement_"+i[o].getType()).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_movement_"+i[o].getType()).append("<div>"+i[o].getDescription()+"</div>"),$("#tutorial_movement_"+i[o].getType()).append('<div id="input_pins'+i[o].getType()+'">IN: </div>'),$("#tutorial_movement_"+i[o].getType()).append('<div id="output_pins'+i[o].getType()+'">OUT: </div>'),$("#tutorial_movement_"+i[o].getType()).append('<div id="circuit_pins'+i[o].getType()+'">CIRCUIT: </div>');$("#tutorialModal .modal-body .message .container").append('<div id="row4" class="row"></div>'),$("#row4").append("<h3>Display</h3>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_display_menu" class="components_overview row"></div>');for(var r=[We,Ue],a=0;a<r.length;a++)$("#tutorialModal_display_menu").append('<div id="tutorial_display_'+r[a].getType()+'" class="col-3 bg-c-6 card"></div>'),$("#tutorial_display_"+r[a].getType()).append('<div class="category_tag">'+MSG.simulator[r[a].getType()]+"</div>"),$("#tutorial_display_"+r[a].getType()).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_display_"+r[a].getType()).append("<div>"+r[a].getDescription()+"</div>"),$("#tutorial_display_"+r[a].getType()).append('<div id="input_pins'+r[a].getType()+'">IN: </div>'),$("#tutorial_display_"+r[a].getType()).append('<div id="output_pins'+r[a].getType()+'">OUT: </div>'),$("#tutorial_display_"+r[a].getType()).append('<div id="circuit_pins'+r[a].getType()+'">CIRCUIT: </div>');$("#tutorialModal .modal-body .message .container").append('<div id="row5" class="row"></div>'),$("#row5").append("<h3>Audio</h3>"),$("#tutorialModal .modal-body .message .container").append('<div id="tutorialModal_audio_menu" class="components_overview row"></div>');for(var s=[je],l=0;l<s.length;l++)$("#tutorialModal_audio_menu").append('<div id="tutorial_audio_'+s[l].getType()+'" class="col-3 bg-c-3 card"></div>'),$("#tutorial_audio_"+s[l].getType()).append('<div class="category_tag">'+MSG.simulator[s[l].getType()]+"</div>"),$("#tutorial_audio_"+s[l].getType()).append('<div id="tutorial_categories_dwenguino_components_img"></div>'),$("#tutorial_audio_"+s[l].getType()).append("<div>"+s[l].getDescription()+"</div>"),$("#tutorial_audio_"+s[l].getType()).append('<div id="input_pins'+s[l].getType()+'">IN: </div>'),$("#tutorial_audio_"+s[l].getType()).append('<div id="output_pins'+s[l].getType()+'">OUT: </div>'),$("#tutorial_audio_"+s[l].getType()).append('<div id="circuit_pins'+s[l].getType()+'">CIRCUIT: </div>');for(var c=t.concat(i).concat(r).concat(s),u=0;u<c.length;u++){for(var d=c[u].getInputPins(),p=0;p<d.length;p++)$("#input_pins"+c[u].getType()).append('<span class="badge badge-pill">'+d[p]+"</span> ");for(var h=c[u].getOutputPins(),f=0;f<h.length;f++)$("#output_pins"+c[u].getType()).append('<span class="badge badge-pill">'+h[f]+"</span> ");$("#circuit_pins"+c[u].getType()).append('<span class="badge badge-pill">5V</span> '),$("#circuit_pins"+c[u].getType()).append('<span class="badge badge-pill">GND</span> ')}$("#tutorialModal .modal-footer").empty(),$("#tutorialModal .modal-footer").append('<button id="previous_tutorial_dialog" type="button" class="btn btn-default">'+MSG.tutorialMenu.previous+"</button>"),$("#tutorialModal .modal-footer").append('<button id="close_tutorial_dialog" type="button" class="btn btn-default" data-dismiss="modal">'+MSG.tutorialMenu.close+"</button>"),$("#previous_tutorial_dialog").click((function(){e.loadTutorialDialog(),e.addTutorialDialogEventHandlers()}))}},{key:"addTutorial",value:function(e,t){var n=this,i=$("<div>").attr("class","tutorial_item row").attr("id",e.id).attr("role","presentation");$("#tutorialModal_tutorials_menu").append(i),i.click((function(){n.eventLogger.tutorialId=e.id,n.tutorialCategory=e.category,n.eventLogger.tutorialIdSetting=e.id,e.initSteps(),hopscotch.configure({showPrevButton:"true"}),n.hideTutorialDialog(),hopscotch.startTour(e),n.eventLogger.recordEvent(n.eventLogger.createEvent(O.startTutorial,e.id))})),t?($("#"+e.id).append('<div class="glyphicon glyphicon-ok c-6 col-auto"></div>'),$("#"+e.id).append('<div class="col-auto">'+e.label+"</div>")):($("#"+e.id).append('<div class="glyphicon glyphicon-remove c-1 col-auto"></div>'),$("#"+e.id).append('<div class="col-auto">'+e.label+"</div>"))}},{key:"endTutorial",value:function(){this.saveCompleteTutorial(this.tutorialId,this.tutorialCategory),this.eventLogger.tutorialId="",this.eventLogger.tutorialIdSetting="",this.tutorialCategory="",this.eventLogger.recordEvent(this.eventLogger.createEvent(O.endTutorial,"")),this.showTutorialDialog()}},{key:"saveCompleteTutorial",value:function(e,t){console.log(e,t);var n={username:User.username,password:User.password,tutorialId:e,category:t};void 0!==this.eventLogger.sessionId&&$.ajax({type:"POST",url:d.getServerUrl()+"/tutorials/completeTutorial",data:n}).done((function(e){console.debug("Recording submitted",e)})).fail((function(e,t){console.warn("Failed to submit recording:",t)}))}}]),e}(),nt={simButtonStateClicked:!1,workspace:null,recording:"",difficultyLevel:1,simulatorState:"off",xmlLoadedFromFile:"",xmlFromScenario:"",logger:null,simulationEnvironment:null,tutorialMenu:null,fileIOController:null,initDwenguinoBlockly:function(e){this.workspace=e,this.setWorkspaceBlockFromXml('<xml id="startBlocks" style="display: none">'+document.getElementById("startBlocks").innerHTML+"</xml>"),this.fileIOController=new ke,this.logger=new h,this.logger.init();var t=this;this.tutorialMenu=new tt(this.logger),this.simulationEnvironment=new Fe(this.logger,this.workspace),nt.recording=window.sessionStorage.loadOnceRecording||"",delete window.sessionStorage.loadOnceRecording,$("#db_menu_item_difficulty_slider").slider({value:0,min:0,max:2,step:1,slide:function(e,n){nt.setDifficultyLevel(n.value),console.log(n.value),t.logger.recordEvent(t.logger.createEvent("setDifficultyLevel",n.value))}}),$("#db_menu_item_difficulty_slider_input").val("$"+$("#db_menu_item_difficulty_slider").slider("value")),$("#db_blockly").resizable({handles:"e"}),$("#db_blockly").resize((function(){nt.onresize(),Blockly.svgResize(nt.workspace)})),$("#db_menu_item_simulator").click((function(){nt.toggleSimulator()})),nt.toggleSimulator(),$("#db_menu_item_run").click((function(){Blockly.Arduino.emptySetup();var e=Blockly.Arduino.workspaceToCode(nt.workspace);nt.runEventHandler(e)})),$("#db_menu_item_upload").click((function(){if(window.File&&window.FileReader&&window.FileList&&window.Blob){console.log("yay, files supported"),$("div").remove("#dropzoneModal"),$("#blocklyDiv").append('<div id="dropzoneModal" class="modal fade" role="dialog"></div>'),$("#dropzoneModal").append('<div id="modalDialog" class="modal-dialog"></div>'),$("#modalDialog").append('<div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Upload</h4></div>'),$("#modalDialog").append('<div class="modal-body">'+MSG.dropzone.dictSelectFile+'<input type="file" id="fileInput"><div id="filedrag">'+MSG.dropzone.dictDefaultMessage+'</div><pre id="fileDisplayArea"><pre></div>'),$("#modalDialog").append('<div class="modal-footer"><button id="submit_upload_modal_dialog_button" type="button" class="btn btn-default" data-dismiss="modal">Ok</button></div>'),$("#dropzoneModal").modal("show");var e=function(e){if(e.type.match(/text.*/)){var t=new FileReader;t.onload=function(i){n.innerText=e.name,nt.xmlLoadedFromFile=t.result},t.readAsText(e)}else n.innerText="File not supported!"},t=document.getElementById("fileInput"),n=document.getElementById("fileDisplayArea");t.addEventListener("change",(function(n){var i=t.files[0];e(i)}));var i=function(e){e.stopPropagation(),e.preventDefault(),e.target.className="dragover"==e.type?"hover":""},o=document.getElementById("filedrag");o.addEventListener("dragover",i,!1),o.addEventListener("dragleave",i,!1),o.addEventListener("drop",(function(t){i(t);var n=(t.target.files||t.dataTransfer.files)[0];e(n)}),!1),o.style.display="block",$("#submit_upload_modal_dialog_button").click((function(){nt.restoreFromXml(Blockly.Xml.textToDom(nt.xmlLoadedFromFile))}))}else alert("The File APIs are not fully supported in this browser.")})),$("#db_menu_item_download").click((function(){var e=Blockly.Xml.workspaceToDom(nt.workspace),n=Blockly.Xml.domToText(e);console.log(n),localStorage.workspaceXml=n,nt.download("blocks.xml",n),nt.logger.recordEvent(t.logger.createEvent(O.downloadClicked,""))})),$("#db_menu_item_clear").click((function(){nt.simulationEnvironment.stop();nt.runEventHandler('#include <Wire.h>\n#include <Dwenguino.h>\n#include <LiquidCrystal.h>\n\nvoid setup(){\ninitDwenguino();\ndwenguinoLCD.setCursor(2,0);\ndwenguinoLCD.print(String("WeGoSTEM ;)"));\n}\n\nvoid loop(){}\n')})),$("#blocklyDiv").click((function(){nt.simulationEnvironment.stop()})),nt.workspace.addChangeListener((function(e){if(console.log("blockly event"),"create"==e.type){var t={xml:e.xml,ids:e.ids};t=JSON.stringify(t),nt.logger.recordEvent(nt.logger.createEvent(O.blocklyBlockCreate,t))}else if("delete"==e.type){t={oldXml:e.oldXml,ids:e.ids};t=JSON.stringify(t),nt.logger.recordEvent(nt.logger.createEvent(O.blocklyBlockDelete,t))}else if("move"==e.type){t={oldParentId:e.oldParentId,oldInputName:e.oldInputName,oldCoordinate:e.oldCoordinate,newParentId:e.newParentId,newInputName:e.newInputName,newCoordinate:e.newCoordinate};t=JSON.stringify(t),nt.logger.recordEvent(nt.logger.createEvent(O.blocklyBlockMove,t))}else if("createVar"==e.type){t={varType:e.varType,varName:e.varName,varId:e.varId};t=JSON.stringify(t),nt.logger.recordEvent(nt.logger.createEvent(O.blocklyVarCreate,t))}else if("deleteVar"==e.type){t={varType:e.varType,varName:e.varName,varId:e.varId};t=JSON.stringify(t),nt.logger.recordEvent(nt.logger.createEvent(O.blocklyVarDelete,t))}else if(e.type==Blockly.Events.VAR_RENAME){t={oldName:e.oldName,newName:e.newName,varId:e.varId};t=JSON.stringify(t),nt.logger.recordEvent(nt.logger.createEvent(O.blocklyVarRename,t))}else if(e.type==Blockly.Events.UI){t={element:e.element,oldValue:e.oldValue,newValue:e.newValue};t=JSON.stringify(t),nt.logger.recordEvent(nt.logger.createEvent(O.blocklyUI,t))}else if(e.type==Blockly.Events.CHANGE){t={element:e.element,name:e.name,oldValue:e.oldValue,newValue:e.newValue};t=JSON.stringify(t),nt.logger.recordEvent(nt.logger.createEvent(O.blocklyChange,t))}else if(e.type==Blockly.Events.UNDO){console.log(e);t={};nt.logger.recordEvent(nt.logger.createEvent(O.undo,t))}}))},restoreFromXml:function(e){nt.workspace.clear(),Blockly.Xml.domToWorkspace(e,nt.workspace);nt.workspace.getAllBlocks().length;nt.logger.recordEvent(nt.logger.createEvent(O.uploadClicked,e))},download:function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},toggleSimulator:function(){var e=[];this.simButtonStateClicked?(e=["100%","off",!1],nt.simulationEnvironment.stop()):(e=["50%","on",!0],nt.simulationEnvironment.open()),$("#db_blockly").width(e[0]),this.simButtonStateClicked=e[2],nt.simulatorState=e[1],nt.logger.recordEvent(nt.logger.createEvent(O.simButtonStateClicked,nt.simulatorState)),nt.onresize(),Blockly.svgResize(nt.workspace)},runEventHandler:function(e){nt.disableRunButton(),$.ajax({url:d.getServerUrl()+"/utilities/run",dataType:"json",type:"post",contentType:"application/x-www-form-urlencoded",data:{code:e},success:function(e,t,n){console.log("succes"),console.log(e),"error"===e.status&&nt.showModalErrorDialog(e),nt.resetRunButton()},error:function(e,t,n){console.log(n),nt.resetRunButton()}}),console.log(e.replace(/\r?\n|\r/g,"\n")),nt.logger.recordEvent(nt.logger.createEvent(O.runClicked,""))},showModalErrorDialog:function(e){$("#errorModal .modal-header").html(MSG.runError),"Upload failed"===e.info?$("#errorModal .modal-body .message").html(MSG.uploadError):"Compilation failed"===e.info?$("#errorModal .modal-body .message").html(MSG.compileError):"Clean failed"===e.info?$("#errorModal .modal-body .message").html(MSG.cleanError):$("#errorModal .modal-body .message").html(MSG.uploadError),$("#errorModal .modal-body .console").hide(),$("#errorModal .modal-body .error_details").off("click"),$("#errorModal .modal-body .error_details").click((function(){console.log("toggle console"),$("#errorModal .modal-body .console").toggle()})),"SIGTERM"===e.message.signal?$("#errorModal .modal-body .console").html("Operation timed out"):$("#errorModal .modal-body .console").html(e.trace),$("#errorModal").modal("show")},disableRunButton:function(){$("#db_menu_item_run").off("click"),$("#db_menu_item_clear").off("click"),$("#db_menu_item_dwengo_robot_teacher_image").attr("src","DwenguinoIDE/img/gear_animation.gif"),$("#db_menu_item_dwengo_robot_teacher_image").css({padding:"10px 25px",maxHeight:"100%",float:"right"}),$("#db_menu_item_run").css({color:"gray"}),$("#db_menu_item_clear").css({color:"gray"})},resetRunButton:function(){$("#db_menu_item_run").click((function(){Blockly.Arduino.emptySetup();var e=Blockly.Arduino.workspaceToCode(nt.workspace);nt.runEventHandler(e)})),$("#db_menu_item_clear").click((function(){nt.runEventHandler('#include <Wire.h>\n#include <Dwenguino.h>\n#include <LiquidCrystal.h>\n\nvoid setup(){\ninitDwenguino();\ndwenguinoLCD.setCursor(2,0);\ndwenguinoLCD.print(String("WeGoSTEM ;)"));\n}\n\nvoid loop(){}\n')})),$("#db_menu_item_run").css({color:"black"}),$("#db_menu_item_run").hover((function(){$(this).css({color:"#8bab42"})})),$("#db_menu_item_run").mouseleave((function(){$(this).css({color:"black"})})),$("#db_menu_item_clear").css({color:"black"}),$("#db_menu_item_clear").hover((function(){$(this).css({color:"#8bab42"})})),$("#db_menu_item_clear").mouseleave((function(){$(this).css({color:"black"})})),$("#db_menu_item_dwengo_robot_teacher_image").css({padding:"10px",maxHeight:"100%",float:"right"}),$("#db_menu_item_dwengo_robot_teacher_image").attr("src","DwenguinoIDE/img/dwengo_robot_plain.svg")},prevWorkspaceXml:"",takeSnapshotOfWorkspace:function(){console.log("taking snapshot");var e=Blockly.Xml.workspaceToDom(nt.workspace),t=Blockly.Xml.domToText(e);if(t!=nt.prevWorkspaceXml){var n={blocksXml:t,blocksJsCode:Blockly.JavaScript.workspaceToCode(nt.workspace)},i=JSON.stringify(n);nt.prevWorkspaceXml=t,nt.logger.recordEvent(this.logger.createEvent(O.changedWorkspace,i))}},logCodeChange:function(e){nt.takeSnapshotOfWorkspace()},previouslyRenderedCode:null,renderCode:function(){nt.logCodeChange(),Blockly.Arduino.emptySetup();var e=Blockly.Arduino.workspaceToCode(nt.workspace);if(null===nt.previouslyRenderedCode)document.getElementById("db_arduino_code").innerHTML=prettyPrintOne(e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),"cpp",!1),nt.previouslyRenderedCode=e;else if(e!==nt.previouslyRenderedCode){for(var t=JsDiff.diffWords(nt.previouslyRenderedCode,e),n=[],i=0;i<t.length;i++)if(!t[i].removed){var o=t[i].value.replace(/</g,"&lt;").replace(/>/g,"&gt;");t[i].added?n.push('<span class="code_highlight_new">'+o+"</span>"):n.push(o)}document.getElementById("db_arduino_code").innerHTML=prettyPrintOne(n.join(""),"cpp",!1),nt.previouslyRenderedCode=e}},setDifficultyLevel:function(e){nt.difficultyLevel=e,$("#toolbox").load("./DwenguinoIDE/levels/lvl"+e+".xml",(function(){nt.doTranslation(),nt.workspace.updateToolbox(document.getElementById("toolbox"))}))},loadFileXmlIntoWorkspace:function(e){console.log("loading into workspace"),nt.setWorkspaceBlockFromXml(e)},onresize:function(){var e=document.getElementById("db_blockly"),t=document.getElementById("blocklyDiv"),n=e,i=0,o=0;do{i+=n.offsetLeft,o+=n.offsetTop,n=n.offsetParent}while(n);t.style.left=i+"px",t.style.top=o+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px"},injectBlockly:function(){document.getElementById("db_blockly");var e=document.getElementById("blocklyDiv"),t=Blockly.inject(e,{toolbox:document.getElementById("toolbox"),media:"DwenguinoIDE/img/",zoom:{controls:!0,wheel:!0},undo:!0});window.addEventListener("resize",nt.onresize,!1),nt.onresize(),Blockly.svgResize(t),t.addChangeListener(nt.renderCode);return t.registerButtonCallback("createVariableCallback",(function(e){console.log("Creating new variable")})),t.registerToolboxCategoryCallback("DWB_VARIABLES",(function(){var e=t.getAllVariables(),n=[];n.push('<block type="variables_declare_set_int"></block>'),n.push('<block type="variables_get_int"></block>'),n.push('<block type="variables_declare_set_string"></block>'),n.push('<block type="variables_get_string"></block>'),console.log(e);for(var i=0;i<e.length;i++){var o='<block type="variables_get'+("Number"==e[i].type?"_int":"String"==e[i].type?"_string":"")+'"><field name="VAR" id="';o=(o=(o=o+e[i].id_+'" variabletype="')+e[i].type+'">')+e[i].name+"</field></block>",console.log(o),n.push(o)}var r=[];for(i=0;i<n.length;i++)r.push(Blockly.Xml.textToDom(n[i]));return r})),t},changeLanguage:function(){if("undefined"!=typeof Blockly&&window.sessionStorage){var e=Blockly.Xml.workspaceToDom(nt.workspace),t=Blockly.Xml.domToText(e);window.sessionStorage.loadOnceBlocks=t,window.sessionStorage.loadOnceRecording=nt.recording,window.sessionStorage.loadOnceSessionId=nt.sessionId}var n=document.getElementById("db_menu_item_language_selection"),i=encodeURIComponent(n.options[n.selectedIndex].value),o=window.location.search;o=o.length<=1?"?lang="+i:o.match(/[?&]lang=[^&]*/)?o.replace(/([?&]lang=)[^&]*/,"$1"+i):o.replace(/\?/,"?lang="+i+"&"),window.location=window.location.protocol+"//"+window.location.host+window.location.pathname+o},LANG:DwenguinoBlocklyLanguageSettings.getLang(),isRtl:function(){return!1},initLanguage:function(){var e=nt.isRtl();document.dir=e?"rtl":"ltr",document.head.parentElement.setAttribute("lang",nt.LANG);var t=[];for(var n in DwenguinoBlocklyLanguageSettings.LANGUAGE_NAME)t.push([DwenguinoBlocklyLanguageSettings.LANGUAGE_NAME[n],n]);t.sort((function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}));var i=document.getElementById("db_menu_item_language_selection");i.options.length=0;for(var o=0;o<t.length;o++){var r=t[o],a=(n=r[r.length-1],new Option(r[0],n));n===nt.LANG&&(a.selected=!0),i.options.add(a)}i.addEventListener("change",nt.changeLanguage,!0)},doTranslation:function(){document.title+=" "+MSG.title,document.getElementById("db_menu_item_upload").title=MSG.loadBlocksFileTooltip,document.getElementById("db_menu_item_download").title=MSG.saveBlocksFileTooltip,document.getElementById("db_menu_item_simulator").title=MSG.toggleSimulator;for(var e,t=["catLogic","catLoops","catMath","catText","catLists","catColour","catVariables","catFunctions","catBoardIO","catDwenguino","catSocialRobot","catArduino","catComments"],n=0;e=t[n];n++){var i=document.getElementById(e);i&&i.setAttribute("name",MSG[e])}var o,r=document.getElementsByClassName("textVar");for(n=0;o=r[n];n++)o.textContent=MSG.textVariable;var a,s=document.getElementsByClassName("listVar");for(n=0;a=s[n];n++)a.textContent=MSG.listVariable},loadBlocks:function(e){try{var t=window.sessionStorage.loadOnceBlocks}catch(e){t=null}if("BlocklyStorage"in window&&window.location.hash.length>1)BlocklyStorage.retrieveXml(window.location.hash.substring(1));else if(t){delete window.sessionStorage.loadOnceBlocks;var n=Blockly.Xml.textToDom(t);Blockly.Xml.domToWorkspace(n,nt.workspace)}else if(e){n=Blockly.Xml.textToDom(e);Blockly.Xml.domToWorkspace(n,nt.workspace),nt.recording=""}else"BlocklyStorage"in window&&window.setTimeout(BlocklyStorage.restoreBlocks,0)},setWorkspaceBlockFromXml:function(e){nt.workspace.clear();try{var t=Blockly.Xml.textToDom(e)}catch(e){return void console.log("invalid xml")}Blockly.Xml.domToWorkspace(t,nt.workspace)},setupEnvironment:function(){nt.initLanguage();var e=nt.injectBlockly();nt.initDwenguinoBlockly(e),nt.doTranslation(),nt.setDifficultyLevel(0),nt.takeSnapshotOfWorkspace(),$(window).resize((function(){nt.onresize(),Blockly.svgResize(nt.workspace)}));var t=document.querySelector('input[id="code_checkbox"]');t.addEventListener("change",(function(){t.checked?(document.getElementById("blocklyDiv").style.visibility="hidden",document.getElementById("db_code_pane").style.visibility="visible",nt.renderCode()):(document.getElementById("blocklyDiv").style.visibility="visible",document.getElementById("db_code_pane").style.visibility="hidden")}))},tearDownEnvironment:function(){}};$(document).ready((function(){nt.setupEnvironment()}));var it=t.default=nt}]);